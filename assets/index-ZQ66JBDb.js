var v_=Object.defineProperty;var Hk=n=>{throw TypeError(n)};var w_=(n,t,e)=>t in n?v_(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var _t=(n,t,e)=>w_(n,typeof t!="symbol"?t+"":t,e),Uw=(n,t,e)=>t.has(n)||Hk("Cannot "+e);var f=(n,t,e)=>(Uw(n,t,"read from private field"),e?e.call(n):t.get(n)),M=(n,t,e)=>t.has(n)?Hk("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),k=(n,t,e,r)=>(Uw(n,t,"write to private field"),r?r.call(n,e):t.set(n,e),e),P=(n,t,e)=>(Uw(n,t,"access private method"),e);var Pr=(n,t,e,r)=>({set _(s){k(n,t,s,e)},get _(){return f(n,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Kv(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const we={},Ud=[],ei=()=>{},x_=()=>!1,ny=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),KA=n=>n.startsWith("onUpdate:"),ze=Object.assign,GA=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},S_=Object.prototype.hasOwnProperty,Oe=(n,t)=>S_.call(n,t),xt=Array.isArray,Wd=n=>kf(n)==="[object Map]",sd=n=>kf(n)==="[object Set]",Vk=n=>kf(n)==="[object Date]",A_=n=>kf(n)==="[object RegExp]",Bt=n=>typeof n=="function",Ge=n=>typeof n=="string",Oi=n=>typeof n=="symbol",$e=n=>n!==null&&typeof n=="object",YA=n=>($e(n)||Bt(n))&&Bt(n.then)&&Bt(n.catch),c2=Object.prototype.toString,kf=n=>c2.call(n),E_=n=>kf(n).slice(8,-1),Gv=n=>kf(n)==="[object Object]",XA=n=>Ge(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Kd=Kv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Yv=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},k_=/-(\w)/g,lr=Yv(n=>n.replace(k_,(t,e)=>e?e.toUpperCase():"")),C_=/\B([A-Z])/g,as=Yv(n=>n.replace(C_,"-$1").toLowerCase()),ry=Yv(n=>n.charAt(0).toUpperCase()+n.slice(1)),xp=Yv(n=>n?`on${ry(n)}`:""),Fr=(n,t)=>!Object.is(n,t),Gd=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},u2=(n,t,e,r=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:r,value:e})},nb=n=>{const t=parseFloat(n);return isNaN(t)?n:t},rb=n=>{const t=Ge(n)?Number(n):NaN;return isNaN(t)?n:t};let zk;const Xv=()=>zk||(zk=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),T_="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",M_=Kv(T_);function Wn(n){if(xt(n)){const t={};for(let e=0;e<n.length;e++){const r=n[e],s=Ge(r)?R_(r):Wn(r);if(s)for(const i in s)t[i]=s[i]}return t}else if(Ge(n)||$e(n))return n}const P_=/;(?![^(]*\))/g,O_=/:([^]+)/,I_=/\/\*[^]*?\*\//g;function R_(n){const t={};return n.replace(I_,"").split(P_).forEach(e=>{if(e){const r=e.split(O_);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Kt(n){let t="";if(Ge(n))t=n;else if(xt(n))for(let e=0;e<n.length;e++){const r=Kt(n[e]);r&&(t+=r+" ")}else if($e(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}function D_(n){if(!n)return null;let{class:t,style:e}=n;return t&&!Ge(t)&&(n.class=Kt(t)),e&&(n.style=Wn(e)),n}const N_="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",__=Kv(N_);function d2(n){return!!n||n===""}function L_(n,t){if(n.length!==t.length)return!1;let e=!0;for(let r=0;e&&r<n.length;r++)e=Gl(n[r],t[r]);return e}function Gl(n,t){if(n===t)return!0;let e=Vk(n),r=Vk(t);if(e||r)return e&&r?n.getTime()===t.getTime():!1;if(e=Oi(n),r=Oi(t),e||r)return n===t;if(e=xt(n),r=xt(t),e||r)return e&&r?L_(n,t):!1;if(e=$e(n),r=$e(t),e||r){if(!e||!r)return!1;const s=Object.keys(n).length,i=Object.keys(t).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Gl(n[o],t[o]))return!1}}return String(n)===String(t)}function qv(n,t){return n.findIndex(e=>Gl(e,t))}const h2=n=>!!(n&&n.__v_isRef===!0),pt=n=>Ge(n)?n:n==null?"":xt(n)||$e(n)&&(n.toString===c2||!Bt(n.toString))?h2(n)?pt(n.value):JSON.stringify(n,f2,2):String(n),f2=(n,t)=>h2(t)?f2(n,t.value):Wd(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[r,s],i)=>(e[Ww(r,i)+" =>"]=s,e),{})}:sd(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Ww(e))}:Oi(t)?Ww(t):$e(t)&&!xt(t)&&!Gv(t)?String(t):t,Ww=(n,t="")=>{var e;return Oi(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let br;class qA{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=br,!t&&br&&(this.index=(br.scopes||(br.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=br;try{return br=this,t()}finally{br=e}}}on(){++this._on===1&&(this.prevScope=br,br=this)}off(){this._on>0&&--this._on===0&&(br=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,r;for(e=0,r=this.effects.length;e<r;e++)this.effects[e].stop();for(this.effects.length=0,e=0,r=this.cleanups.length;e<r;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function JA(n){return new qA(n)}function QA(){return br}function p2(n,t=!1){br&&br.cleanups.push(n)}let Ke;const Kw=new WeakSet;class Zp{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,br&&br.active&&br.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Kw.has(this)&&(Kw.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||m2(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Uk(this),y2(this);const t=Ke,e=Ti;Ke=this,Ti=!0;try{return this.fn()}finally{b2(this),Ke=t,Ti=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)eE(t);this.deps=this.depsTail=void 0,Uk(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Kw.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){r1(this)&&this.run()}get dirty(){return r1(this)}}let g2=0,Sp,Ap;function m2(n,t=!1){if(n.flags|=8,t){n.next=Ap,Ap=n;return}n.next=Sp,Sp=n}function ZA(){g2++}function tE(){if(--g2>0)return;if(Ap){let t=Ap;for(Ap=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Sp;){let t=Sp;for(Sp=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){n||(n=r)}t=e}}if(n)throw n}function y2(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function b2(n){let t,e=n.depsTail,r=e;for(;r;){const s=r.prevDep;r.version===-1?(r===e&&(e=s),eE(r),F_(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=t,n.depsTail=e}function r1(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(v2(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function v2(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===tg)||(n.globalVersion=tg,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!r1(n))))return;n.flags|=2;const t=n.dep,e=Ke,r=Ti;Ke=n,Ti=!0;try{y2(n);const s=n.fn(n._value);(t.version===0||Fr(s,n._value))&&(n.flags|=128,n._value=s,t.version++)}catch(s){throw t.version++,s}finally{Ke=e,Ti=r,b2(n),n.flags&=-3}}function eE(n,t=!1){const{dep:e,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),e.subs===n&&(e.subs=r,!r&&e.computed)){e.computed.flags&=-5;for(let i=e.computed.deps;i;i=i.nextDep)eE(i,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function F_(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}function B_(n,t){n.effect instanceof Zp&&(n=n.effect.fn);const e=new Zp(n);t&&ze(e,t);try{e.run()}catch(s){throw e.stop(),s}const r=e.run.bind(e);return r.effect=e,r}function $_(n){n.effect.stop()}let Ti=!0;const w2=[];function Sa(){w2.push(Ti),Ti=!1}function Aa(){const n=w2.pop();Ti=n===void 0?!0:n}function Uk(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Ke;Ke=void 0;try{t()}finally{Ke=e}}}let tg=0,j_=class{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Jv{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ke||!Ti||Ke===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Ke)e=this.activeLink=new j_(Ke,this),Ke.deps?(e.prevDep=Ke.depsTail,Ke.depsTail.nextDep=e,Ke.depsTail=e):Ke.deps=Ke.depsTail=e,x2(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const r=e.nextDep;r.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=r),e.prevDep=Ke.depsTail,e.nextDep=void 0,Ke.depsTail.nextDep=e,Ke.depsTail=e,Ke.deps===e&&(Ke.deps=r)}return e}trigger(t){this.version++,tg++,this.notify(t)}notify(t){ZA();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{tE()}}}function x2(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)x2(r)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const sb=new WeakMap,Ru=Symbol(""),s1=Symbol(""),eg=Symbol("");function xr(n,t,e){if(Ti&&Ke){let r=sb.get(n);r||sb.set(n,r=new Map);let s=r.get(e);s||(r.set(e,s=new Jv),s.map=r,s.key=e),s.track()}}function la(n,t,e,r,s,i){const o=sb.get(n);if(!o){tg++;return}const a=l=>{l&&l.trigger()};if(ZA(),t==="clear")o.forEach(a);else{const l=xt(n),c=l&&XA(e);if(l&&e==="length"){const u=Number(r);o.forEach((d,h)=>{(h==="length"||h===eg||!Oi(h)&&h>=u)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(eg)),t){case"add":l?c&&a(o.get("length")):(a(o.get(Ru)),Wd(n)&&a(o.get(s1)));break;case"delete":l||(a(o.get(Ru)),Wd(n)&&a(o.get(s1)));break;case"set":Wd(n)&&a(o.get(Ru));break}}tE()}function H_(n,t){const e=sb.get(n);return e&&e.get(t)}function hd(n){const t=be(n);return t===n?t:(xr(t,"iterate",eg),Os(n)?t:t.map(ir))}function Qv(n){return xr(n=be(n),"iterate",eg),n}const V_={__proto__:null,[Symbol.iterator](){return Gw(this,Symbol.iterator,ir)},concat(...n){return hd(this).concat(...n.map(t=>xt(t)?hd(t):t))},entries(){return Gw(this,"entries",n=>(n[1]=ir(n[1]),n))},every(n,t){return So(this,"every",n,t,void 0,arguments)},filter(n,t){return So(this,"filter",n,t,e=>e.map(ir),arguments)},find(n,t){return So(this,"find",n,t,ir,arguments)},findIndex(n,t){return So(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return So(this,"findLast",n,t,ir,arguments)},findLastIndex(n,t){return So(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return So(this,"forEach",n,t,void 0,arguments)},includes(...n){return Yw(this,"includes",n)},indexOf(...n){return Yw(this,"indexOf",n)},join(n){return hd(this).join(n)},lastIndexOf(...n){return Yw(this,"lastIndexOf",n)},map(n,t){return So(this,"map",n,t,void 0,arguments)},pop(){return Df(this,"pop")},push(...n){return Df(this,"push",n)},reduce(n,...t){return Wk(this,"reduce",n,t)},reduceRight(n,...t){return Wk(this,"reduceRight",n,t)},shift(){return Df(this,"shift")},some(n,t){return So(this,"some",n,t,void 0,arguments)},splice(...n){return Df(this,"splice",n)},toReversed(){return hd(this).toReversed()},toSorted(n){return hd(this).toSorted(n)},toSpliced(...n){return hd(this).toSpliced(...n)},unshift(...n){return Df(this,"unshift",n)},values(){return Gw(this,"values",ir)}};function Gw(n,t,e){const r=Qv(n),s=r[t]();return r!==n&&!Os(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=e(i.value)),i}),s}const z_=Array.prototype;function So(n,t,e,r,s,i){const o=Qv(n),a=o!==n&&!Os(n),l=o[t];if(l!==z_[t]){const d=l.apply(n,i);return a?ir(d):d}let c=e;o!==n&&(a?c=function(d,h){return e.call(this,ir(d),h,n)}:e.length>2&&(c=function(d,h){return e.call(this,d,h,n)}));const u=l.call(o,c,r);return a&&s?s(u):u}function Wk(n,t,e,r){const s=Qv(n);let i=e;return s!==n&&(Os(n)?e.length>3&&(i=function(o,a,l){return e.call(this,o,a,l,n)}):i=function(o,a,l){return e.call(this,o,ir(a),l,n)}),s[t](i,...r)}function Yw(n,t,e){const r=be(n);xr(r,"iterate",eg);const s=r[t](...e);return(s===-1||s===!1)&&ew(e[0])?(e[0]=be(e[0]),r[t](...e)):s}function Df(n,t,e=[]){Sa(),ZA();const r=be(n)[t].apply(n,e);return tE(),Aa(),r}const U_=Kv("__proto__,__v_isRef,__isVue"),S2=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Oi));function W_(n){Oi(n)||(n=String(n));const t=be(this);return xr(t,"has",n),t.hasOwnProperty(n)}class A2{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,r){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return i;if(e==="__v_raw")return r===(s?i?P2:M2:i?T2:C2).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=xt(t);if(!s){let l;if(o&&(l=V_[e]))return l;if(e==="hasOwnProperty")return W_}const a=Reflect.get(t,e,dn(t)?t:r);return(Oi(e)?S2.has(e):U_(e))||(s||xr(t,"get",e),i)?a:dn(a)?o&&XA(e)?a:a.value:$e(a)?s?rE(a):Cf(a):a}}class E2 extends A2{constructor(t=!1){super(!1,t)}set(t,e,r,s){let i=t[e];if(!this._isShallow){const l=Ea(i);if(!Os(r)&&!Ea(r)&&(i=be(i),r=be(r)),!xt(t)&&dn(i)&&!dn(r))return l?!1:(i.value=r,!0)}const o=xt(t)&&XA(e)?Number(e)<t.length:Oe(t,e),a=Reflect.set(t,e,r,dn(t)?t:s);return t===be(s)&&(o?Fr(r,i)&&la(t,"set",e,r):la(t,"add",e,r)),a}deleteProperty(t,e){const r=Oe(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&r&&la(t,"delete",e,void 0),s}has(t,e){const r=Reflect.has(t,e);return(!Oi(e)||!S2.has(e))&&xr(t,"has",e),r}ownKeys(t){return xr(t,"iterate",xt(t)?"length":Ru),Reflect.ownKeys(t)}}class k2 extends A2{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const K_=new E2,G_=new k2,Y_=new E2(!0),X_=new k2(!0),i1=n=>n,xy=n=>Reflect.getPrototypeOf(n);function q_(n,t,e){return function(...r){const s=this.__v_raw,i=be(s),o=Wd(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),u=e?i1:t?ib:ir;return!t&&xr(i,"iterate",l?s1:Ru),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function Sy(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function J_(n,t){const e={get(s){const i=this.__v_raw,o=be(i),a=be(s);n||(Fr(s,a)&&xr(o,"get",s),xr(o,"get",a));const{has:l}=xy(o),c=t?i1:n?ib:ir;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&xr(be(s),"iterate",Ru),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=be(i),a=be(s);return n||(Fr(s,a)&&xr(o,"has",s),xr(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=be(a),c=t?i1:n?ib:ir;return!n&&xr(l,"iterate",Ru),a.forEach((u,d)=>s.call(i,c(u),c(d),o))}};return ze(e,n?{add:Sy("add"),set:Sy("set"),delete:Sy("delete"),clear:Sy("clear")}:{add(s){!t&&!Os(s)&&!Ea(s)&&(s=be(s));const i=be(this);return xy(i).has.call(i,s)||(i.add(s),la(i,"add",s,s)),this},set(s,i){!t&&!Os(i)&&!Ea(i)&&(i=be(i));const o=be(this),{has:a,get:l}=xy(o);let c=a.call(o,s);c||(s=be(s),c=a.call(o,s));const u=l.call(o,s);return o.set(s,i),c?Fr(i,u)&&la(o,"set",s,i):la(o,"add",s,i),this},delete(s){const i=be(this),{has:o,get:a}=xy(i);let l=o.call(i,s);l||(s=be(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&la(i,"delete",s,void 0),c},clear(){const s=be(this),i=s.size!==0,o=s.clear();return i&&la(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=q_(s,n,t)}),e}function Zv(n,t){const e=J_(n,t);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Oe(e,s)&&s in r?e:r,s,i)}const Q_={get:Zv(!1,!1)},Z_={get:Zv(!1,!0)},tL={get:Zv(!0,!1)},eL={get:Zv(!0,!0)},C2=new WeakMap,T2=new WeakMap,M2=new WeakMap,P2=new WeakMap;function nL(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rL(n){return n.__v_skip||!Object.isExtensible(n)?0:nL(E_(n))}function Cf(n){return Ea(n)?n:tw(n,!1,K_,Q_,C2)}function nE(n){return tw(n,!1,Y_,Z_,T2)}function rE(n){return tw(n,!0,G_,tL,M2)}function sL(n){return tw(n,!0,X_,eL,P2)}function tw(n,t,e,r,s){if(!$e(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const i=rL(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:e);return s.set(n,a),a}function fo(n){return Ea(n)?fo(n.__v_raw):!!(n&&n.__v_isReactive)}function Ea(n){return!!(n&&n.__v_isReadonly)}function Os(n){return!!(n&&n.__v_isShallow)}function ew(n){return n?!!n.__v_raw:!1}function be(n){const t=n&&n.__v_raw;return t?be(t):n}function sy(n){return!Oe(n,"__v_skip")&&Object.isExtensible(n)&&u2(n,"__v_skip",!0),n}const ir=n=>$e(n)?Cf(n):n,ib=n=>$e(n)?rE(n):n;function dn(n){return n?n.__v_isRef===!0:!1}function ot(n){return O2(n,!1)}function sE(n){return O2(n,!0)}function O2(n,t){return dn(n)?n:new iL(n,t)}class iL{constructor(t,e){this.dep=new Jv,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:be(t),this._value=e?t:ir(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,r=this.__v_isShallow||Os(t)||Ea(t);t=r?t:be(t),Fr(t,e)&&(this._rawValue=t,this._value=r?t:ir(t),this.dep.trigger())}}function oL(n){n.dep&&n.dep.trigger()}function ee(n){return dn(n)?n.value:n}function aL(n){return Bt(n)?n():ee(n)}const lL={get:(n,t,e)=>t==="__v_raw"?n:ee(Reflect.get(n,t,e)),set:(n,t,e,r)=>{const s=n[t];return dn(s)&&!dn(e)?(s.value=e,!0):Reflect.set(n,t,e,r)}};function iE(n){return fo(n)?n:new Proxy(n,lL)}class cL{constructor(t){this.__v_isRef=!0,this._value=void 0;const e=this.dep=new Jv,{get:r,set:s}=t(e.track.bind(e),e.trigger.bind(e));this._get=r,this._set=s}get value(){return this._value=this._get()}set value(t){this._set(t)}}function oE(n){return new cL(n)}function I2(n){const t=xt(n)?new Array(n.length):{};for(const e in n)t[e]=R2(n,e);return t}class uL{constructor(t,e,r){this._object=t,this._key=e,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return H_(be(this._object),this._key)}}class dL{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function hL(n,t,e){return dn(n)?n:Bt(n)?new dL(n):$e(n)&&arguments.length>1?R2(n,t,e):ot(n)}function R2(n,t,e){const r=n[t];return dn(r)?r:new uL(n,t,e)}class fL{constructor(t,e,r){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Jv(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=tg-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ke!==this)return m2(this,!0),!0}get value(){const t=this.dep.track();return v2(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function pL(n,t,e=!1){let r,s;return Bt(n)?r=n:(r=n.get,s=n.set),new fL(r,s,e)}const gL={GET:"get",HAS:"has",ITERATE:"iterate"},mL={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Ay={},ob=new WeakMap;let za;function yL(){return za}function D2(n,t=!1,e=za){if(e){let r=ob.get(e);r||ob.set(e,r=[]),r.push(n)}}function bL(n,t,e=we){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=e,c=S=>s?S:Os(S)||s===!1||s===0?ca(S,1):ca(S);let u,d,h,p,g=!1,m=!1;if(dn(n)?(d=()=>n.value,g=Os(n)):fo(n)?(d=()=>c(n),g=!0):xt(n)?(m=!0,g=n.some(S=>fo(S)||Os(S)),d=()=>n.map(S=>{if(dn(S))return S.value;if(fo(S))return c(S);if(Bt(S))return l?l(S,2):S()})):Bt(n)?t?d=l?()=>l(n,2):n:d=()=>{if(h){Sa();try{h()}finally{Aa()}}const S=za;za=u;try{return l?l(n,3,[p]):n(p)}finally{za=S}}:d=ei,t&&s){const S=d,w=s===!0?1/0:s;d=()=>ca(S(),w)}const b=QA(),y=()=>{u.stop(),b&&b.active&&GA(b.effects,u)};if(i&&t){const S=t;t=(...w)=>{S(...w),y()}}let v=m?new Array(n.length).fill(Ay):Ay;const x=S=>{if(!(!(u.flags&1)||!u.dirty&&!S))if(t){const w=u.run();if(s||g||(m?w.some((E,T)=>Fr(E,v[T])):Fr(w,v))){h&&h();const E=za;za=u;try{const T=[w,v===Ay?void 0:m&&v[0]===Ay?[]:v,p];l?l(t,3,T):t(...T),v=w}finally{za=E}}}else u.run()};return a&&a(x),u=new Zp(d),u.scheduler=o?()=>o(x,!1):x,p=S=>D2(S,!1,u),h=u.onStop=()=>{const S=ob.get(u);if(S){if(l)l(S,4);else for(const w of S)w();ob.delete(u)}},t?r?x(!0):v=u.run():o?o(x.bind(null,!0),!0):u.run(),y.pause=u.pause.bind(u),y.resume=u.resume.bind(u),y.stop=y,y}function ca(n,t=1/0,e){if(t<=0||!$e(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,dn(n))ca(n.value,t,e);else if(xt(n))for(let r=0;r<n.length;r++)ca(n[r],t,e);else if(sd(n)||Wd(n))n.forEach(r=>{ca(r,t,e)});else if(Gv(n)){for(const r in n)ca(n[r],t,e);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&ca(n[r],t,e)}return n}/**
* @vue/runtime-core v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const N2=[];function vL(n){N2.push(n)}function wL(){N2.pop()}function xL(n,t){}const SL={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},AL={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Tf(n,t,e,r){try{return r?n(...r):n()}catch(s){id(s,t,e)}}function ii(n,t,e,r){if(Bt(n)){const s=Tf(n,t,e,r);return s&&YA(s)&&s.catch(i=>{id(i,t,e)}),s}if(xt(n)){const s=[];for(let i=0;i<n.length;i++)s.push(ii(n[i],t,e,r));return s}}function id(n,t,e,r=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||we;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](n,l,c)===!1)return}a=a.parent}if(i){Sa(),Tf(i,null,10,[n,l,c]),Aa();return}}EL(n,e,s,r,o)}function EL(n,t,e,r=!0,s=!1){if(s)throw n;console.error(n)}const Br=[];let ji=-1;const Yd=[];let Ua=null,Ad=0;const _2=Promise.resolve();let ab=null;function od(n){const t=ab||_2;return n?t.then(this?n.bind(this):n):t}function kL(n){let t=ji+1,e=Br.length;for(;t<e;){const r=t+e>>>1,s=Br[r],i=rg(s);i<n||i===n&&s.flags&2?t=r+1:e=r}return t}function aE(n){if(!(n.flags&1)){const t=rg(n),e=Br[Br.length-1];!e||!(n.flags&2)&&t>=rg(e)?Br.push(n):Br.splice(kL(t),0,n),n.flags|=1,L2()}}function L2(){ab||(ab=_2.then(F2))}function ng(n){xt(n)?Yd.push(...n):Ua&&n.id===-1?Ua.splice(Ad+1,0,n):n.flags&1||(Yd.push(n),n.flags|=1),L2()}function Kk(n,t,e=ji+1){for(;e<Br.length;e++){const r=Br[e];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Br.splice(e,1),e--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function lb(n){if(Yd.length){const t=[...new Set(Yd)].sort((e,r)=>rg(e)-rg(r));if(Yd.length=0,Ua){Ua.push(...t);return}for(Ua=t,Ad=0;Ad<Ua.length;Ad++){const e=Ua[Ad];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Ua=null,Ad=0}}const rg=n=>n.id==null?n.flags&2?-1:1/0:n.id;function F2(n){try{for(ji=0;ji<Br.length;ji++){const t=Br[ji];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Tf(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ji<Br.length;ji++){const t=Br[ji];t&&(t.flags&=-2)}ji=-1,Br.length=0,lb(),ab=null,(Br.length||Yd.length)&&F2()}}let Ed,Ey=[];function B2(n,t){var e,r;Ed=n,Ed?(Ed.enabled=!0,Ey.forEach(({event:s,args:i})=>Ed.emit(s,...i)),Ey=[]):typeof window<"u"&&window.HTMLElement&&!((r=(e=window.navigator)==null?void 0:e.userAgent)!=null&&r.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{B2(i,t)}),setTimeout(()=>{Ed||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Ey=[])},3e3)):Ey=[]}let _n=null,nw=null;function sg(n){const t=_n;return _n=n,nw=n&&n.type.__scopeId||null,t}function CL(n){nw=n}function TL(){nw=null}const ML=n=>Se;function Se(n,t=_n,e){if(!t||n._n)return n;const r=(...s)=>{r._d&&f1(-1);const i=sg(t);let o;try{o=n(...s)}finally{sg(i),r._d&&f1(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Le(n,t){if(_n===null)return n;const e=ay(_n),r=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[i,o,a,l=we]=t[s];i&&(Bt(i)&&(i={mounted:i,updated:i}),i.deep&&ca(o),r.push({dir:i,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Ui(n,t,e,r){const s=n.dirs,i=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Sa(),ii(l,e,8,[n.el,a,n,t]),Aa())}}const $2=Symbol("_vte"),j2=n=>n.__isTeleport,Ep=n=>n&&(n.disabled||n.disabled===""),Gk=n=>n&&(n.defer||n.defer===""),Yk=n=>typeof SVGElement<"u"&&n instanceof SVGElement,Xk=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,o1=(n,t)=>{const e=n&&n.to;return Ge(e)?t?t(e):null:e},H2={name:"Teleport",__isTeleport:!0,process(n,t,e,r,s,i,o,a,l,c){const{mc:u,pc:d,pbc:h,o:{insert:p,querySelector:g,createText:m,createComment:b}}=c,y=Ep(t.props);let{shapeFlag:v,children:x,dynamicChildren:S}=t;if(n==null){const w=t.el=m(""),E=t.anchor=m("");p(w,e,r),p(E,e,r);const T=(C,R)=>{v&16&&(s&&s.isCE&&(s.ce._teleportTarget=C),u(x,C,R,s,i,o,a,l))},I=()=>{const C=t.target=o1(t.props,g),R=V2(C,t,m,p);C&&(o!=="svg"&&Yk(C)?o="svg":o!=="mathml"&&Xk(C)&&(o="mathml"),y||(T(C,R),s0(t,!1)))};y&&(T(e,E),s0(t,!0)),Gk(t.props)?Rn(()=>{I(),t.el.__isMounted=!0},i):I()}else{if(Gk(t.props)&&!n.el.__isMounted){Rn(()=>{H2.process(n,t,e,r,s,i,o,a,l,c),delete n.el.__isMounted},i);return}t.el=n.el,t.targetStart=n.targetStart;const w=t.anchor=n.anchor,E=t.target=n.target,T=t.targetAnchor=n.targetAnchor,I=Ep(n.props),C=I?e:E,R=I?w:T;if(o==="svg"||Yk(E)?o="svg":(o==="mathml"||Xk(E))&&(o="mathml"),S?(h(n.dynamicChildren,S,C,s,i,o,a),bE(n,t,!0)):l||d(n,t,C,R,s,i,o,a,!1),y)I?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):ky(t,e,w,c,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const N=t.target=o1(t.props,g);N&&ky(t,N,null,c,0)}else I&&ky(t,E,T,c,1);s0(t,y)}},remove(n,t,e,{um:r,o:{remove:s}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:u,target:d,props:h}=n;if(d&&(s(c),s(u)),i&&s(l),o&16){const p=i||!Ep(h);for(let g=0;g<a.length;g++){const m=a[g];r(m,t,e,p,!!m.dynamicChildren)}}},move:ky,hydrate:PL};function ky(n,t,e,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,t,e);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=n,d=i===2;if(d&&r(o,t,e),(!d||Ep(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],t,e,2);d&&r(a,t,e)}function PL(n,t,e,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:u}},d){const h=t.target=o1(t.props,l);if(h){const p=Ep(t.props),g=h._lpa||h.firstChild;if(t.shapeFlag&16)if(p)t.anchor=d(o(n),t,a(n),e,r,s,i),t.targetStart=g,t.targetAnchor=g&&o(g);else{t.anchor=o(n);let m=g;for(;m;){if(m&&m.nodeType===8){if(m.data==="teleport start anchor")t.targetStart=m;else if(m.data==="teleport anchor"){t.targetAnchor=m,h._lpa=t.targetAnchor&&o(t.targetAnchor);break}}m=o(m)}t.targetAnchor||V2(h,t,u,c),d(g&&o(g),t,h,e,r,s,i)}s0(t,p)}return t.anchor&&o(t.anchor)}const OL=H2;function s0(n,t){const e=n.ctx;if(e&&e.ut){let r,s;for(t?(r=n.el,s=n.anchor):(r=n.targetStart,s=n.targetAnchor);r&&r!==s;)r.nodeType===1&&r.setAttribute("data-v-owner",e.uid),r=r.nextSibling;e.ut()}}function V2(n,t,e,r){const s=t.targetStart=e(""),i=t.targetAnchor=e("");return s[$2]=i,n&&(r(s,n),r(i,n)),i}const Wa=Symbol("_leaveCb"),Cy=Symbol("_enterCb");function lE(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return qn(()=>{n.isMounted=!0}),ad(()=>{n.isUnmounting=!0}),n}const Fs=[Function,Array],cE={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fs,onEnter:Fs,onAfterEnter:Fs,onEnterCancelled:Fs,onBeforeLeave:Fs,onLeave:Fs,onAfterLeave:Fs,onLeaveCancelled:Fs,onBeforeAppear:Fs,onAppear:Fs,onAfterAppear:Fs,onAppearCancelled:Fs},z2=n=>{const t=n.subTree;return t.component?z2(t.component):t},IL={name:"BaseTransition",props:cE,setup(n,{slots:t}){const e=_s(),r=lE();return()=>{const s=t.default&&rw(t.default(),!0);if(!s||!s.length)return;const i=U2(s),o=be(n),{mode:a}=o;if(r.isLeaving)return Xw(i);const l=qk(i);if(!l)return Xw(i);let c=uf(l,o,r,e,d=>c=d);l.type!==wn&&ka(l,c);let u=e.subTree&&qk(e.subTree);if(u&&u.type!==wn&&!Ei(l,u)&&z2(e).type!==wn){let d=uf(u,o,r,e);if(ka(u,d),a==="out-in"&&l.type!==wn)return r.isLeaving=!0,d.afterLeave=()=>{r.isLeaving=!1,e.job.flags&8||e.update(),delete d.afterLeave,u=void 0},Xw(i);a==="in-out"&&l.type!==wn?d.delayLeave=(h,p,g)=>{const m=K2(r,u);m[String(u.key)]=u,h[Wa]=()=>{p(),h[Wa]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function U2(n){let t=n[0];if(n.length>1){for(const e of n)if(e.type!==wn){t=e;break}}return t}const W2=IL;function K2(n,t){const{leavingVNodes:e}=n;let r=e.get(t.type);return r||(r=Object.create(null),e.set(t.type,r)),r}function uf(n,t,e,r,s){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:p,onAfterLeave:g,onLeaveCancelled:m,onBeforeAppear:b,onAppear:y,onAfterAppear:v,onAppearCancelled:x}=t,S=String(n.key),w=K2(e,n),E=(C,R)=>{C&&ii(C,r,9,R)},T=(C,R)=>{const N=R[1];E(C,R),xt(C)?C.every(B=>B.length<=1)&&N():C.length<=1&&N()},I={mode:o,persisted:a,beforeEnter(C){let R=l;if(!e.isMounted)if(i)R=b||l;else return;C[Wa]&&C[Wa](!0);const N=w[S];N&&Ei(n,N)&&N.el[Wa]&&N.el[Wa](),E(R,[C])},enter(C){let R=c,N=u,B=d;if(!e.isMounted)if(i)R=y||c,N=v||u,B=x||d;else return;let $=!1;const L=C[Cy]=F=>{$||($=!0,F?E(B,[C]):E(N,[C]),I.delayedLeave&&I.delayedLeave(),C[Cy]=void 0)};R?T(R,[C,L]):L()},leave(C,R){const N=String(n.key);if(C[Cy]&&C[Cy](!0),e.isUnmounting)return R();E(h,[C]);let B=!1;const $=C[Wa]=L=>{B||(B=!0,R(),L?E(m,[C]):E(g,[C]),C[Wa]=void 0,w[N]===n&&delete w[N])};w[N]=n,p?T(p,[C,$]):$()},clone(C){const R=uf(C,t,e,r,s);return s&&s(R),R}};return I}function Xw(n){if(iy(n))return n=go(n),n.children=null,n}function qk(n){if(!iy(n))return j2(n.type)&&n.children?U2(n.children):n;if(n.component)return n.component.subTree;const{shapeFlag:t,children:e}=n;if(e){if(t&16)return e[0];if(t&32&&Bt(e.default))return e.default()}}function ka(n,t){n.shapeFlag&6&&n.component?(n.transition=t,ka(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function rw(n,t=!1,e){let r=[],s=0;for(let i=0;i<n.length;i++){let o=n[i];const a=e==null?o.key:String(e)+String(o.key!=null?o.key:i);o.type===ae?(o.patchFlag&128&&s++,r=r.concat(rw(o.children,t,a))):(t||o.type!==wn)&&r.push(a!=null?go(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Mf(n,t){return Bt(n)?ze({name:n.name},t,{setup:n}):n}function RL(){const n=_s();return n?(n.appContext.config.idPrefix||"v")+"-"+n.ids[0]+n.ids[1]++:""}function uE(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function DL(n){const t=_s(),e=sE(null);if(t){const s=t.refs===we?t.refs={}:t.refs;Object.defineProperty(s,n,{enumerable:!0,get:()=>e.value,set:i=>e.value=i})}return e}function ig(n,t,e,r,s=!1){if(xt(n)){n.forEach((g,m)=>ig(g,t&&(xt(t)?t[m]:t),e,r,s));return}if($l(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&ig(n,t,e,r.component.subTree);return}const i=r.shapeFlag&4?ay(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=t&&t.r,u=a.refs===we?a.refs={}:a.refs,d=a.setupState,h=be(d),p=d===we?()=>!1:g=>Oe(h,g);if(c!=null&&c!==l&&(Ge(c)?(u[c]=null,p(c)&&(d[c]=null)):dn(c)&&(c.value=null)),Bt(l))Tf(l,a,12,[o,u]);else{const g=Ge(l),m=dn(l);if(g||m){const b=()=>{if(n.f){const y=g?p(l)?d[l]:u[l]:l.value;s?xt(y)&&GA(y,i):xt(y)?y.includes(i)||y.push(i):g?(u[l]=[i],p(l)&&(d[l]=u[l])):(l.value=[i],n.k&&(u[n.k]=l.value))}else g?(u[l]=o,p(l)&&(d[l]=o)):m&&(l.value=o,n.k&&(u[n.k]=o))};o?(b.id=-1,Rn(b,e)):b()}}}let Jk=!1;const fd=()=>{Jk||(console.error("Hydration completed but contains mismatches."),Jk=!0)},NL=n=>n.namespaceURI.includes("svg")&&n.tagName!=="foreignObject",_L=n=>n.namespaceURI.includes("MathML"),Ty=n=>{if(n.nodeType===1){if(NL(n))return"svg";if(_L(n))return"mathml"}},Bd=n=>n.nodeType===8;function LL(n){const{mt:t,p:e,o:{patchProp:r,createText:s,nextSibling:i,parentNode:o,remove:a,insert:l,createComment:c}}=n,u=(x,S)=>{if(!S.hasChildNodes()){e(null,x,S),lb(),S._vnode=x;return}d(S.firstChild,x,null,null,null),lb(),S._vnode=x},d=(x,S,w,E,T,I=!1)=>{I=I||!!S.dynamicChildren;const C=Bd(x)&&x.data==="[",R=()=>m(x,S,w,E,T,C),{type:N,ref:B,shapeFlag:$,patchFlag:L}=S;let F=x.nodeType;S.el=x,L===-2&&(I=!1,S.dynamicChildren=null);let _=null;switch(N){case jl:F!==3?S.children===""?(l(S.el=s(""),o(x),x),_=x):_=R():(x.data!==S.children&&(fd(),x.data=S.children),_=i(x));break;case wn:v(x)?(_=i(x),y(S.el=x.content.firstChild,x,w)):F!==8||C?_=R():_=i(x);break;case Nu:if(C&&(x=i(x),F=x.nodeType),F===1||F===3){_=x;const j=!S.children.length;for(let X=0;X<S.staticCount;X++)j&&(S.children+=_.nodeType===1?_.outerHTML:_.data),X===S.staticCount-1&&(S.anchor=_),_=i(_);return C?i(_):_}else R();break;case ae:C?_=g(x,S,w,E,T,I):_=R();break;default:if($&1)(F!==1||S.type.toLowerCase()!==x.tagName.toLowerCase())&&!v(x)?_=R():_=h(x,S,w,E,T,I);else if($&6){S.slotScopeIds=T;const j=o(x);if(C?_=b(x):Bd(x)&&x.data==="teleport start"?_=b(x,x.data,"teleport end"):_=i(x),t(S,j,null,w,E,Ty(j),I),$l(S)&&!S.type.__asyncResolved){let X;C?(X=bt(ae),X.anchor=_?_.previousSibling:j.lastChild):X=x.nodeType===3?ge(""):bt("div"),X.el=x,S.component.subTree=X}}else $&64?F!==8?_=R():_=S.type.hydrate(x,S,w,E,T,I,n,p):$&128&&(_=S.type.hydrate(x,S,w,E,Ty(o(x)),T,I,n,d))}return B!=null&&ig(B,null,E,S),_},h=(x,S,w,E,T,I)=>{I=I||!!S.dynamicChildren;const{type:C,props:R,patchFlag:N,shapeFlag:B,dirs:$,transition:L}=S,F=C==="input"||C==="option";if(F||N!==-1){$&&Ui(S,null,w,"created");let _=!1;if(v(x)){_=bP(null,L)&&w&&w.vnode.props&&w.vnode.props.appear;const X=x.content.firstChild;_&&L.beforeEnter(X),y(X,x,w),S.el=x=X}if(B&16&&!(R&&(R.innerHTML||R.textContent))){let X=p(x.firstChild,S,x,w,E,T,I);for(;X;){My(x,1)||fd();const wt=X;X=X.nextSibling,a(wt)}}else if(B&8){let X=S.children;X[0]===`
`&&(x.tagName==="PRE"||x.tagName==="TEXTAREA")&&(X=X.slice(1)),x.textContent!==X&&(My(x,0)||fd(),x.textContent=S.children)}if(R){if(F||!I||N&48){const X=x.tagName.includes("-");for(const wt in R)(F&&(wt.endsWith("value")||wt==="indeterminate")||ny(wt)&&!Kd(wt)||wt[0]==="."||X)&&r(x,wt,null,R[wt],void 0,w)}else if(R.onClick)r(x,"onClick",null,R.onClick,void 0,w);else if(N&4&&fo(R.style))for(const X in R.style)R.style[X]}let j;(j=R&&R.onVnodeBeforeMount)&&ns(j,w,S),$&&Ui(S,null,w,"beforeMount"),((j=R&&R.onVnodeMounted)||$||_)&&MP(()=>{j&&ns(j,w,S),_&&L.enter(x),$&&Ui(S,null,w,"mounted")},E)}return x.nextSibling},p=(x,S,w,E,T,I,C)=>{C=C||!!S.dynamicChildren;const R=S.children,N=R.length;for(let B=0;B<N;B++){const $=C?R[B]:R[B]=ss(R[B]),L=$.type===jl;x?(L&&!C&&B+1<N&&ss(R[B+1]).type===jl&&(l(s(x.data.slice($.children.length)),w,i(x)),x.data=$.children),x=d(x,$,E,T,I,C)):L&&!$.children?l($.el=s(""),w):(My(w,1)||fd(),e(null,$,w,null,E,T,Ty(w),I))}return x},g=(x,S,w,E,T,I)=>{const{slotScopeIds:C}=S;C&&(T=T?T.concat(C):C);const R=o(x),N=p(i(x),S,R,w,E,T,I);return N&&Bd(N)&&N.data==="]"?i(S.anchor=N):(fd(),l(S.anchor=c("]"),R,N),N)},m=(x,S,w,E,T,I)=>{if(My(x.parentElement,1)||fd(),S.el=null,I){const N=b(x);for(;;){const B=i(x);if(B&&B!==N)a(B);else break}}const C=i(x),R=o(x);return a(x),e(null,S,R,C,w,E,Ty(R),T),w&&(w.vnode.el=S.el,lw(w,S.el)),C},b=(x,S="[",w="]")=>{let E=0;for(;x;)if(x=i(x),x&&Bd(x)&&(x.data===S&&E++,x.data===w)){if(E===0)return i(x);E--}return x},y=(x,S,w)=>{const E=S.parentNode;E&&E.replaceChild(x,S);let T=w;for(;T;)T.vnode.el===S&&(T.vnode.el=T.subTree.el=x),T=T.parent},v=x=>x.nodeType===1&&x.tagName==="TEMPLATE";return[u,d]}const Qk="data-allow-mismatch",FL={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function My(n,t){if(t===0||t===1)for(;n&&!n.hasAttribute(Qk);)n=n.parentElement;const e=n&&n.getAttribute(Qk);if(e==null)return!1;if(e==="")return!0;{const r=e.split(",");return t===0&&r.includes("children")?!0:e.split(",").includes(FL[t])}}const BL=Xv().requestIdleCallback||(n=>setTimeout(n,1)),$L=Xv().cancelIdleCallback||(n=>clearTimeout(n)),jL=(n=1e4)=>t=>{const e=BL(t,{timeout:n});return()=>$L(e)};function HL(n){const{top:t,left:e,bottom:r,right:s}=n.getBoundingClientRect(),{innerHeight:i,innerWidth:o}=window;return(t>0&&t<i||r>0&&r<i)&&(e>0&&e<o||s>0&&s<o)}const VL=n=>(t,e)=>{const r=new IntersectionObserver(s=>{for(const i of s)if(i.isIntersecting){r.disconnect(),t();break}},n);return e(s=>{if(s instanceof Element){if(HL(s))return t(),r.disconnect(),!1;r.observe(s)}}),()=>r.disconnect()},zL=n=>t=>{if(n){const e=matchMedia(n);if(e.matches)t();else return e.addEventListener("change",t,{once:!0}),()=>e.removeEventListener("change",t)}},UL=(n=[])=>(t,e)=>{Ge(n)&&(n=[n]);let r=!1;const s=o=>{r||(r=!0,i(),t(),o.target.dispatchEvent(new o.constructor(o.type,o)))},i=()=>{e(o=>{for(const a of n)o.removeEventListener(a,s)})};return e(o=>{for(const a of n)o.addEventListener(a,s,{once:!0})}),i};function WL(n,t){if(Bd(n)&&n.data==="["){let e=1,r=n.nextSibling;for(;r;){if(r.nodeType===1){if(t(r)===!1)break}else if(Bd(r))if(r.data==="]"){if(--e===0)break}else r.data==="["&&e++;r=r.nextSibling}}else t(n)}const $l=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function KL(n){Bt(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:r,delay:s=200,hydrate:i,timeout:o,suspensible:a=!0,onError:l}=n;let c=null,u,d=0;const h=()=>(d++,c=null,p()),p=()=>{let g;return c||(g=c=t().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),l)return new Promise((b,y)=>{l(m,()=>b(h()),()=>y(m),d+1)});throw m}).then(m=>g!==c&&c?c:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),u=m,m)))};return Mf({name:"AsyncComponentWrapper",__asyncLoader:p,__asyncHydrate(g,m,b){const y=i?()=>{const v=i(b,x=>WL(g,x));v&&(m.bum||(m.bum=[])).push(v)}:b;u?y():p().then(()=>!m.isUnmounted&&y())},get __asyncResolved(){return u},setup(){const g=Nn;if(uE(g),u)return()=>qw(u,g);const m=x=>{c=null,id(x,g,13,!r)};if(a&&g.suspense||df)return p().then(x=>()=>qw(x,g)).catch(x=>(m(x),()=>r?bt(r,{error:x}):null));const b=ot(!1),y=ot(),v=ot(!!s);return s&&setTimeout(()=>{v.value=!1},s),o!=null&&setTimeout(()=>{if(!b.value&&!y.value){const x=new Error(`Async component timed out after ${o}ms.`);m(x),y.value=x}},o),p().then(()=>{b.value=!0,g.parent&&iy(g.parent.vnode)&&g.parent.update()}).catch(x=>{m(x),y.value=x}),()=>{if(b.value&&u)return qw(u,g);if(y.value&&r)return bt(r,{error:y.value});if(e&&!v.value)return bt(e)}}})}function qw(n,t){const{ref:e,props:r,children:s,ce:i}=t.vnode,o=bt(n,r,s);return o.ref=e,o.ce=i,delete t.vnode.ce,o}const iy=n=>n.type.__isKeepAlive,GL={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:t}){const e=_s(),r=e.ctx;if(!r.renderer)return()=>{const v=t.default&&t.default();return v&&v.length===1?v[0]:v};const s=new Map,i=new Set;let o=null;const a=e.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:d}}}=r,h=d("div");r.activate=(v,x,S,w,E)=>{const T=v.component;c(v,x,S,0,a),l(T.vnode,v,x,S,T,a,w,v.slotScopeIds,E),Rn(()=>{T.isDeactivated=!1,T.a&&Gd(T.a);const I=v.props&&v.props.onVnodeMounted;I&&ns(I,T.parent,v)},a)},r.deactivate=v=>{const x=v.component;ub(x.m),ub(x.a),c(v,h,null,1,a),Rn(()=>{x.da&&Gd(x.da);const S=v.props&&v.props.onVnodeUnmounted;S&&ns(S,x.parent,v),x.isDeactivated=!0},a)};function p(v){Jw(v),u(v,e,a,!0)}function g(v){s.forEach((x,S)=>{const w=b1(x.type);w&&!v(w)&&m(S)})}function m(v){const x=s.get(v);x&&(!o||!Ei(x,o))?p(x):o&&Jw(o),s.delete(v),i.delete(v)}Mi(()=>[n.include,n.exclude],([v,x])=>{v&&g(S=>Gf(v,S)),x&&g(S=>!Gf(x,S))},{flush:"post",deep:!0});let b=null;const y=()=>{b!=null&&(db(e.subTree.type)?Rn(()=>{s.set(b,Py(e.subTree))},e.subTree.suspense):s.set(b,Py(e.subTree)))};return qn(y),iw(y),ad(()=>{s.forEach(v=>{const{subTree:x,suspense:S}=e,w=Py(x);if(v.type===w.type&&v.key===w.key){Jw(w);const E=w.component.da;E&&Rn(E,S);return}p(v)})}),()=>{if(b=null,!t.default)return o=null;const v=t.default(),x=v[0];if(v.length>1)return o=null,v;if(!Ca(x)||!(x.shapeFlag&4)&&!(x.shapeFlag&128))return o=null,x;let S=Py(x);if(S.type===wn)return o=null,S;const w=S.type,E=b1($l(S)?S.type.__asyncResolved||{}:w),{include:T,exclude:I,max:C}=n;if(T&&(!E||!Gf(T,E))||I&&E&&Gf(I,E))return S.shapeFlag&=-257,o=S,x;const R=S.key==null?w:S.key,N=s.get(R);return S.el&&(S=go(S),x.shapeFlag&128&&(x.ssContent=S)),b=R,N?(S.el=N.el,S.component=N.component,S.transition&&ka(S,S.transition),S.shapeFlag|=512,i.delete(R),i.add(R)):(i.add(R),C&&i.size>parseInt(C,10)&&m(i.values().next().value)),S.shapeFlag|=256,o=S,db(x.type)?x:S}}},YL=GL;function Gf(n,t){return xt(n)?n.some(e=>Gf(e,t)):Ge(n)?n.split(",").includes(t):A_(n)?(n.lastIndex=0,n.test(t)):!1}function G2(n,t){X2(n,"a",t)}function Y2(n,t){X2(n,"da",t)}function X2(n,t,e=Nn){const r=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(sw(t,r,e),e){let s=e.parent;for(;s&&s.parent;)iy(s.parent.vnode)&&XL(r,t,e,s),s=s.parent}}function XL(n,t,e,r){const s=sw(t,n,r,!0);ow(()=>{GA(r[t],s)},e)}function Jw(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Py(n){return n.shapeFlag&128?n.ssContent:n}function sw(n,t,e=Nn,r=!1){if(e){const s=e[n]||(e[n]=[]),i=t.__weh||(t.__weh=(...o)=>{Sa();const a=Wu(e),l=ii(t,e,n,o);return a(),Aa(),l});return r?s.unshift(i):s.push(i),i}}const Oa=n=>(t,e=Nn)=>{(!df||n==="sp")&&sw(n,(...r)=>t(...r),e)},q2=Oa("bm"),qn=Oa("m"),dE=Oa("bu"),iw=Oa("u"),ad=Oa("bum"),ow=Oa("um"),J2=Oa("sp"),Q2=Oa("rtg"),Z2=Oa("rtc");function tP(n,t=Nn){sw("ec",n,t)}const hE="components",qL="directives";function Ia(n,t){return fE(hE,n,!0,t)||n}const eP=Symbol.for("v-ndc");function nP(n){return Ge(n)?fE(hE,n,!1)||n:n||eP}function JL(n){return fE(qL,n)}function fE(n,t,e=!0,r=!1){const s=_n||Nn;if(s){const i=s.type;if(n===hE){const a=b1(i,!1);if(a&&(a===t||a===lr(t)||a===ry(lr(t))))return i}const o=Zk(s[n]||i[n],t)||Zk(s.appContext[n],t);return!o&&r?i:o}}function Zk(n,t){return n&&(n[t]||n[lr(t)]||n[ry(lr(t))])}function ln(n,t,e,r){let s;const i=e&&e[r],o=xt(n);if(o||Ge(n)){const a=o&&fo(n);let l=!1,c=!1;a&&(l=!Os(n),c=Ea(n),n=Qv(n)),s=new Array(n.length);for(let u=0,d=n.length;u<d;u++)s[u]=t(l?c?ib(ir(n[u])):ir(n[u]):n[u],u,void 0,i&&i[u])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=t(a+1,a,void 0,i&&i[a])}else if($e(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>t(a,l,void 0,i&&i[l]));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];s[l]=t(n[u],u,l,i&&i[l])}}else s=[];return e&&(e[r]=s),s}function QL(n,t){for(let e=0;e<t.length;e++){const r=t[e];if(xt(r))for(let s=0;s<r.length;s++)n[r[s].name]=r[s].fn;else r&&(n[r.name]=r.key?(...s)=>{const i=r.fn(...s);return i&&(i.key=r.key),i}:r.fn)}return n}function ZL(n,t,e={},r,s){if(_n.ce||_n.parent&&$l(_n.parent)&&_n.parent.ce)return t!=="default"&&(e.name=t),K(),Yl(ae,null,[bt("slot",e,r&&r())],64);let i=n[t];i&&i._c&&(i._d=!1),K();const o=i&&pE(i(e)),a=e.key||o&&o.key,l=Yl(ae,{key:(a&&!Oi(a)?a:`_${t}`)+(!o&&r?"_fb":"")},o||(r?r():[]),o&&n._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function pE(n){return n.some(t=>Ca(t)?!(t.type===wn||t.type===ae&&!pE(t.children)):!0)?n:null}function tF(n,t){const e={};for(const r in n)e[t&&/[A-Z]/.test(r)?`on:${r}`:xp(r)]=n[r];return e}const a1=n=>n?_P(n)?ay(n):a1(n.parent):null,kp=ze(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>a1(n.parent),$root:n=>a1(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>gE(n),$forceUpdate:n=>n.f||(n.f=()=>{aE(n.update)}),$nextTick:n=>n.n||(n.n=od.bind(n.proxy)),$watch:n=>OF.bind(n)}),Qw=(n,t)=>n!==we&&!n.__isScriptSetup&&Oe(n,t),l1={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(t[0]!=="$"){const p=o[t];if(p!==void 0)switch(p){case 1:return r[t];case 2:return s[t];case 4:return e[t];case 3:return i[t]}else{if(Qw(r,t))return o[t]=1,r[t];if(s!==we&&Oe(s,t))return o[t]=2,s[t];if((c=n.propsOptions[0])&&Oe(c,t))return o[t]=3,i[t];if(e!==we&&Oe(e,t))return o[t]=4,e[t];c1&&(o[t]=0)}}const u=kp[t];let d,h;if(u)return t==="$attrs"&&xr(n.attrs,"get",""),u(n);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==we&&Oe(e,t))return o[t]=4,e[t];if(h=l.config.globalProperties,Oe(h,t))return h[t]},set({_:n},t,e){const{data:r,setupState:s,ctx:i}=n;return Qw(s,t)?(s[t]=e,!0):r!==we&&Oe(r,t)?(r[t]=e,!0):Oe(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(i[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!e[o]||n!==we&&Oe(n,o)||Qw(t,o)||(a=i[0])&&Oe(a,o)||Oe(r,o)||Oe(kp,o)||Oe(s.config.globalProperties,o)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Oe(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}},eF=ze({},l1,{get(n,t){if(t!==Symbol.unscopables)return l1.get(n,t,n)},has(n,t){return t[0]!=="_"&&!M_(t)}});function nF(){return null}function rF(){return null}function sF(n){}function iF(n){}function oF(){return null}function aF(){}function lF(n,t){return null}function cF(){return rP().slots}function uF(){return rP().attrs}function rP(){const n=_s();return n.setupContext||(n.setupContext=BP(n))}function og(n){return xt(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}function dF(n,t){const e=og(n);for(const r in t){if(r.startsWith("__skip"))continue;let s=e[r];s?xt(s)||Bt(s)?s=e[r]={type:s,default:t[r]}:s.default=t[r]:s===null&&(s=e[r]={default:t[r]}),s&&t[`__skip_${r}`]&&(s.skipFactory=!0)}return e}function hF(n,t){return!n||!t?n||t:xt(n)&&xt(t)?n.concat(t):ze({},og(n),og(t))}function fF(n,t){const e={};for(const r in n)t.includes(r)||Object.defineProperty(e,r,{enumerable:!0,get:()=>n[r]});return e}function pF(n){const t=_s();let e=n();return g1(),YA(e)&&(e=e.catch(r=>{throw Wu(t),r})),[e,()=>Wu(t)]}let c1=!0;function gF(n){const t=gE(n),e=n.proxy,r=n.ctx;c1=!1,t.beforeCreate&&tC(t.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:p,updated:g,activated:m,deactivated:b,beforeDestroy:y,beforeUnmount:v,destroyed:x,unmounted:S,render:w,renderTracked:E,renderTriggered:T,errorCaptured:I,serverPrefetch:C,expose:R,inheritAttrs:N,components:B,directives:$,filters:L}=t;if(c&&mF(c,r,null),o)for(const j in o){const X=o[j];Bt(X)&&(r[j]=X.bind(e))}if(s){const j=s.call(e,e);$e(j)&&(n.data=Cf(j))}if(c1=!0,i)for(const j in i){const X=i[j],wt=Bt(X)?X.bind(e,e):Bt(X.get)?X.get.bind(e,e):ei,qt=!Bt(X)&&Bt(X.set)?X.set.bind(e):ei,$t=Ee({get:wt,set:qt});Object.defineProperty(r,j,{enumerable:!0,configurable:!0,get:()=>$t.value,set:Pt=>$t.value=Pt})}if(a)for(const j in a)sP(a[j],r,e,j);if(l){const j=Bt(l)?l.call(e):l;Reflect.ownKeys(j).forEach(X=>{Cp(X,j[X])})}u&&tC(u,n,"c");function _(j,X){xt(X)?X.forEach(wt=>j(wt.bind(e))):X&&j(X.bind(e))}if(_(q2,d),_(qn,h),_(dE,p),_(iw,g),_(G2,m),_(Y2,b),_(tP,I),_(Z2,E),_(Q2,T),_(ad,v),_(ow,S),_(J2,C),xt(R))if(R.length){const j=n.exposed||(n.exposed={});R.forEach(X=>{Object.defineProperty(j,X,{get:()=>e[X],set:wt=>e[X]=wt})})}else n.exposed||(n.exposed={});w&&n.render===ei&&(n.render=w),N!=null&&(n.inheritAttrs=N),B&&(n.components=B),$&&(n.directives=$),C&&uE(n)}function mF(n,t,e=ei){xt(n)&&(n=u1(n));for(const r in n){const s=n[r];let i;$e(s)?"default"in s?i=Is(s.from||r,s.default,!0):i=Is(s.from||r):i=Is(s),dn(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[r]=i}}function tC(n,t,e){ii(xt(n)?n.map(r=>r.bind(t.proxy)):n.bind(t.proxy),t,e)}function sP(n,t,e,r){let s=r.includes(".")?EP(e,r):()=>e[r];if(Ge(n)){const i=t[n];Bt(i)&&Mi(s,i)}else if(Bt(n))Mi(s,n.bind(e));else if($e(n))if(xt(n))n.forEach(i=>sP(i,t,e,r));else{const i=Bt(n.handler)?n.handler.bind(e):t[n.handler];Bt(i)&&Mi(s,i,n)}}function gE(n){const t=n.type,{mixins:e,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(t);let l;return a?l=a:!s.length&&!e&&!r?l=t:(l={},s.length&&s.forEach(c=>cb(l,c,o,!0)),cb(l,t,o)),$e(t)&&i.set(t,l),l}function cb(n,t,e,r=!1){const{mixins:s,extends:i}=t;i&&cb(n,i,e,!0),s&&s.forEach(o=>cb(n,o,e,!0));for(const o in t)if(!(r&&o==="expose")){const a=yF[o]||e&&e[o];n[o]=a?a(n[o],t[o]):t[o]}return n}const yF={data:eC,props:nC,emits:nC,methods:Yf,computed:Yf,beforeCreate:Or,created:Or,beforeMount:Or,mounted:Or,beforeUpdate:Or,updated:Or,beforeDestroy:Or,beforeUnmount:Or,destroyed:Or,unmounted:Or,activated:Or,deactivated:Or,errorCaptured:Or,serverPrefetch:Or,components:Yf,directives:Yf,watch:vF,provide:eC,inject:bF};function eC(n,t){return t?n?function(){return ze(Bt(n)?n.call(this,this):n,Bt(t)?t.call(this,this):t)}:t:n}function bF(n,t){return Yf(u1(n),u1(t))}function u1(n){if(xt(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function Or(n,t){return n?[...new Set([].concat(n,t))]:t}function Yf(n,t){return n?ze(Object.create(null),n,t):t}function nC(n,t){return n?xt(n)&&xt(t)?[...new Set([...n,...t])]:ze(Object.create(null),og(n),og(t??{})):t}function vF(n,t){if(!n)return t;if(!t)return n;const e=ze(Object.create(null),n);for(const r in t)e[r]=Or(n[r],t[r]);return e}function iP(){return{app:null,config:{isNativeTag:x_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wF=0;function xF(n,t){return function(r,s=null){Bt(r)||(r=ze({},r)),s!=null&&!$e(s)&&(s=null);const i=iP(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:wF++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:jP,get config(){return i.config},set config(u){},use(u,...d){return o.has(u)||(u&&Bt(u.install)?(o.add(u),u.install(c,...d)):Bt(u)&&(o.add(u),u(c,...d))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,d){return d?(i.components[u]=d,c):i.components[u]},directive(u,d){return d?(i.directives[u]=d,c):i.directives[u]},mount(u,d,h){if(!l){const p=c._ceVNode||bt(r,s);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),d&&t?t(p,u):n(p,u,h),l=!0,c._container=u,u.__vue_app__=c,ay(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(ii(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,d){return i.provides[u]=d,c},runWithContext(u){const d=Du;Du=c;try{return u()}finally{Du=d}}};return c}}let Du=null;function Cp(n,t){if(Nn){let e=Nn.provides;const r=Nn.parent&&Nn.parent.provides;r===e&&(e=Nn.provides=Object.create(r)),e[n]=t}}function Is(n,t,e=!1){const r=Nn||_n;if(r||Du){const s=Du?Du._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&Bt(t)?t.call(r&&r.proxy):t}}function oP(){return!!(Nn||_n||Du)}const aP={},lP=()=>Object.create(aP),cP=n=>Object.getPrototypeOf(n)===aP;function SF(n,t,e,r=!1){const s={},i=lP();n.propsDefaults=Object.create(null),uP(n,t,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);e?n.props=r?s:nE(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function AF(n,t,e,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=be(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(aw(n.emitsOptions,h))continue;const p=t[h];if(l)if(Oe(i,h))p!==i[h]&&(i[h]=p,c=!0);else{const g=lr(h);s[g]=d1(l,a,g,p,n,!1)}else p!==i[h]&&(i[h]=p,c=!0)}}}else{uP(n,t,s,i)&&(c=!0);let u;for(const d in a)(!t||!Oe(t,d)&&((u=as(d))===d||!Oe(t,u)))&&(l?e&&(e[d]!==void 0||e[u]!==void 0)&&(s[d]=d1(l,a,d,void 0,n,!0)):delete s[d]);if(i!==a)for(const d in i)(!t||!Oe(t,d))&&(delete i[d],c=!0)}c&&la(n.attrs,"set","")}function uP(n,t,e,r){const[s,i]=n.propsOptions;let o=!1,a;if(t)for(let l in t){if(Kd(l))continue;const c=t[l];let u;s&&Oe(s,u=lr(l))?!i||!i.includes(u)?e[u]=c:(a||(a={}))[u]=c:aw(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=be(e),c=a||we;for(let u=0;u<i.length;u++){const d=i[u];e[d]=d1(s,l,d,c[d],n,!Oe(c,d))}}return o}function d1(n,t,e,r,s,i){const o=n[e];if(o!=null){const a=Oe(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Bt(l)){const{propsDefaults:c}=s;if(e in c)r=c[e];else{const u=Wu(s);r=c[e]=l.call(null,t),u()}}else r=l;s.ce&&s.ce._setProp(e,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===as(e))&&(r=!0))}return r}const EF=new WeakMap;function dP(n,t,e=!1){const r=e?EF:t.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!Bt(n)){const u=d=>{l=!0;const[h,p]=dP(d,t,!0);ze(o,h),p&&a.push(...p)};!e&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!i&&!l)return $e(n)&&r.set(n,Ud),Ud;if(xt(i))for(let u=0;u<i.length;u++){const d=lr(i[u]);rC(d)&&(o[d]=we)}else if(i)for(const u in i){const d=lr(u);if(rC(d)){const h=i[u],p=o[d]=xt(h)||Bt(h)?{type:h}:ze({},h),g=p.type;let m=!1,b=!0;if(xt(g))for(let y=0;y<g.length;++y){const v=g[y],x=Bt(v)&&v.name;if(x==="Boolean"){m=!0;break}else x==="String"&&(b=!1)}else m=Bt(g)&&g.name==="Boolean";p[0]=m,p[1]=b,(m||Oe(p,"default"))&&a.push(d)}}const c=[o,a];return $e(n)&&r.set(n,c),c}function rC(n){return n[0]!=="$"&&!Kd(n)}const mE=n=>n[0]==="_"||n==="$stable",yE=n=>xt(n)?n.map(ss):[ss(n)],kF=(n,t,e)=>{if(t._n)return t;const r=Se((...s)=>yE(t(...s)),e);return r._c=!1,r},hP=(n,t,e)=>{const r=n._ctx;for(const s in n){if(mE(s))continue;const i=n[s];if(Bt(i))t[s]=kF(s,i,r);else if(i!=null){const o=yE(i);t[s]=()=>o}}},fP=(n,t)=>{const e=yE(t);n.slots.default=()=>e},pP=(n,t,e)=>{for(const r in t)(e||!mE(r))&&(n[r]=t[r])},CF=(n,t,e)=>{const r=n.slots=lP();if(n.vnode.shapeFlag&32){const s=t._;s?(pP(r,t,e),e&&u2(r,"_",s,!0)):hP(t,r)}else t&&fP(n,t)},TF=(n,t,e)=>{const{vnode:r,slots:s}=n;let i=!0,o=we;if(r.shapeFlag&32){const a=t._;a?e&&a===1?i=!1:pP(s,t,e):(i=!t.$stable,hP(t,s)),o=t}else t&&(fP(n,t),o={default:1});if(i)for(const a in s)!mE(a)&&o[a]==null&&delete s[a]},Rn=MP;function gP(n){return yP(n)}function mP(n){return yP(n,LL)}function yP(n,t){const e=Xv();e.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:p=ei,insertStaticContent:g}=n,m=(O,D,U,q=null,G=null,Q=null,ct=void 0,st=null,it=!!D.dynamicChildren)=>{if(O===D)return;O&&!Ei(O,D)&&(q=z(O),Pt(O,G,Q,!0),O=null),D.patchFlag===-2&&(it=!1,D.dynamicChildren=null);const{type:tt,ref:Tt,shapeFlag:lt}=D;switch(tt){case jl:b(O,D,U,q);break;case wn:y(O,D,U,q);break;case Nu:O==null&&v(D,U,q,ct);break;case ae:B(O,D,U,q,G,Q,ct,st,it);break;default:lt&1?w(O,D,U,q,G,Q,ct,st,it):lt&6?$(O,D,U,q,G,Q,ct,st,it):(lt&64||lt&128)&&tt.process(O,D,U,q,G,Q,ct,st,it,ht)}Tt!=null&&G&&ig(Tt,O&&O.ref,Q,D||O,!D)},b=(O,D,U,q)=>{if(O==null)r(D.el=a(D.children),U,q);else{const G=D.el=O.el;D.children!==O.children&&c(G,D.children)}},y=(O,D,U,q)=>{O==null?r(D.el=l(D.children||""),U,q):D.el=O.el},v=(O,D,U,q)=>{[O.el,O.anchor]=g(O.children,D,U,q,O.el,O.anchor)},x=({el:O,anchor:D},U,q)=>{let G;for(;O&&O!==D;)G=h(O),r(O,U,q),O=G;r(D,U,q)},S=({el:O,anchor:D})=>{let U;for(;O&&O!==D;)U=h(O),s(O),O=U;s(D)},w=(O,D,U,q,G,Q,ct,st,it)=>{D.type==="svg"?ct="svg":D.type==="math"&&(ct="mathml"),O==null?E(D,U,q,G,Q,ct,st,it):C(O,D,G,Q,ct,st,it)},E=(O,D,U,q,G,Q,ct,st)=>{let it,tt;const{props:Tt,shapeFlag:lt,transition:St,dirs:Nt}=O;if(it=O.el=o(O.type,Q,Tt&&Tt.is,Tt),lt&8?u(it,O.children):lt&16&&I(O.children,it,null,q,G,Zw(O,Q),ct,st),Nt&&Ui(O,null,q,"created"),T(it,O,O.scopeId,ct,q),Tt){for(const Ce in Tt)Ce!=="value"&&!Kd(Ce)&&i(it,Ce,null,Tt[Ce],Q,q);"value"in Tt&&i(it,"value",null,Tt.value,Q),(tt=Tt.onVnodeBeforeMount)&&ns(tt,q,O)}Nt&&Ui(O,null,q,"beforeMount");const se=bP(G,St);se&&St.beforeEnter(it),r(it,D,U),((tt=Tt&&Tt.onVnodeMounted)||se||Nt)&&Rn(()=>{tt&&ns(tt,q,O),se&&St.enter(it),Nt&&Ui(O,null,q,"mounted")},G)},T=(O,D,U,q,G)=>{if(U&&p(O,U),q)for(let Q=0;Q<q.length;Q++)p(O,q[Q]);if(G){let Q=G.subTree;if(D===Q||db(Q.type)&&(Q.ssContent===D||Q.ssFallback===D)){const ct=G.vnode;T(O,ct,ct.scopeId,ct.slotScopeIds,G.parent)}}},I=(O,D,U,q,G,Q,ct,st,it=0)=>{for(let tt=it;tt<O.length;tt++){const Tt=O[tt]=st?Ka(O[tt]):ss(O[tt]);m(null,Tt,D,U,q,G,Q,ct,st)}},C=(O,D,U,q,G,Q,ct)=>{const st=D.el=O.el;let{patchFlag:it,dynamicChildren:tt,dirs:Tt}=D;it|=O.patchFlag&16;const lt=O.props||we,St=D.props||we;let Nt;if(U&&lc(U,!1),(Nt=St.onVnodeBeforeUpdate)&&ns(Nt,U,D,O),Tt&&Ui(D,O,U,"beforeUpdate"),U&&lc(U,!0),(lt.innerHTML&&St.innerHTML==null||lt.textContent&&St.textContent==null)&&u(st,""),tt?R(O.dynamicChildren,tt,st,U,q,Zw(D,G),Q):ct||X(O,D,st,null,U,q,Zw(D,G),Q,!1),it>0){if(it&16)N(st,lt,St,U,G);else if(it&2&&lt.class!==St.class&&i(st,"class",null,St.class,G),it&4&&i(st,"style",lt.style,St.style,G),it&8){const se=D.dynamicProps;for(let Ce=0;Ce<se.length;Ce++){const H=se[Ce],V=lt[H],W=St[H];(W!==V||H==="value")&&i(st,H,V,W,G,U)}}it&1&&O.children!==D.children&&u(st,D.children)}else!ct&&tt==null&&N(st,lt,St,U,G);((Nt=St.onVnodeUpdated)||Tt)&&Rn(()=>{Nt&&ns(Nt,U,D,O),Tt&&Ui(D,O,U,"updated")},q)},R=(O,D,U,q,G,Q,ct)=>{for(let st=0;st<D.length;st++){const it=O[st],tt=D[st],Tt=it.el&&(it.type===ae||!Ei(it,tt)||it.shapeFlag&70)?d(it.el):U;m(it,tt,Tt,null,q,G,Q,ct,!0)}},N=(O,D,U,q,G)=>{if(D!==U){if(D!==we)for(const Q in D)!Kd(Q)&&!(Q in U)&&i(O,Q,D[Q],null,G,q);for(const Q in U){if(Kd(Q))continue;const ct=U[Q],st=D[Q];ct!==st&&Q!=="value"&&i(O,Q,st,ct,G,q)}"value"in U&&i(O,"value",D.value,U.value,G)}},B=(O,D,U,q,G,Q,ct,st,it)=>{const tt=D.el=O?O.el:a(""),Tt=D.anchor=O?O.anchor:a("");let{patchFlag:lt,dynamicChildren:St,slotScopeIds:Nt}=D;Nt&&(st=st?st.concat(Nt):Nt),O==null?(r(tt,U,q),r(Tt,U,q),I(D.children||[],U,Tt,G,Q,ct,st,it)):lt>0&&lt&64&&St&&O.dynamicChildren?(R(O.dynamicChildren,St,U,G,Q,ct,st),(D.key!=null||G&&D===G.subTree)&&bE(O,D,!0)):X(O,D,U,Tt,G,Q,ct,st,it)},$=(O,D,U,q,G,Q,ct,st,it)=>{D.slotScopeIds=st,O==null?D.shapeFlag&512?G.ctx.activate(D,U,q,ct,it):L(D,U,q,G,Q,ct,it):F(O,D,it)},L=(O,D,U,q,G,Q,ct)=>{const st=O.component=NP(O,q,G);if(iy(O)&&(st.ctx.renderer=ht),LP(st,!1,ct),st.asyncDep){if(G&&G.registerDep(st,_,ct),!O.el){const it=st.subTree=bt(wn);y(null,it,D,U)}}else _(st,O,D,U,G,Q,ct)},F=(O,D,U)=>{const q=D.component=O.component;if(LF(O,D,U))if(q.asyncDep&&!q.asyncResolved){j(q,D,U);return}else q.next=D,q.update();else D.el=O.el,q.vnode=D},_=(O,D,U,q,G,Q,ct)=>{const st=()=>{if(O.isMounted){let{next:lt,bu:St,u:Nt,parent:se,vnode:Ce}=O;{const dt=vP(O);if(dt){lt&&(lt.el=Ce.el,j(O,lt,ct)),dt.asyncDep.then(()=>{O.isUnmounted||st()});return}}let H=lt,V;lc(O,!1),lt?(lt.el=Ce.el,j(O,lt,ct)):lt=Ce,St&&Gd(St),(V=lt.props&&lt.props.onVnodeBeforeUpdate)&&ns(V,se,lt,Ce),lc(O,!0);const W=i0(O),J=O.subTree;O.subTree=W,m(J,W,d(J.el),z(J),O,G,Q),lt.el=W.el,H===null&&lw(O,W.el),Nt&&Rn(Nt,G),(V=lt.props&&lt.props.onVnodeUpdated)&&Rn(()=>ns(V,se,lt,Ce),G)}else{let lt;const{el:St,props:Nt}=D,{bm:se,m:Ce,parent:H,root:V,type:W}=O,J=$l(D);if(lc(O,!1),se&&Gd(se),!J&&(lt=Nt&&Nt.onVnodeBeforeMount)&&ns(lt,H,D),lc(O,!0),St&&fe){const dt=()=>{O.subTree=i0(O),fe(St,O.subTree,O,G,null)};J&&W.__asyncHydrate?W.__asyncHydrate(St,O,dt):dt()}else{V.ce&&V.ce._injectChildStyle(W);const dt=O.subTree=i0(O);m(null,dt,U,q,O,G,Q),D.el=dt.el}if(Ce&&Rn(Ce,G),!J&&(lt=Nt&&Nt.onVnodeMounted)){const dt=D;Rn(()=>ns(lt,H,dt),G)}(D.shapeFlag&256||H&&$l(H.vnode)&&H.vnode.shapeFlag&256)&&O.a&&Rn(O.a,G),O.isMounted=!0,D=U=q=null}};O.scope.on();const it=O.effect=new Zp(st);O.scope.off();const tt=O.update=it.run.bind(it),Tt=O.job=it.runIfDirty.bind(it);Tt.i=O,Tt.id=O.uid,it.scheduler=()=>aE(Tt),lc(O,!0),tt()},j=(O,D,U)=>{D.component=O;const q=O.vnode.props;O.vnode=D,O.next=null,AF(O,D.props,q,U),TF(O,D.children,U),Sa(),Kk(O),Aa()},X=(O,D,U,q,G,Q,ct,st,it=!1)=>{const tt=O&&O.children,Tt=O?O.shapeFlag:0,lt=D.children,{patchFlag:St,shapeFlag:Nt}=D;if(St>0){if(St&128){qt(tt,lt,U,q,G,Q,ct,st,it);return}else if(St&256){wt(tt,lt,U,q,G,Q,ct,st,it);return}}Nt&8?(Tt&16&&Ot(tt,G,Q),lt!==tt&&u(U,lt)):Tt&16?Nt&16?qt(tt,lt,U,q,G,Q,ct,st,it):Ot(tt,G,Q,!0):(Tt&8&&u(U,""),Nt&16&&I(lt,U,q,G,Q,ct,st,it))},wt=(O,D,U,q,G,Q,ct,st,it)=>{O=O||Ud,D=D||Ud;const tt=O.length,Tt=D.length,lt=Math.min(tt,Tt);let St;for(St=0;St<lt;St++){const Nt=D[St]=it?Ka(D[St]):ss(D[St]);m(O[St],Nt,U,null,G,Q,ct,st,it)}tt>Tt?Ot(O,G,Q,!0,!1,lt):I(D,U,q,G,Q,ct,st,it,lt)},qt=(O,D,U,q,G,Q,ct,st,it)=>{let tt=0;const Tt=D.length;let lt=O.length-1,St=Tt-1;for(;tt<=lt&&tt<=St;){const Nt=O[tt],se=D[tt]=it?Ka(D[tt]):ss(D[tt]);if(Ei(Nt,se))m(Nt,se,U,null,G,Q,ct,st,it);else break;tt++}for(;tt<=lt&&tt<=St;){const Nt=O[lt],se=D[St]=it?Ka(D[St]):ss(D[St]);if(Ei(Nt,se))m(Nt,se,U,null,G,Q,ct,st,it);else break;lt--,St--}if(tt>lt){if(tt<=St){const Nt=St+1,se=Nt<Tt?D[Nt].el:q;for(;tt<=St;)m(null,D[tt]=it?Ka(D[tt]):ss(D[tt]),U,se,G,Q,ct,st,it),tt++}}else if(tt>St)for(;tt<=lt;)Pt(O[tt],G,Q,!0),tt++;else{const Nt=tt,se=tt,Ce=new Map;for(tt=se;tt<=St;tt++){const Wt=D[tt]=it?Ka(D[tt]):ss(D[tt]);Wt.key!=null&&Ce.set(Wt.key,tt)}let H,V=0;const W=St-se+1;let J=!1,dt=0;const It=new Array(W);for(tt=0;tt<W;tt++)It[tt]=0;for(tt=Nt;tt<=lt;tt++){const Wt=O[tt];if(V>=W){Pt(Wt,G,Q,!0);continue}let Te;if(Wt.key!=null)Te=Ce.get(Wt.key);else for(H=se;H<=St;H++)if(It[H-se]===0&&Ei(Wt,D[H])){Te=H;break}Te===void 0?Pt(Wt,G,Q,!0):(It[Te-se]=tt+1,Te>=dt?dt=Te:J=!0,m(Wt,D[Te],U,null,G,Q,ct,st,it),V++)}const Yt=J?MF(It):Ud;for(H=Yt.length-1,tt=W-1;tt>=0;tt--){const Wt=se+tt,Te=D[Wt],Ht=Wt+1<Tt?D[Wt+1].el:q;It[tt]===0?m(null,Te,U,Ht,G,Q,ct,st,it):J&&(H<0||tt!==Yt[H]?$t(Te,U,Ht,2):H--)}}},$t=(O,D,U,q,G=null)=>{const{el:Q,type:ct,transition:st,children:it,shapeFlag:tt}=O;if(tt&6){$t(O.component.subTree,D,U,q);return}if(tt&128){O.suspense.move(D,U,q);return}if(tt&64){ct.move(O,D,U,ht);return}if(ct===ae){r(Q,D,U);for(let lt=0;lt<it.length;lt++)$t(it[lt],D,U,q);r(O.anchor,D,U);return}if(ct===Nu){x(O,D,U);return}if(q!==2&&tt&1&&st)if(q===0)st.beforeEnter(Q),r(Q,D,U),Rn(()=>st.enter(Q),G);else{const{leave:lt,delayLeave:St,afterLeave:Nt}=st,se=()=>{O.ctx.isUnmounted?s(Q):r(Q,D,U)},Ce=()=>{lt(Q,()=>{se(),Nt&&Nt()})};St?St(Q,se,Ce):Ce()}else r(Q,D,U)},Pt=(O,D,U,q=!1,G=!1)=>{const{type:Q,props:ct,ref:st,children:it,dynamicChildren:tt,shapeFlag:Tt,patchFlag:lt,dirs:St,cacheIndex:Nt}=O;if(lt===-2&&(G=!1),st!=null&&(Sa(),ig(st,null,U,O,!0),Aa()),Nt!=null&&(D.renderCache[Nt]=void 0),Tt&256){D.ctx.deactivate(O);return}const se=Tt&1&&St,Ce=!$l(O);let H;if(Ce&&(H=ct&&ct.onVnodeBeforeUnmount)&&ns(H,D,O),Tt&6)xe(O.component,U,q);else{if(Tt&128){O.suspense.unmount(U,q);return}se&&Ui(O,null,D,"beforeUnmount"),Tt&64?O.type.remove(O,D,U,ht,q):tt&&!tt.hasOnce&&(Q!==ae||lt>0&&lt&64)?Ot(tt,D,U,!1,!0):(Q===ae&&lt&384||!G&&Tt&16)&&Ot(it,D,U),q&&jt(O)}(Ce&&(H=ct&&ct.onVnodeUnmounted)||se)&&Rn(()=>{H&&ns(H,D,O),se&&Ui(O,null,D,"unmounted")},U)},jt=O=>{const{type:D,el:U,anchor:q,transition:G}=O;if(D===ae){me(U,q);return}if(D===Nu){S(O);return}const Q=()=>{s(U),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(O.shapeFlag&1&&G&&!G.persisted){const{leave:ct,delayLeave:st}=G,it=()=>ct(U,Q);st?st(O.el,Q,it):it()}else Q()},me=(O,D)=>{let U;for(;O!==D;)U=h(O),s(O),O=U;s(D)},xe=(O,D,U)=>{const{bum:q,scope:G,job:Q,subTree:ct,um:st,m:it,a:tt,parent:Tt,slots:{__:lt}}=O;ub(it),ub(tt),q&&Gd(q),Tt&&xt(lt)&&lt.forEach(St=>{Tt.renderCache[St]=void 0}),G.stop(),Q&&(Q.flags|=8,Pt(ct,O,D,U)),st&&Rn(st,D),Rn(()=>{O.isUnmounted=!0},D),D&&D.pendingBranch&&!D.isUnmounted&&O.asyncDep&&!O.asyncResolved&&O.suspenseId===D.pendingId&&(D.deps--,D.deps===0&&D.resolve())},Ot=(O,D,U,q=!1,G=!1,Q=0)=>{for(let ct=Q;ct<O.length;ct++)Pt(O[ct],D,U,q,G)},z=O=>{if(O.shapeFlag&6)return z(O.component.subTree);if(O.shapeFlag&128)return O.suspense.next();const D=h(O.anchor||O.el),U=D&&D[$2];return U?h(U):D};let rt=!1;const et=(O,D,U)=>{O==null?D._vnode&&Pt(D._vnode,null,null,!0):m(D._vnode||null,O,D,null,null,null,U),D._vnode=O,rt||(rt=!0,Kk(),lb(),rt=!1)},ht={p:m,um:Pt,m:$t,r:jt,mt:L,mc:I,pc:X,pbc:R,n:z,o:n};let Zt,fe;return t&&([Zt,fe]=t(ht)),{render:et,hydrate:Zt,createApp:xF(et,Zt)}}function Zw({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function lc({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function bP(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function bE(n,t,e=!1){const r=n.children,s=t.children;if(xt(r)&&xt(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Ka(s[i]),a.el=o.el),!e&&a.patchFlag!==-2&&bE(o,a)),a.type===jl&&(a.el=o.el),a.type===wn&&!a.el&&(a.el=o.el)}}function MF(n){const t=n.slice(),e=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=e[e.length-1],n[s]<c){t[r]=s,e.push(r);continue}for(i=0,o=e.length-1;i<o;)a=i+o>>1,n[e[a]]<c?i=a+1:o=a;c<n[e[i]]&&(i>0&&(t[r]=e[i-1]),e[i]=r)}}for(i=e.length,o=e[i-1];i-- >0;)e[i]=o,o=t[o];return e}function vP(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:vP(t)}function ub(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const wP=Symbol.for("v-scx"),xP=()=>Is(wP);function SP(n,t){return oy(n,null,t)}function PF(n,t){return oy(n,null,{flush:"post"})}function AP(n,t){return oy(n,null,{flush:"sync"})}function Mi(n,t,e){return oy(n,t,e)}function oy(n,t,e=we){const{immediate:r,deep:s,flush:i,once:o}=e,a=ze({},e),l=t&&r||!t&&i!=="post";let c;if(df){if(i==="sync"){const p=xP();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=ei,p.resume=ei,p.pause=ei,p}}const u=Nn;a.call=(p,g,m)=>ii(p,u,g,m);let d=!1;i==="post"?a.scheduler=p=>{Rn(p,u&&u.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(p,g)=>{g?p():aE(p)}),a.augmentJob=p=>{t&&(p.flags|=4),d&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=bL(n,t,a);return df&&(c?c.push(h):l&&h()),h}function OF(n,t,e){const r=this.proxy,s=Ge(n)?n.includes(".")?EP(r,n):()=>r[n]:n.bind(r,r);let i;Bt(t)?i=t:(i=t.handler,e=t);const o=Wu(this),a=oy(s,i.bind(r),e);return o(),a}function EP(n,t){const e=t.split(".");return()=>{let r=n;for(let s=0;s<e.length&&r;s++)r=r[e[s]];return r}}function IF(n,t,e=we){const r=_s(),s=lr(t),i=as(t),o=kP(n,s),a=oE((l,c)=>{let u,d=we,h;return AP(()=>{const p=n[s];Fr(u,p)&&(u=p,c())}),{get(){return l(),e.get?e.get(u):u},set(p){const g=e.set?e.set(p):p;if(!Fr(g,u)&&!(d!==we&&Fr(p,d)))return;const m=r.vnode.props;m&&(t in m||s in m||i in m)&&(`onUpdate:${t}`in m||`onUpdate:${s}`in m||`onUpdate:${i}`in m)||(u=p,c()),r.emit(`update:${t}`,g),Fr(p,g)&&Fr(p,d)&&!Fr(g,h)&&c(),d=p,h=g}}});return a[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?o||we:a,done:!1}:{done:!0}}}},a}const kP=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${lr(t)}Modifiers`]||n[`${as(t)}Modifiers`];function RF(n,t,...e){if(n.isUnmounted)return;const r=n.vnode.props||we;let s=e;const i=t.startsWith("update:"),o=i&&kP(r,t.slice(7));o&&(o.trim&&(s=e.map(u=>Ge(u)?u.trim():u)),o.number&&(s=e.map(nb)));let a,l=r[a=xp(t)]||r[a=xp(lr(t))];!l&&i&&(l=r[a=xp(as(t))]),l&&ii(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,ii(c,n,6,s)}}function CP(n,t,e=!1){const r=t.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!Bt(n)){const l=c=>{const u=CP(c,t,!0);u&&(a=!0,ze(o,u))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?($e(n)&&r.set(n,null),null):(xt(i)?i.forEach(l=>o[l]=null):ze(o,i),$e(n)&&r.set(n,o),o)}function aw(n,t){return!n||!ny(t)?!1:(t=t.slice(2).replace(/Once$/,""),Oe(n,t[0].toLowerCase()+t.slice(1))||Oe(n,as(t))||Oe(n,t))}function i0(n){const{type:t,vnode:e,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:d,data:h,setupState:p,ctx:g,inheritAttrs:m}=n,b=sg(n);let y,v;try{if(e.shapeFlag&4){const S=s||r,w=S;y=ss(c.call(w,S,u,d,p,h,g)),v=a}else{const S=t;y=ss(S.length>1?S(d,{attrs:a,slots:o,emit:l}):S(d,null)),v=t.props?a:NF(a)}}catch(S){Tp.length=0,id(S,n,1),y=bt(wn)}let x=y;if(v&&m!==!1){const S=Object.keys(v),{shapeFlag:w}=x;S.length&&w&7&&(i&&S.some(KA)&&(v=_F(v,i)),x=go(x,v,!1,!0))}return e.dirs&&(x=go(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&ka(x,e.transition),y=x,sg(b),y}function DF(n,t=!0){let e;for(let r=0;r<n.length;r++){const s=n[r];if(Ca(s)){if(s.type!==wn||s.children==="v-if"){if(e)return;e=s}}else return}return e}const NF=n=>{let t;for(const e in n)(e==="class"||e==="style"||ny(e))&&((t||(t={}))[e]=n[e]);return t},_F=(n,t)=>{const e={};for(const r in n)(!KA(r)||!(r.slice(9)in t))&&(e[r]=n[r]);return e};function LF(n,t,e){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return r?sC(r,o,c):!!o;if(l&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(o[h]!==r[h]&&!aw(c,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?sC(r,o,c):!0:!!o;return!1}function sC(n,t,e){const r=Object.keys(t);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==n[i]&&!aw(e,i))return!0}return!1}function lw({vnode:n,parent:t},e){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=t.vnode).el=e,t=t.parent;else break}}const db=n=>n.__isSuspense;let h1=0;const FF={name:"Suspense",__isSuspense:!0,process(n,t,e,r,s,i,o,a,l,c){if(n==null)$F(t,e,r,s,i,o,a,l,c);else{if(i&&i.deps>0&&!n.suspense.isInFallback){t.suspense=n.suspense,t.suspense.vnode=t,t.el=n.el;return}jF(n,t,e,r,s,o,a,l,c)}},hydrate:HF,normalize:VF},BF=FF;function ag(n,t){const e=n.props&&n.props[t];Bt(e)&&e()}function $F(n,t,e,r,s,i,o,a,l){const{p:c,o:{createElement:u}}=l,d=u("div"),h=n.suspense=TP(n,s,r,t,d,e,i,o,a,l);c(null,h.pendingBranch=n.ssContent,d,null,r,h,i,o),h.deps>0?(ag(n,"onPending"),ag(n,"onFallback"),c(null,n.ssFallback,t,e,r,null,i,o),Xd(h,n.ssFallback)):h.resolve(!1,!0)}function jF(n,t,e,r,s,i,o,a,{p:l,um:c,o:{createElement:u}}){const d=t.suspense=n.suspense;d.vnode=t,t.el=n.el;const h=t.ssContent,p=t.ssFallback,{activeBranch:g,pendingBranch:m,isInFallback:b,isHydrating:y}=d;if(m)d.pendingBranch=h,Ei(h,m)?(l(m,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0?d.resolve():b&&(y||(l(g,p,e,r,s,null,i,o,a),Xd(d,p)))):(d.pendingId=h1++,y?(d.isHydrating=!1,d.activeBranch=m):c(m,s,d),d.deps=0,d.effects.length=0,d.hiddenContainer=u("div"),b?(l(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0?d.resolve():(l(g,p,e,r,s,null,i,o,a),Xd(d,p))):g&&Ei(h,g)?(l(g,h,e,r,s,d,i,o,a),d.resolve(!0)):(l(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0&&d.resolve()));else if(g&&Ei(h,g))l(g,h,e,r,s,d,i,o,a),Xd(d,h);else if(ag(t,"onPending"),d.pendingBranch=h,h.shapeFlag&512?d.pendingId=h.component.suspenseId:d.pendingId=h1++,l(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0)d.resolve();else{const{timeout:v,pendingId:x}=d;v>0?setTimeout(()=>{d.pendingId===x&&d.fallback(p)},v):v===0&&d.fallback(p)}}function TP(n,t,e,r,s,i,o,a,l,c,u=!1){const{p:d,m:h,um:p,n:g,o:{parentNode:m,remove:b}}=c;let y;const v=zF(n);v&&t&&t.pendingBranch&&(y=t.pendingId,t.deps++);const x=n.props?rb(n.props.timeout):void 0,S=i,w={vnode:n,parent:t,parentComponent:e,namespace:o,container:r,hiddenContainer:s,deps:0,pendingId:h1++,timeout:typeof x=="number"?x:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(E=!1,T=!1){const{vnode:I,activeBranch:C,pendingBranch:R,pendingId:N,effects:B,parentComponent:$,container:L}=w;let F=!1;w.isHydrating?w.isHydrating=!1:E||(F=C&&R.transition&&R.transition.mode==="out-in",F&&(C.transition.afterLeave=()=>{N===w.pendingId&&(h(R,L,i===S?g(C):i,0),ng(B))}),C&&(m(C.el)===L&&(i=g(C)),p(C,$,w,!0)),F||h(R,L,i,0)),Xd(w,R),w.pendingBranch=null,w.isInFallback=!1;let _=w.parent,j=!1;for(;_;){if(_.pendingBranch){_.effects.push(...B),j=!0;break}_=_.parent}!j&&!F&&ng(B),w.effects=[],v&&t&&t.pendingBranch&&y===t.pendingId&&(t.deps--,t.deps===0&&!T&&t.resolve()),ag(I,"onResolve")},fallback(E){if(!w.pendingBranch)return;const{vnode:T,activeBranch:I,parentComponent:C,container:R,namespace:N}=w;ag(T,"onFallback");const B=g(I),$=()=>{w.isInFallback&&(d(null,E,R,B,C,null,N,a,l),Xd(w,E))},L=E.transition&&E.transition.mode==="out-in";L&&(I.transition.afterLeave=$),w.isInFallback=!0,p(I,C,null,!0),L||$()},move(E,T,I){w.activeBranch&&h(w.activeBranch,E,T,I),w.container=E},next(){return w.activeBranch&&g(w.activeBranch)},registerDep(E,T,I){const C=!!w.pendingBranch;C&&w.deps++;const R=E.vnode.el;E.asyncDep.catch(N=>{id(N,E,0)}).then(N=>{if(E.isUnmounted||w.isUnmounted||w.pendingId!==E.suspenseId)return;E.asyncResolved=!0;const{vnode:B}=E;m1(E,N,!1),R&&(B.el=R);const $=!R&&E.subTree.el;T(E,B,m(R||E.subTree.el),R?null:g(E.subTree),w,o,I),$&&b($),lw(E,B.el),C&&--w.deps===0&&w.resolve()})},unmount(E,T){w.isUnmounted=!0,w.activeBranch&&p(w.activeBranch,e,E,T),w.pendingBranch&&p(w.pendingBranch,e,E,T)}};return w}function HF(n,t,e,r,s,i,o,a,l){const c=t.suspense=TP(t,r,e,n.parentNode,document.createElement("div"),null,s,i,o,a,!0),u=l(n,c.pendingBranch=t.ssContent,e,c,i,o);return c.deps===0&&c.resolve(!1,!0),u}function VF(n){const{shapeFlag:t,children:e}=n,r=t&32;n.ssContent=iC(r?e.default:e),n.ssFallback=r?iC(e.fallback):bt(wn)}function iC(n){let t;if(Bt(n)){const e=Uu&&n._c;e&&(n._d=!1,K()),n=n(),e&&(n._d=!0,t=kr,PP())}return xt(n)&&(n=DF(n)),n=ss(n),t&&!n.dynamicChildren&&(n.dynamicChildren=t.filter(e=>e!==n)),n}function MP(n,t){t&&t.pendingBranch?xt(n)?t.effects.push(...n):t.effects.push(n):ng(n)}function Xd(n,t){n.activeBranch=t;const{vnode:e,parentComponent:r}=n;let s=t.el;for(;!s&&t.component;)t=t.component.subTree,s=t.el;e.el=s,r&&r.subTree===e&&(r.vnode.el=s,lw(r,s))}function zF(n){const t=n.props&&n.props.suspensible;return t!=null&&t!==!1}const ae=Symbol.for("v-fgt"),jl=Symbol.for("v-txt"),wn=Symbol.for("v-cmt"),Nu=Symbol.for("v-stc"),Tp=[];let kr=null;function K(n=!1){Tp.push(kr=n?null:[])}function PP(){Tp.pop(),kr=Tp[Tp.length-1]||null}let Uu=1;function f1(n,t=!1){Uu+=n,n<0&&kr&&t&&(kr.hasOnce=!0)}function OP(n){return n.dynamicChildren=Uu>0?kr||Ud:null,PP(),Uu>0&&kr&&kr.push(n),n}function Y(n,t,e,r,s,i){return OP(A(n,t,e,r,s,i,!0))}function Yl(n,t,e,r,s){return OP(bt(n,t,e,r,s,!0))}function Ca(n){return n?n.__v_isVNode===!0:!1}function Ei(n,t){return n.type===t.type&&n.key===t.key}function UF(n){}const IP=({key:n})=>n??null,o0=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Ge(n)||dn(n)||Bt(n)?{i:_n,r:n,k:t,f:!!e}:n:null);function A(n,t=null,e=null,r=0,s=null,i=n===ae?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&IP(t),ref:t&&o0(t),scopeId:nw,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:_n};return a?(vE(l,e),i&128&&n.normalize(l)):e&&(l.shapeFlag|=Ge(e)?8:16),Uu>0&&!o&&kr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&kr.push(l),l}const bt=WF;function WF(n,t=null,e=null,r=0,s=null,i=!1){if((!n||n===eP)&&(n=wn),Ca(n)){const a=go(n,t,!0);return e&&vE(a,e),Uu>0&&!i&&kr&&(a.shapeFlag&6?kr[kr.indexOf(n)]=a:kr.push(a)),a.patchFlag=-2,a}if(ZF(n)&&(n=n.__vccOpts),t){t=RP(t);let{class:a,style:l}=t;a&&!Ge(a)&&(t.class=Kt(a)),$e(l)&&(ew(l)&&!xt(l)&&(l=ze({},l)),t.style=Wn(l))}const o=Ge(n)?1:db(n)?128:j2(n)?64:$e(n)?4:Bt(n)?2:0;return A(n,t,e,r,s,o,i,!0)}function RP(n){return n?ew(n)||cP(n)?ze({},n):n:null}function go(n,t,e=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=t?DP(s||{},t):s,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&IP(c),ref:t&&t.ref?e&&i?xt(i)?i.concat(o0(t)):[i,o0(t)]:o0(t):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==ae?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&go(n.ssContent),ssFallback:n.ssFallback&&go(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&ka(u,l.clone(u)),u}function ge(n=" ",t=0){return bt(jl,null,n,t)}function KF(n,t){const e=bt(Nu,null,n);return e.staticCount=t,e}function Re(n="",t=!1){return t?(K(),Yl(wn,null,n)):bt(wn,null,n)}function ss(n){return n==null||typeof n=="boolean"?bt(wn):xt(n)?bt(ae,null,n.slice()):Ca(n)?Ka(n):bt(jl,null,String(n))}function Ka(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:go(n)}function vE(n,t){let e=0;const{shapeFlag:r}=n;if(t==null)t=null;else if(xt(t))e=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),vE(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!cP(t)?t._ctx=_n:s===3&&_n&&(_n.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else Bt(t)?(t={default:t,_ctx:_n},e=32):(t=String(t),r&64?(e=16,t=[ge(t)]):e=8);n.children=t,n.shapeFlag|=e}function DP(...n){const t={};for(let e=0;e<n.length;e++){const r=n[e];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=Kt([t.class,r.class]));else if(s==="style")t.style=Wn([t.style,r.style]);else if(ny(s)){const i=t[s],o=r[s];o&&i!==o&&!(xt(i)&&i.includes(o))&&(t[s]=i?[].concat(i,o):o)}else s!==""&&(t[s]=r[s])}return t}function ns(n,t,e,r=null){ii(n,t,7,[e,r])}const GF=iP();let YF=0;function NP(n,t,e){const r=n.type,s=(t?t.appContext:n.appContext)||GF,i={uid:YF++,vnode:n,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new qA(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:dP(r,s),emitsOptions:CP(r,s),emit:null,emitted:null,propsDefaults:we,inheritAttrs:r.inheritAttrs,ctx:we,data:we,props:we,attrs:we,slots:we,refs:we,setupState:we,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=RF.bind(null,i),n.ce&&n.ce(i),i}let Nn=null;const _s=()=>Nn||_n;let hb,p1;{const n=Xv(),t=(e,r)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};hb=t("__VUE_INSTANCE_SETTERS__",e=>Nn=e),p1=t("__VUE_SSR_SETTERS__",e=>df=e)}const Wu=n=>{const t=Nn;return hb(n),n.scope.on(),()=>{n.scope.off(),hb(t)}},g1=()=>{Nn&&Nn.scope.off(),hb(null)};function _P(n){return n.vnode.shapeFlag&4}let df=!1;function LP(n,t=!1,e=!1){t&&p1(t);const{props:r,children:s}=n.vnode,i=_P(n);SF(n,r,i,t),CF(n,s,e||t);const o=i?XF(n,t):void 0;return t&&p1(!1),o}function XF(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,l1);const{setup:r}=e;if(r){Sa();const s=n.setupContext=r.length>1?BP(n):null,i=Wu(n),o=Tf(r,n,0,[n.props,s]),a=YA(o);if(Aa(),i(),(a||n.sp)&&!$l(n)&&uE(n),a){if(o.then(g1,g1),t)return o.then(l=>{m1(n,l,t)}).catch(l=>{id(l,n,0)});n.asyncDep=o}else m1(n,o,t)}else FP(n,t)}function m1(n,t,e){Bt(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:$e(t)&&(n.setupState=iE(t)),FP(n,e)}let fb,y1;function qF(n){fb=n,y1=t=>{t.render._rc&&(t.withProxy=new Proxy(t.ctx,eF))}}const JF=()=>!fb;function FP(n,t,e){const r=n.type;if(!n.render){if(!t&&fb&&!r.render){const s=r.template||gE(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=ze(ze({isCustomElement:i,delimiters:a},o),l);r.render=fb(s,c)}}n.render=r.render||ei,y1&&y1(n)}{const s=Wu(n);Sa();try{gF(n)}finally{Aa(),s()}}}const QF={get(n,t){return xr(n,"get",""),n[t]}};function BP(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,QF),slots:n.slots,emit:n.emit,expose:t}}function ay(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(iE(sy(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in kp)return kp[e](n)},has(t,e){return e in t||e in kp}})):n.proxy}function b1(n,t=!0){return Bt(n)?n.displayName||n.name:n.name||t&&n.__name}function ZF(n){return Bt(n)&&"__vccOpts"in n}const Ee=(n,t)=>pL(n,t,df);function ly(n,t,e){const r=arguments.length;return r===2?$e(t)&&!xt(t)?Ca(t)?bt(n,null,[t]):bt(n,t):bt(n,null,t):(r>3?e=Array.prototype.slice.call(arguments,2):r===3&&Ca(e)&&(e=[e]),bt(n,t,e))}function t3(){}function e3(n,t,e,r){const s=e[r];if(s&&$P(s,n))return s;const i=t();return i.memo=n.slice(),i.cacheIndex=r,e[r]=i}function $P(n,t){const e=n.memo;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(Fr(e[r],t[r]))return!1;return Uu>0&&kr&&kr.push(n),!0}const jP="3.5.14",n3=ei,r3=AL,s3=Ed,i3=B2,o3={createComponentInstance:NP,setupComponent:LP,renderComponentRoot:i0,setCurrentRenderingInstance:sg,isVNode:Ca,normalizeVNode:ss,getComponentPublicInstance:ay,ensureValidVNode:pE,pushWarningContext:vL,popWarningContext:wL},a3=o3,l3=null,c3=null,u3=null;/**
* @vue/runtime-dom v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let v1;const oC=typeof window<"u"&&window.trustedTypes;if(oC)try{v1=oC.createPolicy("vue",{createHTML:n=>n})}catch{}const HP=v1?n=>v1.createHTML(n):n=>n,d3="http://www.w3.org/2000/svg",h3="http://www.w3.org/1998/Math/MathML",Ro=typeof document<"u"?document:null,aC=Ro&&Ro.createElement("template"),f3={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,r)=>{const s=t==="svg"?Ro.createElementNS(d3,n):t==="mathml"?Ro.createElementNS(h3,n):e?Ro.createElement(n,{is:e}):Ro.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Ro.createTextNode(n),createComment:n=>Ro.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Ro.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,r,s,i){const o=e?e.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===i||!(s=s.nextSibling)););else{aC.innerHTML=HP(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=aC.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},Na="transition",Nf="animation",hf=Symbol("_vtc"),VP={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},zP=ze({},cE,VP),p3=n=>(n.displayName="Transition",n.props=zP,n),UP=p3((n,{slots:t})=>ly(W2,WP(n),t)),cc=(n,t=[])=>{xt(n)?n.forEach(e=>e(...t)):n&&n(...t)},lC=n=>n?xt(n)?n.some(t=>t.length>1):n.length>1:!1;function WP(n){const t={};for(const B in n)B in VP||(t[B]=n[B]);if(n.css===!1)return t;const{name:e="v",type:r,duration:s,enterFromClass:i=`${e}-enter-from`,enterActiveClass:o=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${e}-leave-from`,leaveActiveClass:h=`${e}-leave-active`,leaveToClass:p=`${e}-leave-to`}=n,g=g3(s),m=g&&g[0],b=g&&g[1],{onBeforeEnter:y,onEnter:v,onEnterCancelled:x,onLeave:S,onLeaveCancelled:w,onBeforeAppear:E=y,onAppear:T=v,onAppearCancelled:I=x}=t,C=(B,$,L,F)=>{B._enterCancelled=F,Ba(B,$?u:a),Ba(B,$?c:o),L&&L()},R=(B,$)=>{B._isLeaving=!1,Ba(B,d),Ba(B,p),Ba(B,h),$&&$()},N=B=>($,L)=>{const F=B?T:v,_=()=>C($,B,L);cc(F,[$,_]),cC(()=>{Ba($,B?l:i),Bi($,B?u:a),lC(F)||uC($,r,m,_)})};return ze(t,{onBeforeEnter(B){cc(y,[B]),Bi(B,i),Bi(B,o)},onBeforeAppear(B){cc(E,[B]),Bi(B,l),Bi(B,c)},onEnter:N(!1),onAppear:N(!0),onLeave(B,$){B._isLeaving=!0;const L=()=>R(B,$);Bi(B,d),B._enterCancelled?(Bi(B,h),w1()):(w1(),Bi(B,h)),cC(()=>{B._isLeaving&&(Ba(B,d),Bi(B,p),lC(S)||uC(B,r,b,L))}),cc(S,[B,L])},onEnterCancelled(B){C(B,!1,void 0,!0),cc(x,[B])},onAppearCancelled(B){C(B,!0,void 0,!0),cc(I,[B])},onLeaveCancelled(B){R(B),cc(w,[B])}})}function g3(n){if(n==null)return null;if($e(n))return[tx(n.enter),tx(n.leave)];{const t=tx(n);return[t,t]}}function tx(n){return rb(n)}function Bi(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[hf]||(n[hf]=new Set)).add(t)}function Ba(n,t){t.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const e=n[hf];e&&(e.delete(t),e.size||(n[hf]=void 0))}function cC(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let m3=0;function uC(n,t,e,r){const s=n._endId=++m3,i=()=>{s===n._endId&&r()};if(e!=null)return setTimeout(i,e);const{type:o,timeout:a,propCount:l}=KP(n,t);if(!o)return r();const c=o+"end";let u=0;const d=()=>{n.removeEventListener(c,h),i()},h=p=>{p.target===n&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),n.addEventListener(c,h)}function KP(n,t){const e=window.getComputedStyle(n),r=g=>(e[g]||"").split(", "),s=r(`${Na}Delay`),i=r(`${Na}Duration`),o=dC(s,i),a=r(`${Nf}Delay`),l=r(`${Nf}Duration`),c=dC(a,l);let u=null,d=0,h=0;t===Na?o>0&&(u=Na,d=o,h=i.length):t===Nf?c>0&&(u=Nf,d=c,h=l.length):(d=Math.max(o,c),u=d>0?o>c?Na:Nf:null,h=u?u===Na?i.length:l.length:0);const p=u===Na&&/\b(transform|all)(,|$)/.test(r(`${Na}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:p}}function dC(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,r)=>hC(e)+hC(n[r])))}function hC(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function w1(){return document.body.offsetHeight}function y3(n,t,e){const r=n[hf];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const pb=Symbol("_vod"),GP=Symbol("_vsh"),YP={beforeMount(n,{value:t},{transition:e}){n[pb]=n.style.display==="none"?"":n.style.display,e&&t?e.beforeEnter(n):_f(n,t)},mounted(n,{value:t},{transition:e}){e&&t&&e.enter(n)},updated(n,{value:t,oldValue:e},{transition:r}){!t!=!e&&(r?t?(r.beforeEnter(n),_f(n,!0),r.enter(n)):r.leave(n,()=>{_f(n,!1)}):_f(n,t))},beforeUnmount(n,{value:t}){_f(n,t)}};function _f(n,t){n.style.display=t?n[pb]:"none",n[GP]=!t}function b3(){YP.getSSRProps=({value:n})=>{if(!n)return{style:{display:"none"}}}}const XP=Symbol("");function v3(n){const t=_s();if(!t)return;const e=t.ut=(s=n(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>gb(i,s))},r=()=>{const s=n(t.proxy);t.ce?gb(t.ce,s):x1(t.subTree,s),e(s)};dE(()=>{ng(r)}),qn(()=>{Mi(r,ei,{flush:"post"});const s=new MutationObserver(r);s.observe(t.subTree.el.parentNode,{childList:!0}),ow(()=>s.disconnect())})}function x1(n,t){if(n.shapeFlag&128){const e=n.suspense;n=e.activeBranch,e.pendingBranch&&!e.isHydrating&&e.effects.push(()=>{x1(e.activeBranch,t)})}for(;n.component;)n=n.component.subTree;if(n.shapeFlag&1&&n.el)gb(n.el,t);else if(n.type===ae)n.children.forEach(e=>x1(e,t));else if(n.type===Nu){let{el:e,anchor:r}=n;for(;e&&(gb(e,t),e!==r);)e=e.nextSibling}}function gb(n,t){if(n.nodeType===1){const e=n.style;let r="";for(const s in t)e.setProperty(`--${s}`,t[s]),r+=`--${s}: ${t[s]};`;e[XP]=r}}const w3=/(^|;)\s*display\s*:/;function x3(n,t,e){const r=n.style,s=Ge(e);let i=!1;if(e&&!s){if(t)if(Ge(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&a0(r,a,"")}else for(const o in t)e[o]==null&&a0(r,o,"");for(const o in e)o==="display"&&(i=!0),a0(r,o,e[o])}else if(s){if(t!==e){const o=r[XP];o&&(e+=";"+o),r.cssText=e,i=w3.test(e)}}else t&&n.removeAttribute("style");pb in n&&(n[pb]=i?r.display:"",n[GP]&&(r.display="none"))}const fC=/\s*!important$/;function a0(n,t,e){if(xt(e))e.forEach(r=>a0(n,t,r));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const r=S3(n,t);fC.test(e)?n.setProperty(as(r),e.replace(fC,""),"important"):n[r]=e}}const pC=["Webkit","Moz","ms"],ex={};function S3(n,t){const e=ex[t];if(e)return e;let r=lr(t);if(r!=="filter"&&r in n)return ex[t]=r;r=ry(r);for(let s=0;s<pC.length;s++){const i=pC[s]+r;if(i in n)return ex[t]=i}return t}const gC="http://www.w3.org/1999/xlink";function mC(n,t,e,r,s,i=__(t)){r&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(gC,t.slice(6,t.length)):n.setAttributeNS(gC,t,e):e==null||i&&!d2(e)?n.removeAttribute(t):n.setAttribute(t,i?"":Oi(e)?String(e):e)}function yC(n,t,e,r,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?HP(e):e);return}const i=n.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=e==null?n.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in n))&&(n.value=l),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const a=typeof n[t];a==="boolean"?e=d2(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(s||t)}function ua(n,t,e,r){n.addEventListener(t,e,r)}function A3(n,t,e,r){n.removeEventListener(t,e,r)}const bC=Symbol("_vei");function E3(n,t,e,r,s=null){const i=n[bC]||(n[bC]={}),o=i[t];if(r&&o)o.value=r;else{const[a,l]=k3(t);if(r){const c=i[t]=M3(r,s);ua(n,a,c,l)}else o&&(A3(n,a,o,l),i[t]=void 0)}}const vC=/(?:Once|Passive|Capture)$/;function k3(n){let t;if(vC.test(n)){t={};let r;for(;r=n.match(vC);)n=n.slice(0,n.length-r[0].length),t[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):as(n.slice(2)),t]}let nx=0;const C3=Promise.resolve(),T3=()=>nx||(C3.then(()=>nx=0),nx=Date.now());function M3(n,t){const e=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=e.attached)return;ii(P3(r,e.value),t,5,[r])};return e.value=n,e.attached=T3(),e}function P3(n,t){if(xt(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const wC=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,O3=(n,t,e,r,s,i)=>{const o=s==="svg";t==="class"?y3(n,r,o):t==="style"?x3(n,e,r):ny(t)?KA(t)||E3(n,t,e,r,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):I3(n,t,r,o))?(yC(n,t,r),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&mC(n,t,r,o,i,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Ge(r))?yC(n,lr(t),r,i,t):(t==="true-value"?n._trueValue=r:t==="false-value"&&(n._falseValue=r),mC(n,t,r,o))};function I3(n,t,e,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in n&&wC(t)&&Bt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return wC(t)&&Ge(e)?!1:t in n}const xC={};/*! #__NO_SIDE_EFFECTS__ */function qP(n,t,e){const r=Mf(n,t);Gv(r)&&ze(r,t);class s extends cw{constructor(o){super(r,o,e)}}return s.def=r,s}/*! #__NO_SIDE_EFFECTS__ */const R3=(n,t)=>qP(n,t,lO),D3=typeof HTMLElement<"u"?HTMLElement:class{};class cw extends D3{constructor(t,e={},r=yb){super(),this._def=t,this._props=e,this._createApp=r,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&r!==yb?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof cw){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,od(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);this._ob=new MutationObserver(r=>{for(const s of r)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(r,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:i,styles:o}=r;let a;if(i&&!xt(i))for(const l in i){const c=i[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=rb(this._props[l])),(a||(a=Object.create(null)))[lr(l)]=!0)}this._numberProps=a,s&&this._resolveProps(r),this.shadowRoot&&this._applyStyles(o),this._mount(r)},e=this._def.__asyncLoader;e?this._pendingResolve=e().then(r=>t(this._def=r,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const e=this._instance&&this._instance.exposed;if(e)for(const r in e)Oe(this,r)||Object.defineProperty(this,r,{get:()=>ee(e[r])})}_resolveProps(t){const{props:e}=t,r=xt(e)?e:Object.keys(e||{});for(const s of Object.keys(this))s[0]!=="_"&&r.includes(s)&&this._setProp(s,this[s]);for(const s of r.map(lr))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(i){this._setProp(s,i,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const e=this.hasAttribute(t);let r=e?this.getAttribute(t):xC;const s=lr(t);e&&this._numberProps&&this._numberProps[s]&&(r=rb(r)),this._setProp(s,r,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,e,r=!0,s=!1){if(e!==this._props[t]&&(e===xC?delete this._props[t]:(this._props[t]=e,t==="key"&&this._app&&(this._app._ceVNode.key=e)),s&&this._instance&&this._update(),r)){const i=this._ob;i&&i.disconnect(),e===!0?this.setAttribute(as(t),""):typeof e=="string"||typeof e=="number"?this.setAttribute(as(t),e+""):e||this.removeAttribute(as(t)),i&&i.observe(this,{attributes:!0})}}_update(){aO(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const e=bt(this._def,ze(t,this._props));return this._instance||(e.ce=r=>{this._instance=r,r.ce=this,r.isCE=!0;const s=(i,o)=>{this.dispatchEvent(new CustomEvent(i,Gv(o[0])?ze({detail:o},o[0]):{detail:o}))};r.emit=(i,...o)=>{s(i,o),as(i)!==i&&s(as(i),o)},this._setParent()}),e}_applyStyles(t,e){if(!t)return;if(e){if(e===this._def||this._styleChildren.has(e))return;this._styleChildren.add(e)}const r=this._nonce;for(let s=t.length-1;s>=0;s--){const i=document.createElement("style");r&&i.setAttribute("nonce",r),i.textContent=t[s],this.shadowRoot.prepend(i)}}_parseSlots(){const t=this._slots={};let e;for(;e=this.firstChild;){const r=e.nodeType===1&&e.getAttribute("slot")||"default";(t[r]||(t[r]=[])).push(e),this.removeChild(e)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),e=this._instance.type.__scopeId;for(let r=0;r<t.length;r++){const s=t[r],i=s.getAttribute("name")||"default",o=this._slots[i],a=s.parentNode;if(o)for(const l of o){if(e&&l.nodeType===1){const c=e+"-s",u=document.createTreeWalker(l,1);l.setAttribute(c,"");let d;for(;d=u.nextNode();)d.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}function JP(n){const t=_s(),e=t&&t.ce;return e||null}function N3(){const n=JP();return n&&n.shadowRoot}function _3(n="$style"){{const t=_s();if(!t)return we;const e=t.type.__cssModules;if(!e)return we;const r=e[n];return r||we}}const QP=new WeakMap,ZP=new WeakMap,mb=Symbol("_moveCb"),SC=Symbol("_enterCb"),L3=n=>(delete n.props.mode,n),F3=L3({name:"TransitionGroup",props:ze({},zP,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=_s(),r=lE();let s,i;return iw(()=>{if(!s.length)return;const o=n.moveClass||`${n.name||"v"}-move`;if(!V3(s[0].el,e.vnode.el,o)){s=[];return}s.forEach($3),s.forEach(j3);const a=s.filter(H3);w1(),a.forEach(l=>{const c=l.el,u=c.style;Bi(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const d=c[mb]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",d),c[mb]=null,Ba(c,o))};c.addEventListener("transitionend",d)}),s=[]}),()=>{const o=be(n),a=WP(o);let l=o.tag||ae;if(s=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(s.push(u),ka(u,uf(u,a,r,e)),QP.set(u,u.el.getBoundingClientRect()))}i=t.default?rw(t.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&ka(u,uf(u,a,r,e))}return bt(l,null,i)}}}),B3=F3;function $3(n){const t=n.el;t[mb]&&t[mb](),t[SC]&&t[SC]()}function j3(n){ZP.set(n,n.el.getBoundingClientRect())}function H3(n){const t=QP.get(n),e=ZP.get(n),r=t.left-e.left,s=t.top-e.top;if(r||s){const i=n.el.style;return i.transform=i.webkitTransform=`translate(${r}px,${s}px)`,i.transitionDuration="0s",n}}function V3(n,t,e){const r=n.cloneNode(),s=n[hf];s&&s.forEach(a=>{a.split(/\s+/).forEach(l=>l&&r.classList.remove(l))}),e.split(/\s+/).forEach(a=>a&&r.classList.add(a)),r.style.display="none";const i=t.nodeType===1?t:t.parentNode;i.appendChild(r);const{hasTransform:o}=KP(r);return i.removeChild(r),o}const Xl=n=>{const t=n.props["onUpdate:modelValue"]||!1;return xt(t)?e=>Gd(t,e):t};function z3(n){n.target.composing=!0}function AC(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ni=Symbol("_assign"),cn={created(n,{modifiers:{lazy:t,trim:e,number:r}},s){n[ni]=Xl(s);const i=r||s.props&&s.props.type==="number";ua(n,t?"change":"input",o=>{if(o.target.composing)return;let a=n.value;e&&(a=a.trim()),i&&(a=nb(a)),n[ni](a)}),e&&ua(n,"change",()=>{n.value=n.value.trim()}),t||(ua(n,"compositionstart",z3),ua(n,"compositionend",AC),ua(n,"change",AC))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:r,trim:s,number:i}},o){if(n[ni]=Xl(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?nb(n.value):n.value,l=t??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&t===e||s&&n.value.trim()===l)||(n.value=l))}},wE={deep:!0,created(n,t,e){n[ni]=Xl(e),ua(n,"change",()=>{const r=n._modelValue,s=ff(n),i=n.checked,o=n[ni];if(xt(r)){const a=qv(r,s),l=a!==-1;if(i&&!l)o(r.concat(s));else if(!i&&l){const c=[...r];c.splice(a,1),o(c)}}else if(sd(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(tO(n,i))})},mounted:EC,beforeUpdate(n,t,e){n[ni]=Xl(e),EC(n,t,e)}};function EC(n,{value:t,oldValue:e},r){n._modelValue=t;let s;if(xt(t))s=qv(t,r.props.value)>-1;else if(sd(t))s=t.has(r.props.value);else{if(t===e)return;s=Gl(t,tO(n,!0))}n.checked!==s&&(n.checked=s)}const xE={created(n,{value:t},e){n.checked=Gl(t,e.props.value),n[ni]=Xl(e),ua(n,"change",()=>{n[ni](ff(n))})},beforeUpdate(n,{value:t,oldValue:e},r){n[ni]=Xl(r),t!==e&&(n.checked=Gl(t,r.props.value))}},mo={deep:!0,created(n,{value:t,modifiers:{number:e}},r){const s=sd(t);ua(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>e?nb(ff(o)):ff(o));n[ni](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,od(()=>{n._assigning=!1})}),n[ni]=Xl(r)},mounted(n,{value:t}){kC(n,t)},beforeUpdate(n,t,e){n[ni]=Xl(e)},updated(n,{value:t}){n._assigning||kC(n,t)}};function kC(n,t){const e=n.multiple,r=xt(t);if(!(e&&!r&&!sd(t))){for(let s=0,i=n.options.length;s<i;s++){const o=n.options[s],a=ff(o);if(e)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=qv(t,a)>-1}else o.selected=t.has(a);else if(Gl(ff(o),t)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function ff(n){return"_value"in n?n._value:n.value}function tO(n,t){const e=t?"_trueValue":"_falseValue";return e in n?n[e]:t}const eO={created(n,t,e){Oy(n,t,e,null,"created")},mounted(n,t,e){Oy(n,t,e,null,"mounted")},beforeUpdate(n,t,e,r){Oy(n,t,e,r,"beforeUpdate")},updated(n,t,e,r){Oy(n,t,e,r,"updated")}};function nO(n,t){switch(n){case"SELECT":return mo;case"TEXTAREA":return cn;default:switch(t){case"checkbox":return wE;case"radio":return xE;default:return cn}}}function Oy(n,t,e,r,s){const o=nO(n.tagName,e.props&&e.props.type)[s];o&&o(n,t,e,r)}function U3(){cn.getSSRProps=({value:n})=>({value:n}),xE.getSSRProps=({value:n},t)=>{if(t.props&&Gl(t.props.value,n))return{checked:!0}},wE.getSSRProps=({value:n},t)=>{if(xt(n)){if(t.props&&qv(n,t.props.value)>-1)return{checked:!0}}else if(sd(n)){if(t.props&&n.has(t.props.value))return{checked:!0}}else if(n)return{checked:!0}},eO.getSSRProps=(n,t)=>{if(typeof t.type!="string")return;const e=nO(t.type.toUpperCase(),t.props&&t.props.type);if(e.getSSRProps)return e.getSSRProps(n,t)}}const W3=["ctrl","shift","alt","meta"],K3={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>W3.some(e=>n[`${e}Key`]&&!t.includes(e))},uw=(n,t)=>{const e=n._withMods||(n._withMods={}),r=t.join(".");return e[r]||(e[r]=(s,...i)=>{for(let o=0;o<t.length;o++){const a=K3[t[o]];if(a&&a(s,t))return}return n(s,...i)})},G3={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},rO=(n,t)=>{const e=n._withKeys||(n._withKeys={}),r=t.join(".");return e[r]||(e[r]=s=>{if(!("key"in s))return;const i=as(s.key);if(t.some(o=>o===i||G3[o]===i))return n(s)})},sO=ze({patchProp:O3},f3);let Mp,CC=!1;function iO(){return Mp||(Mp=gP(sO))}function oO(){return Mp=CC?Mp:mP(sO),CC=!0,Mp}const aO=(...n)=>{iO().render(...n)},Y3=(...n)=>{oO().hydrate(...n)},yb=(...n)=>{const t=iO().createApp(...n),{mount:e}=t;return t.mount=r=>{const s=uO(r);if(!s)return;const i=t._component;!Bt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=e(s,!1,cO(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t},lO=(...n)=>{const t=oO().createApp(...n),{mount:e}=t;return t.mount=r=>{const s=uO(r);if(s)return e(s,!0,cO(s))},t};function cO(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function uO(n){return Ge(n)?document.querySelector(n):n}let TC=!1;const X3=()=>{TC||(TC=!0,U3(),b3())};/**
* vue v3.5.14
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const q3=()=>{},J3=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:W2,BaseTransitionPropsValidators:cE,Comment:wn,DeprecationTypes:u3,EffectScope:qA,ErrorCodes:SL,ErrorTypeStrings:r3,Fragment:ae,KeepAlive:YL,ReactiveEffect:Zp,Static:Nu,Suspense:BF,Teleport:OL,Text:jl,TrackOpTypes:gL,Transition:UP,TransitionGroup:B3,TriggerOpTypes:mL,VueElement:cw,assertNumber:xL,callWithAsyncErrorHandling:ii,callWithErrorHandling:Tf,camelize:lr,capitalize:ry,cloneVNode:go,compatUtils:c3,compile:q3,computed:Ee,createApp:yb,createBlock:Yl,createCommentVNode:Re,createElementBlock:Y,createElementVNode:A,createHydrationRenderer:mP,createPropsRestProxy:fF,createRenderer:gP,createSSRApp:lO,createSlots:QL,createStaticVNode:KF,createTextVNode:ge,createVNode:bt,customRef:oE,defineAsyncComponent:KL,defineComponent:Mf,defineCustomElement:qP,defineEmits:rF,defineExpose:sF,defineModel:aF,defineOptions:iF,defineProps:nF,defineSSRCustomElement:R3,defineSlots:oF,devtools:s3,effect:B_,effectScope:JA,getCurrentInstance:_s,getCurrentScope:QA,getCurrentWatcher:yL,getTransitionRawChildren:rw,guardReactiveProps:RP,h:ly,handleError:id,hasInjectionContext:oP,hydrate:Y3,hydrateOnIdle:jL,hydrateOnInteraction:UL,hydrateOnMediaQuery:zL,hydrateOnVisible:VL,initCustomFormatter:t3,initDirectivesForSSR:X3,inject:Is,isMemoSame:$P,isProxy:ew,isReactive:fo,isReadonly:Ea,isRef:dn,isRuntimeOnly:JF,isShallow:Os,isVNode:Ca,markRaw:sy,mergeDefaults:dF,mergeModels:hF,mergeProps:DP,nextTick:od,normalizeClass:Kt,normalizeProps:D_,normalizeStyle:Wn,onActivated:G2,onBeforeMount:q2,onBeforeUnmount:ad,onBeforeUpdate:dE,onDeactivated:Y2,onErrorCaptured:tP,onMounted:qn,onRenderTracked:Z2,onRenderTriggered:Q2,onScopeDispose:p2,onServerPrefetch:J2,onUnmounted:ow,onUpdated:iw,onWatcherCleanup:D2,openBlock:K,popScopeId:TL,provide:Cp,proxyRefs:iE,pushScopeId:CL,queuePostFlushCb:ng,reactive:Cf,readonly:rE,ref:ot,registerRuntimeCompiler:qF,render:aO,renderList:ln,renderSlot:ZL,resolveComponent:Ia,resolveDirective:JL,resolveDynamicComponent:nP,resolveFilter:l3,resolveTransitionHooks:uf,setBlockTracking:f1,setDevtoolsHook:i3,setTransitionHooks:ka,shallowReactive:nE,shallowReadonly:sL,shallowRef:sE,ssrContextKey:wP,ssrUtils:a3,stop:$_,toDisplayString:pt,toHandlerKey:xp,toHandlers:tF,toRaw:be,toRef:hL,toRefs:I2,toValue:aL,transformVNodeArgs:UF,triggerRef:oL,unref:ee,useAttrs:uF,useCssModule:_3,useCssVars:v3,useHost:JP,useId:RL,useModel:IF,useSSRContext:xP,useShadowRoot:N3,useSlots:cF,useTemplateRef:DL,useTransitionState:lE,vModelCheckbox:wE,vModelDynamic:eO,vModelRadio:xE,vModelSelect:mo,vModelText:cn,vShow:YP,version:jP,warn:n3,watch:Mi,watchEffect:SP,watchPostEffect:PF,watchSyncEffect:AP,withAsyncContext:pF,withCtx:Se,withDefaults:lF,withDirectives:Le,withKeys:rO,withMemo:e3,withModifiers:uw,withScopeId:ML},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let dO;const dw=n=>dO=n,hO=Symbol();function S1(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Pp;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Pp||(Pp={}));function Q3(){const n=JA(!0),t=n.run(()=>ot({}));let e=[],r=[];const s=sy({install(i){dw(s),s._a=i,i.provide(hO,s),i.config.globalProperties.$pinia=s,r.forEach(o=>e.push(o)),r=[]},use(i){return this._a?e.push(i):r.push(i),this},_p:e,_a:null,_e:n,_s:new Map,state:t});return s}const fO=()=>{};function MC(n,t,e,r=fO){n.push(t);const s=()=>{const i=n.indexOf(t);i>-1&&(n.splice(i,1),r())};return!e&&QA()&&p2(s),s}function pd(n,...t){n.slice().forEach(e=>{e(...t)})}const Z3=n=>n(),PC=Symbol(),rx=Symbol();function A1(n,t){n instanceof Map&&t instanceof Map?t.forEach((e,r)=>n.set(r,e)):n instanceof Set&&t instanceof Set&&t.forEach(n.add,n);for(const e in t){if(!t.hasOwnProperty(e))continue;const r=t[e],s=n[e];S1(s)&&S1(r)&&n.hasOwnProperty(e)&&!dn(r)&&!fo(r)?n[e]=A1(s,r):n[e]=r}return n}const t4=Symbol();function e4(n){return!S1(n)||!n.hasOwnProperty(t4)}const{assign:$a}=Object;function n4(n){return!!(dn(n)&&n.effect)}function r4(n,t,e,r){const{state:s,actions:i,getters:o}=t,a=e.state.value[n];let l;function c(){a||(e.state.value[n]=s?s():{});const u=I2(e.state.value[n]);return $a(u,i,Object.keys(o||{}).reduce((d,h)=>(d[h]=sy(Ee(()=>{dw(e);const p=e._s.get(n);return o[h].call(p,p)})),d),{}))}return l=pO(n,c,t,e,r,!0),l}function pO(n,t,e={},r,s,i){let o;const a=$a({actions:{}},e),l={deep:!0};let c,u,d=[],h=[],p;const g=r.state.value[n];!i&&!g&&(r.state.value[n]={}),ot({});let m;function b(I){let C;c=u=!1,typeof I=="function"?(I(r.state.value[n]),C={type:Pp.patchFunction,storeId:n,events:p}):(A1(r.state.value[n],I),C={type:Pp.patchObject,payload:I,storeId:n,events:p});const R=m=Symbol();od().then(()=>{m===R&&(c=!0)}),u=!0,pd(d,C,r.state.value[n])}const y=i?function(){const{state:C}=e,R=C?C():{};this.$patch(N=>{$a(N,R)})}:fO;function v(){o.stop(),d=[],h=[],r._s.delete(n)}const x=(I,C="")=>{if(PC in I)return I[rx]=C,I;const R=function(){dw(r);const N=Array.from(arguments),B=[],$=[];function L(j){B.push(j)}function F(j){$.push(j)}pd(h,{args:N,name:R[rx],store:w,after:L,onError:F});let _;try{_=I.apply(this&&this.$id===n?this:w,N)}catch(j){throw pd($,j),j}return _ instanceof Promise?_.then(j=>(pd(B,j),j)).catch(j=>(pd($,j),Promise.reject(j))):(pd(B,_),_)};return R[PC]=!0,R[rx]=C,R},S={_p:r,$id:n,$onAction:MC.bind(null,h),$patch:b,$reset:y,$subscribe(I,C={}){const R=MC(d,I,C.detached,()=>N()),N=o.run(()=>Mi(()=>r.state.value[n],B=>{(C.flush==="sync"?u:c)&&I({storeId:n,type:Pp.direct,events:p},B)},$a({},l,C)));return R},$dispose:v},w=Cf(S);r._s.set(n,w);const T=(r._a&&r._a.runWithContext||Z3)(()=>r._e.run(()=>(o=JA()).run(()=>t({action:x}))));for(const I in T){const C=T[I];if(dn(C)&&!n4(C)||fo(C))i||(g&&e4(C)&&(dn(C)?C.value=g[I]:A1(C,g[I])),r.state.value[n][I]=C);else if(typeof C=="function"){const R=x(C,I);T[I]=R,a.actions[I]=C}}return $a(w,T),$a(be(w),T),Object.defineProperty(w,"$state",{get:()=>r.state.value[n],set:I=>{b(C=>{$a(C,I)})}}),r._p.forEach(I=>{$a(w,o.run(()=>I({store:w,app:r._a,pinia:r,options:a})))}),g&&i&&e.hydrate&&e.hydrate(w.$state,g),c=!0,u=!0,w}/*! #__NO_SIDE_EFFECTS__ */function ld(n,t,e){let r,s;const i=typeof t=="function";typeof n=="string"?(r=n,s=i?e:t):(s=n,r=n.id);function o(a,l){const c=oP();return a=a||(c?Is(hO,null):null),a&&dw(a),a=dO,a._s.has(r)||(i?pO(r,t,s,a):r4(r,s,a)),a._s.get(r)}return o.$id=r,o}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const kd=typeof document<"u";function gO(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function s4(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&gO(n.default)}const Ie=Object.assign;function sx(n,t){const e={};for(const r in t){const s=t[r];e[r]=Ii(s)?s.map(n):n(s)}return e}const Op=()=>{},Ii=Array.isArray,mO=/#/g,i4=/&/g,o4=/\//g,a4=/=/g,l4=/\?/g,yO=/\+/g,c4=/%5B/g,u4=/%5D/g,bO=/%5E/g,d4=/%60/g,vO=/%7B/g,h4=/%7C/g,wO=/%7D/g,f4=/%20/g;function SE(n){return encodeURI(""+n).replace(h4,"|").replace(c4,"[").replace(u4,"]")}function p4(n){return SE(n).replace(vO,"{").replace(wO,"}").replace(bO,"^")}function E1(n){return SE(n).replace(yO,"%2B").replace(f4,"+").replace(mO,"%23").replace(i4,"%26").replace(d4,"`").replace(vO,"{").replace(wO,"}").replace(bO,"^")}function g4(n){return E1(n).replace(a4,"%3D")}function m4(n){return SE(n).replace(mO,"%23").replace(l4,"%3F")}function y4(n){return n==null?"":m4(n).replace(o4,"%2F")}function lg(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const b4=/\/$/,v4=n=>n.replace(b4,"");function ix(n,t,e="/"){let r,s={},i="",o="";const a=t.indexOf("#");let l=t.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=t.slice(0,l),i=t.slice(l+1,a>-1?a:t.length),s=n(i)),a>-1&&(r=r||t.slice(0,a),o=t.slice(a,t.length)),r=A4(r??t,e),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:lg(o)}}function w4(n,t){const e=t.query?n(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function OC(n,t){return!t||!n.toLowerCase().startsWith(t.toLowerCase())?n:n.slice(t.length)||"/"}function x4(n,t,e){const r=t.matched.length-1,s=e.matched.length-1;return r>-1&&r===s&&pf(t.matched[r],e.matched[s])&&xO(t.params,e.params)&&n(t.query)===n(e.query)&&t.hash===e.hash}function pf(n,t){return(n.aliasOf||n)===(t.aliasOf||t)}function xO(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(!S4(n[e],t[e]))return!1;return!0}function S4(n,t){return Ii(n)?IC(n,t):Ii(t)?IC(t,n):n===t}function IC(n,t){return Ii(t)?n.length===t.length&&n.every((e,r)=>e===t[r]):n.length===1&&n[0]===t}function A4(n,t){if(n.startsWith("/"))return n;if(!n)return t;const e=t.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=e.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return e.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const _a={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var cg;(function(n){n.pop="pop",n.push="push"})(cg||(cg={}));var Ip;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Ip||(Ip={}));function E4(n){if(!n)if(kd){const t=document.querySelector("base");n=t&&t.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),v4(n)}const k4=/^[^#]+#/;function C4(n,t){return n.replace(k4,"#")+t}function T4(n,t){const e=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:t.behavior,left:r.left-e.left-(t.left||0),top:r.top-e.top-(t.top||0)}}const hw=()=>({left:window.scrollX,top:window.scrollY});function M4(n){let t;if("el"in n){const e=n.el,r=typeof e=="string"&&e.startsWith("#"),s=typeof e=="string"?r?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!s)return;t=T4(s,n)}else t=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function RC(n,t){return(history.state?history.state.position-t:-1)+n}const k1=new Map;function P4(n,t){k1.set(n,t)}function O4(n){const t=k1.get(n);return k1.delete(n),t}let I4=()=>location.protocol+"//"+location.host;function SO(n,t){const{pathname:e,search:r,hash:s}=t,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),OC(l,"")}return OC(e,n)+r+s}function R4(n,t,e,r){let s=[],i=[],o=null;const a=({state:h})=>{const p=SO(n,location),g=e.value,m=t.value;let b=0;if(h){if(e.value=p,t.value=h,o&&o===g){o=null;return}b=m?h.position-m.position:0}else r(p);s.forEach(y=>{y(e.value,g,{delta:b,type:cg.pop,direction:b?b>0?Ip.forward:Ip.back:Ip.unknown})})};function l(){o=e.value}function c(h){s.push(h);const p=()=>{const g=s.indexOf(h);g>-1&&s.splice(g,1)};return i.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(Ie({},h.state,{scroll:hw()}),"")}function d(){for(const h of i)h();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function DC(n,t,e,r=!1,s=!1){return{back:n,current:t,forward:e,replaced:r,position:window.history.length,scroll:s?hw():null}}function D4(n){const{history:t,location:e}=window,r={value:SO(n,e)},s={value:t.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const d=n.indexOf("#"),h=d>-1?(e.host&&document.querySelector("base")?n:n.slice(d))+l:I4()+n+l;try{t[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),e[u?"replace":"assign"](h)}}function o(l,c){const u=Ie({},t.state,DC(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),r.value=l}function a(l,c){const u=Ie({},s.value,t.state,{forward:l,scroll:hw()});i(u.current,u,!0);const d=Ie({},DC(r.value,l,null),{position:u.position+1},c);i(l,d,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function N4(n){n=E4(n);const t=D4(n),e=R4(n,t.state,t.location,t.replace);function r(i,o=!0){o||e.pauseListeners(),history.go(i)}const s=Ie({location:"",base:n,go:r,createHref:C4.bind(null,n)},t,e);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function _4(n){return typeof n=="string"||n&&typeof n=="object"}function AO(n){return typeof n=="string"||typeof n=="symbol"}const EO=Symbol("");var NC;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NC||(NC={}));function gf(n,t){return Ie(new Error,{type:n,[EO]:!0},t)}function Ao(n,t){return n instanceof Error&&EO in n&&(t==null||!!(n.type&t))}const _C="[^/]+?",L4={sensitive:!1,strict:!1,start:!0,end:!0},F4=/[.+*?^${}()[\]/\\]/g;function B4(n,t){const e=Ie({},L4,t),r=[];let s=e.start?"^":"";const i=[];for(const c of n){const u=c.length?[]:[90];e.strict&&!c.length&&(s+="/");for(let d=0;d<c.length;d++){const h=c[d];let p=40+(e.sensitive?.25:0);if(h.type===0)d||(s+="/"),s+=h.value.replace(F4,"\\$&"),p+=40;else if(h.type===1){const{value:g,repeatable:m,optional:b,regexp:y}=h;i.push({name:g,repeatable:m,optional:b});const v=y||_C;if(v!==_C){p+=10;try{new RegExp(`(${v})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${g}" (${v}): `+S.message)}}let x=m?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;d||(x=b&&c.length<2?`(?:/${x})`:"/"+x),b&&(x+="?"),s+=x,p+=20,b&&(p+=-8),m&&(p+=-20),v===".*"&&(p+=-50)}u.push(p)}r.push(u)}if(e.strict&&e.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}e.strict||(s+="/?"),e.end?s+="$":e.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,e.sensitive?"":"i");function a(c){const u=c.match(o),d={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",g=i[h-1];d[g.name]=p&&g.repeatable?p.split("/"):p}return d}function l(c){let u="",d=!1;for(const h of n){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:g,repeatable:m,optional:b}=p,y=g in c?c[g]:"";if(Ii(y)&&!m)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const v=Ii(y)?y.join("/"):y;if(!v)if(b)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${g}"`);u+=v}}return u||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function $4(n,t){let e=0;for(;e<n.length&&e<t.length;){const r=t[e]-n[e];if(r)return r;e++}return n.length<t.length?n.length===1&&n[0]===80?-1:1:n.length>t.length?t.length===1&&t[0]===80?1:-1:0}function kO(n,t){let e=0;const r=n.score,s=t.score;for(;e<r.length&&e<s.length;){const i=$4(r[e],s[e]);if(i)return i;e++}if(Math.abs(s.length-r.length)===1){if(LC(r))return 1;if(LC(s))return-1}return s.length-r.length}function LC(n){const t=n[n.length-1];return n.length>0&&t[t.length-1]<0}const j4={type:0,value:""},H4=/[a-zA-Z0-9_]/;function V4(n){if(!n)return[[]];if(n==="/")return[[j4]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function t(p){throw new Error(`ERR (${e})/"${c}": ${p}`)}let e=0,r=e;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",u="";function d(){c&&(e===0?i.push({type:0,value:c}):e===1||e===2||e===3?(i.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&e!==2){r=e,e=4;continue}switch(e){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),e=1):h();break;case 4:h(),e=r;break;case 1:l==="("?e=2:H4.test(l)?h():(d(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:e=3:u+=l;break;case 3:d(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:t("Unknown state");break}}return e===2&&t(`Unfinished custom RegExp for param "${c}"`),d(),o(),s}function z4(n,t,e){const r=B4(V4(n.path),e),s=Ie(r,{record:n,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function U4(n,t){const e=[],r=new Map;t=jC({strict:!1,end:!0,sensitive:!1},t);function s(d){return r.get(d)}function i(d,h,p){const g=!p,m=BC(d);m.aliasOf=p&&p.record;const b=jC(t,d),y=[m];if("alias"in d){const S=typeof d.alias=="string"?[d.alias]:d.alias;for(const w of S)y.push(BC(Ie({},m,{components:p?p.record.components:m.components,path:w,aliasOf:p?p.record:m})))}let v,x;for(const S of y){const{path:w}=S;if(h&&w[0]!=="/"){const E=h.record.path,T=E[E.length-1]==="/"?"":"/";S.path=h.record.path+(w&&T+w)}if(v=z4(S,h,b),p?p.alias.push(v):(x=x||v,x!==v&&x.alias.push(v),g&&d.name&&!$C(v)&&o(d.name)),CO(v)&&l(v),m.children){const E=m.children;for(let T=0;T<E.length;T++)i(E[T],v,p&&p.children[T])}p=p||v}return x?()=>{o(x)}:Op}function o(d){if(AO(d)){const h=r.get(d);h&&(r.delete(d),e.splice(e.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=e.indexOf(d);h>-1&&(e.splice(h,1),d.record.name&&r.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return e}function l(d){const h=G4(d,e);e.splice(h,0,d),d.record.name&&!$C(d)&&r.set(d.record.name,d)}function c(d,h){let p,g={},m,b;if("name"in d&&d.name){if(p=r.get(d.name),!p)throw gf(1,{location:d});b=p.record.name,g=Ie(FC(h.params,p.keys.filter(x=>!x.optional).concat(p.parent?p.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),d.params&&FC(d.params,p.keys.map(x=>x.name))),m=p.stringify(g)}else if(d.path!=null)m=d.path,p=e.find(x=>x.re.test(m)),p&&(g=p.parse(m),b=p.record.name);else{if(p=h.name?r.get(h.name):e.find(x=>x.re.test(h.path)),!p)throw gf(1,{location:d,currentLocation:h});b=p.record.name,g=Ie({},h.params,d.params),m=p.stringify(g)}const y=[];let v=p;for(;v;)y.unshift(v.record),v=v.parent;return{name:b,path:m,params:g,matched:y,meta:K4(y)}}n.forEach(d=>i(d));function u(){e.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:s}}function FC(n,t){const e={};for(const r of t)r in n&&(e[r]=n[r]);return e}function BC(n){const t={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:W4(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function W4(n){const t={},e=n.props||!1;if("component"in n)t.default=e;else for(const r in n.components)t[r]=typeof e=="object"?e[r]:e;return t}function $C(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function K4(n){return n.reduce((t,e)=>Ie(t,e.meta),{})}function jC(n,t){const e={};for(const r in n)e[r]=r in t?t[r]:n[r];return e}function G4(n,t){let e=0,r=t.length;for(;e!==r;){const i=e+r>>1;kO(n,t[i])<0?r=i:e=i+1}const s=Y4(n);return s&&(r=t.lastIndexOf(s,r-1)),r}function Y4(n){let t=n;for(;t=t.parent;)if(CO(t)&&kO(n,t)===0)return t}function CO({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function X4(n){const t={};if(n===""||n==="?")return t;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(yO," "),o=i.indexOf("="),a=lg(o<0?i:i.slice(0,o)),l=o<0?null:lg(i.slice(o+1));if(a in t){let c=t[a];Ii(c)||(c=t[a]=[c]),c.push(l)}else t[a]=l}return t}function HC(n){let t="";for(let e in n){const r=n[e];if(e=g4(e),r==null){r!==void 0&&(t+=(t.length?"&":"")+e);continue}(Ii(r)?r.map(i=>i&&E1(i)):[r&&E1(r)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+e,i!=null&&(t+="="+i))})}return t}function q4(n){const t={};for(const e in n){const r=n[e];r!==void 0&&(t[e]=Ii(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return t}const J4=Symbol(""),VC=Symbol(""),fw=Symbol(""),AE=Symbol(""),C1=Symbol("");function Lf(){let n=[];function t(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function e(){n=[]}return{add:t,list:()=>n.slice(),reset:e}}function Ga(n,t,e,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=h=>{h===!1?l(gf(4,{from:e,to:t})):h instanceof Error?l(h):_4(h)?l(gf(2,{from:t,to:h})):(o&&r.enterCallbacks[s]===o&&typeof h=="function"&&o.push(h),a())},u=i(()=>n.call(r&&r.instances[s],t,e,c));let d=Promise.resolve(u);n.length<3&&(d=d.then(c)),d.catch(h=>l(h))})}function ox(n,t,e,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(t!=="beforeRouteEnter"&&!o.instances[a]))if(gO(l)){const u=(l.__vccOpts||l)[t];u&&i.push(Ga(u,e,r,o,a,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=s4(u)?u.default:u;o.mods[a]=u,o.components[a]=d;const p=(d.__vccOpts||d)[t];return p&&Ga(p,e,r,o,a,s)()}))}}return i}function zC(n){const t=Is(fw),e=Is(AE),r=Ee(()=>{const l=ee(n.to);return t.resolve(l)}),s=Ee(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],d=e.matched;if(!u||!d.length)return-1;const h=d.findIndex(pf.bind(null,u));if(h>-1)return h;const p=UC(l[c-2]);return c>1&&UC(u)===p&&d[d.length-1].path!==p?d.findIndex(pf.bind(null,l[c-2])):h}),i=Ee(()=>s.value>-1&&nB(e.params,r.value.params)),o=Ee(()=>s.value>-1&&s.value===e.matched.length-1&&xO(e.params,r.value.params));function a(l={}){if(eB(l)){const c=t[ee(n.replace)?"replace":"push"](ee(n.to)).catch(Op);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:Ee(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function Q4(n){return n.length===1?n[0]:n}const Z4=Mf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:zC,setup(n,{slots:t}){const e=Cf(zC(n)),{options:r}=Is(fw),s=Ee(()=>({[WC(n.activeClass,r.linkActiveClass,"router-link-active")]:e.isActive,[WC(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const i=t.default&&Q4(t.default(e));return n.custom?i:ly("a",{"aria-current":e.isExactActive?n.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:s.value},i)}}}),tB=Z4;function eB(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const t=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return n.preventDefault&&n.preventDefault(),!0}}function nB(n,t){for(const e in t){const r=t[e],s=n[e];if(typeof r=="string"){if(r!==s)return!1}else if(!Ii(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function UC(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const WC=(n,t,e)=>n??t??e,rB=Mf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:t,slots:e}){const r=Is(C1),s=Ee(()=>n.route||r.value),i=Is(VC,0),o=Ee(()=>{let c=ee(i);const{matched:u}=s.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=Ee(()=>s.value.matched[o.value]);Cp(VC,Ee(()=>o.value+1)),Cp(J4,a),Cp(C1,s);const l=ot();return Mi(()=>[l.value,a.value,n.name],([c,u,d],[h,p,g])=>{u&&(u.instances[d]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!pf(u,p)||!h)&&(u.enterCallbacks[d]||[]).forEach(m=>m(c))},{flush:"post"}),()=>{const c=s.value,u=n.name,d=a.value,h=d&&d.components[u];if(!h)return KC(e.default,{Component:h,route:c});const p=d.props[u],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,b=ly(h,Ie({},g,t,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return KC(e.default,{Component:b,route:c})||b}}});function KC(n,t){if(!n)return null;const e=n(t);return e.length===1?e[0]:e}const sB=rB;function iB(n){const t=U4(n.routes,n),e=n.parseQuery||X4,r=n.stringifyQuery||HC,s=n.history,i=Lf(),o=Lf(),a=Lf(),l=sE(_a);let c=_a;kd&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=sx.bind(null,z=>""+z),d=sx.bind(null,y4),h=sx.bind(null,lg);function p(z,rt){let et,ht;return AO(z)?(et=t.getRecordMatcher(z),ht=rt):ht=z,t.addRoute(ht,et)}function g(z){const rt=t.getRecordMatcher(z);rt&&t.removeRoute(rt)}function m(){return t.getRoutes().map(z=>z.record)}function b(z){return!!t.getRecordMatcher(z)}function y(z,rt){if(rt=Ie({},rt||l.value),typeof z=="string"){const D=ix(e,z,rt.path),U=t.resolve({path:D.path},rt),q=s.createHref(D.fullPath);return Ie(D,U,{params:h(U.params),hash:lg(D.hash),redirectedFrom:void 0,href:q})}let et;if(z.path!=null)et=Ie({},z,{path:ix(e,z.path,rt.path).path});else{const D=Ie({},z.params);for(const U in D)D[U]==null&&delete D[U];et=Ie({},z,{params:d(D)}),rt.params=d(rt.params)}const ht=t.resolve(et,rt),Zt=z.hash||"";ht.params=u(h(ht.params));const fe=w4(r,Ie({},z,{hash:p4(Zt),path:ht.path})),O=s.createHref(fe);return Ie({fullPath:fe,hash:Zt,query:r===HC?q4(z.query):z.query||{}},ht,{redirectedFrom:void 0,href:O})}function v(z){return typeof z=="string"?ix(e,z,l.value.path):Ie({},z)}function x(z,rt){if(c!==z)return gf(8,{from:rt,to:z})}function S(z){return T(z)}function w(z){return S(Ie(v(z),{replace:!0}))}function E(z){const rt=z.matched[z.matched.length-1];if(rt&&rt.redirect){const{redirect:et}=rt;let ht=typeof et=="function"?et(z):et;return typeof ht=="string"&&(ht=ht.includes("?")||ht.includes("#")?ht=v(ht):{path:ht},ht.params={}),Ie({query:z.query,hash:z.hash,params:ht.path!=null?{}:z.params},ht)}}function T(z,rt){const et=c=y(z),ht=l.value,Zt=z.state,fe=z.force,O=z.replace===!0,D=E(et);if(D)return T(Ie(v(D),{state:typeof D=="object"?Ie({},Zt,D.state):Zt,force:fe,replace:O}),rt||et);const U=et;U.redirectedFrom=rt;let q;return!fe&&x4(r,ht,et)&&(q=gf(16,{to:U,from:ht}),$t(ht,ht,!0,!1)),(q?Promise.resolve(q):R(U,ht)).catch(G=>Ao(G)?Ao(G,2)?G:qt(G):X(G,U,ht)).then(G=>{if(G){if(Ao(G,2))return T(Ie({replace:O},v(G.to),{state:typeof G.to=="object"?Ie({},Zt,G.to.state):Zt,force:fe}),rt||U)}else G=B(U,ht,!0,O,Zt);return N(U,ht,G),G})}function I(z,rt){const et=x(z,rt);return et?Promise.reject(et):Promise.resolve()}function C(z){const rt=me.values().next().value;return rt&&typeof rt.runWithContext=="function"?rt.runWithContext(z):z()}function R(z,rt){let et;const[ht,Zt,fe]=oB(z,rt);et=ox(ht.reverse(),"beforeRouteLeave",z,rt);for(const D of ht)D.leaveGuards.forEach(U=>{et.push(Ga(U,z,rt))});const O=I.bind(null,z,rt);return et.push(O),Ot(et).then(()=>{et=[];for(const D of i.list())et.push(Ga(D,z,rt));return et.push(O),Ot(et)}).then(()=>{et=ox(Zt,"beforeRouteUpdate",z,rt);for(const D of Zt)D.updateGuards.forEach(U=>{et.push(Ga(U,z,rt))});return et.push(O),Ot(et)}).then(()=>{et=[];for(const D of fe)if(D.beforeEnter)if(Ii(D.beforeEnter))for(const U of D.beforeEnter)et.push(Ga(U,z,rt));else et.push(Ga(D.beforeEnter,z,rt));return et.push(O),Ot(et)}).then(()=>(z.matched.forEach(D=>D.enterCallbacks={}),et=ox(fe,"beforeRouteEnter",z,rt,C),et.push(O),Ot(et))).then(()=>{et=[];for(const D of o.list())et.push(Ga(D,z,rt));return et.push(O),Ot(et)}).catch(D=>Ao(D,8)?D:Promise.reject(D))}function N(z,rt,et){a.list().forEach(ht=>C(()=>ht(z,rt,et)))}function B(z,rt,et,ht,Zt){const fe=x(z,rt);if(fe)return fe;const O=rt===_a,D=kd?history.state:{};et&&(ht||O?s.replace(z.fullPath,Ie({scroll:O&&D&&D.scroll},Zt)):s.push(z.fullPath,Zt)),l.value=z,$t(z,rt,et,O),qt()}let $;function L(){$||($=s.listen((z,rt,et)=>{if(!xe.listening)return;const ht=y(z),Zt=E(ht);if(Zt){T(Ie(Zt,{replace:!0,force:!0}),ht).catch(Op);return}c=ht;const fe=l.value;kd&&P4(RC(fe.fullPath,et.delta),hw()),R(ht,fe).catch(O=>Ao(O,12)?O:Ao(O,2)?(T(Ie(v(O.to),{force:!0}),ht).then(D=>{Ao(D,20)&&!et.delta&&et.type===cg.pop&&s.go(-1,!1)}).catch(Op),Promise.reject()):(et.delta&&s.go(-et.delta,!1),X(O,ht,fe))).then(O=>{O=O||B(ht,fe,!1),O&&(et.delta&&!Ao(O,8)?s.go(-et.delta,!1):et.type===cg.pop&&Ao(O,20)&&s.go(-1,!1)),N(ht,fe,O)}).catch(Op)}))}let F=Lf(),_=Lf(),j;function X(z,rt,et){qt(z);const ht=_.list();return ht.length?ht.forEach(Zt=>Zt(z,rt,et)):console.error(z),Promise.reject(z)}function wt(){return j&&l.value!==_a?Promise.resolve():new Promise((z,rt)=>{F.add([z,rt])})}function qt(z){return j||(j=!z,L(),F.list().forEach(([rt,et])=>z?et(z):rt()),F.reset()),z}function $t(z,rt,et,ht){const{scrollBehavior:Zt}=n;if(!kd||!Zt)return Promise.resolve();const fe=!et&&O4(RC(z.fullPath,0))||(ht||!et)&&history.state&&history.state.scroll||null;return od().then(()=>Zt(z,rt,fe)).then(O=>O&&M4(O)).catch(O=>X(O,z,rt))}const Pt=z=>s.go(z);let jt;const me=new Set,xe={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:b,getRoutes:m,resolve:y,options:n,push:S,replace:w,go:Pt,back:()=>Pt(-1),forward:()=>Pt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:_.add,isReady:wt,install(z){const rt=this;z.component("RouterLink",tB),z.component("RouterView",sB),z.config.globalProperties.$router=rt,Object.defineProperty(z.config.globalProperties,"$route",{enumerable:!0,get:()=>ee(l)}),kd&&!jt&&l.value===_a&&(jt=!0,S(s.location).catch(Zt=>{}));const et={};for(const Zt in _a)Object.defineProperty(et,Zt,{get:()=>l.value[Zt],enumerable:!0});z.provide(fw,rt),z.provide(AE,nE(et)),z.provide(C1,l);const ht=z.unmount;me.add(z),z.unmount=function(){me.delete(z),me.size<1&&(c=_a,$&&$(),$=null,l.value=_a,jt=!1,j=!1),ht()}}};function Ot(z){return z.reduce((rt,et)=>rt.then(()=>C(et)),Promise.resolve())}return xe}function oB(n,t){const e=[],r=[],s=[],i=Math.max(t.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=t.matched[o];a&&(n.matched.find(c=>pf(c,a))?r.push(a):e.push(a));const l=n.matched[o];l&&(t.matched.find(c=>pf(c,l))||s.push(l))}return[e,r,s]}function pw(){return Is(fw)}function Pf(n){return Is(AE)}const qe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Cn=Object.keys,Cr=Array.isArray;function zr(n,t){return typeof t!="object"||Cn(t).forEach(function(e){n[e]=t[e]}),n}typeof Promise>"u"||qe.Promise||(qe.Promise=Promise);const ug=Object.getPrototypeOf,aB={}.hasOwnProperty;function Ns(n,t){return aB.call(n,t)}function mf(n,t){typeof t=="function"&&(t=t(ug(n))),(typeof Reflect>"u"?Cn:Reflect.ownKeys)(t).forEach(e=>{ga(n,e,t[e])})}const TO=Object.defineProperty;function ga(n,t,e,r){TO(n,t,zr(e&&Ns(e,"get")&&typeof e.get=="function"?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},r))}function qd(n){return{from:function(t){return n.prototype=Object.create(t.prototype),ga(n.prototype,"constructor",n),{extend:mf.bind(null,n.prototype)}}}}const lB=Object.getOwnPropertyDescriptor;function EE(n,t){let e;return lB(n,t)||(e=ug(n))&&EE(e,t)}const cB=[].slice;function bb(n,t,e){return cB.call(n,t,e)}function MO(n,t){return t(n)}function Xf(n){if(!n)throw new Error("Assertion Failed")}function PO(n){qe.setImmediate?setImmediate(n):setTimeout(n,0)}function OO(n,t){return n.reduce((e,r,s)=>{var i=t(r,s);return i&&(e[i[0]]=i[1]),e},{})}function ma(n,t){if(typeof t=="string"&&Ns(n,t))return n[t];if(!t)return n;if(typeof t!="string"){for(var e=[],r=0,s=t.length;r<s;++r){var i=ma(n,t[r]);e.push(i)}return e}var o=t.indexOf(".");if(o!==-1){var a=n[t.substr(0,o)];return a==null?void 0:ma(a,t.substr(o+1))}}function Pi(n,t,e){if(n&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(n)))if(typeof t!="string"&&"length"in t){Xf(typeof e!="string"&&"length"in e);for(var r=0,s=t.length;r<s;++r)Pi(n,t[r],e[r])}else{var i=t.indexOf(".");if(i!==-1){var o=t.substr(0,i),a=t.substr(i+1);if(a==="")e===void 0?Cr(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=e;else{var l=n[o];l&&Ns(n,o)||(l=n[o]={}),Pi(l,a,e)}}else e===void 0?Cr(n)&&!isNaN(parseInt(t))?n.splice(t,1):delete n[t]:n[t]=e}}function IO(n){var t={};for(var e in n)Ns(n,e)&&(t[e]=n[e]);return t}const uB=[].concat;function RO(n){return uB.apply([],n)}const DO="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(RO([8,16,32,64].map(n=>["Int","Uint","Float"].map(t=>t+n+"Array")))).filter(n=>qe[n]),dB=DO.map(n=>qe[n]);OO(DO,n=>[n,!0]);let Ya=null;function cy(n){Ya=typeof WeakMap<"u"&&new WeakMap;const t=T1(n);return Ya=null,t}function T1(n){if(!n||typeof n!="object")return n;let t=Ya&&Ya.get(n);if(t)return t;if(Cr(n)){t=[],Ya&&Ya.set(n,t);for(var e=0,r=n.length;e<r;++e)t.push(T1(n[e]))}else if(dB.indexOf(n.constructor)>=0)t=n;else{const i=ug(n);for(var s in t=i===Object.prototype?{}:Object.create(i),Ya&&Ya.set(n,t),n)Ns(n,s)&&(t[s]=T1(n[s]))}return t}const{toString:hB}={};function M1(n){return hB.call(n).slice(8,-1)}const P1=typeof Symbol<"u"?Symbol.iterator:"@@iterator",fB=typeof P1=="symbol"?function(n){var t;return n!=null&&(t=n[P1])&&t.apply(n)}:function(){return null},Cd={};function da(n){var t,e,r,s;if(arguments.length===1){if(Cr(n))return n.slice();if(this===Cd&&typeof n=="string")return[n];if(s=fB(n)){for(e=[];!(r=s.next()).done;)e.push(r.value);return e}if(n==null)return[n];if(typeof(t=n.length)=="number"){for(e=new Array(t);t--;)e[t]=n[t];return e}return[n]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}const kE=typeof Symbol<"u"?n=>n[Symbol.toStringTag]==="AsyncFunction":()=>!1;var xo=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function NO(n,t){xo=n,_O=t}var _O=()=>!0;const pB=!new Error("").stack;function cd(){if(pB)try{throw cd.arguments,new Error}catch(n){return n}return new Error}function O1(n,t){var e=n.stack;return e?(t=t||0,e.indexOf(n.name)===0&&(t+=(n.name+n.message).split(`
`).length),e.split(`
`).slice(t).filter(_O).map(r=>`
`+r).join("")):""}var LO=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],CE=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(LO),gB={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Jd(n,t){this._e=cd(),this.name=n,this.message=t}function FO(n,t){return n+". Errors: "+Object.keys(t).map(e=>t[e].toString()).filter((e,r,s)=>s.indexOf(e)===r).join(`
`)}function vb(n,t,e,r){this._e=cd(),this.failures=t,this.failedKeys=r,this.successCount=e,this.message=FO(n,t)}function Rp(n,t){this._e=cd(),this.name="BulkError",this.failures=Object.keys(t).map(e=>t[e]),this.failuresByPos=t,this.message=FO(n,t)}qd(Jd).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+O1(this._e,2))}},toString:function(){return this.name+": "+this.message}}),qd(vb).from(Jd),qd(Rp).from(Jd);var TE=CE.reduce((n,t)=>(n[t]=t+"Error",n),{});const mB=Jd;var zt=CE.reduce((n,t)=>{var e=t+"Error";function r(s,i){this._e=cd(),this.name=e,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=gB[t]||e,this.inner=null)}return qd(r).from(mB),n[t]=r,n},{});zt.Syntax=SyntaxError,zt.Type=TypeError,zt.Range=RangeError;var GC=LO.reduce((n,t)=>(n[t+"Error"]=zt[t],n),{}),l0=CE.reduce((n,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(n[t+"Error"]=zt[t]),n),{});function je(){}function dg(n){return n}function yB(n,t){return n==null||n===dg?t:function(e){return t(n(e))}}function Ku(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function bB(n,t){return n===je?t:function(){var e=n.apply(this,arguments);e!==void 0&&(arguments[0]=e);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ku(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Ku(s,this.onerror):s),i!==void 0?i:e}}function vB(n,t){return n===je?t:function(){n.apply(this,arguments);var e=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?Ku(e,this.onsuccess):e),r&&(this.onerror=this.onerror?Ku(r,this.onerror):r)}}function wB(n,t){return n===je?t:function(e){var r=n.apply(this,arguments);zr(e,r);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Ku(s,this.onsuccess):s),i&&(this.onerror=this.onerror?Ku(i,this.onerror):i),r===void 0?o===void 0?void 0:o:zr(r,o)}}function xB(n,t){return n===je?t:function(){return t.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function ME(n,t){return n===je?t:function(){var e=n.apply(this,arguments);if(e&&typeof e.then=="function"){for(var r=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return e.then(function(){return t.apply(r,i)})}return t.apply(this,arguments)}}l0.ModifyError=vb,l0.DexieError=Jd,l0.BulkError=Rp;var hg={};const BO=100,[I1,wb,R1]=typeof Promise>"u"?[]:(()=>{let n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,ug(n),n];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,ug(t),n]})(),$O=wb&&wb.then,c0=I1&&I1.constructor,PE=!!R1;var D1=!1,SB=R1?()=>{R1.then(Iy)}:qe.setImmediate?setImmediate.bind(null,Iy):qe.MutationObserver?()=>{var n=document.createElement("div");new MutationObserver(()=>{Iy(),n=null}).observe(n,{attributes:!0}),n.setAttribute("i","1")}:()=>{setTimeout(Iy,0)},Dp=function(n,t){qf.push([n,t]),xb&&(SB(),xb=!1)},N1=!0,xb=!0,_u=[],u0=[],_1=null,L1=dg,Qd={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:qC,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(n=>{try{qC(n[0],n[1])}catch{}})}},Rt=Qd,qf=[],Lu=0,d0=[];function mt(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=je,this._lib=!1;var t=this._PSD=Rt;if(xo&&(this._stackHolder=cd(),this._prev=null,this._numPrev=0),typeof n!="function"){if(n!==hg)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&B1(this,this._value))}this._state=null,this._value=null,++t.ref,HO(this,n)}const F1={get:function(){var n=Rt,t=Sb;function e(r,s){var i=!n.global&&(n!==Rt||t!==Sb);const o=i&&!Ta();var a=new mt((l,c)=>{OE(this,new jO(Ab(r,n,i,o),Ab(s,n,i,o),l,c,n))});return xo&&UO(a,this),a}return e.prototype=hg,e},set:function(n){ga(this,"then",n&&n.prototype===hg?F1:{get:function(){return n},set:F1.set})}};function jO(n,t,e,r,s){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof t=="function"?t:null,this.resolve=e,this.reject=r,this.psd=s}function HO(n,t){try{t(e=>{if(n._state===null){if(e===n)throw new TypeError("A promise cannot be resolved with itself.");var r=n._lib&&uy();e&&typeof e.then=="function"?HO(n,(s,i)=>{e instanceof mt?e._then(s,i):e.then(s,i)}):(n._state=!0,n._value=e,VO(n)),r&&dy()}},B1.bind(null,n))}catch(e){B1(n,e)}}function B1(n,t){if(u0.push(t),n._state===null){var e=n._lib&&uy();t=L1(t),n._state=!1,n._value=t,xo&&t!==null&&typeof t=="object"&&!t._promise&&function(r,s,i){try{r.apply(null,i)}catch{}}(()=>{var r=EE(t,"stack");t._promise=n,ga(t,"stack",{get:()=>D1?r&&(r.get?r.get.apply(t):r.value):n.stack})}),function(r){_u.some(s=>s._value===r._value)||_u.push(r)}(n),VO(n),e&&dy()}}function VO(n){var t=n._listeners;n._listeners=[];for(var e=0,r=t.length;e<r;++e)OE(n,t[e]);var s=n._PSD;--s.ref||s.finalize(),Lu===0&&(++Lu,Dp(()=>{--Lu==0&&IE()},[]))}function OE(n,t){if(n._state!==null){var e=n._state?t.onFulfilled:t.onRejected;if(e===null)return(n._state?t.resolve:t.reject)(n._value);++t.psd.ref,++Lu,Dp(AB,[e,n,t])}else n._listeners.push(t)}function AB(n,t,e){try{_1=t;var r,s=t._value;t._state?r=n(s):(u0.length&&(u0=[]),r=n(s),u0.indexOf(s)===-1&&function(i){for(var o=_u.length;o;)if(_u[--o]._value===i._value)return void _u.splice(o,1)}(t)),e.resolve(r)}catch(i){e.reject(i)}finally{_1=null,--Lu==0&&IE(),--e.psd.ref||e.psd.finalize()}}function zO(n,t,e){if(t.length===e)return t;var r="";if(n._state===!1){var s,i,o=n._value;o!=null?(s=o.name||"Error",i=o.message||o,r=O1(o,0)):(s=o,i=""),t.push(s+(i?": "+i:"")+r)}return xo&&((r=O1(n._stackHolder,2))&&t.indexOf(r)===-1&&t.push(r),n._prev&&zO(n._prev,t,e)),t}function UO(n,t){var e=t?t._numPrev+1:0;e<100&&(n._prev=t,n._numPrev=e)}function Iy(){uy()&&dy()}function uy(){var n=N1;return N1=!1,xb=!1,n}function dy(){var n,t,e;do for(;qf.length>0;)for(n=qf,qf=[],e=n.length,t=0;t<e;++t){var r=n[t];r[0].apply(null,r[1])}while(qf.length>0);N1=!0,xb=!0}function IE(){var n=_u;_u=[],n.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var t=d0.slice(0),e=t.length;e;)t[--e]()}function Ry(n){return new mt(hg,!1,n)}function en(n,t){var e=Rt;return function(){var r=uy(),s=Rt;try{return Jl(e,!0),n.apply(this,arguments)}catch(i){t&&t(i)}finally{Jl(s,!1),r&&dy()}}}mf(mt.prototype,{then:F1,_then:function(n,t){OE(this,new jO(null,null,n,t,Rt))},catch:function(n){if(arguments.length===1)return this.then(null,n);var t=arguments[0],e=arguments[1];return typeof t=="function"?this.then(null,r=>r instanceof t?e(r):Ry(r)):this.then(null,r=>r&&r.name===t?e(r):Ry(r))},finally:function(n){return this.then(t=>(n(),t),t=>(n(),Ry(t)))},stack:{get:function(){if(this._stack)return this._stack;try{D1=!0;var n=zO(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=n),n}finally{D1=!1}}},timeout:function(n,t){return n<1/0?new mt((e,r)=>{var s=setTimeout(()=>r(new zt.Timeout(t)),n);this.then(e,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ga(mt.prototype,Symbol.toStringTag,"Dexie.Promise"),Qd.env=WO(),mf(mt,{all:function(){var n=da.apply(null,arguments).map(Dy);return new mt(function(t,e){n.length===0&&t([]);var r=n.length;n.forEach((s,i)=>mt.resolve(s).then(o=>{n[i]=o,--r||t(n)},e))})},resolve:n=>{if(n instanceof mt)return n;if(n&&typeof n.then=="function")return new mt((e,r)=>{n.then(e,r)});var t=new mt(hg,!0,n);return UO(t,_1),t},reject:Ry,race:function(){var n=da.apply(null,arguments).map(Dy);return new mt((t,e)=>{n.map(r=>mt.resolve(r).then(t,e))})},PSD:{get:()=>Rt,set:n=>Rt=n},totalEchoes:{get:()=>Sb},newPSD:ql,usePSD:If,scheduler:{get:()=>Dp,set:n=>{Dp=n}},rejectionMapper:{get:()=>L1,set:n=>{L1=n}},follow:(n,t)=>new mt((e,r)=>ql((s,i)=>{var o=Rt;o.unhandleds=[],o.onunhandled=i,o.finalize=Ku(function(){(function(a){function l(){a(),d0.splice(d0.indexOf(l),1)}d0.push(l),++Lu,Dp(()=>{--Lu==0&&IE()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},o.finalize),n()},t,e,r))}),c0&&(c0.allSettled&&ga(mt,"allSettled",function(){const n=da.apply(null,arguments).map(Dy);return new mt(t=>{n.length===0&&t([]);let e=n.length;const r=new Array(e);n.forEach((s,i)=>mt.resolve(s).then(o=>r[i]={status:"fulfilled",value:o},o=>r[i]={status:"rejected",reason:o}).then(()=>--e||t(r)))})}),c0.any&&typeof AggregateError<"u"&&ga(mt,"any",function(){const n=da.apply(null,arguments).map(Dy);return new mt((t,e)=>{n.length===0&&e(new AggregateError([]));let r=n.length;const s=new Array(r);n.forEach((i,o)=>mt.resolve(i).then(a=>t(a),a=>{s[o]=a,--r||e(new AggregateError(s))}))})}));const Sr={awaits:0,echoes:0,id:0};var EB=0,h0=[],ax=0,Sb=0,kB=0;function ql(n,t,e,r){var s=Rt,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++kB;var o=Qd.env;i.env=PE?{Promise:mt,PromiseProp:{value:mt,configurable:!0,writable:!0},all:mt.all,race:mt.race,allSettled:mt.allSettled,any:mt.any,resolve:mt.resolve,reject:mt.reject,nthen:YC(o.nthen,i),gthen:YC(o.gthen,i)}:{},t&&zr(i,t),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=If(i,n,e,r);return i.ref===0&&i.finalize(),a}function Of(){return Sr.id||(Sr.id=++EB),++Sr.awaits,Sr.echoes+=BO,Sr.id}function Ta(){return!!Sr.awaits&&(--Sr.awaits==0&&(Sr.id=0),Sr.echoes=Sr.awaits*BO,!0)}function Dy(n){return Sr.echoes&&n&&n.constructor===c0?(Of(),n.then(t=>(Ta(),t),t=>(Ta(),Fn(t)))):n}function CB(n){++Sb,Sr.echoes&&--Sr.echoes!=0||(Sr.echoes=Sr.id=0),h0.push(Rt),Jl(n,!0)}function TB(){var n=h0[h0.length-1];h0.pop(),Jl(n,!1)}function Jl(n,t){var e=Rt;if((t?!Sr.echoes||ax++&&n===Rt:!ax||--ax&&n===Rt)||KO(t?CB.bind(null,n):TB),n!==Rt&&(Rt=n,e===Qd&&(Qd.env=WO()),PE)){var r=Qd.env.Promise,s=n.env;wb.then=s.nthen,r.prototype.then=s.gthen,(e.global||n.global)&&(Object.defineProperty(qe,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function WO(){var n=qe.Promise;return PE?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(qe,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject,nthen:wb.then,gthen:n.prototype.then}:{}}function If(n,t,e,r,s){var i=Rt;try{return Jl(n,!0),t(e,r,s)}finally{Jl(i,!1)}}function KO(n){$O.call(I1,n)}function Ab(n,t,e,r){return typeof n!="function"?n:function(){var s=Rt;e&&Of(),Jl(t,!0);try{return n.apply(this,arguments)}finally{Jl(s,!1),r&&KO(Ta)}}}function YC(n,t){return function(e,r){return n.call(this,Ab(e,t),Ab(r,t))}}(""+$O).indexOf("[native code]")===-1&&(Of=Ta=je);const XC="unhandledrejection";function qC(n,t){var e;try{e=t.onuncatched(n)}catch{}if(e!==!1)try{var r,s={promise:t,reason:n};if(qe.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(XC,!0,!0),zr(r,s)):qe.CustomEvent&&zr(r=new CustomEvent(XC,{detail:s}),s),r&&qe.dispatchEvent&&(dispatchEvent(r),!qe.PromiseRejectionEvent&&qe.onunhandledrejection))try{qe.onunhandledrejection(r)}catch{}xo&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${n.stack||n}`)}catch{}}var Fn=mt.reject;function $1(n,t,e,r){if(n.idbdb&&(n._state.openComplete||Rt.letThrough||n._vip)){var s=n._createTransaction(t,e,n._dbSchema);try{s.create(),n._state.PR1398_maxLoop=3}catch(i){return i.name===TE.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n._close(),n.open().then(()=>$1(n,t,e,r))):Fn(i)}return s._promise(t,(i,o)=>ql(()=>(Rt.trans=s,r(i,o,s)))).then(i=>s._completion.then(()=>i))}if(n._state.openComplete)return Fn(new zt.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen)return Fn(new zt.DatabaseClosed);n.open().catch(je)}return n._state.dbReadyPromise.then(()=>$1(n,t,e,r))}const JC="3.2.7",Ac="￿",j1=-1/0,Eo="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",GO="String expected.",Np=[],gw=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),MB=gw,PB=gw,YO=n=>!/(dexie\.js|dexie\.min\.js)/.test(n),mw="__dbnames",lx="readonly",cx="readwrite";function Gu(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}const XO={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ny(n){return typeof n!="string"||/\./.test(n)?t=>t:t=>(t[n]===void 0&&n in t&&delete(t=cy(t))[n],t)}class OB{_trans(t,e,r){const s=this._tx||Rt.trans,i=this.name;function o(l,c,u){if(!u.schema[i])throw new zt.NotFound("Table "+i+" not part of transaction");return e(u.idbtrans,u)}const a=uy();try{return s&&s.db===this.db?s===Rt.trans?s._promise(t,o,r):ql(()=>s._promise(t,o,r),{trans:s,transless:Rt.transless||Rt}):$1(this.db,t,[this.name],o)}finally{a&&dy()}}get(t,e){return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",r=>this.core.get({trans:r,key:t}).then(s=>this.hook.reading.fire(s))).then(e)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Cr(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const e=Cn(t);if(e.length===1)return this.where(e[0]).equals(t[e[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>{if(c.compound&&e.every(u=>c.keyPath.indexOf(u)>=0)){for(let u=0;u<e.length;++u)if(e.indexOf(c.keyPath[u])===-1)return!1;return!0}return!1}).sort((c,u)=>c.keyPath.length-u.keyPath.length)[0];if(r&&this.db._maxKey!==Ac){const c=r.keyPath.slice(0,e.length);return this.where(c).equals(c.map(u=>t[u]))}!r&&xo&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${e.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function o(c,u){try{return i.cmp(c,u)===0}catch{return!1}}const[a,l]=e.reduce(([c,u],d)=>{const h=s[d],p=t[d];return[c||h,c||!h?Gu(u,h&&h.multi?g=>{const m=ma(g,d);return Cr(m)&&m.some(b=>o(p,b))}:g=>o(p,ma(g,d))):u]},[null,null]);return a?this.where(a.name).equals(t[a.keyPath]).filter(l):r?this.filter(l):this.where(e).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Cr(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const e=r=>{if(!r)return r;const s=Object.create(t.prototype);for(var i in r)if(Ns(r,i))try{s[i]=r[i]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t}defineClass(){return this.mapToClass(function(t){zr(this,t)})}add(t,e){const{auto:r,keyPath:s}=this.schema.primKey;let i=t;return s&&r&&(i=Ny(s)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:e!=null?[e]:null,values:[i]})).then(o=>o.numFailures?mt.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{Pi(t,s,o)}catch{}return o})}update(t,e){if(typeof t!="object"||Cr(t))return this.where(":id").equals(t).modify(e);{const r=ma(t,this.schema.primKey.keyPath);if(r===void 0)return Fn(new zt.InvalidArgument("Given object does not contain its primary key"));try{typeof e!="function"?Cn(e).forEach(s=>{Pi(t,s,e[s])}):e(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(e)}}put(t,e){const{auto:r,keyPath:s}=this.schema.primKey;let i=t;return s&&r&&(i=Ny(s)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[i],keys:e!=null?[e]:null})).then(o=>o.numFailures?mt.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{Pi(t,s,o)}catch{}return o})}delete(t){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"delete",keys:[t]})).then(e=>e.numFailures?mt.reject(e.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:XO})).then(t=>t.numFailures?mt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",e=>this.core.getMany({keys:t,trans:e}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,e,r){const s=Array.isArray(e)?e:void 0,i=(r=r||(s?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new zt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new zt.InvalidArgument("Arguments objects and keys must have the same length");const c=t.length;let u=l&&a?t.map(Ny(l)):t;return this.core.mutate({trans:o,type:"add",keys:s,values:u,wantResults:i}).then(({numFailures:d,results:h,lastResult:p,failures:g})=>{if(d===0)return i?h:p;throw new Rp(`${this.name}.bulkAdd(): ${d} of ${c} operations failed`,g)})})}bulkPut(t,e,r){const s=Array.isArray(e)?e:void 0,i=(r=r||(s?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new zt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new zt.InvalidArgument("Arguments objects and keys must have the same length");const c=t.length;let u=l&&a?t.map(Ny(l)):t;return this.core.mutate({trans:o,type:"put",keys:s,values:u,wantResults:i}).then(({numFailures:d,results:h,lastResult:p,failures:g})=>{if(d===0)return i?h:p;throw new Rp(`${this.name}.bulkPut(): ${d} of ${c} operations failed`,g)})})}bulkDelete(t){const e=t.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:t})).then(({numFailures:r,lastResult:s,failures:i})=>{if(r===0)return s;throw new Rp(`${this.name}.bulkDelete(): ${r} of ${e} operations failed`,i)})}}function _p(n){var t={},e=function(o,a){if(a){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return t[o].subscribe.apply(null,c),n}if(typeof o=="string")return t[o]};e.addEventType=i;for(var r=1,s=arguments.length;r<s;++r)i(arguments[r]);return e;function i(o,a,l){if(typeof o!="object"){var c;a||(a=xB),l||(l=je);var u={subscribers:[],fire:l,subscribe:function(d){u.subscribers.indexOf(d)===-1&&(u.subscribers.push(d),u.fire=a(u.fire,d))},unsubscribe:function(d){u.subscribers=u.subscribers.filter(function(h){return h!==d}),u.fire=u.subscribers.reduce(a,l)}};return t[o]=e[o]=u,u}Cn(c=o).forEach(function(d){var h=c[d];if(Cr(h))i(d,c[d][0],c[d][1]);else{if(h!=="asap")throw new zt.InvalidArgument("Invalid event config");var p=i(d,dg,function(){for(var g=arguments.length,m=new Array(g);g--;)m[g]=arguments[g];p.subscribers.forEach(function(b){PO(function(){b.apply(null,m)})})})}})}}function Ff(n,t){return qd(t).from({prototype:n}),t}function gd(n,t){return!(n.filter||n.algorithm||n.or)&&(t?n.justLimit:!n.replayFilter)}function ux(n,t){n.filter=Gu(n.filter,t)}function dx(n,t,e){var r=n.replayFilter;n.replayFilter=r?()=>Gu(r(),t()):t,n.justLimit=e&&!r}function f0(n,t){if(n.isPrimKey)return t.primaryKey;const e=t.getIndexByKeyPath(n.index);if(!e)throw new zt.Schema("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return e}function QC(n,t,e){const r=f0(n,t.schema);return t.openCursor({trans:e,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:r,range:n.range}})}function _y(n,t,e,r){const s=n.replayFilter?Gu(n.filter,n.replayFilter()):n.filter;if(n.or){const i={},o=(a,l,c)=>{if(!s||s(l,c,h=>l.stop(h),h=>l.fail(h))){var u=l.primaryKey,d=""+u;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(u)),Ns(i,d)||(i[d]=!0,t(a,l,c))}};return Promise.all([n.or._iterate(o,e),ZC(QC(n,r,e),n.algorithm,o,!n.keysOnly&&n.valueMapper)])}return ZC(QC(n,r,e),Gu(n.algorithm,s),t,!n.keysOnly&&n.valueMapper)}function ZC(n,t,e,r){var s=en(r?(i,o,a)=>e(r(i),o,a):e);return n.then(i=>{if(i)return i.start(()=>{var o=()=>i.continue();t&&!t(i,a=>o=a,a=>{i.stop(a),o=je},a=>{i.fail(a),o=je})||s(i.value,i,a=>o=a),o()})})}function $r(n,t){try{const e=tT(n),r=tT(t);if(e!==r)return e==="Array"?1:r==="Array"?-1:e==="binary"?1:r==="binary"?-1:e==="string"?1:r==="string"?-1:e==="Date"?1:r!=="Date"?NaN:-1;switch(e){case"number":case"Date":case"string":return n>t?1:n<t?-1:0;case"binary":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let c=0;c<l;++c)if(s[c]!==i[c])return s[c]<i[c]?-1:1;return o===a?0:o<a?-1:1}(eT(n),eT(t));case"Array":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let c=0;c<l;++c){const u=$r(s[c],i[c]);if(u!==0)return u}return o===a?0:o<a?-1:1}(n,t)}}catch{}return NaN}function tT(n){const t=typeof n;if(t!=="object")return t;if(ArrayBuffer.isView(n))return"binary";const e=M1(n);return e==="ArrayBuffer"?"binary":e}function eT(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}class IB{_read(t,e){var r=this._ctx;return r.error?r.table._trans(null,Fn.bind(null,r.error)):r.table._trans("readonly",t).then(e)}_write(t){var e=this._ctx;return e.error?e.table._trans(null,Fn.bind(null,e.error)):e.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var e=this._ctx;e.algorithm=Gu(e.algorithm,t)}_iterate(t,e){return _y(this._ctx,t,e,this._ctx.table.core)}clone(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&zr(r,t),e._ctx=r,e}raw(){return this._ctx.valueMapper=null,this}each(t){var e=this._ctx;return this._read(r=>_y(e,t,r,e.table.core))}count(t){return this._read(e=>{const r=this._ctx,s=r.table.core;if(gd(r,!0))return s.count({trans:e,query:{index:f0(r,s.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var i=0;return _y(r,()=>(++i,!1),e,s).then(()=>i)}).then(t)}sortBy(t,e){const r=t.split(".").reverse(),s=r[0],i=r.length-1;function o(c,u){return u?o(c[r[u]],u-1):c[s]}var a=this._ctx.dir==="next"?1:-1;function l(c,u){var d=o(c,i),h=o(u,i);return d<h?-a:d>h?a:0}return this.toArray(function(c){return c.sort(l)}).then(e)}toArray(t){return this._read(e=>{var r=this._ctx;if(r.dir==="next"&&gd(r,!0)&&r.limit>0){const{valueMapper:s}=r,i=f0(r,r.table.core.schema);return r.table.core.query({trans:e,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(({result:o})=>s?o.map(s):o)}{const s=[];return _y(r,i=>s.push(i),e,r.table.core).then(()=>s)}},t)}offset(t){var e=this._ctx;return t<=0||(e.offset+=t,gd(e)?dx(e,()=>{var r=t;return(s,i)=>r===0||(r===1?(--r,!1):(i(()=>{s.advance(r),r=0}),!1))}):dx(e,()=>{var r=t;return()=>--r<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),dx(this._ctx,()=>{var e=t;return function(r,s,i){return--e<=0&&s(i),e>=0}},!0),this}until(t,e){return ux(this._ctx,function(r,s,i){return!t(r.value)||(s(i),e)}),this}first(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var e,r;return ux(this._ctx,function(s){return t(s.value)}),e=this._ctx,r=t,e.isMatch=Gu(e.isMatch,r),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(r,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(r,s){t(s.primaryKey,s)})}keys(t){var e=this._ctx;e.keysOnly=!e.isMatch;var r=[];return this.each(function(s,i){r.push(i.key)}).then(function(){return r}).then(t)}primaryKeys(t){var e=this._ctx;if(e.dir==="next"&&gd(e,!0)&&e.limit>0)return this._read(s=>{var i=f0(e,e.table.core.schema);return e.table.core.query({trans:s,values:!1,limit:e.limit,query:{index:i,range:e.range}})}).then(({result:s})=>s).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each(function(s,i){r.push(i.primaryKey)}).then(function(){return r}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(e){return e[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var r={};return ux(this._ctx,function(s){var i=s.primaryKey.toString(),o=Ns(r,i);return r[i]=!0,!o}),this}modify(t){var e=this._ctx;return this._write(r=>{var s;if(typeof t=="function")s=t;else{var i=Cn(t),o=i.length;s=function(m){for(var b=!1,y=0;y<o;++y){var v=i[y],x=t[v];ma(m,v)!==x&&(Pi(m,v,x),b=!0)}return b}}const a=e.table.core,{outbound:l,extractKey:c}=a.schema.primaryKey,u=this.db._options.modifyChunkSize||200,d=[];let h=0;const p=[],g=(m,b)=>{const{failures:y,numFailures:v}=b;h+=m-v;for(let x of Cn(y))d.push(y[x])};return this.clone().primaryKeys().then(m=>{const b=y=>{const v=Math.min(u,m.length-y);return a.getMany({trans:r,keys:m.slice(y,y+v),cache:"immutable"}).then(x=>{const S=[],w=[],E=l?[]:null,T=[];for(let C=0;C<v;++C){const R=x[C],N={value:cy(R),primKey:m[y+C]};s.call(N,N.value,N)!==!1&&(N.value==null?T.push(m[y+C]):l||$r(c(R),c(N.value))===0?(w.push(N.value),l&&E.push(m[y+C])):(T.push(m[y+C]),S.push(N.value)))}const I=gd(e)&&e.limit===1/0&&(typeof t!="function"||t===hx)&&{index:e.index,range:e.range};return Promise.resolve(S.length>0&&a.mutate({trans:r,type:"add",values:S}).then(C=>{for(let R in C.failures)T.splice(parseInt(R),1);g(S.length,C)})).then(()=>(w.length>0||I&&typeof t=="object")&&a.mutate({trans:r,type:"put",keys:E,values:w,criteria:I,changeSpec:typeof t!="function"&&t}).then(C=>g(w.length,C))).then(()=>(T.length>0||I&&t===hx)&&a.mutate({trans:r,type:"delete",keys:T,criteria:I}).then(C=>g(T.length,C))).then(()=>m.length>y+v&&b(y+u))})};return b(0).then(()=>{if(d.length>0)throw new vb("Error modifying one or more objects",d,h,p);return m.length})})})}delete(){var t=this._ctx,e=t.range;return gd(t)&&(t.isPrimKey&&!PB||e.type===3)?this._write(r=>{const{primaryKey:s}=t.table.core.schema,i=e;return t.table.core.count({trans:r,query:{index:s,range:i}}).then(o=>t.table.core.mutate({trans:r,type:"deleteRange",range:i}).then(({failures:a,lastResult:l,results:c,numFailures:u})=>{if(u)throw new vb("Could not delete some values",Object.keys(a).map(d=>a[d]),o-u);return o-u}))}):this.modify(hx)}}const hx=(n,t)=>t.value=null;function RB(n,t){return n<t?-1:n===t?0:1}function DB(n,t){return n>t?-1:n===t?0:1}function ds(n,t,e){var r=n instanceof JO?new n.Collection(n):n;return r._ctx.error=e?new e(t):new TypeError(t),r}function md(n){return new n.Collection(n,()=>qO("")).limit(0)}function NB(n,t,e,r,s,i){for(var o=Math.min(n.length,r.length),a=-1,l=0;l<o;++l){var c=t[l];if(c!==r[l])return s(n[l],e[l])<0?n.substr(0,l)+e[l]+e.substr(l+1):s(n[l],r[l])<0?n.substr(0,l)+r[l]+e.substr(l+1):a>=0?n.substr(0,a)+t[a]+e.substr(a+1):null;s(n[l],c)<0&&(a=l)}return o<r.length&&i==="next"?n+e.substr(n.length):o<n.length&&i==="prev"?n.substr(0,e.length):a<0?null:n.substr(0,a)+r[a]+e.substr(a+1)}function Ly(n,t,e,r){var s,i,o,a,l,c,u,d=e.length;if(!e.every(m=>typeof m=="string"))return ds(n,GO);function h(m){s=function(y){return y==="next"?v=>v.toUpperCase():v=>v.toLowerCase()}(m),i=function(y){return y==="next"?v=>v.toLowerCase():v=>v.toUpperCase()}(m),o=m==="next"?RB:DB;var b=e.map(function(y){return{lower:i(y),upper:s(y)}}).sort(function(y,v){return o(y.lower,v.lower)});a=b.map(function(y){return y.upper}),l=b.map(function(y){return y.lower}),c=m,u=m==="next"?"":r}h("next");var p=new n.Collection(n,()=>ja(a[0],l[d-1]+r));p._ondirectionchange=function(m){h(m)};var g=0;return p._addAlgorithm(function(m,b,y){var v=m.key;if(typeof v!="string")return!1;var x=i(v);if(t(x,l,g))return!0;for(var S=null,w=g;w<d;++w){var E=NB(v,x,a[w],l[w],o,c);E===null&&S===null?g=w+1:(S===null||o(S,E)>0)&&(S=E)}return b(S!==null?function(){m.continue(S+u)}:y),!1}),p}function ja(n,t,e,r){return{type:2,lower:n,upper:t,lowerOpen:e,upperOpen:r}}function qO(n){return{type:1,lower:n,upper:n}}class JO{get Collection(){return this._ctx.table.db.Collection}between(t,e,r,s){r=r!==!1,s=s===!0;try{return this._cmp(t,e)>0||this._cmp(t,e)===0&&(r||s)&&(!r||!s)?md(this):new this.Collection(this,()=>ja(t,e,!r,!s))}catch{return ds(this,Eo)}}equals(t){return t==null?ds(this,Eo):new this.Collection(this,()=>qO(t))}above(t){return t==null?ds(this,Eo):new this.Collection(this,()=>ja(t,void 0,!0))}aboveOrEqual(t){return t==null?ds(this,Eo):new this.Collection(this,()=>ja(t,void 0,!1))}below(t){return t==null?ds(this,Eo):new this.Collection(this,()=>ja(void 0,t,!1,!0))}belowOrEqual(t){return t==null?ds(this,Eo):new this.Collection(this,()=>ja(void 0,t))}startsWith(t){return typeof t!="string"?ds(this,GO):this.between(t,t+Ac,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Ly(this,(e,r)=>e.indexOf(r[0])===0,[t],Ac)}equalsIgnoreCase(t){return Ly(this,(e,r)=>e===r[0],[t],"")}anyOfIgnoreCase(){var t=da.apply(Cd,arguments);return t.length===0?md(this):Ly(this,(e,r)=>r.indexOf(e)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=da.apply(Cd,arguments);return t.length===0?md(this):Ly(this,(e,r)=>r.some(s=>e.indexOf(s)===0),t,Ac)}anyOf(){const t=da.apply(Cd,arguments);let e=this._cmp;try{t.sort(e)}catch{return ds(this,Eo)}if(t.length===0)return md(this);const r=new this.Collection(this,()=>ja(t[0],t[t.length-1]));r._ondirectionchange=i=>{e=i==="next"?this._ascending:this._descending,t.sort(e)};let s=0;return r._addAlgorithm((i,o,a)=>{const l=i.key;for(;e(l,t[s])>0;)if(++s,s===t.length)return o(a),!1;return e(l,t[s])===0||(o(()=>{i.continue(t[s])}),!1)}),r}notEqual(t){return this.inAnyRange([[j1,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=da.apply(Cd,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ds(this,Eo)}const e=t.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[j1,s]],null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,e){const r=this._cmp,s=this._ascending,i=this._descending,o=this._min,a=this._max;if(t.length===0)return md(this);if(!t.every(v=>v[0]!==void 0&&v[1]!==void 0&&s(v[0],v[1])<=0))return ds(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",zt.InvalidArgument);const l=!e||e.includeLowers!==!1,c=e&&e.includeUppers===!0;let u,d=s;function h(v,x){return d(v[0],x[0])}try{u=t.reduce(function(v,x){let S=0,w=v.length;for(;S<w;++S){const E=v[S];if(r(x[0],E[1])<0&&r(x[1],E[0])>0){E[0]=o(E[0],x[0]),E[1]=a(E[1],x[1]);break}}return S===w&&v.push(x),v},[]),u.sort(h)}catch{return ds(this,Eo)}let p=0;const g=c?v=>s(v,u[p][1])>0:v=>s(v,u[p][1])>=0,m=l?v=>i(v,u[p][0])>0:v=>i(v,u[p][0])>=0;let b=g;const y=new this.Collection(this,()=>ja(u[0][0],u[u.length-1][1],!l,!c));return y._ondirectionchange=v=>{v==="next"?(b=g,d=s):(b=m,d=i),u.sort(h)},y._addAlgorithm((v,x,S)=>{for(var w=v.key;b(w);)if(++p,p===u.length)return x(S),!1;return!!function(E){return!g(E)&&!m(E)}(w)||(this._cmp(w,u[p][1])===0||this._cmp(w,u[p][0])===0||x(()=>{d===s?v.continue(u[p][0]):v.continue(u[p][1])}),!1)}),y}startsWithAnyOf(){const t=da.apply(Cd,arguments);return t.every(e=>typeof e=="string")?t.length===0?md(this):this.inAnyRange(t.map(e=>[e,e+Ac])):ds(this,"startsWithAnyOf() only works with strings")}}function Wi(n){return en(function(t){return fg(t),n(t.target.error),!1})}function fg(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}const pg="storagemutated",Za="x-storagemutated-1",Ql=_p(null,pg);class _B{_lock(){return Xf(!Rt.global),++this._reculock,this._reculock!==1||Rt.global||(Rt.lockOwnerFor=this),this}_unlock(){if(Xf(!Rt.global),--this._reculock==0)for(Rt.global||(Rt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{If(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Rt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const e=this.db.idbdb,r=this.db._state.dbOpenError;if(Xf(!this.idbtrans),!t&&!e)switch(r&&r.name){case"DatabaseClosedError":throw new zt.DatabaseClosed(r);case"MissingAPIError":throw new zt.MissingAPI(r.message,r);default:throw new zt.OpenFailed(r)}if(!this.active)throw new zt.TransactionInactive;return Xf(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):e.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=en(s=>{fg(s),this._reject(t.error)}),t.onabort=en(s=>{fg(s),this.active&&this._reject(new zt.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=en(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&Ql.storagemutated.fire(t.mutatedParts)}),this}_promise(t,e,r){if(t==="readwrite"&&this.mode!=="readwrite")return Fn(new zt.ReadOnly("Transaction is readonly"));if(!this.active)return Fn(new zt.TransactionInactive);if(this._locked())return new mt((i,o)=>{this._blockedFuncs.push([()=>{this._promise(t,e,r).then(i,o)},Rt])});if(r)return ql(()=>{var i=new mt((o,a)=>{this._lock();const l=e(o,a,this);l&&l.then&&l.then(o,a)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new mt((i,o)=>{var a=e(i,o,this);a&&a.then&&a.then(i,o)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var e=this._root();const r=mt.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then(()=>r);else{e._waitingFor=r,e._waitingQueue=[];var s=e.idbtrans.objectStore(e.storeNames[0]);(function o(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(s.get(-1/0).onsuccess=o)})()}var i=e._waitingFor;return new mt((o,a)=>{r.then(l=>e._waitingQueue.push(en(o.bind(null,l))),l=>e._waitingQueue.push(en(a.bind(null,l)))).finally(()=>{e._waitingFor===i&&(e._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new zt.Abort))}table(t){const e=this._memoizedTables||(this._memoizedTables={});if(Ns(e,t))return e[t];const r=this.schema[t];if(!r)throw new zt.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,r,this);return s.core=this.db.core.table(t),e[t]=s,s}}function H1(n,t,e,r,s,i,o){return{name:n,keyPath:t,unique:e,multi:r,auto:s,compound:i,src:(e&&!o?"&":"")+(r?"*":"")+(s?"++":"")+QO(t)}}function QO(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function ZO(n,t,e){return{name:n,primKey:t,indexes:e,mappedClass:null,idxByName:OO(e,r=>[r.name,r])}}let gg=n=>{try{return n.only([[]]),gg=()=>[[]],[[]]}catch{return gg=()=>Ac,Ac}};function V1(n){return n==null?()=>{}:typeof n=="string"?function(t){return t.split(".").length===1?r=>r[t]:r=>ma(r,t)}(n):t=>ma(t,n)}function nT(n){return[].slice.call(n)}let LB=0;function Lp(n){return n==null?":id":typeof n=="string"?n:`[${n.join("+")}]`}function FB(n,t,e){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:d,upperOpen:h}=l;return c===void 0?u===void 0?null:t.upperBound(u,!!h):u===void 0?t.lowerBound(c,!!d):t.bound(c,u,!!d,!!h)}const{schema:s,hasGetAll:i}=function(l,c){const u=nT(l.objectStoreNames);return{schema:{name:l.name,tables:u.map(d=>c.objectStore(d)).map(d=>{const{keyPath:h,autoIncrement:p}=d,g=Cr(h),m=h==null,b={},y={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m,compound:g,keyPath:h,autoIncrement:p,unique:!0,extractKey:V1(h)},indexes:nT(d.indexNames).map(v=>d.index(v)).map(v=>{const{name:x,unique:S,multiEntry:w,keyPath:E}=v,T={name:x,compound:Cr(E),keyPath:E,unique:S,multiEntry:w,extractKey:V1(E)};return b[Lp(E)]=T,T}),getIndexByKeyPath:v=>b[Lp(v)]};return b[":id"]=y.primaryKey,h!=null&&(b[Lp(h)]=y.primaryKey),y})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(n,e),o=s.tables.map(l=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:d,type:h,keys:p,values:g,range:m}){return new Promise((b,y)=>{b=en(b);const v=d.objectStore(u),x=v.keyPath==null,S=h==="put"||h==="add";if(!S&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);const{length:w}=p||g||{length:1};if(p&&g&&p.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(w===0)return b({numFailures:0,failures:{},results:[],lastResult:void 0});let E;const T=[],I=[];let C=0;const R=B=>{++C,fg(B)};if(h==="deleteRange"){if(m.type===4)return b({numFailures:C,failures:I,results:[],lastResult:void 0});m.type===3?T.push(E=v.clear()):T.push(E=v.delete(r(m)))}else{const[B,$]=S?x?[g,p]:[g,null]:[p,null];if(S)for(let L=0;L<w;++L)T.push(E=$&&$[L]!==void 0?v[h](B[L],$[L]):v[h](B[L])),E.onerror=R;else for(let L=0;L<w;++L)T.push(E=v[h](B[L])),E.onerror=R}const N=B=>{const $=B.target.result;T.forEach((L,F)=>L.error!=null&&(I[F]=L.error)),b({numFailures:C,failures:I,results:h==="delete"?p:T.map(L=>L.result),lastResult:$})};E.onerror=B=>{R(B),N(B)},E.onsuccess=N})},getMany:({trans:d,keys:h})=>new Promise((p,g)=>{p=en(p);const m=d.objectStore(u),b=h.length,y=new Array(b);let v,x=0,S=0;const w=T=>{const I=T.target;y[I._pos]=I.result,++S===x&&p(y)},E=Wi(g);for(let T=0;T<b;++T)h[T]!=null&&(v=m.get(h[T]),v._pos=T,v.onsuccess=w,v.onerror=E,++x);x===0&&p(y)}),get:({trans:d,key:h})=>new Promise((p,g)=>{p=en(p);const m=d.objectStore(u).get(h);m.onsuccess=b=>p(b.target.result),m.onerror=Wi(g)}),query:function(d){return h=>new Promise((p,g)=>{p=en(p);const{trans:m,values:b,limit:y,query:v}=h,x=y===1/0?void 0:y,{index:S,range:w}=v,E=m.objectStore(u),T=S.isPrimaryKey?E:E.index(S.name),I=r(w);if(y===0)return p({result:[]});if(d){const C=b?T.getAll(I,x):T.getAllKeys(I,x);C.onsuccess=R=>p({result:R.target.result}),C.onerror=Wi(g)}else{let C=0;const R=b||!("openKeyCursor"in T)?T.openCursor(I):T.openKeyCursor(I),N=[];R.onsuccess=B=>{const $=R.result;return $?(N.push(b?$.value:$.primaryKey),++C===y?p({result:N}):void $.continue()):p({result:N})},R.onerror=Wi(g)}})}(i),openCursor:function({trans:d,values:h,query:p,reverse:g,unique:m}){return new Promise((b,y)=>{b=en(b);const{index:v,range:x}=p,S=d.objectStore(u),w=v.isPrimaryKey?S:S.index(v.name),E=g?m?"prevunique":"prev":m?"nextunique":"next",T=h||!("openKeyCursor"in w)?w.openCursor(r(x),E):w.openKeyCursor(r(x),E);T.onerror=Wi(y),T.onsuccess=en(I=>{const C=T.result;if(!C)return void b(null);C.___id=++LB,C.done=!1;const R=C.continue.bind(C);let N=C.continuePrimaryKey;N&&(N=N.bind(C));const B=C.advance.bind(C),$=()=>{throw new Error("Cursor not stopped")};C.trans=d,C.stop=C.continue=C.continuePrimaryKey=C.advance=()=>{throw new Error("Cursor not started")},C.fail=en(y),C.next=function(){let L=1;return this.start(()=>L--?this.continue():this.stop()).then(()=>this)},C.start=L=>{const F=new Promise((j,X)=>{j=en(j),T.onerror=Wi(X),C.fail=X,C.stop=wt=>{C.stop=C.continue=C.continuePrimaryKey=C.advance=$,j(wt)}}),_=()=>{if(T.result)try{L()}catch(j){C.fail(j)}else C.done=!0,C.start=()=>{throw new Error("Cursor behind last entry")},C.stop()};return T.onsuccess=en(j=>{T.onsuccess=_,_()}),C.continue=R,C.continuePrimaryKey=N,C.advance=B,_(),F},b(C)},y)})},count({query:d,trans:h}){const{index:p,range:g}=d;return new Promise((m,b)=>{const y=h.objectStore(u),v=p.isPrimaryKey?y:y.index(p.name),x=r(g),S=x?v.count(x):v.count();S.onsuccess=en(w=>m(w.target.result)),S.onerror=Wi(b)})}}}(l)),a={};return o.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:n.transaction.bind(n),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:gg(t),schema:s}}function z1({_novip:n},t){const e=t.db,r=function(s,i,{IDBKeyRange:o,indexedDB:a},l){return{dbcore:function(u,d){return d.reduce((h,{create:p})=>({...h,...p(h)}),u)}(FB(i,o,l),s.dbcore)}}(n._middlewares,e,n._deps,t);n.core=r.dbcore,n.tables.forEach(s=>{const i=s.name;n.core.schema.tables.some(o=>o.name===i)&&(s.core=n.core.table(i),n[i]instanceof n.Table&&(n[i].core=s.core))})}function Eb({_novip:n},t,e,r){e.forEach(s=>{const i=r[s];t.forEach(o=>{const a=EE(o,s);(!a||"value"in a&&a.value===void 0)&&(o===n.Transaction.prototype||o instanceof n.Transaction?ga(o,s,{get(){return this.table(s)},set(l){TO(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new n.Table(s,i))})})}function U1({_novip:n},t){t.forEach(e=>{for(let r in e)e[r]instanceof n.Table&&delete e[r]})}function BB(n,t){return n._cfg.version-t._cfg.version}function $B(n,t,e,r){const s=n._dbSchema,i=n._createTransaction("readwrite",n._storeNames,s);i.create(e),i._completion.catch(r);const o=i._reject.bind(i),a=Rt.transless||Rt;ql(()=>{Rt.trans=i,Rt.transless=a,t===0?(Cn(s).forEach(l=>{fx(e,l,s[l].primKey,s[l].indexes)}),z1(n,e),mt.follow(()=>n.on.populate.fire(i)).catch(o)):function({_novip:l},c,u,d){const h=[],p=l._versions;let g=l._dbSchema=K1(l,l.idbdb,d),m=!1;const b=p.filter(v=>v._cfg.version>=c);function y(){return h.length?mt.resolve(h.shift()(u.idbtrans)).then(y):mt.resolve()}return b.forEach(v=>{h.push(()=>{const x=g,S=v._cfg.dbschema;G1(l,x,d),G1(l,S,d),g=l._dbSchema=S;const w=tI(x,S);w.add.forEach(T=>{fx(d,T[0],T[1].primKey,T[1].indexes)}),w.change.forEach(T=>{if(T.recreate)throw new zt.Upgrade("Not yet support for changing primary key");{const I=d.objectStore(T.name);T.add.forEach(C=>W1(I,C)),T.change.forEach(C=>{I.deleteIndex(C.name),W1(I,C)}),T.del.forEach(C=>I.deleteIndex(C))}});const E=v._cfg.contentUpgrade;if(E&&v._cfg.version>c){z1(l,d),u._memoizedTables={},m=!0;let T=IO(S);w.del.forEach(N=>{T[N]=x[N]}),U1(l,[l.Transaction.prototype]),Eb(l,[l.Transaction.prototype],Cn(T),T),u.schema=T;const I=kE(E);let C;I&&Of();const R=mt.follow(()=>{if(C=E(u),C&&I){var N=Ta.bind(null,null);C.then(N,N)}});return C&&typeof C.then=="function"?mt.resolve(C):R.then(()=>C)}}),h.push(x=>{(!m||!MB)&&function(S,w){[].slice.call(w.db.objectStoreNames).forEach(E=>S[E]==null&&w.db.deleteObjectStore(E))}(v._cfg.dbschema,x),U1(l,[l.Transaction.prototype]),Eb(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),u.schema=l._dbSchema})}),y().then(()=>{var v,x;x=d,Cn(v=g).forEach(S=>{x.db.objectStoreNames.contains(S)||fx(x,S,v[S].primKey,v[S].indexes)})})}(n,t,i,e).catch(o)})}function tI(n,t){const e={del:[],add:[],change:[]};let r;for(r in n)t[r]||e.del.push(r);for(r in t){const s=n[r],i=t[r];if(s){const o={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!gw)o.recreate=!0,e.change.push(o);else{const a=s.idxByName,l=i.idxByName;let c;for(c in a)l[c]||o.del.push(c);for(c in l){const u=a[c],d=l[c];u?u.src!==d.src&&o.change.push(d):o.add.push(d)}(o.del.length>0||o.add.length>0||o.change.length>0)&&e.change.push(o)}}else e.add.push([r,i])}return e}function fx(n,t,e,r){const s=n.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach(i=>W1(s,i)),s}function W1(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function K1(n,t,e){const r={};return bb(t.objectStoreNames,0).forEach(s=>{const i=e.objectStore(s);let o=i.keyPath;const a=H1(QO(o),o||"",!1,!1,!!i.autoIncrement,o&&typeof o!="string",!0),l=[];for(let u=0;u<i.indexNames.length;++u){const d=i.index(i.indexNames[u]);o=d.keyPath;var c=H1(d.name,o,!!d.unique,!!d.multiEntry,!1,o&&typeof o!="string",!1);l.push(c)}r[s]=ZO(s,a,l)}),r}function G1({_novip:n},t,e){const r=e.db.objectStoreNames;for(let s=0;s<r.length;++s){const i=r[s],o=e.objectStore(i);n._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){const l=o.indexNames[a],c=o.index(l).keyPath,u=typeof c=="string"?c:"["+bb(c).join("+")+"]";if(t[i]){const d=t[i].idxByName[u];d&&(d.name=l,delete t[i].idxByName[u],t[i].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&qe.WorkerGlobalScope&&qe instanceof qe.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}class jB{_parseStoresSpec(t,e){Cn(t).forEach(r=>{if(t[r]!==null){var s=t[r].split(",").map((o,a)=>{const l=(o=o.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return H1(l,c||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),Cr(c),a===0)}),i=s.shift();if(i.multi)throw new zt.Schema("Primary key cannot be multi-valued");s.forEach(o=>{if(o.auto)throw new zt.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new zt.Schema("Index must have a name and cannot be an empty string")}),e[r]=ZO(r,i,s)}})}stores(t){const e=this.db;this._cfg.storesSource=this._cfg.storesSource?zr(this._cfg.storesSource,t):t;const r=e._versions,s={};let i={};return r.forEach(o=>{zr(s,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(s,i)}),e._dbSchema=i,U1(e,[e._allTables,e,e.Transaction.prototype]),Eb(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],Cn(i),i),e._storeNames=Cn(i),this}upgrade(t){return this._cfg.contentUpgrade=ME(this._cfg.contentUpgrade||je,t),this}}function RE(n,t){let e=n._dbNamesDB;return e||(e=n._dbNamesDB=new Fu(mw,{addons:[],indexedDB:n,IDBKeyRange:t}),e.version(1).stores({dbnames:"name"})),e.table("dbnames")}function DE(n){return n&&typeof n.databases=="function"}function Y1(n){return ql(function(){return Rt.letThrough=!0,n()})}function HB(){var n;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var e=function(){return indexedDB.databases().finally(t)};n=setInterval(e,100),e()}).finally(function(){return clearInterval(n)}):Promise.resolve()}function VB(n){const t=n._state,{indexedDB:e}=n._deps;if(t.isBeingOpened||n.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Fn(t.dbOpenError):n);xo&&(t.openCanceller._stackHolder=cd()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function s(){if(t.openCanceller!==r)throw new zt.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,o=null,a=!1;const l=()=>new mt((c,u)=>{if(s(),!e)throw new zt.MissingAPI;const d=n.name,h=t.autoSchema?e.open(d):e.open(d,Math.round(10*n.verno));if(!h)throw new zt.MissingAPI;h.onerror=Wi(u),h.onblocked=en(n._fireOnBlocked),h.onupgradeneeded=en(p=>{if(o=h.transaction,t.autoSchema&&!n._options.allowEmptyDB){h.onerror=fg,o.abort(),h.result.close();const m=e.deleteDatabase(d);m.onsuccess=m.onerror=en(()=>{u(new zt.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{o.onerror=Wi(u);var g=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;a=g<1,n._novip.idbdb=h.result,$B(n,g/10,o,u)}},u),h.onsuccess=en(()=>{o=null;const p=n._novip.idbdb=h.result,g=bb(p.objectStoreNames);if(g.length>0)try{const b=p.transaction((m=g).length===1?m[0]:m,"readonly");t.autoSchema?function({_novip:y},v,x){y.verno=v.version/10;const S=y._dbSchema=K1(0,v,x);y._storeNames=bb(v.objectStoreNames,0),Eb(y,[y._allTables],Cn(S),S)}(n,p,b):(G1(n,n._dbSchema,b),function(y,v){const x=tI(K1(0,y.idbdb,v),y._dbSchema);return!(x.add.length||x.change.some(S=>S.add.length||S.change.length))}(n,b)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),z1(n,b)}catch{}var m;Np.push(n),p.onversionchange=en(b=>{t.vcFired=!0,n.on("versionchange").fire(b)}),p.onclose=en(b=>{n.on("close").fire(b)}),a&&function({indexedDB:b,IDBKeyRange:y},v){!DE(b)&&v!==mw&&RE(b,y).put({name:v}).catch(je)}(n._deps,d),c()},u)}).catch(c=>c&&c.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):mt.reject(c));return mt.race([r,(typeof navigator>"u"?mt.resolve():HB()).then(l)]).then(()=>(s(),t.onReadyBeingFired=[],mt.resolve(Y1(()=>n.on.ready.fire(n.vip))).then(function c(){if(t.onReadyBeingFired.length>0){let u=t.onReadyBeingFired.reduce(ME,je);return t.onReadyBeingFired=[],mt.resolve(Y1(()=>u(n.vip))).then(c)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>n).catch(c=>{t.dbOpenError=c;try{o&&o.abort()}catch{}return r===t.openCanceller&&n._close(),Fn(c)}).finally(()=>{t.openComplete=!0,i()})}function X1(n){var t=i=>n.next(i),e=s(t),r=s(i=>n.throw(i));function s(i){return o=>{var a=i(o),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(e,r):Cr(l)?Promise.all(l).then(e,r):e(l)}}return s(t)()}function zB(n,t,e){var r=arguments.length;if(r<2)throw new zt.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];return e=s.pop(),[n,RO(s),e]}function eI(n,t,e,r,s){return mt.resolve().then(()=>{const i=Rt.transless||Rt,o=n._createTransaction(t,e,n._dbSchema,r),a={trans:o,transless:i};if(r)o.idbtrans=r.idbtrans;else try{o.create(),n._state.PR1398_maxLoop=3}catch(d){return d.name===TE.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n._close(),n.open().then(()=>eI(n,t,e,null,s))):Fn(d)}const l=kE(s);let c;l&&Of();const u=mt.follow(()=>{if(c=s.call(o,o),c)if(l){var d=Ta.bind(null,null);c.then(d,d)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=X1(c))},a);return(c&&typeof c.then=="function"?mt.resolve(c).then(d=>o.active?d:Fn(new zt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(d=>(r&&o._resolve(),o._completion.then(()=>d))).catch(d=>(o._reject(d),Fn(d)))})}function Fy(n,t,e){const r=Cr(n)?n.slice():[n];for(let s=0;s<e;++s)r.push(t);return r}const UB={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return{...n,table(t){const e=n.table(t),{schema:r}=e,s={},i=[];function o(u,d,h){const p=Lp(u),g=s[p]=s[p]||[],m=u==null?0:typeof u=="string"?1:u.length,b=d>0,y={...h,isVirtual:b,keyTail:d,keyLength:m,extractKey:V1(u),unique:!b&&h.unique};return g.push(y),y.isPrimaryKey||i.push(y),m>1&&o(m===2?u[0]:u.slice(0,m-1),d+1,h),g.sort((v,x)=>v.keyTail-x.keyTail),y}const a=o(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[a];for(const u of r.indexes)o(u.keyPath,0,u);function l(u){const d=u.query.index;return d.isVirtual?{...u,query:{index:d,range:(h=u.query.range,p=d.keyTail,{type:h.type===1?2:h.type,lower:Fy(h.lower,h.lowerOpen?n.MAX_KEY:n.MIN_KEY,p),lowerOpen:!0,upper:Fy(h.upper,h.upperOpen?n.MIN_KEY:n.MAX_KEY,p),upperOpen:!0})}}:u;var h,p}return{...e,schema:{...r,primaryKey:a,indexes:i,getIndexByKeyPath:function(u){const d=s[Lp(u)];return d&&d[0]}},count:u=>e.count(l(u)),query:u=>e.query(l(u)),openCursor(u){const{keyTail:d,isVirtual:h,keyLength:p}=u.query.index;return h?e.openCursor(l(u)).then(g=>g&&function(m){return Object.create(m,{continue:{value:function(y){y!=null?m.continue(Fy(y,u.reverse?n.MAX_KEY:n.MIN_KEY,d)):u.unique?m.continue(m.key.slice(0,p).concat(u.reverse?n.MIN_KEY:n.MAX_KEY,d)):m.continue()}},continuePrimaryKey:{value(y,v){m.continuePrimaryKey(Fy(y,n.MAX_KEY,d),v)}},primaryKey:{get:()=>m.primaryKey},key:{get(){const y=m.key;return p===1?y[0]:y.slice(0,p)}},value:{get:()=>m.value}})}(g)):e.openCursor(u)}}}}}};function NE(n,t,e,r){return e=e||{},r=r||"",Cn(n).forEach(s=>{if(Ns(t,s)){var i=n[s],o=t[s];if(typeof i=="object"&&typeof o=="object"&&i&&o){const a=M1(i);a!==M1(o)?e[r+s]=t[s]:a==="Object"?NE(i,o,e,r+s+"."):i!==o&&(e[r+s]=t[s])}else i!==o&&(e[r+s]=t[s])}else e[r+s]=void 0}),Cn(t).forEach(s=>{Ns(n,s)||(e[r+s]=t[s])}),e}const WB={stack:"dbcore",name:"HooksMiddleware",level:2,create:n=>({...n,table(t){const e=n.table(t),{primaryKey:r}=e.schema;return{...e,mutate(i){const o=Rt.trans,{deleting:a,creating:l,updating:c}=o.table(t).hook;switch(i.type){case"add":if(l.fire===je)break;return o._promise("readwrite",()=>u(i),!0);case"put":if(l.fire===je&&c.fire===je)break;return o._promise("readwrite",()=>u(i),!0);case"delete":if(a.fire===je)break;return o._promise("readwrite",()=>u(i),!0);case"deleteRange":if(a.fire===je)break;return o._promise("readwrite",()=>function(h){return d(h.trans,h.range,1e4)}(i),!0)}return e.mutate(i);function u(h){const p=Rt.trans,g=h.keys||function(m,b){return b.type==="delete"?b.keys:b.keys||b.values.map(m.extractKey)}(r,h);if(!g)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?{...h,keys:g}:{...h}).type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),function(m,b,y){return b.type==="add"?Promise.resolve([]):m.getMany({trans:b.trans,keys:y,cache:"immutable"})}(e,h,g).then(m=>{const b=g.map((y,v)=>{const x=m[v],S={onerror:null,onsuccess:null};if(h.type==="delete")a.fire.call(S,y,x,p);else if(h.type==="add"||x===void 0){const w=l.fire.call(S,y,h.values[v],p);y==null&&w!=null&&(y=w,h.keys[v]=y,r.outbound||Pi(h.values[v],r.keyPath,y))}else{const w=NE(x,h.values[v]),E=c.fire.call(S,w,y,x,p);if(E){const T=h.values[v];Object.keys(E).forEach(I=>{Ns(T,I)?T[I]=E[I]:Pi(T,I,E[I])})}}return S});return e.mutate(h).then(({failures:y,results:v,numFailures:x,lastResult:S})=>{for(let w=0;w<g.length;++w){const E=v?v[w]:g[w],T=b[w];E==null?T.onerror&&T.onerror(y[w]):T.onsuccess&&T.onsuccess(h.type==="put"&&m[w]?h.values[w]:E)}return{failures:y,results:v,numFailures:x,lastResult:S}}).catch(y=>(b.forEach(v=>v.onerror&&v.onerror(y)),Promise.reject(y)))})}function d(h,p,g){return e.query({trans:h,values:!1,query:{index:r,range:p},limit:g}).then(({result:m})=>u({type:"delete",keys:m,trans:h}).then(b=>b.numFailures>0?Promise.reject(b.failures[0]):m.length<g?{failures:[],numFailures:0,lastResult:void 0}:d(h,{...p,lower:m[m.length-1],lowerOpen:!0},g)))}}}}})};function nI(n,t,e){try{if(!t||t.keys.length<n.length)return null;const r=[];for(let s=0,i=0;s<t.keys.length&&i<n.length;++s)$r(t.keys[s],n[i])===0&&(r.push(e?cy(t.values[s]):t.values[s]),++i);return r.length===n.length?r:null}catch{return null}}const KB={stack:"dbcore",level:-1,create:n=>({table:t=>{const e=n.table(t);return{...e,getMany:r=>{if(!r.cache)return e.getMany(r);const s=nI(r.keys,r.trans._cache,r.cache==="clone");return s?mt.resolve(s):e.getMany(r).then(i=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?cy(i):i},i))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),e.mutate(r))}}})};function _E(n){return!("from"in n)}const Lo=function(n,t){if(!this){const e=new Lo;return n&&"d"in n&&zr(e,n),e}zr(this,arguments.length?{d:1,from:n,to:arguments.length>1?t:n}:{d:0})};function mg(n,t,e){const r=$r(t,e);if(isNaN(r))return;if(r>0)throw RangeError();if(_E(n))return zr(n,{from:t,to:e,d:1});const s=n.l,i=n.r;if($r(e,n.from)<0)return s?mg(s,t,e):n.l={from:t,to:e,d:1,l:null,r:null},rT(n);if($r(t,n.to)>0)return i?mg(i,t,e):n.r={from:t,to:e,d:1,l:null,r:null},rT(n);$r(t,n.from)<0&&(n.from=t,n.l=null,n.d=i?i.d+1:1),$r(e,n.to)>0&&(n.to=e,n.r=null,n.d=n.l?n.l.d+1:1);const o=!n.r;s&&!n.l&&kb(n,s),i&&o&&kb(n,i)}function kb(n,t){_E(t)||function e(r,{from:s,to:i,l:o,r:a}){mg(r,s,i),o&&e(r,o),a&&e(r,a)}(n,t)}function GB(n,t){const e=q1(t);let r=e.next();if(r.done)return!1;let s=r.value;const i=q1(n);let o=i.next(s.from),a=o.value;for(;!r.done&&!o.done;){if($r(a.from,s.to)<=0&&$r(a.to,s.from)>=0)return!0;$r(s.from,a.from)<0?s=(r=e.next(a.from)).value:a=(o=i.next(s.from)).value}return!1}function q1(n){let t=_E(n)?null:{s:0,n};return{next(e){const r=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&$r(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||$r(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function rT(n){var t,e;const r=(((t=n.r)===null||t===void 0?void 0:t.d)||0)-(((e=n.l)===null||e===void 0?void 0:e.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const i=s==="r"?"l":"r",o={...n},a=n[s];n.from=a.from,n.to=a.to,n[s]=a[s],o[s]=a[i],n[i]=o,o.d=sT(o)}n.d=sT(n)}function sT({r:n,l:t}){return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}mf(Lo.prototype,{add(n){return kb(this,n),this},addKey(n){return mg(this,n,n),this},addKeys(n){return n.forEach(t=>mg(this,t,t)),this},[P1](){return q1(this)}});const YB={stack:"dbcore",level:0,create:n=>{const t=n.schema.name,e=new Lo(n.MIN_KEY,n.MAX_KEY);return{...n,table:r=>{const s=n.table(r),{schema:i}=s,{primaryKey:o}=i,{extractKey:a,outbound:l}=o,c={...s,mutate:h=>{const p=h.trans,g=p.mutatedParts||(p.mutatedParts={}),m=E=>{const T=`idb://${t}/${r}/${E}`;return g[T]||(g[T]=new Lo)},b=m(""),y=m(":dels"),{type:v}=h;let[x,S]=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[];const w=h.trans._cache;return s.mutate(h).then(E=>{if(Cr(x)){v!=="delete"&&(x=E.results),b.addKeys(x);const T=nI(x,w);T||v==="add"||y.addKeys(x),(T||S)&&function(I,C,R,N){function B($){const L=I($.name||"");function F(j){return j!=null?$.extractKey(j):null}const _=j=>$.multiEntry&&Cr(j)?j.forEach(X=>L.addKey(X)):L.addKey(j);(R||N).forEach((j,X)=>{const wt=R&&F(R[X]),qt=N&&F(N[X]);$r(wt,qt)!==0&&(wt!=null&&_(wt),qt!=null&&_(qt))})}C.indexes.forEach(B)}(m,i,T,S)}else if(x){const T={from:x.lower,to:x.upper};y.add(T),b.add(T)}else b.add(e),y.add(e),i.indexes.forEach(T=>m(T.name).add(e));return E})}},u=({query:{index:h,range:p}})=>{var g,m;return[h,new Lo((g=p.lower)!==null&&g!==void 0?g:n.MIN_KEY,(m=p.upper)!==null&&m!==void 0?m:n.MAX_KEY)]},d={get:h=>[o,new Lo(h.key)],getMany:h=>[o,new Lo().addKeys(h.keys)],count:u,query:u,openCursor:u};return Cn(d).forEach(h=>{c[h]=function(p){const{subscr:g}=Rt;if(g){const m=S=>{const w=`idb://${t}/${r}/${S}`;return g[w]||(g[w]=new Lo)},b=m(""),y=m(":dels"),[v,x]=d[h](p);if(m(v.name||"").add(x),!v.isPrimaryKey){if(h!=="count"){const S=h==="query"&&l&&p.values&&s.query({...p,values:!1});return s[h].apply(this,arguments).then(w=>{if(h==="query"){if(l&&p.values)return S.then(({result:T})=>(b.addKeys(T),w));const E=p.values?w.result.map(a):w.result;p.values?b.addKeys(E):y.addKeys(E)}else if(h==="openCursor"){const E=w,T=p.values;return E&&Object.create(E,{key:{get:()=>(y.addKey(E.primaryKey),E.key)},primaryKey:{get(){const I=E.primaryKey;return y.addKey(I),I}},value:{get:()=>(T&&b.addKey(E.primaryKey),E.value)}})}return w})}y.add(e)}}return s[h].apply(this,arguments)}}),c}}}};class Fu{constructor(t,e){this._middlewares={},this.verno=0;const r=Fu.dependencies;this._options=e={addons:Fu.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...e},this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};const{addons:s}=e;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:je,dbReadyPromise:null,cancelOpen:je,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new mt(a=>{i.dbReadyResolve=a}),i.openCanceller=new mt((a,l)=>{i.cancelOpen=l}),this._state=i,this.name=t,this.on=_p(this,"populate","blocked","versionchange","close",{ready:[ME,je]}),this.on.ready.subscribe=MO(this.on.ready.subscribe,a=>(l,c)=>{Fu.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||mt.resolve().then(l),c&&a(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&a(l);else{a(l);const d=this;c||a(function h(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(h)})}})}),this.Collection=(o=this,Ff(IB.prototype,function(a,l){this.db=o;let c=XO,u=null;if(l)try{c=l()}catch(g){u=g}const d=a._ctx,h=d.table,p=h.hook.reading.fire;this._ctx={table:h,index:d.index,isPrimKey:!d.index||h.schema.primKey.keyPath&&d.index===h.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:d.or,valueMapper:p!==dg?p:null}})),this.Table=function(a){return Ff(OB.prototype,function(l,c,u){this.db=a,this._tx=u,this.name=l,this.schema=c,this.hook=a._allTables[l]?a._allTables[l].hook:_p(null,{creating:[bB,je],reading:[yB,dg],updating:[wB,je],deleting:[vB,je]})})}(this),this.Transaction=function(a){return Ff(_B.prototype,function(l,c,u,d,h){this.db=a,this.mode=l,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=_p(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new mt((p,g)=>{this._resolve=p,this._reject=g}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},p=>{var g=this.active;return this.active=!1,this.on.error.fire(p),this.parent?this.parent._reject(p):g&&this.idbtrans&&this.idbtrans.abort(),Fn(p)})})}(this),this.Version=function(a){return Ff(jB.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return Ff(JO.prototype,function(l,c,u){this.db=a,this._ctx={table:l,index:c===":id"?null:c,or:u};const d=a._deps.indexedDB;if(!d)throw new zt.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(h,p)=>d.cmp(p,h),this._max=(h,p)=>d.cmp(h,p)>0?h:p,this._min=(h,p)=>d.cmp(h,p)<0?h:p,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=gg(e.IDBKeyRange),this._createTransaction=(a,l,c,u)=>new this.Transaction(a,l,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Np.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(UB),this.use(WB),this.use(YB),this.use(KB),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(a=>a(this))}version(t){if(isNaN(t)||t<.1)throw new zt.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new zt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const e=this._versions;var r=e.filter(s=>s._cfg.version===t)[0];return r||(r=new this.Version(t),e.push(r),e.sort(BB),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Rt.letThrough||this._vip)?t():new mt((e,r)=>{if(this._state.openComplete)return r(new zt.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new zt.DatabaseClosed);this.open().catch(je)}this._state.dbReadyPromise.then(e,r)}).then(t)}use({stack:t,create:e,level:r,name:s}){s&&this.unuse({stack:t,name:s});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:e,level:r??10,name:s}),i.sort((o,a)=>o.level-a.level),this}unuse({stack:t,name:e,create:r}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>r?s.create!==r:!!e&&s.name!==e)),this}open(){return VB(this)}_close(){const t=this._state,e=Np.indexOf(this);if(e>=0&&Np.splice(e,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new mt(r=>{t.dbReadyResolve=r}),t.openCanceller=new mt((r,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new zt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,e=this._state;return new mt((r,s)=>{const i=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=en(()=>{(function({indexedDB:a,IDBKeyRange:l},c){!DE(a)&&c!==mw&&RE(a,l).delete(c).catch(je)})(this._deps,this.name),r()}),o.onerror=Wi(s),o.onblocked=this._fireOnBlocked};if(t)throw new zt.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Cn(this._allTables).map(t=>this._allTables[t])}transaction(){const t=zB.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,e,r){let s=Rt.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const i=t.indexOf("?")!==-1;let o,a;t=t.replace("!","").replace("?","");try{if(a=e.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),t=="r"||t===lx)o=lx;else{if(t!="rw"&&t!=cx)throw new zt.InvalidArgument("Invalid transaction mode: "+t);o=cx}if(s){if(s.mode===lx&&o===cx){if(!i)throw new zt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&a.forEach(c=>{if(s&&s.storeNames.indexOf(c)===-1){if(!i)throw new zt.SubTransaction("Table "+c+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(c){return s?s._promise(null,(u,d)=>{d(c)}):Fn(c)}const l=eI.bind(null,this,o,a,s,r);return s?s._promise(o,l,"lock"):Rt.trans?If(Rt.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!Ns(this._allTables,t))throw new zt.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const XB=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class qB{constructor(t){this._subscribe=t}subscribe(t,e,r){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:e,complete:r})}[XB](){return this}}function rI(n,t){return Cn(t).forEach(e=>{kb(n[e]||(n[e]=new Lo),t[e])}),n}function JB(n){let t,e=!1;const r=new qB(s=>{const i=kE(n);let o=!1,a={},l={};const c={get closed(){return o},unsubscribe:()=>{o=!0,Ql.storagemutated.unsubscribe(p)}};s.start&&s.start(c);let u=!1,d=!1;function h(){return Cn(l).some(m=>a[m]&&GB(a[m],l[m]))}const p=m=>{rI(a,m),h()&&g()},g=()=>{if(u||o)return;a={};const m={},b=function(y){i&&Of();const v=()=>ql(n,{subscr:y,trans:null}),x=Rt.trans?If(Rt.transless,v):v();return i&&x.then(Ta,Ta),x}(m);d||(Ql(pg,p),d=!0),u=!0,Promise.resolve(b).then(y=>{e=!0,t=y,u=!1,o||(h()?g():(a={},l=m,s.next&&s.next(y)))},y=>{u=!1,e=!1,s.error&&s.error(y),c.unsubscribe()})};return g(),c});return r.hasValue=()=>e,r.getValue=()=>t,r}let J1;try{J1={indexedDB:qe.indexedDB||qe.mozIndexedDB||qe.webkitIndexedDB||qe.msIndexedDB,IDBKeyRange:qe.IDBKeyRange||qe.webkitIDBKeyRange}}catch{J1={indexedDB:null,IDBKeyRange:null}}const uc=Fu;function p0(n){let t=fa;try{fa=!0,Ql.storagemutated.fire(n)}finally{fa=t}}mf(uc,{...l0,delete:n=>new uc(n,{addons:[]}).delete(),exists:n=>new uc(n,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(n){try{return function({indexedDB:t,IDBKeyRange:e}){return DE(t)?Promise.resolve(t.databases()).then(r=>r.map(s=>s.name).filter(s=>s!==mw)):RE(t,e).toCollection().primaryKeys()}(uc.dependencies).then(n)}catch{return Fn(new zt.MissingAPI)}},defineClass:()=>function(n){zr(this,n)},ignoreTransaction:n=>Rt.trans?If(Rt.transless,n):n(),vip:Y1,async:function(n){return function(){try{var t=X1(n.apply(this,arguments));return t&&typeof t.then=="function"?t:mt.resolve(t)}catch(e){return Fn(e)}}},spawn:function(n,t,e){try{var r=X1(n.apply(e,t||[]));return r&&typeof r.then=="function"?r:mt.resolve(r)}catch(s){return Fn(s)}},currentTransaction:{get:()=>Rt.trans||null},waitFor:function(n,t){const e=mt.resolve(typeof n=="function"?uc.ignoreTransaction(n):n).timeout(t||6e4);return Rt.trans?Rt.trans.waitFor(e):e},Promise:mt,debug:{get:()=>xo,set:n=>{NO(n,n==="dexie"?()=>!0:YO)}},derive:qd,extend:zr,props:mf,override:MO,Events:_p,on:Ql,liveQuery:JB,extendObservabilitySet:rI,getByKeyPath:ma,setByKeyPath:Pi,delByKeyPath:function(n,t){typeof t=="string"?Pi(n,t,void 0):"length"in t&&[].map.call(t,function(e){Pi(n,e,void 0)})},shallowClone:IO,deepClone:cy,getObjectDiff:NE,cmp:$r,asap:PO,minKey:j1,addons:[],connections:Np,errnames:TE,dependencies:J1,semVer:JC,version:JC.split(".").map(n=>parseInt(n)).reduce((n,t,e)=>n+t/Math.pow(10,2*e))}),uc.maxKey=gg(uc.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ql(pg,n=>{if(!fa){let t;gw?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Za,!0,!0,n)):t=new CustomEvent(Za,{detail:n}),fa=!0,dispatchEvent(t),fa=!1}}),addEventListener(Za,({detail:n})=>{fa||p0(n)}));let fa=!1;if(typeof BroadcastChannel<"u"){const n=new BroadcastChannel(Za);typeof n.unref=="function"&&n.unref(),Ql(pg,t=>{fa||n.postMessage(t)}),n.onmessage=t=>{t.data&&p0(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ql(pg,t=>{try{fa||(typeof localStorage<"u"&&localStorage.setItem(Za,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(e=>e.postMessage({type:Za,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Za){const e=JSON.parse(t.newValue);e&&p0(e.changedParts)}});const n=self.document&&navigator.serviceWorker;n&&n.addEventListener("message",function({data:t}){t&&t.type===Za&&p0(t.changedParts)})}mt.rejectionMapper=function(n,t){if(!n||n instanceof Jd||n instanceof TypeError||n instanceof SyntaxError||!n.name||!GC[n.name])return n;var e=new GC[n.name](t||n.message,n);return"stack"in n&&ga(e,"stack",{get:function(){return this.inner.stack}}),e},NO(xo,YO);const ce=new Fu("EstudiaPlan");ce.version(1).stores({subjects:"++id, name, color",notes:"++id, title, content, subjectId, tags, createdAt, updatedAt",tasks:"++id, title, description, dueDate, status, priority, subjectId, createdAt, updatedAt",planner:"++id, title, description, startTime, endTime, day, subjectId, createdAt, updatedAt",grades:"++id, title, score, maxScore, weight, subjectId, date, createdAt",pdfs:"++id, title, file, size, subjectId, createdAt, updatedAt"});ce.on("populate",async()=>{await ce.subjects.bulkAdd([{name:"Matemáticas",color:"#ef4444"},{name:"Ciencias",color:"#3b82f6"},{name:"Historia",color:"#f59e0b"},{name:"Literatura",color:"#10b981"},{name:"Inglés",color:"#8b5cf6"}])});const yw=ld("tasks",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.tasks.toArray(),e.value=null}catch(d){console.error("Error fetching tasks:",d),e.value="Error al cargar las tareas"}finally{t.value=!1}}async function s(d){t.value=!0;try{n.value=await ce.tasks.where("subjectId").equals(d).toArray(),e.value=null}catch(h){console.error("Error fetching tasks by subject:",h),e.value="Error al cargar las tareas de la materia"}finally{t.value=!1}}async function i(d){try{const h=new Date().toISOString(),p={...d,createdAt:h,updatedAt:h},g=await ce.tasks.add(p);if(await r(),d.dueDate&&"Notification"in window&&Notification.permission==="granted"){const m=new Date(d.dueDate),b=new Date;if(m>b){const y=new Date(m);y.setDate(y.getDate()-1);const v=y.getTime()-b.getTime();v>0&&setTimeout(()=>{new Notification("Recordatorio de tarea",{body:`La tarea "${d.title}" vence mañana!`,icon:"/estudiaplan/pwa-192x192.png"})},v)}}return g}catch(h){throw console.error("Error adding task:",h),e.value="Error al añadir la tarea",h}}async function o(d,h){try{const p=new Date().toISOString();await ce.tasks.update(d,{...h,updatedAt:p}),await r()}catch(p){throw console.error("Error updating task:",p),e.value="Error al actualizar la tarea",p}}async function a(d){try{await ce.tasks.delete(d),await r()}catch(h){throw console.error("Error deleting task:",h),e.value="Error al eliminar la tarea",h}}const l=Ee(()=>async d=>d?await ce.tasks.get(Number(d)):null);async function c(){t.value=!0;try{const d=await ce.tasks.toArray(),h=new Date;h.setHours(0,0,0,0),n.value=d.filter(p=>{const g=new Date(p.dueDate);return g.setHours(0,0,0,0),g>=h&&p.status!=="completed"}).sort((p,g)=>new Date(p.dueDate)-new Date(g.dueDate)),e.value=null}catch(d){console.error("Error fetching upcoming tasks:",d),e.value="Error al cargar las tareas próximas"}finally{t.value=!1}}async function u(){if("Notification"in window)try{return await Notification.requestPermission()}catch(d){return console.error("Error requesting notification permission:",d),"denied"}return"unsupported"}return{tasks:n,loading:t,error:e,fetchTasks:r,fetchTasksBySubject:s,addTask:i,updateTask:o,deleteTask:a,getTaskById:l,fetchUpcomingTasks:c,requestNotificationPermission:u}}),bw=ld("notes",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.notes.toArray(),e.value=null}catch(u){console.error("Error fetching notes:",u),e.value="Error al cargar los apuntes"}finally{t.value=!1}}async function s(u){t.value=!0;try{n.value=await ce.notes.where("subjectId").equals(u).toArray(),e.value=null}catch(d){console.error("Error fetching notes by subject:",d),e.value="Error al cargar los apuntes de la materia"}finally{t.value=!1}}async function i(u){try{const d=new Date().toISOString(),h={...u,createdAt:d,updatedAt:d},p=await ce.notes.add(h);return await r(),p}catch(d){throw console.error("Error adding note:",d),e.value="Error al añadir el apunte",d}}async function o(u,d){try{const h=new Date().toISOString();await ce.notes.update(u,{...d,updatedAt:h}),await r()}catch(h){throw console.error("Error updating note:",h),e.value="Error al actualizar el apunte",h}}async function a(u){try{await ce.notes.delete(u),await r()}catch(d){throw console.error("Error deleting note:",d),e.value="Error al eliminar el apunte",d}}const l=Ee(()=>async u=>u?await ce.notes.get(Number(u)):null);async function c(u){t.value=!0;try{const d=await ce.notes.toArray(),h=u.toLowerCase();n.value=d.filter(p=>p.title.toLowerCase().includes(h)||p.content.toLowerCase().includes(h)||p.tags&&p.tags.some(g=>g.toLowerCase().includes(h))),e.value=null}catch(d){console.error("Error searching notes:",d),e.value="Error al buscar los apuntes"}finally{t.value=!1}}return{notes:n,loading:t,error:e,fetchNotes:r,fetchNotesBySubject:s,addNote:i,updateNote:o,deleteNote:a,getNoteById:l,searchNotes:c}}),Ra=ld("subjects",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.subjects.toArray(),e.value=null}catch(l){console.error("Error fetching subjects:",l),e.value="Error al cargar las materias"}finally{t.value=!1}}async function s(l){try{const c=await ce.subjects.add(l);return await r(),c}catch(c){throw console.error("Error adding subject:",c),e.value="Error al añadir la materia",c}}async function i(l,c){try{await ce.subjects.update(l,c),await r()}catch(u){throw console.error("Error updating subject:",u),e.value="Error al actualizar la materia",u}}async function o(l){try{await ce.subjects.delete(l),await r()}catch(c){throw console.error("Error deleting subject:",c),e.value="Error al eliminar la materia",c}}const a=Ee(()=>l=>n.value.find(c=>c.id===l));return{subjects:n,loading:t,error:e,fetchSubjects:r,addSubject:s,updateSubject:i,deleteSubject:o,getSubjectById:a}}),LE=ld("planner",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.planner.toArray(),e.value=null}catch(l){console.error("Error fetching events:",l),e.value="Error al cargar los eventos"}finally{t.value=!1}}async function s(l){t.value=!0;try{n.value=await ce.planner.where("day").equals(l).toArray(),e.value=null}catch(c){console.error("Error fetching events by day:",c),e.value="Error al cargar los eventos del día"}finally{t.value=!1}}async function i(l){try{const c=new Date().toISOString(),u={...l,createdAt:c,updatedAt:c},d=await ce.planner.add(u);return await r(),d}catch(c){throw console.error("Error adding event:",c),e.value="Error al añadir el evento",c}}async function o(l,c){try{const u=new Date().toISOString();await ce.planner.update(l,{...c,updatedAt:u}),await r()}catch(u){throw console.error("Error updating event:",u),e.value="Error al actualizar el evento",u}}async function a(l){try{await ce.planner.delete(l),await r()}catch(c){throw console.error("Error deleting event:",c),e.value="Error al eliminar el evento",c}}return{events:n,loading:t,error:e,fetchEvents:r,fetchEventsByDay:s,addEvent:i,updateEvent:o,deleteEvent:a}});function _i(n){const t=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&t==="[object Date]"?new n.constructor(+n):typeof n=="number"||t==="[object Number]"||typeof n=="string"||t==="[object String]"?new Date(n):new Date(NaN)}function Yu(n,t){return n instanceof Date?new n.constructor(t):new Date(t)}const sI=6048e5,QB=864e5;let ZB={};function vw(){return ZB}function yg(n,t){var a,l,c,u;const e=vw(),r=(t==null?void 0:t.weekStartsOn)??((l=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??e.weekStartsOn??((u=(c=e.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=_i(n),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Cb(n){return yg(n,{weekStartsOn:1})}function iI(n){const t=_i(n),e=t.getFullYear(),r=Yu(n,0);r.setFullYear(e+1,0,4),r.setHours(0,0,0,0);const s=Cb(r),i=Yu(n,0);i.setFullYear(e,0,4),i.setHours(0,0,0,0);const o=Cb(i);return t.getTime()>=s.getTime()?e+1:t.getTime()>=o.getTime()?e:e-1}function iT(n){const t=_i(n);return t.setHours(0,0,0,0),t}function oT(n){const t=_i(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function t$(n,t){const e=iT(n),r=iT(t),s=+e-oT(e),i=+r-oT(r);return Math.round((s-i)/QB)}function e$(n){const t=iI(n),e=Yu(n,0);return e.setFullYear(t,0,4),e.setHours(0,0,0,0),Cb(e)}function n$(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function r$(n){if(!n$(n)&&typeof n!="number")return!1;const t=_i(n);return!isNaN(Number(t))}function s$(n){const t=_i(n),e=Yu(n,0);return e.setFullYear(t.getFullYear(),0,1),e.setHours(0,0,0,0),e}const i$={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},o$=(n,t,e)=>{let r;const s=i$[n];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+r:r+" ago":r};function Zd(n){return(t={})=>{const e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}const a$={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},l$={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},c$={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},u$={date:Zd({formats:a$,defaultWidth:"full"}),time:Zd({formats:l$,defaultWidth:"full"}),dateTime:Zd({formats:c$,defaultWidth:"full"})},d$={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},h$=(n,t,e,r)=>d$[n];function co(n){return(t,e)=>{const r=e!=null&&e.context?String(e.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=e!=null&&e.width?String(e.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=e!=null&&e.width?String(e.width):n.defaultWidth;s=n.values[a]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(t):t;return s[i]}}const f$={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},p$={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},g$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},m$={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},y$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},b$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},v$=(n,t)=>{const e=Number(n),r=e%100;if(r>20||r<10)switch(r%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},w$={ordinalNumber:v$,era:co({values:f$,defaultWidth:"wide"}),quarter:co({values:p$,defaultWidth:"wide",argumentCallback:n=>n-1}),month:co({values:g$,defaultWidth:"wide"}),day:co({values:m$,defaultWidth:"wide"}),dayPeriod:co({values:y$,defaultWidth:"wide",formattingValues:b$,defaultFormattingWidth:"wide"})};function uo(n){return(t,e={})=>{const r=e.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?S$(a,d=>d.test(o)):x$(a,d=>d.test(o));let c;c=n.valueCallback?n.valueCallback(l):l,c=e.valueCallback?e.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function x$(n,t){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function S$(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function oI(n){return(t,e={})=>{const r=t.match(n.matchPattern);if(!r)return null;const s=r[0],i=t.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=e.valueCallback?e.valueCallback(o):o;const a=t.slice(s.length);return{value:o,rest:a}}}const A$=/^(\d+)(th|st|nd|rd)?/i,E$=/\d+/i,k$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},C$={any:[/^b/i,/^(a|c)/i]},T$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},M$={any:[/1/i,/2/i,/3/i,/4/i]},P$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},O$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},I$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},R$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},D$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},_$={ordinalNumber:oI({matchPattern:A$,parsePattern:E$,valueCallback:n=>parseInt(n,10)}),era:uo({matchPatterns:k$,defaultMatchWidth:"wide",parsePatterns:C$,defaultParseWidth:"any"}),quarter:uo({matchPatterns:T$,defaultMatchWidth:"wide",parsePatterns:M$,defaultParseWidth:"any",valueCallback:n=>n+1}),month:uo({matchPatterns:P$,defaultMatchWidth:"wide",parsePatterns:O$,defaultParseWidth:"any"}),day:uo({matchPatterns:I$,defaultMatchWidth:"wide",parsePatterns:R$,defaultParseWidth:"any"}),dayPeriod:uo({matchPatterns:D$,defaultMatchWidth:"any",parsePatterns:N$,defaultParseWidth:"any"})},L$={code:"en-US",formatDistance:o$,formatLong:u$,formatRelative:h$,localize:w$,match:_$,options:{weekStartsOn:0,firstWeekContainsDate:1}};function F$(n){const t=_i(n);return t$(t,s$(t))+1}function B$(n){const t=_i(n),e=+Cb(t)-+e$(t);return Math.round(e/sI)+1}function aI(n,t){var u,d,h,p;const e=_i(n),r=e.getFullYear(),s=vw(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,o=Yu(n,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=yg(o,t),l=Yu(n,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=yg(l,t);return e.getTime()>=a.getTime()?r+1:e.getTime()>=c.getTime()?r:r-1}function $$(n,t){var a,l,c,u;const e=vw(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??e.firstWeekContainsDate??((u=(c=e.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=aI(n,t),i=Yu(n,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),yg(i,t)}function j$(n,t){const e=_i(n),r=+yg(e,t)-+$$(e,t);return Math.round(r/sI)+1}function _e(n,t){const e=n<0?"-":"",r=Math.abs(n).toString().padStart(t,"0");return e+r}const La={y(n,t){const e=n.getFullYear(),r=e>0?e:1-e;return _e(t==="yy"?r%100:r,t.length)},M(n,t){const e=n.getMonth();return t==="M"?String(e+1):_e(e+1,2)},d(n,t){return _e(n.getDate(),t.length)},a(n,t){const e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(n,t){return _e(n.getHours()%12||12,t.length)},H(n,t){return _e(n.getHours(),t.length)},m(n,t){return _e(n.getMinutes(),t.length)},s(n,t){return _e(n.getSeconds(),t.length)},S(n,t){const e=t.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,e-3));return _e(s,t.length)}},yd={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},aT={G:function(n,t,e){const r=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(r,{width:"abbreviated"});case"GGGGG":return e.era(r,{width:"narrow"});case"GGGG":default:return e.era(r,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return e.ordinalNumber(s,{unit:"year"})}return La.y(n,t)},Y:function(n,t,e,r){const s=aI(n,r),i=s>0?s:1-s;if(t==="YY"){const o=i%100;return _e(o,2)}return t==="Yo"?e.ordinalNumber(i,{unit:"year"}):_e(i,t.length)},R:function(n,t){const e=iI(n);return _e(e,t.length)},u:function(n,t){const e=n.getFullYear();return _e(e,t.length)},Q:function(n,t,e){const r=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return _e(r,2);case"Qo":return e.ordinalNumber(r,{unit:"quarter"});case"QQQ":return e.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,t,e){const r=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return _e(r,2);case"qo":return e.ordinalNumber(r,{unit:"quarter"});case"qqq":return e.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,t,e){const r=n.getMonth();switch(t){case"M":case"MM":return La.M(n,t);case"Mo":return e.ordinalNumber(r+1,{unit:"month"});case"MMM":return e.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(r,{width:"wide",context:"formatting"})}},L:function(n,t,e){const r=n.getMonth();switch(t){case"L":return String(r+1);case"LL":return _e(r+1,2);case"Lo":return e.ordinalNumber(r+1,{unit:"month"});case"LLL":return e.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(r,{width:"wide",context:"standalone"})}},w:function(n,t,e,r){const s=j$(n,r);return t==="wo"?e.ordinalNumber(s,{unit:"week"}):_e(s,t.length)},I:function(n,t,e){const r=B$(n);return t==="Io"?e.ordinalNumber(r,{unit:"week"}):_e(r,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):La.d(n,t)},D:function(n,t,e){const r=F$(n);return t==="Do"?e.ordinalNumber(r,{unit:"dayOfYear"}):_e(r,t.length)},E:function(n,t,e){const r=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(r,{width:"short",context:"formatting"});case"EEEE":default:return e.day(r,{width:"wide",context:"formatting"})}},e:function(n,t,e,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return _e(i,2);case"eo":return e.ordinalNumber(i,{unit:"day"});case"eee":return e.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(s,{width:"short",context:"formatting"});case"eeee":default:return e.day(s,{width:"wide",context:"formatting"})}},c:function(n,t,e,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return _e(i,t.length);case"co":return e.ordinalNumber(i,{unit:"day"});case"ccc":return e.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(s,{width:"narrow",context:"standalone"});case"cccccc":return e.day(s,{width:"short",context:"standalone"});case"cccc":default:return e.day(s,{width:"wide",context:"standalone"})}},i:function(n,t,e){const r=n.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return _e(s,t.length);case"io":return e.ordinalNumber(s,{unit:"day"});case"iii":return e.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(r,{width:"short",context:"formatting"});case"iiii":default:return e.day(r,{width:"wide",context:"formatting"})}},a:function(n,t,e){const s=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,t,e){const r=n.getHours();let s;switch(r===12?s=yd.noon:r===0?s=yd.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,t,e){const r=n.getHours();let s;switch(r>=17?s=yd.evening:r>=12?s=yd.afternoon:r>=4?s=yd.morning:s=yd.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let r=n.getHours()%12;return r===0&&(r=12),e.ordinalNumber(r,{unit:"hour"})}return La.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):La.H(n,t)},K:function(n,t,e){const r=n.getHours()%12;return t==="Ko"?e.ordinalNumber(r,{unit:"hour"}):_e(r,t.length)},k:function(n,t,e){let r=n.getHours();return r===0&&(r=24),t==="ko"?e.ordinalNumber(r,{unit:"hour"}):_e(r,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):La.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):La.s(n,t)},S:function(n,t){return La.S(n,t)},X:function(n,t,e){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return cT(r);case"XXXX":case"XX":return pc(r);case"XXXXX":case"XXX":default:return pc(r,":")}},x:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"x":return cT(r);case"xxxx":case"xx":return pc(r);case"xxxxx":case"xxx":default:return pc(r,":")}},O:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+lT(r,":");case"OOOO":default:return"GMT"+pc(r,":")}},z:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+lT(r,":");case"zzzz":default:return"GMT"+pc(r,":")}},t:function(n,t,e){const r=Math.trunc(n.getTime()/1e3);return _e(r,t.length)},T:function(n,t,e){const r=n.getTime();return _e(r,t.length)}};function lT(n,t=""){const e=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),i=r%60;return i===0?e+String(s):e+String(s)+t+_e(i,2)}function cT(n,t){return n%60===0?(n>0?"-":"+")+_e(Math.abs(n)/60,2):pc(n,t)}function pc(n,t=""){const e=n>0?"-":"+",r=Math.abs(n),s=_e(Math.trunc(r/60),2),i=_e(r%60,2);return e+s+t+i}const uT=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},lI=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},H$=(n,t)=>{const e=n.match(/(P+)(p+)?/)||[],r=e[1],s=e[2];if(!s)return uT(n,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",uT(r,t)).replace("{{time}}",lI(s,t))},V$={p:lI,P:H$},z$=/^D+$/,U$=/^Y+$/,W$=["D","DD","YY","YYYY"];function K$(n){return z$.test(n)}function G$(n){return U$.test(n)}function Y$(n,t,e){const r=X$(n,t,e);if(console.warn(r),W$.includes(n))throw new RangeError(r)}function X$(n,t,e){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${r} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const q$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,J$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Q$=/^'([^]*?)'?$/,Z$=/''/g,tj=/[a-zA-Z]/;function Zs(n,t,e){var u,d,h,p,g,m,b,y;const r=vw(),s=(e==null?void 0:e.locale)??r.locale??L$,i=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,o=(e==null?void 0:e.weekStartsOn)??((m=(g=e==null?void 0:e.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??r.weekStartsOn??((y=(b=r.locale)==null?void 0:b.options)==null?void 0:y.weekStartsOn)??0,a=_i(n);if(!r$(a))throw new RangeError("Invalid time value");let l=t.match(J$).map(v=>{const x=v[0];if(x==="p"||x==="P"){const S=V$[x];return S(v,s.formatLong)}return v}).join("").match(q$).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const x=v[0];if(x==="'")return{isToken:!1,value:ej(v)};if(aT[x])return{isToken:!0,value:v};if(x.match(tj))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(v=>{if(!v.isToken)return v.value;const x=v.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&G$(x)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&K$(x))&&Y$(x,t,String(n));const S=aT[x[0]];return S(a,x,s.localize,c)}).join("")}function ej(n){const t=n.match(Q$);return t?t[1].replace(Z$,"'"):n}const nj={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},rj=(n,t,e)=>{let r;const s=nj[n];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"en "+r:"hace "+r:r},sj={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},ij={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},oj={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aj={date:Zd({formats:sj,defaultWidth:"full"}),time:Zd({formats:ij,defaultWidth:"full"}),dateTime:Zd({formats:oj,defaultWidth:"full"})},lj={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},cj={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},uj=(n,t,e,r)=>t.getHours()!==1?cj[n]:lj[n],dj={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},hj={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},fj={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},pj={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},gj={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},mj={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},yj=(n,t)=>Number(n)+"º",bj={ordinalNumber:yj,era:co({values:dj,defaultWidth:"wide"}),quarter:co({values:hj,defaultWidth:"wide",argumentCallback:n=>Number(n)-1}),month:co({values:fj,defaultWidth:"wide"}),day:co({values:pj,defaultWidth:"wide"}),dayPeriod:co({values:gj,defaultWidth:"wide",formattingValues:mj,defaultFormattingWidth:"wide"})},vj=/^(\d+)(º)?/i,wj=/\d+/i,xj={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},Sj={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Aj={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Ej={any:[/1/i,/2/i,/3/i,/4/i]},kj={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Cj={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Tj={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Mj={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Pj={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},Oj={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Ij={ordinalNumber:oI({matchPattern:vj,parsePattern:wj,valueCallback:function(n){return parseInt(n,10)}}),era:uo({matchPatterns:xj,defaultMatchWidth:"wide",parsePatterns:Sj,defaultParseWidth:"any"}),quarter:uo({matchPatterns:Aj,defaultMatchWidth:"wide",parsePatterns:Ej,defaultParseWidth:"any",valueCallback:n=>n+1}),month:uo({matchPatterns:kj,defaultMatchWidth:"wide",parsePatterns:Cj,defaultParseWidth:"any"}),day:uo({matchPatterns:Tj,defaultMatchWidth:"wide",parsePatterns:Mj,defaultParseWidth:"any"}),dayPeriod:uo({matchPatterns:Pj,defaultMatchWidth:"any",parsePatterns:Oj,defaultParseWidth:"any"})},Nl={code:"es",formatDistance:rj,formatLong:aj,formatRelative:uj,localize:bj,match:Ij,options:{weekStartsOn:1,firstWeekContainsDate:1}},Rj={class:"mb-6"},Dj={class:"text-sm text-gray-500 dark:text-gray-400"},Nj={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_j={class:"card"},Lj={class:"flex justify-between items-center mb-4"},Fj={key:0,class:"py-4 text-center text-gray-500 dark:text-gray-400"},Bj={key:1,class:"py-4 text-center text-gray-500 dark:text-gray-400"},$j={key:2,class:"space-y-3"},jj={class:"flex justify-between items-start"},Hj={class:"font-medium text-gray-900 dark:text-white"},Vj={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},zj={class:"flex items-center"},Uj={class:"mt-2 flex items-center"},Wj={class:"text-xs text-gray-600 dark:text-gray-300"},Kj={class:"card"},Gj={class:"flex justify-between items-center mb-4"},Yj={key:0,class:"py-4 text-center text-gray-500 dark:text-gray-400"},Xj={key:1,class:"py-4 text-center text-gray-500 dark:text-gray-400"},qj={key:2,class:"space-y-3"},Jj={class:"flex justify-between items-start"},Qj={class:"font-medium text-gray-900 dark:text-white"},Zj={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},tH={class:"mt-2 flex items-center"},eH={class:"text-xs text-gray-600 dark:text-gray-300"},nH={class:"card"},rH={class:"flex justify-between items-center mb-4"},sH={key:0,class:"py-4 text-center text-gray-500 dark:text-gray-400"},iH={key:1,class:"py-4 text-center text-gray-500 dark:text-gray-400"},oH={key:2,class:"space-y-3"},aH={class:"flex justify-between items-start"},lH={class:"font-medium text-gray-900 dark:text-white"},cH={class:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},uH={class:"mt-2 flex items-center"},dH={class:"text-xs text-gray-600 dark:text-gray-300"},hH={class:"card"},fH={class:"grid grid-cols-2 gap-3"},pH={__name:"HomePage",setup(n){const t=yw(),e=bw(),r=Ra(),s=LE(),i=new Date,o=Ee(()=>Zs(i,"EEEE",{locale:Nl})),a=Ee(()=>Zs(i,"d 'de' MMMM, yyyy",{locale:Nl}));qn(async()=>{await r.fetchSubjects(),await t.fetchUpcomingTasks(),await e.fetchNotes();const d=Zs(i,"EEEE",{locale:Nl}).toLowerCase();await s.fetchEventsByDay(d),"Notification"in window&&Notification.permission==="default"&&await t.requestNotificationPermission()});const l=d=>r.subjects.find(h=>h.id===d)||{name:"Sin materia",color:"#94a3b8"},c=d=>{const h={low:"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800",medium:"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800",high:"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800"};return h[d]||h.medium},u=d=>d?d.substring(0,5):"";return(d,h)=>{const p=Ia("router-link");return K(),Y("div",null,[A("div",Rj,[A("p",Dj,pt(o.value)+", "+pt(a.value),1),h[0]||(h[0]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},"Bienvenido a EstudiaPlan",-1))]),A("div",Nj,[A("div",_j,[A("div",Lj,[h[2]||(h[2]=A("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Tareas Próximas",-1)),bt(p,{to:"/tasks",class:"text-sm text-primary-600 dark:text-primary-400 hover:underline"},{default:Se(()=>h[1]||(h[1]=[ge(" Ver todas ")])),_:1,__:[1]})]),ee(t).loading?(K(),Y("div",Fj," Cargando tareas... ")):ee(t).tasks.length===0?(K(),Y("div",Bj," No hay tareas próximas ")):(K(),Y("div",$j,[(K(!0),Y(ae,null,ln(ee(t).tasks.slice(0,5),g=>(K(),Yl(p,{key:g.id,to:`/tasks/${g.id}`,class:"block p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>[A("div",jj,[A("div",null,[A("h3",Hj,pt(g.title),1),A("p",Vj," Vence: "+pt(ee(Zs)(new Date(g.dueDate),"d MMM",{locale:ee(Nl)})),1)]),A("div",zj,[A("span",{class:Kt(["inline-block px-2 py-1 text-xs rounded-full border",c(g.priority)])},pt(g.priority==="low"?"Baja":g.priority==="medium"?"Media":"Alta"),3)])]),A("div",Uj,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:l(g.subjectId).color})},null,4),A("span",Wj,pt(l(g.subjectId).name),1)])]),_:2},1032,["to"]))),128))]))]),A("div",Kj,[A("div",Gj,[h[4]||(h[4]=A("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Horario de Hoy",-1)),bt(p,{to:"/planner",class:"text-sm text-primary-600 dark:text-primary-400 hover:underline"},{default:Se(()=>h[3]||(h[3]=[ge(" Ver calendario ")])),_:1,__:[3]})]),ee(s).loading?(K(),Y("div",Yj," Cargando horario... ")):ee(s).events.length===0?(K(),Y("div",Xj," No hay eventos programados para hoy ")):(K(),Y("div",qj,[(K(!0),Y(ae,null,ln(ee(s).events,g=>(K(),Y("div",{key:g.id,class:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg"},[A("div",Jj,[A("div",null,[A("h3",Qj,pt(g.title),1),A("p",Zj,pt(u(g.startTime))+" - "+pt(u(g.endTime)),1)])]),A("div",tH,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:l(g.subjectId).color})},null,4),A("span",eH,pt(l(g.subjectId).name),1)])]))),128))]))]),A("div",nH,[A("div",rH,[h[6]||(h[6]=A("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Apuntes Recientes",-1)),bt(p,{to:"/notes",class:"text-sm text-primary-600 dark:text-primary-400 hover:underline"},{default:Se(()=>h[5]||(h[5]=[ge(" Ver todos ")])),_:1,__:[5]})]),ee(e).loading?(K(),Y("div",sH," Cargando apuntes... ")):ee(e).notes.length===0?(K(),Y("div",iH," No hay apuntes guardados ")):(K(),Y("div",oH,[(K(!0),Y(ae,null,ln(ee(e).notes.slice(0,5),g=>(K(),Yl(p,{key:g.id,to:`/notes/${g.id}`,class:"block p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>[A("div",aH,[A("div",null,[A("h3",lH,pt(g.title),1),A("p",cH,pt(g.content.replace(/<[^>]*>?/gm,"")),1)])]),A("div",uH,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:l(g.subjectId).color})},null,4),A("span",dH,pt(l(g.subjectId).name),1)])]),_:2},1032,["to"]))),128))]))]),A("div",hH,[h[11]||(h[11]=A("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Acciones Rápidas",-1)),A("div",fH,[bt(p,{to:"/notes/new",class:"flex flex-col items-center justify-center p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>h[7]||(h[7]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-primary-600 dark:text-primary-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),A("span",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Nuevo Apunte",-1)])),_:1,__:[7]}),bt(p,{to:"/tasks/new",class:"flex flex-col items-center justify-center p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>h[8]||(h[8]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-primary-600 dark:text-primary-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),A("span",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Nueva Tarea",-1)])),_:1,__:[8]}),bt(p,{to:"/grades",class:"flex flex-col items-center justify-center p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>h[9]||(h[9]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-primary-600 dark:text-primary-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),A("span",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Registrar Nota",-1)])),_:1,__:[9]}),bt(p,{to:"/pdfs",class:"flex flex-col items-center justify-center p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors"},{default:Se(()=>h[10]||(h[10]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-primary-600 dark:text-primary-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),A("span",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Subir PDF",-1)])),_:1,__:[10]})])])])])}}},gH={class:"relative w-full"},mH=["placeholder"],FE={__name:"SearchBar",props:{placeholder:{type:String,default:"Buscar..."}},emits:["search"],setup(n,{emit:t}){const e=t,r=ot(""),s=ot(null);Mi(r,o=>{s.value&&clearTimeout(s.value),s.value=setTimeout(()=>{e("search",o)},300)});const i=()=>{r.value="",e("search","")};return(o,a)=>(K(),Y("div",gH,[a[2]||(a[2]=A("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),Le(A("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=l=>r.value=l),placeholder:n.placeholder,class:"input pl-10 pr-10"},null,8,mH),[[cn,r.value]]),r.value?(K(),Y("button",{key:0,onClick:i,class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"},a[1]||(a[1]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):Re("",!0)]))}},yH={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},bH={key:0,class:"text-red-500"},vH={key:0,class:"mb-4"},wH={class:"grid grid-cols-2 gap-2"},xH=["onClick"],SH={key:1,class:"mb-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-slate-900"},AH={class:"mb-3"},EH={class:"mb-3"},kH={class:"flex space-x-2"},CH=["disabled"],yf={__name:"SubjectSelector",props:{modelValue:{type:Number,default:null},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:t}){const e=t,r=Ra(),s=ot(!1),i=ot(""),o=ot("#3b82f6");qn(async()=>{await r.fetchSubjects()});const a=c=>{e("update:modelValue",c)},l=async()=>{if(i.value.trim()){const c={name:i.value.trim(),color:o.value},u=await r.addSubject(c);e("update:modelValue",u),i.value="",o.value="#3b82f6",s.value=!1}};return(c,u)=>(K(),Y("div",null,[A("label",yH,[u[4]||(u[4]=ge(" Materia ")),n.required?(K(),Y("span",bH,"*")):Re("",!0)]),s.value?(K(),Y("div",SH,[A("div",AH,[u[5]||(u[5]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Nombre de la materia ",-1)),Le(A("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=d=>i.value=d),placeholder:"Ej: Física",class:"input"},null,512),[[cn,i.value]])]),A("div",EH,[u[6]||(u[6]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Color ",-1)),Le(A("input",{type:"color","onUpdate:modelValue":u[2]||(u[2]=d=>o.value=d),class:"w-full h-10 rounded-lg cursor-pointer"},null,512),[[cn,o.value]])]),A("div",kH,[A("button",{onClick:u[3]||(u[3]=d=>s.value=!1),class:"flex-1 py-2 px-4 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:l,class:"flex-1 py-2 px-4 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",disabled:!i.value.trim()}," Guardar ",8,CH)])])):(K(),Y("div",vH,[A("div",wH,[(K(!0),Y(ae,null,ln(ee(r).subjects,d=>(K(),Y("button",{key:d.id,onClick:h=>a(d.id),class:Kt(["px-3 py-2 rounded-lg flex items-center justify-between text-sm transition-colors",n.modelValue===d.id?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500 text-primary-700 dark:text-primary-300":"bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},[ge(pt(d.name)+" ",1),A("span",{class:"w-4 h-4 rounded-full",style:Wn({backgroundColor:d.color})},null,4)],10,xH))),128))]),A("button",{onClick:u[0]||(u[0]=d=>s.value=!0),class:"mt-2 w-full py-2 px-3 text-sm text-gray-600 dark:text-gray-400 border border-dashed border-gray-300 dark:border-gray-700 rounded-lg hover:text-primary-600 dark:hover:text-primary-400 hover:border-primary-500 dark:hover:border-primary-500 transition-colors"}," + Añadir nueva materia ")]))]))}},TH={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},MH={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},PH={class:"md:col-span-2"},OH={key:0,class:"text-center py-8"},IH={key:1,class:"text-center py-8"},RH={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},DH={class:"mb-2 flex items-center"},NH={class:"text-xs text-gray-600 dark:text-gray-300"},_H={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},LH={class:"text-sm text-gray-600 dark:text-gray-300 mb-3 line-clamp-3 prose-sm prose-p:my-0"},FH=["innerHTML"],BH={key:0,class:"mb-3 flex flex-wrap gap-1"},$H={class:"text-xs text-gray-500 dark:text-gray-400"},jH={__name:"NotesPage",setup(n){const t=bw(),e=Ra(),r=ot(null),s=ot("");qn(async()=>{await e.fetchSubjects(),await t.fetchNotes()});const i=Ee(()=>{let u=t.notes;if(r.value&&(u=u.filter(d=>d.subjectId===r.value)),s.value){const d=s.value.toLowerCase();u=u.filter(h=>h.title.toLowerCase().includes(d)||h.content.toLowerCase().includes(d)||h.tags&&h.tags.some(p=>p.toLowerCase().includes(d)))}return[...u].sort((d,h)=>new Date(h.updatedAt)-new Date(d.updatedAt))}),o=u=>Zs(new Date(u),"d MMM, yyyy",{locale:Nl}),a=u=>e.subjects.find(d=>d.id===u)||{name:"Sin materia",color:"#94a3b8"},l=u=>{s.value=u},c=()=>{r.value=null,s.value=""};return(u,d)=>{const h=Ia("router-link");return K(),Y("div",null,[A("div",TH,[d[2]||(d[2]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Apuntes de Clase",-1)),bt(h,{to:"/notes/new",class:"btn btn-primary flex items-center justify-center"},{default:Se(()=>d[1]||(d[1]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ge(" Nuevo Apunte ")])),_:1,__:[1]})]),A("div",MH,[A("div",PH,[bt(FE,{placeholder:"Buscar por título o contenido...",onSearch:l})]),A("div",null,[bt(yf,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=p=>r.value=p)},null,8,["modelValue"])])]),ee(t).loading?(K(),Y("div",OH,d[3]||(d[3]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando apuntes...",-1)]))):i.value.length===0?(K(),Y("div",IH,[d[4]||(d[4]=A("p",{class:"text-gray-500 dark:text-gray-400"},"No se encontraron apuntes",-1)),r.value||s.value?(K(),Y("button",{key:0,onClick:c,class:"mt-2 text-primary-600 dark:text-primary-400 hover:underline"}," Borrar filtros ")):Re("",!0)])):(K(),Y("div",RH,[(K(!0),Y(ae,null,ln(i.value,p=>(K(),Yl(h,{key:p.id,to:`/notes/${p.id}`,class:"card hover:shadow-lg transition-shadow cursor-pointer"},{default:Se(()=>[A("div",DH,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:a(p.subjectId).color})},null,4),A("span",NH,pt(a(p.subjectId).name),1)]),A("h3",_H,pt(p.title),1),A("div",LH,[A("div",{innerHTML:p.content.substring(0,150)+(p.content.length>150?"...":"")},null,8,FH)]),p.tags&&p.tags.length>0?(K(),Y("div",BH,[(K(!0),Y(ae,null,ln(p.tags,(g,m)=>(K(),Y("span",{key:m,class:"inline-block px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},pt(g),1))),128))])):Re("",!0),A("div",$H," Última actualización: "+pt(o(p.updatedAt)),1)]),_:2},1032,["to"]))),128))]))])}}};function rr(n){this.content=n}rr.prototype={constructor:rr,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(e||n,t):(i[s+1]=t,e&&(i[s]=e)),new rr(i)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new rr(e)},addToStart:function(n,t){return new rr([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new rr(e)},addBefore:function(n,t,e){var r=this.remove(t),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,t,e),new rr(s)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=rr.from(n),n.size?new rr(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=rr.from(n),n.size?new rr(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=rr.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}};rr.from=function(n){if(n instanceof rr)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new rr(t)};function cI(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let s=n.child(r),i=t.child(r);if(s==i){e+=s.nodeSize;continue}if(!s.sameMarkup(i))return e;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)e++;return e}if(s.content.size||i.content.size){let o=cI(s.content,i.content,e+1);if(o!=null)return o}e+=s.nodeSize}}function uI(n,t,e,r){for(let s=n.childCount,i=t.childCount;;){if(s==0||i==0)return s==i?null:{a:e,b:r};let o=n.child(--s),a=t.child(--i),l=o.nodeSize;if(o==a){e-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:e,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,e--,r--;return{a:e,b:r}}if(o.content.size||a.content.size){let c=uI(o.content,a.content,e-1,r-1);if(c)return c}e-=l,r-=l}}class Z{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,s=0,i){for(let o=0,a=0;a<e;o++){let l=this.content[o],c=a+l.nodeSize;if(c>t&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,t-u),Math.min(l.content.size,e-u),r,s+u)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,s){let i="",o=!0;return this.nodesBetween(t,e,(a,l)=>{let c=a.isText?a.text.slice(Math.max(t,l)-l,e-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,s=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(r)&&(s[s.length-1]=e.withText(e.text+r.text),i=1);i<t.content.length;i++)s.push(t.content[i]);return new Z(s,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],s=0;if(e>t)for(let i=0,o=0;o<e;i++){let a=this.content[i],l=o+a.nodeSize;l>t&&((o<t||l>e)&&(a.isText?a=a.cut(Math.max(0,t-o),Math.min(a.text.length,e-o)):a=a.cut(Math.max(0,t-o-1),Math.min(a.content.size,e-o-1))),r.push(a),s+=a.nodeSize),o=l}return new Z(r,s)}cutByIndex(t,e){return t==e?Z.empty:t==0&&e==this.content.length?this:new Z(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let s=this.content.slice(),i=this.size+e.nodeSize-r.nodeSize;return s[t]=e,new Z(s,i)}addToStart(t){return new Z([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Z(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let s=this.content[e];t(s,r,e),r+=s.nodeSize}}findDiffStart(t,e=0){return cI(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return uI(this,t,e,r)}findIndex(t,e=-1){if(t==0)return By(0,t);if(t==this.size)return By(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=t)return o==t||e>0?By(r+1,o):By(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return Z.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Z(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Z.empty;let e,r=0;for(let s=0;s<t.length;s++){let i=t[s];r+=i.nodeSize,s&&i.isText&&t[s-1].sameMarkup(i)?(e||(e=t.slice(0,s)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new Z(e||t,r)}static from(t){if(!t)return Z.empty;if(t instanceof Z)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Z([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Z.empty=new Z([],0);const px={index:0,offset:0};function By(n,t){return px.index=n,px.offset=t,px}function Tb(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!Tb(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!Tb(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}let He=class Q1{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let s=0;s<t.length;s++){let i=t[s];if(this.eq(i))return t;if(this.type.excludes(i.type))e||(e=t.slice(0,s));else{if(i.type.excludes(this.type))return t;!r&&i.type.rank>this.type.rank&&(e||(e=t.slice(0,s)),e.push(this),r=!0),e&&e.push(i)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&Tb(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);let s=r.create(e.attrs);return r.checkAttrs(s.attrs),s}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return Q1.none;if(t instanceof Q1)return[t];let e=t.slice();return e.sort((r,s)=>r.type.rank-s.type.rank),e}};He.none=[];class Mb extends Error{}class ft{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=hI(this.content,t+this.openStart,e);return r&&new ft(r,this.openStart,this.openEnd)}removeBetween(t,e){return new ft(dI(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return ft.empty;let r=e.openStart||0,s=e.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ft(Z.fromJSON(t,e.content),r,s)}static maxOpen(t,e=!0){let r=0,s=0;for(let i=t.firstChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)s++;return new ft(t,r,s)}}ft.empty=new ft(Z.empty,0,0);function dI(n,t,e){let{index:r,offset:s}=n.findIndex(t),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(e);if(s==t||i.isText){if(a!=e&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(dI(i.content,t-s-1,e-s-1)))}function hI(n,t,e,r){let{index:s,offset:i}=n.findIndex(t),o=n.maybeChild(s);if(i==t||o.isText)return n.cut(0,t).append(e).append(n.cut(t));let a=hI(o.content,t-i-1,e);return a&&n.replaceChild(s,o.copy(a))}function HH(n,t,e){if(e.openStart>n.depth)throw new Mb("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new Mb("Inconsistent open depths");return fI(n,t,e,0)}function fI(n,t,e,r){let s=n.index(r),i=n.node(r);if(s==t.index(r)&&r<n.depth-e.openStart){let o=fI(n,t,e,r+1);return i.copy(i.content.replaceChild(s,o))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let o=n.parent,a=o.content;return $u(o,a.cut(0,n.parentOffset).append(e.content).append(a.cut(t.parentOffset)))}else{let{start:o,end:a}=VH(e,n);return $u(i,gI(n,o,a,t,r))}else return $u(i,Pb(n,t,r))}function pI(n,t){if(!t.type.compatibleContent(n.type))throw new Mb("Cannot join "+t.type.name+" onto "+n.type.name)}function Z1(n,t,e){let r=n.node(e);return pI(r,t.node(e)),r}function Bu(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function Fp(n,t,e,r){let s=(t||n).node(e),i=0,o=t?t.index(e):s.childCount;n&&(i=n.index(e),n.depth>e?i++:n.textOffset&&(Bu(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Bu(s.child(a),r);t&&t.depth==e&&t.textOffset&&Bu(t.nodeBefore,r)}function $u(n,t){return n.type.checkContent(t),n.copy(t)}function gI(n,t,e,r,s){let i=n.depth>s&&Z1(n,t,s+1),o=r.depth>s&&Z1(e,r,s+1),a=[];return Fp(null,n,s,a),i&&o&&t.index(s)==e.index(s)?(pI(i,o),Bu($u(i,gI(n,t,e,r,s+1)),a)):(i&&Bu($u(i,Pb(n,t,s+1)),a),Fp(t,e,s,a),o&&Bu($u(o,Pb(e,r,s+1)),a)),Fp(r,null,s,a),new Z(a)}function Pb(n,t,e){let r=[];if(Fp(null,n,e,r),n.depth>e){let s=Z1(n,t,e+1);Bu($u(s,Pb(n,t,e+1)),r)}return Fp(t,null,e,r),new Z(r)}function VH(n,t){let e=t.depth-n.openStart,s=t.node(e).copy(n.content);for(let i=e-1;i>=0;i--)s=t.node(i).copy(Z.from(s));return{start:s.resolveNoCache(n.openStart+e),end:s.resolveNoCache(s.content.size-n.openEnd-e)}}class bg{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=t.child(e);return r?t.child(e).cut(r):s}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],s=e==0?0:this.path[e*3-1]+1;for(let i=0;i<t;i++)s+=r.child(i).nodeSize;return s}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return He.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),s=t.maybeChild(e);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,s=t.parent.maybeChild(t.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new Ob(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],s=0,i=e;for(let o=t;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new bg(e,r,i)}static resolveCached(t,e){let r=dT.get(t);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==e)return o}else dT.set(t,r=new zH);let s=r.elts[r.i]=bg.resolve(t,e);return r.i=(r.i+1)%UH,s}}class zH{constructor(){this.elts=[],this.i=0}}const UH=12,dT=new WeakMap;class Ob{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const WH=Object.create(null);let Hl=class tS{constructor(t,e,r,s=He.none){this.type=t,this.attrs=e,this.marks=s,this.content=r||Z.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,s=0){this.content.nodesBetween(t,e,r,s,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,s){return this.content.textBetween(t,e,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&Tb(this.attrs,e||t.defaultAttrs||WH)&&He.sameSet(this.marks,r||He.none)}copy(t=null){return t==this.content?this:new tS(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new tS(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return ft.empty;let s=this.resolve(t),i=this.resolve(e),o=r?0:s.sharedDepth(e),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new ft(c,s.depth-o,i.depth-o)}replace(t,e,r){return HH(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:s}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(s==t||e.isText)return e;t-=s+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let s=this.content.child(e-1);return{node:s,index:e-1,offset:r-s.nodeSize}}resolve(t){return bg.resolveCached(this,t)}resolveNoCache(t){return bg.resolve(this,t)}rangeHasMark(t,e,r){let s=!1;return e>t&&this.nodesBetween(t,e,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),mI(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=Z.empty,s=0,i=r.childCount){let o=this.contentMatchAt(t).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(t,e,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(t).matchType(r),o=i&&i.matchFragment(this.content,e);return o?o.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=He.none;for(let e=0;e<this.marks.length;e++){let r=this.marks[e];r.type.checkAttrs(r.attrs),t=r.addToSet(t)}if(!He.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let s=Z.fromJSON(t,e.content),i=t.nodeType(e.type).create(e.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};Hl.prototype.text=void 0;class Ib extends Hl{constructor(t,e,r,s){if(super(t,e,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):mI(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new Ib(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new Ib(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function mI(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class Xu{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new KH(t,e);if(r.next==null)return Xu.empty;let s=yI(r);r.next&&r.err("Unexpected trailing text");let i=ZH(QH(s));return t5(i,r),i}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let s=this;for(let i=e;s&&i<r;i++)s=s.matchType(t.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(t,r);if(l&&(!e||l.validEnd))return Z.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(d)==-1){s.push(d);let h=i(d,a.concat(u));if(h)return h}}return null}return i(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(t)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in e)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),e[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let s=0;s<r.next.length;s++)t.indexOf(r.next[s].next)==-1&&e(r.next[s].next)}return e(this),t.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+t.indexOf(r.next[o].next);return i}).join(`
`)}}Xu.empty=new Xu(!0);class KH{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function yI(n){let t=[];do t.push(GH(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function GH(n){let t=[];do t.push(YH(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function YH(n){let t=JH(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=XH(n,t);else break;return t}function hT(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function XH(n,t){let e=hT(n),r=e;return n.eat(",")&&(n.next!="}"?r=hT(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function qH(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let s=[];for(let i in e){let o=e[i];o.isInGroup(t)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+t+"' found"),s}function JH(n){if(n.eat("(")){let t=yI(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=qH(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function QH(n){let t=[[]];return s(i(n,0),e()),t;function e(){return t.push([])-1}function r(o,a,l){let c={term:l,to:a};return t[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=e())}else if(o.type=="star"){let l=e();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=e();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=e();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=e();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function bI(n,t){return t-n}function fT(n,t){let e=[];return r(t),e.sort(bI);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);e.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&e.indexOf(l)==-1&&r(l)}}}function ZH(n){let t=Object.create(null);return e(fT(n,0));function e(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);fT(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=t[r.join(",")]=new Xu(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(bI);i.next.push({type:s[o][0],next:t[a.join(",")]||e(a)})}return i}}function t5(n,t){for(let e=0,r=[n];e<r.length;e++){let s=r[e],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function vI(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function wI(n,t){let e=Object.create(null);for(let r in n){let s=t&&t[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=s}return e}function xI(n,t,e,r){for(let s in t)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${e} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(t[s])}}function SI(n,t){let e=Object.create(null);if(t)for(let r in t)e[r]=new n5(n,r,t[r]);return e}let pT=class AI{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=SI(t,r.attrs),this.defaultAttrs=vI(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Xu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:wI(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Hl(this,this.computeAttrs(t),Z.from(e),He.setFrom(r))}createChecked(t=null,e,r){return e=Z.from(e),this.checkContent(e),new Hl(this,this.computeAttrs(t),e,He.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=Z.from(e),e.size){let o=this.contentMatch.fillBefore(e);if(!o)return null;e=o.append(e)}let s=this.contentMatch.matchFragment(e),i=s&&s.fillBefore(Z.empty,!0);return i?new Hl(this,t,e.append(i),He.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){xI(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:He.none:t}static compile(t,e){let r=Object.create(null);t.forEach((i,o)=>r[i]=new AI(i,e,o));let s=e.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function e5(n,t,e){let r=e.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${n}, got ${i}`)}}class n5{constructor(t,e,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?e5(t,e,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ww{constructor(t,e,r,s){this.name=t,this.rank=e,this.schema=r,this.spec=s,this.attrs=SI(t,s.attrs),this.excluded=null;let i=vI(this.attrs);this.instance=i?new He(this,i):null}create(t=null){return!t&&this.instance?this.instance:new He(this,wI(this.attrs,t))}static compile(t,e){let r=Object.create(null),s=0;return t.forEach((i,o)=>r[i]=new ww(i,s++,e,o)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){xI(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class EI{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let s in t)e[s]=t[s];e.nodes=rr.from(t.nodes),e.marks=rr.from(t.marks||{}),this.nodes=pT.compile(this.spec.nodes,this),this.marks=ww.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Xu.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?gT(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:gT(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,s){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof pT){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,s)}text(t,e){let r=this.nodes.text;return new Ib(r,r.defaultAttrs,t,He.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return Hl.fromJSON(this,t)}markFromJSON(t){return He.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function gT(n,t){let e=[];for(let r=0;r<t.length;r++){let s=t[r],i=n.marks[s],o=i;if(i)e.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&e.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}function r5(n){return n.tag!=null}function s5(n){return n.style!=null}class Vl{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let r=this.matchedStyles=[];e.forEach(s=>{if(r5(s))this.tags.push(s);else if(s5(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=t.nodes[s.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let r=new yT(this,e,!1);return r.addAll(t,He.none,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new yT(this,e,!0);return r.addAll(t,He.none,e.from,e.to),ft.maxOpen(r.finish())}matchTag(t,e,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(a5(t,i.tag)&&(i.namespace===void 0||t.namespaceURI==i.namespace)&&(!i.context||e.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(t);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(t,e,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(t)!=0||o.context&&!r.matchesContext(o.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=e))){if(o.getAttrs){let l=o.getAttrs(e);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(t){let e=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<e.length;o++){let a=e[o];if((a.priority==null?50:a.priority)<i)break}e.splice(o,0,s)}for(let s in t.marks){let i=t.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=bT(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in t.nodes){let i=t.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=bT(o)),o.node||o.ignore||o.mark||(o.node=s)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Vl(t,Vl.schemaRules(t)))}}const kI={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},i5={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},CI={ol:!0,ul:!0},vg=1,eS=2,g0=4;function mT(n,t,e){return t!=null?(t?vg:0)|(t==="full"?eS:0):n&&n.whitespace=="pre"?vg|eS:e&-5}class $y{constructor(t,e,r,s,i,o){this.type=t,this.attrs=e,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=He.none,this.match=i||(o&g0?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(Z.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(t.type))?(this.match=r,s):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&vg)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let e=Z.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(Z.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!kI.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class yT{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=e.topNode,i,o=mT(null,e.preserveWhitespace,0)|(r?g0:0);s?i=new $y(s.type,s.attrs,He.none,!0,e.topMatch||s.type.contentMatch,o):r?i=new $y(null,null,He.none,!0,null,o):i=new $y(t.schema.topNodeType,null,He.none,!0,null,o),this.nodes=[i],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let r=t.nodeValue,s=this.top,i=s.options&eS?"full":this.localPreserveWS||(s.options&vg)>0;if(i==="full"||s.inlineContext(t)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],a=t.previousSibling;(!o||a&&a.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),e,!/\S/.test(r)),this.findInText(t)}else this.findInside(t)}addElement(t,e,r){let s=this.localPreserveWS,i=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let o=t.nodeName.toLowerCase(),a;CI.hasOwnProperty(o)&&this.parser.normalizeLists&&o5(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,r));t:if(l?l.ignore:i5.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,e);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let c,u=this.needsBlock;if(kI.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let d=l&&l.skip?e:this.readStyles(t,e);d&&this.addAll(t,d),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(t,e);c&&this.addElementByRule(t,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let r=t.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?e=e.filter(c=>!l.clearMark(c)):e=e.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return e}addElementByRule(t,e,r,s){let i,o;if(e.node)if(o=this.parser.schema.nodes[e.node],o.isLeaf)this.insertNode(o.create(e.attrs),r,t.nodeName=="BR")||this.leafFallback(t,r);else{let l=this.enter(o,e.attrs||null,r,e.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[e.mark];r=r.concat(l.create(e.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(s)this.addElement(t,r,s);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=t;typeof e.contentElement=="string"?l=t.querySelector(e.contentElement):typeof e.contentElement=="function"?l=e.contentElement(t):e.contentElement&&(l=e.contentElement),this.findAround(t,l,!0),this.addAll(l,r),this.findAround(t,l,!1)}i&&this.sync(a)&&this.open--}addAll(t,e,r,s){let i=r||0;for(let o=r?t.childNodes[r]:t.firstChild,a=s==null?null:t.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(o,e);this.findAtPoint(t,i)}findPlace(t,e,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(t);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)e=this.enterInner(s[o],null,e,!1);return e}insertNode(t,e,r){if(t.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(e=this.enterInner(i,null,e))}let s=this.findPlace(t,e,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(t.type));let o=He.none;for(let a of s.concat(t.marks))(i.type?i.type.allowsMarkType(a.type):vT(a.type,t.type))&&(o=a.addToSet(o));return i.content.push(t.mark(o)),!0}return!1}enter(t,e,r,s){let i=this.findPlace(t.create(e),r,!1);return i&&(i=this.enterInner(t,e,r,!0,s)),i}enterInner(t,e,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(t);let a=mT(t,i,o.options);o.options&g0&&o.content.length==0&&(a|=g0);let l=He.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):vT(c.type,t))?(l=c.addToSet(l),!1):!0),this.nodes.push(new $y(t,e,l,s,null,a)),this.open++,r}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=vg)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let s=r.length-1;s>=0;s--)t+=r[s].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&t.nodeType==1&&t.contains(this.find[s].node)&&e.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=e[a];if(c==""){if(a==e.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}}function o5(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&CI.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function a5(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function bT(n){let t={};for(let e in n)t[e]=n[e];return t}function vT(n,t){let e=t.schema.nodes;for(let r in e){let s=e[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==t||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class ud{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=gx(e).createDocumentFragment());let s=r,i=[];return t.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,e);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:s}=m0(gx(e),this.nodes[t.type.name](t),null,t.attrs);if(s){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,s)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let s=t.marks.length-1;s>=0;s--){let i=this.serializeMark(t.marks[s],t.isInline,e);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(t,e,r={}){let s=this.marks[t.type.name];return s&&m0(gx(r),s(t,e),null,t.attrs)}static renderSpec(t,e,r=null,s){return m0(t,e,r,s)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new ud(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=wT(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return wT(t.marks)}}function wT(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function gx(n){return n.document||window.document}const xT=new WeakMap;function l5(n){let t=xT.get(n);return t===void 0&&xT.set(n,t=c5(n)),t}function c5(n){let t=null;function e(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")t||(t=[]),t.push(r);else for(let s=0;s<r.length;s++)e(r[s]);else for(let s in r)e(r[s])}return e(n),t}function m0(n,t,e,r){if(typeof t=="string")return{dom:n.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=l5(r))&&i.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(e=s.slice(0,o),s=s.slice(o+1));let a,l=e?n.createElementNS(e,s):n.createElement(s),c=t[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<t.length;d++){let h=t[d];if(h===0){if(d<t.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:g}=m0(n,h,e,r);if(l.appendChild(p),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}const TI=65535,MI=Math.pow(2,16);function u5(n,t){return n+t*MI}function ST(n){return n&TI}function d5(n){return(n-(n&TI))/MI}const PI=1,OI=2,y0=4,II=8;class nS{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&II)>0}get deletedBefore(){return(this.delInfo&(PI|y0))>0}get deletedAfter(){return(this.delInfo&(OI|y0))>0}get deletedAcross(){return(this.delInfo&y0)>0}}class Ms{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Ms.empty)return Ms.empty}recover(t){let e=0,r=ST(t);if(!this.inverted)for(let s=0;s<r;s++)e+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+e+d5(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>t)break;let c=this.ranges[a+i],u=this.ranges[a+o],d=l+c;if(t<=d){let h=c?t==l?-1:t==d?1:e:e,p=l+s+(h<0?0:u);if(r)return p;let g=t==(e<0?l:d)?null:u5(a/3,t-l),m=t==l?OI:t==d?PI:y0;return(e<0?t!=l:t!=d)&&(m|=II),new nS(p,m,g)}s+=u-c}return r?t+s:new nS(t+s,0,null)}touches(t,e){let r=0,s=ST(e),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[a+i],u=l+c;if(t<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+e],u=this.ranges[s+r];t(a,a+c,l,l+u),i+=u-c}}invert(){return new Ms(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Ms.empty:new Ms(t<0?[0,-t,0]:[0,0,t])}}Ms.empty=new Ms([]);class wg{constructor(t,e,r=0,s=t?t.length:0){this.mirror=e,this.from=r,this.to=s,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new wg(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),e!=null&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,r=this._maps.length;e<t._maps.length;e++){let s=t.getMirror(e);this.appendMap(t._maps[e],s!=null&&s<e?r+s:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this._maps.length+t._maps.length;e>=0;e--){let s=t.getMirror(e);this.appendMap(t._maps[e].invert(),s!=null&&s>e?r-s-1:void 0)}}invert(){let t=new wg;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this._maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(t,e);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,t=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,t=a.pos}return r?t:new nS(t,s,null)}}const mx=Object.create(null);class Mr{getMap(){return Ms.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=mx[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in mx)throw new RangeError("Duplicate use of step JSON ID "+t);return mx[t]=e,e.prototype.jsonID=t,e}}class kn{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new kn(t,null)}static fail(t){return new kn(null,t)}static fromReplace(t,e,r,s){try{return kn.ok(t.replace(e,r,s))}catch(i){if(i instanceof Mb)return kn.fail(i.message);throw i}}}function BE(n,t,e){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(BE(i.content,t,i))),i.isInline&&(i=t(i,e,s)),r.push(i)}return Z.fromArray(r)}class _l extends Mr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new ft(BE(e.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),e.openStart,e.openEnd);return kn.fromReplace(t,this.from,this.to,i)}invert(){return new ho(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new _l(e.pos,r.pos,this.mark)}merge(t){return t instanceof _l&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new _l(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new _l(e.from,e.to,t.markFromJSON(e.mark))}}Mr.jsonID("addMark",_l);class ho extends Mr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new ft(BE(e.content,s=>s.mark(this.mark.removeFromSet(s.marks)),t),e.openStart,e.openEnd);return kn.fromReplace(t,this.from,this.to,r)}invert(){return new _l(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new ho(e.pos,r.pos,this.mark)}merge(t){return t instanceof ho&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new ho(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ho(e.from,e.to,t.markFromJSON(e.mark))}}Mr.jsonID("removeMark",ho);class Ll extends Mr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return kn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return kn.fromReplace(t,this.pos,this.pos+1,new ft(Z.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let s=0;s<e.marks.length;s++)if(!e.marks[s].isInSet(r))return new Ll(this.pos,e.marks[s]);return new Ll(this.pos,this.mark)}}return new qu(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Ll(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ll(e.pos,t.markFromJSON(e.mark))}}Mr.jsonID("addNodeMark",Ll);class qu extends Mr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return kn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return kn.fromReplace(t,this.pos,this.pos+1,new ft(Z.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new Ll(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new qu(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new qu(e.pos,t.markFromJSON(e.mark))}}Mr.jsonID("removeNodeMark",qu);class Un extends Mr{constructor(t,e,r,s=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=s}apply(t){return this.structure&&rS(t,this.from,this.to)?kn.fail("Structure replace would overwrite content"):kn.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Ms([this.from,this.to-this.from,this.slice.size])}invert(t){return new Un(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new Un(e.pos,Math.max(e.pos,r.pos),this.slice,this.structure)}merge(t){if(!(t instanceof Un)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?ft.empty:new ft(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Un(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?ft.empty:new ft(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Un(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Un(e.from,e.to,ft.fromJSON(t,e.slice),!!e.structure)}}Mr.jsonID("replace",Un);class Kn extends Mr{constructor(t,e,r,s,i,o,a=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(t){if(this.structure&&(rS(t,this.from,this.gapFrom)||rS(t,this.gapTo,this.to)))return kn.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return kn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?kn.fromReplace(t,this.from,this.to,r):kn.fail("Content does not fit in gap")}getMap(){return new Ms([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new Kn(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),s=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||s<e.pos||i>r.pos?null:new Kn(e.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Kn(e.from,e.to,e.gapFrom,e.gapTo,ft.fromJSON(t,e.slice),e.insert,!!e.structure)}}Mr.jsonID("replaceAround",Kn);function rS(n,t,e){let r=n.resolve(t),s=e-t,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function h5(n,t,e,r){let s=[],i=[],o,a;n.doc.nodesBetween(t,e,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,t),p=Math.min(c+l.nodeSize,e),g=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(g)||(o&&o.to==h&&o.mark.eq(d[m])?o.to=p:s.push(o=new ho(h,p,d[m])));a&&a.to==h?a.to=p:i.push(a=new _l(h,p,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function f5(n,t,e,r){let s=[],i=0;n.doc.nodesBetween(t,e,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof ww){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,e);for(let u=0;u<l.length;u++){let d=l[u],h;for(let p=0;p<s.length;p++){let g=s[p];g.step==i-1&&d.eq(s[p].style)&&(h=g)}h?(h.to=c,h.step=i):s.push({style:d,from:Math.max(a,t),to:c,step:i})}}}),s.forEach(o=>n.step(new ho(o.from,o.to,o.style)))}function $E(n,t,e,r=e.contentMatch,s=!0){let i=n.doc.nodeAt(t),o=[],a=t+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)o.push(new Un(a,u,ft.empty));else{r=d;for(let h=0;h<c.marks.length;h++)e.allowsMarkType(c.marks[h].type)||n.step(new ho(a,u,c.marks[h]));if(s&&c.isText&&e.whitespace!="pre"){let h,p=/\r?\n|\r/g,g;for(;h=p.exec(c.text);)g||(g=new ft(Z.from(e.schema.text(" ",e.allowedMarks(c.marks))),0,0)),o.push(new Un(a+h.index,a+h.index+h[0].length,g))}}a=u}if(!r.validEnd){let l=r.fillBefore(Z.empty,!0);n.replace(a,a,new ft(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function p5(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function Rf(n){let e=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,e))return r;if(r==0||s.type.spec.isolating||!p5(s,i,o))break}return null}function g5(n,t,e){let{$from:r,$to:s,depth:i}=t,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=Z.empty,d=0;for(let g=i,m=!1;g>e;g--)m||r.index(g)>0?(m=!0,u=Z.from(r.node(g).copy(u)),d++):l--;let h=Z.empty,p=0;for(let g=i,m=!1;g>e;g--)m||s.after(g+1)<s.end(g)?(m=!0,h=Z.from(s.node(g).copy(h)),p++):c++;n.step(new Kn(l,c,o,a,new ft(u.append(h),d,p),u.size-d,!0))}function jE(n,t,e=null,r=n){let s=m5(n,t),i=s&&y5(r,t);return i?s.map(AT).concat({type:t,attrs:e}).concat(i.map(AT)):null}function AT(n){return{type:n,attrs:null}}function m5(n,t){let{parent:e,startIndex:r,endIndex:s}=n,i=e.contentMatchAt(r).findWrapping(t);if(!i)return null;let o=i.length?i[0]:t;return e.canReplaceWith(r,s,o)?i:null}function y5(n,t){let{parent:e,startIndex:r,endIndex:s}=n,i=e.child(r),o=t.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:t).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(e.child(c).type);return!l||!l.validEnd?null:o}function b5(n,t,e){let r=Z.empty;for(let o=e.length-1;o>=0;o--){if(r.size){let a=e[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Z.from(e[o].type.create(e[o].attrs,r))}let s=t.start,i=t.end;n.step(new Kn(s,i,s,i,new ft(r,0,0),e.length,!0))}function v5(n,t,e,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(t,e,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&w5(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",g=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!g?c=!1:!p&&g&&(c=!0)}c===!1&&DI(n,o,a,i),$E(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),d=u.map(a,1),h=u.map(a+o.nodeSize,1);return n.step(new Kn(d,h,d+1,h-1,new ft(Z.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&RI(n,o,a,i),!1}})}function RI(n,t,e,r){t.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(e+1+i+o.index);n.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function DI(n,t,e,r){t.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(e+1+i);n.replaceWith(o,o+1,t.type.schema.text(`
`))}})}function w5(n,t,e){let r=n.resolve(t),s=r.index();return r.parent.canReplaceWith(s,s+1,e)}function x5(n,t,e,r,s){let i=n.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");e||(e=i.type);let o=e.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(t,t+i.nodeSize,o);if(!e.validContent(i.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new Kn(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new ft(Z.from(o),0,0),1,!0))}function ya(n,t,e=1,r){let s=n.resolve(t),i=s.depth-e,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=e-2;c>i;c--,u--){let d=s.node(c),h=s.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(h,d.childCount),g=r&&r[u+1];g&&(p=p.replaceChild(0,g.type.create(g.attrs)));let m=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(p))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function S5(n,t,e=1,r){let s=n.doc.resolve(t),i=Z.empty,o=Z.empty;for(let a=s.depth,l=s.depth-e,c=e-1;a>l;a--,c--){i=Z.from(s.node(a).copy(i));let u=r&&r[c];o=Z.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new Un(t,t,new ft(i.append(o),e,e),!0))}function sc(n,t){let e=n.resolve(t),r=e.index();return NI(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function A5(n,t){t.content.size||n.type.compatibleContent(t.type);let e=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<t.childCount;s++){let i=t.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(e=e.matchType(o),!e||!n.type.allowsMarks(i.marks))return!1}return e.validEnd}function NI(n,t){return!!(n&&t&&!n.isLeaf&&A5(n,t))}function xw(n,t,e=-1){let r=n.resolve(t);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):e>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&NI(i,o)&&r.node(s).canReplace(a,a+1))return t;if(s==0)break;t=e<0?r.before(s):r.after(s)}}function E5(n,t,e){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(t-e),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",d=!!o.contentMatch.matchType(s);u&&!d?r=!1:!u&&d&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(t+e);DI(n,u.node(),u.before(),a)}o.inlineContent&&$E(n,t+e-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(t-e);if(n.step(new Un(c,l.map(t+e,-1),ft.empty,!0)),r===!0){let u=n.doc.resolve(c);RI(n,u.node(),u.before(),n.steps.length)}return n}function k5(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,e))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,e))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function _I(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let s=e.content;for(let i=0;i<e.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(e.openStart==0&&e.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let d=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Sw(n,t,e=t,r=ft.empty){if(t==e&&!r.size)return null;let s=n.resolve(t),i=n.resolve(e);return LI(s,i,r)?new Un(t,e,r):new C5(s,i,r).fit()}function LI(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class C5{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=Z.empty;for(let s=0;s<=t.depth;s++){let i=t.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(s))})}for(let s=t.depth;s>0;s--)this.placed=Z.from(t.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(t<0?this.$to:r.doc.resolve(t));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new ft(i,o,a);return t>-1?new Kn(r.pos,t,this.$to.pos,this.$to.end(),l,e):l.size||r.pos!=this.$to.pos?new Un(r.pos,s.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<t;r++){let i=e.firstChild;if(e.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){t=r;break}e=i.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=yx(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(e==1&&(o?c.matchType(o.type)||(d=c.fillBefore(Z.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(e==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,s=yx(t,e);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new ft(t,e+1,Math.max(r,s.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,s=yx(t,e);if(s.childCount<=1&&e>0){let i=t.size-e<=e+s.size;this.unplaced=new ft(Jf(t,e-1,1),e-1,i?e-1:r)}else this.unplaced=new ft(Jf(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:s,wrap:i}){for(;this.depth>e;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-t,c=0,u=[],{match:d,type:h}=this.frontier[e];if(s){for(let m=0;m<s.childCount;m++)u.push(s.child(m));d=d.matchFragment(s)}let p=a.size+t-(o.content.size-o.openEnd);for(;c<a.childCount;){let m=a.child(c),b=d.matchType(m.type);if(!b)break;c++,(c>1||l==0||m.content.size)&&(d=b,u.push(FI(m.mark(h.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?p:-1)))}let g=c==a.childCount;g||(p=-1),this.placed=Qf(this.placed,e,Z.from(u)),this.frontier[e].match=d,g&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,b=a;m<p;m++){let y=b.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),b=y.content}this.unplaced=g?t==0?ft.empty:new ft(Jf(o.content,t-1,1),t-1,p<0?o.openEnd:t-1):new ft(Jf(o.content,t,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!bx(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:s}=this.frontier[e],i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),o=bx(t,e,s,r,i);if(o){for(let a=e-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=bx(t,a,c,l,!0);if(!u||u.childCount)continue t}return{depth:e,fit:o,move:i?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Qf(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let s=t.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,t.index(r));this.openFrontierNode(s.type,s.attrs,i)}return t}openFrontierNode(t,e=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(t),this.placed=Qf(this.placed,this.depth,Z.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(Z.empty,!0);e.childCount&&(this.placed=Qf(this.placed,this.frontier.length,e))}}function Jf(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(Jf(n.firstChild.content,t-1,e)))}function Qf(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(Qf(n.lastChild.content,t-1,e)))}function yx(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function FI(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,FI(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(Z.empty,!0)))),n.copy(r)}function bx(n,t,e,r,s){let i=n.node(t),o=s?n.indexAfter(t):n.index(t);if(o==i.childCount&&!e.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!T5(e,i.content,o)?a:null}function T5(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function M5(n){return n.spec.defining||n.spec.definingForContent}function P5(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let s=n.doc.resolve(t),i=n.doc.resolve(e);if(LI(s,i,r))return n.step(new Un(t,e,r));let o=$I(s,n.doc.resolve(e));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let h=s.depth,p=s.pos-1;h>0;h--,p--){let g=s.node(h).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;o.indexOf(h)>-1?a=h:s.before(h)==p&&o.splice(1,0,-h)}let l=o.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let g=h.firstChild;if(c.push(g),p==r.openStart)break;h=g.content}for(let h=u-1;h>=0;h--){let p=c[h],g=M5(p.type);if(g&&!p.sameMarkup(s.node(Math.abs(a)-1)))u=h;else if(g||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+u+1)%(r.openStart+1),g=c[p];if(g)for(let m=0;m<o.length;m++){let b=o[(m+l)%o.length],y=!0;b<0&&(y=!1,b=-b);let v=s.node(b-1),x=s.index(b-1);if(v.canReplaceWith(x,x,g.type,g.marks))return n.replace(s.before(b),y?i.after(b):e,new ft(BI(r.content,0,r.openStart,p),p,r.openEnd))}}let d=n.steps.length;for(let h=o.length-1;h>=0&&(n.replace(t,e,r),!(n.steps.length>d));h--){let p=o[h];p<0||(t=s.before(p),e=i.after(p))}}function BI(n,t,e,r,s){if(t<e){let i=n.firstChild;n=n.replaceChild(0,i.copy(BI(i.content,t+1,e,r,i)))}if(t>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(Z.empty,!0))}return n}function O5(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let s=k5(n.doc,t,r.type);s!=null&&(t=e=s)}n.replaceRange(t,e,new ft(Z.from(r),0,0))}function I5(n,t,e){let r=n.doc.resolve(t),s=n.doc.resolve(e),i=$I(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(t-r.start(o)==r.depth-o&&e>r.end(o)&&s.end(o)-e!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),e);n.delete(t,e)}function $I(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||t.end(s)>t.pos+(t.depth-s)||n.node(s).type.spec.isolating||t.node(s).type.spec.isolating)break;(i==t.start(s)||s==n.depth&&s==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&s&&t.start(s-1)==i-1)&&e.push(s)}return e}class th extends Mr{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return kn.fail("No node at attribute step's position");let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let s=e.type.create(r,null,e.marks);return kn.fromReplace(t,this.pos,this.pos+1,new ft(Z.from(s),0,e.isLeaf?0:1))}getMap(){return Ms.empty}invert(t){return new th(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new th(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new th(e.pos,e.attr,e.value)}}Mr.jsonID("attr",th);class xg extends Mr{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let s in t.attrs)e[s]=t.attrs[s];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return kn.ok(r)}getMap(){return Ms.empty}invert(t){return new xg(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new xg(e.attr,e.value)}}Mr.jsonID("docAttr",xg);let bf=class extends Error{};bf=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e};bf.prototype=Object.create(Error.prototype);bf.prototype.constructor=bf;bf.prototype.name="TransformError";class jI{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new wg}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new bf(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=ft.empty){let s=Sw(this.doc,t,e,r);return s&&this.step(s),this}replaceWith(t,e,r){return this.replace(t,e,new ft(Z.from(r),0,0))}delete(t,e){return this.replace(t,e,ft.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return P5(this,t,e,r),this}replaceRangeWith(t,e,r){return O5(this,t,e,r),this}deleteRange(t,e){return I5(this,t,e),this}lift(t,e){return g5(this,t,e),this}join(t,e=1){return E5(this,t,e),this}wrap(t,e){return b5(this,t,e),this}setBlockType(t,e=t,r,s=null){return v5(this,t,e,r,s),this}setNodeMarkup(t,e,r=null,s){return x5(this,t,e,r,s),this}setNodeAttribute(t,e,r){return this.step(new th(t,e,r)),this}setDocAttribute(t,e){return this.step(new xg(t,e)),this}addNodeMark(t,e){return this.step(new Ll(t,e)),this}removeNodeMark(t,e){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e instanceof He)e.isInSet(r.marks)&&this.step(new qu(t,e));else{let s=r.marks,i,o=[];for(;i=e.isInSet(s);)o.push(new qu(t,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(t,e=1,r){return S5(this,t,e,r),this}addMark(t,e,r){return h5(this,t,e,r),this}removeMark(t,e,r){return f5(this,t,e,r),this}clearIncompatible(t,e,r){return $E(this,t,e,r),this}}const vx=Object.create(null);class re{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new R5(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=ft.empty){let r=e.content.lastChild,s=null;for(let a=0;a<e.openEnd;a++)s=r,r=r.lastChild;let i=t.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=t.mapping.slice(i);t.replaceRange(u.map(l.pos),u.map(c.pos),a?ft.empty:e),a==0&&CT(t,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=t.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?t.deleteRange(c,u):(t.replaceRangeWith(c,u,e),CT(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let s=t.parent.inlineContent?new Gt(t):Td(t.node(0),t.parent,t.pos,t.index(),e,r);if(s)return s;for(let i=t.depth-1;i>=0;i--){let o=e<0?Td(t.node(0),t.node(i),t.before(i+1),t.index(i),e,r):Td(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,e,r);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new Rs(t.node(0))}static atStart(t){return Td(t,t,0,0,1)||new Rs(t)}static atEnd(t){return Td(t,t,t.content.size,t.childCount,-1)||new Rs(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=vx[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in vx)throw new RangeError("Duplicate use of selection JSON ID "+t);return vx[t]=e,e.prototype.jsonID=t,e}getBookmark(){return Gt.between(this.$anchor,this.$head).getBookmark()}}re.prototype.visible=!0;class R5{constructor(t,e){this.$from=t,this.$to=e}}let ET=!1;function kT(n){!ET&&!n.parent.inlineContent&&(ET=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Gt extends re{constructor(t,e=t){kT(t),kT(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return re.near(r);let s=t.resolve(e.map(this.anchor));return new Gt(s.parent.inlineContent?s:r,r)}replace(t,e=ft.empty){if(super.replace(t,e),e==ft.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof Gt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Aw(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Gt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let s=t.resolve(e);return new this(s,r==e?s:t.resolve(r))}static between(t,e,r){let s=t.pos-e.pos;if((!r||s)&&(r=s>=0?1:-1),!e.parent.inlineContent){let i=re.findFrom(e,r,!0)||re.findFrom(e,-r,!0);if(i)e=i.$head;else return re.near(e,r)}return t.parent.inlineContent||(s==0?t=e:(t=(re.findFrom(t,-r,!0)||re.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=s<0&&(t=e))),new Gt(t,e)}}re.jsonID("text",Gt);class Aw{constructor(t,e){this.anchor=t,this.head=e}map(t){return new Aw(t.map(this.anchor),t.map(this.head))}resolve(t){return Gt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Dt extends re{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:s}=e.mapResult(this.anchor),i=t.resolve(s);return r?re.near(i):new Dt(i)}content(){return new ft(Z.from(this.node),0,0)}eq(t){return t instanceof Dt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new HE(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Dt(t.resolve(e.anchor))}static create(t,e){return new Dt(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}Dt.prototype.visible=!1;re.jsonID("node",Dt);class HE{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new Aw(r,r):new HE(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&Dt.isSelectable(r)?new Dt(e):re.near(e)}}class Rs extends re{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=ft.empty){if(e==ft.empty){t.delete(0,t.doc.content.size);let r=re.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new Rs(t)}map(t){return new Rs(t)}eq(t){return t instanceof Rs}getBookmark(){return D5}}re.jsonID("all",Rs);const D5={map(){return this},resolve(n){return new Rs(n)}};function Td(n,t,e,r,s,i=!1){if(t.inlineContent)return Gt.create(n,e);for(let o=r-(s>0?0:1);s>0?o<t.childCount:o>=0;o+=s){let a=t.child(o);if(a.isAtom){if(!i&&Dt.isSelectable(a))return Dt.create(n,e-(s<0?a.nodeSize:0))}else{let l=Td(n,a,e+s,s<0?a.childCount:0,s,i);if(l)return l}e+=a.nodeSize*s}return null}function CT(n,t,e){let r=n.steps.length-1;if(r<t)return;let s=n.steps[r];if(!(s instanceof Un||s instanceof Kn))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(re.near(n.doc.resolve(o),e))}const TT=1,MT=2,PT=4;class N5 extends jI{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|TT)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&TT)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=MT,this}ensureMarks(t){return He.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&MT)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&-3,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||He.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let s=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(s.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),r=r??e,!t)return this.deleteRange(e,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(e);i=r==e?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,s.text(t,i)),this.selection.empty||this.setSelection(re.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=PT,this}get scrolledIntoView(){return(this.updated&PT)>0}}function OT(n,t){return!t||!n?n:n.bind(t)}class Zf{constructor(t,e,r){this.name=t,this.init=OT(e.init,r),this.apply=OT(e.apply,r)}}const _5=[new Zf("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Zf("selection",{init(n,t){return n.selection||re.atStart(t.doc)},apply(n){return n.selection}}),new Zf("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new Zf("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class wx{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=_5.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Zf(r.key,r.spec.state,r))})}}class $d{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<e.length&&a.spec.appendTransaction.call(a,l?e.slice(l):e,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",t),!s){s=[];for(let d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:r,n:e.length}:{state:this,n:0})}e.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:e.length})}}if(!i)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new $d(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];e[i.name]=i.apply(t,this[i.name],this,e)}return e}get tr(){return new N5(this)}static create(t){let e=new wx(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new $d(e);for(let s=0;s<e.fields.length;s++)r[e.fields[s].name]=e.fields[s].init(t,r);return r}reconfigure(t){let e=new wx(this.schema,t.plugins),r=e.fields,s=new $d(e);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(t,s)}return s}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=t[r],i=s.spec.state;i&&i.toJSON&&(e[r]=i.toJSON.call(s,this[s.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let s=new wx(t.schema,t.plugins),i=new $d(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Hl.fromJSON(t.schema,e.doc);else if(o.name=="selection")i.selection=re.fromJSON(i.doc,e.selection);else if(o.name=="storedMarks")e.storedMarks&&(i.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,a)){i[o.name]=c.fromJSON.call(l,t,e[a],i);return}}i[o.name]=o.init(t,i)}}),i}}function HI(n,t,e){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(t):r=="handleDOMEvents"&&(s=HI(s,t,{})),e[r]=s}return e}class cr{constructor(t){this.spec=t,this.props={},t.props&&HI(t.props,this,this.props),this.key=t.key?t.key.key:VI("plugin")}getState(t){return t[this.key]}}const xx=Object.create(null);function VI(n){return n in xx?n+"$"+ ++xx[n]:(xx[n]=0,n+"$")}class Ls{constructor(t="key"){this.key=VI(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const or=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},vf=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let sS=null;const Do=function(n,t,e){let r=sS||(sS=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},L5=function(){sS=null},Ju=function(n,t,e,r){return e&&(IT(n,t,e,r,-1)||IT(n,t,e,r,1))},F5=/^(img|br|input|textarea|hr)$/i;function IT(n,t,e,r,s){for(;;){if(n==e&&t==r)return!0;if(t==(s<0?0:qs(n))){let i=n.parentNode;if(!i||i.nodeType!=1||hy(n)||F5.test(n.nodeName)||n.contentEditable=="false")return!1;t=or(n)+(s<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[t+(s<0?-1:0)],n.contentEditable=="false")return!1;t=s<0?qs(n):0}else return!1}}function qs(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function B5(n,t){for(;;){if(n.nodeType==3&&t)return n;if(n.nodeType==1&&t>0){if(n.contentEditable=="false")return null;n=n.childNodes[t-1],t=qs(n)}else if(n.parentNode&&!hy(n))t=or(n),n=n.parentNode;else return null}}function $5(n,t){for(;;){if(n.nodeType==3&&t<n.nodeValue.length)return n;if(n.nodeType==1&&t<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[t],t=0}else if(n.parentNode&&!hy(n))t=or(n)+1,n=n.parentNode;else return null}}function j5(n,t,e){for(let r=t==0,s=t==qs(n);r||s;){if(n==e)return!0;let i=or(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==qs(n)}}function hy(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const Ew=function(n){return n.focusNode&&Ju(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function vc(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function H5(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function V5(n,t,e){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(t,e);if(r)return{node:r.offsetNode,offset:Math.min(qs(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(t,e);if(r)return{node:r.startContainer,offset:Math.min(qs(r.startContainer),r.startOffset)}}}const yo=typeof navigator<"u"?navigator:null,RT=typeof document<"u"?document:null,ic=yo&&yo.userAgent||"",iS=/Edge\/(\d+)/.exec(ic),zI=/MSIE \d/.exec(ic),oS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ic),ls=!!(zI||oS||iS),zl=zI?document.documentMode:oS?+oS[1]:iS?+iS[1]:0,Ri=!ls&&/gecko\/(\d+)/i.test(ic);Ri&&+(/Firefox\/(\d+)/.exec(ic)||[0,0])[1];const aS=!ls&&/Chrome\/(\d+)/.exec(ic),Tr=!!aS,UI=aS?+aS[1]:0,Ur=!ls&&!!yo&&/Apple Computer/.test(yo.vendor),wf=Ur&&(/Mobile\/\w+/.test(ic)||!!yo&&yo.maxTouchPoints>2),Xs=wf||(yo?/Mac/.test(yo.platform):!1),z5=yo?/Win/.test(yo.platform):!1,pa=/Android \d/.test(ic),fy=!!RT&&"webkitFontSmoothing"in RT.documentElement.style,U5=fy?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function W5(n){let t=n.defaultView&&n.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function ko(n,t){return typeof n=="number"?n:n[t]}function K5(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function DT(n,t,e){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=e||n.dom;o;){if(o.nodeType!=1){o=vf(o);continue}let a=o,l=a==i.body,c=l?W5(i):K5(a),u=0,d=0;if(t.top<c.top+ko(r,"top")?d=-(c.top-t.top+ko(s,"top")):t.bottom>c.bottom-ko(r,"bottom")&&(d=t.bottom-t.top>c.bottom-c.top?t.top+ko(s,"top")-c.top:t.bottom-c.bottom+ko(s,"bottom")),t.left<c.left+ko(r,"left")?u=-(c.left-t.left+ko(s,"left")):t.right>c.right-ko(r,"right")&&(u=t.right-c.right+ko(s,"right")),u||d)if(l)i.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,g=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-p,b=a.scrollTop-g;t={left:t.left-m,top:t.top-b,right:t.right-m,bottom:t.bottom-b}}let h=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(h))break;o=h=="absolute"?o.offsetParent:vf(o)}}function G5(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,s;for(let i=(t.left+t.right)/2,o=e+1;o<Math.min(innerHeight,t.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=e-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:WI(n.dom)}}function WI(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=vf(r));return t}function Y5({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;KI(e,r==0?0:r-t)}function KI(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:s,left:i}=n[e];r.scrollTop!=s+t&&(r.scrollTop=s+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let bd=null;function X5(n){if(n.setActive)return n.setActive();if(bd)return n.focus(bd);let t=WI(n);n.focus(bd==null?{get preventScroll(){return bd={preventScroll:!0},!0}}:void 0),bd||(bd=!1,KI(t,0))}function GI(n,t){let e,r=2e8,s,i=0,o=t.top,a=t.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Do(u).getClientRects();else continue;for(let p=0;p<h.length;p++){let g=h[p];if(g.top<=o&&g.bottom>=a){o=Math.max(g.bottom,o),a=Math.min(g.top,a);let m=g.left>t.left?g.left-t.left:g.right<t.left?t.left-g.right:0;if(m<r){e=u,r=m,s=m&&e.nodeType==3?{left:g.right<t.left?g.right:g.left,top:t.top}:t,u.nodeType==1&&m&&(i=d+(t.left>=(g.left+g.right)/2?1:0));continue}}else g.top>t.top&&!l&&g.left<=t.left&&g.right>=t.left&&(l=u,c={left:Math.max(g.left,Math.min(g.right,t.left)),top:g.top});!e&&(t.left>=g.right&&t.top>=g.top||t.left>=g.left&&t.top>=g.bottom)&&(i=d+1)}}return!e&&l&&(e=l,s=c,r=0),e&&e.nodeType==3?q5(e,s):!e||r&&e.nodeType==1?{node:n,offset:i}:GI(e,s)}function q5(n,t){let e=n.nodeValue.length,r=document.createRange();for(let s=0;s<e;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=Ha(r,1);if(i.top!=i.bottom&&VE(t,i))return{node:n,offset:s+(t.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function VE(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function J5(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function Q5(n,t,e){let{node:r,offset:s}=GI(t,e),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&e.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function Z5(n,t,e,r){let s=-1;for(let i=t,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(t,e,-1)}function YI(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(VE(t,c))return YI(o,t,c)}}if((i=(i+1)%r)==s)break}return n}function t6(n,t){let e=n.dom.ownerDocument,r,s=0,i=V5(e,t.left,t.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!VE(t,c)||(o=YI(n.dom,t,c),!o))return null}if(Ur)for(let c=o;r&&c;c=vf(c))c.draggable&&(r=void 0);if(o=J5(o,t),r){if(Ri&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&s++}let c;fy&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=Z5(n,r,s,t))}a==null&&(a=Q5(n,o,t));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function NT(n){return n.top<n.bottom||n.left<n.right}function Ha(n,t){let e=n.getClientRects();if(e.length){let r=e[t<0?0:e.length-1];if(NT(r))return r}return Array.prototype.find.call(e,NT)||n.getBoundingClientRect()}const e6=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function XI(n,t,e){let{node:r,offset:s,atom:i}=n.docView.domFromPos(t,e<0?-1:1),o=fy||Ri;if(r.nodeType==3)if(o&&(e6.test(r.nodeValue)||(e<0?!s:s==r.nodeValue.length))){let l=Ha(Do(r,s,s),e);if(Ri&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=Ha(Do(r,s-1,s-1),-1);if(c.top==l.top){let u=Ha(Do(r,s,s+1),-1);if(u.top!=l.top)return Bf(u,u.left<c.left)}}return l}else{let l=s,c=s,u=e<0?1:-1;return e<0&&!s?(c++,u=-1):e>=0&&s==r.nodeValue.length?(l--,u=1):e<0?l--:c++,Bf(Ha(Do(r,l,c),u),u<0)}if(!n.state.doc.resolve(t-(i||0)).parent.inlineContent){if(i==null&&s&&(e<0||s==qs(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return Sx(l.getBoundingClientRect(),!1)}if(i==null&&s<qs(r)){let l=r.childNodes[s];if(l.nodeType==1)return Sx(l.getBoundingClientRect(),!0)}return Sx(r.getBoundingClientRect(),e>=0)}if(i==null&&s&&(e<0||s==qs(r))){let l=r.childNodes[s-1],c=l.nodeType==3?Do(l,qs(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Bf(Ha(c,1),!1)}if(i==null&&s<qs(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Do(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Bf(Ha(c,-1),!0)}return Bf(Ha(r.nodeType==3?Do(r):r,-e),e>=0)}function Bf(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Sx(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function qI(n,t,e){let r=n.state,s=n.root.activeElement;r!=t&&n.updateState(t),s!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function n6(n,t,e){let r=t.selection,s=e=="up"?r.$from:r.$to;return qI(n,t,()=>{let{node:i}=n.docView.domFromPos(s.pos,e=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=XI(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Do(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(e=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const r6=/[\u0590-\u08ac]/;function s6(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!r6.test(r.parent.textContent)||!a.modify?e=="left"||e=="backward"?i:o:qI(n,t,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",e,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:g,focusOffset:m}=n.domSelectionRange(),b=g&&!p.contains(g.nodeType==1?g:g.parentNode)||l==g&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),b}):r.pos==r.start()||r.pos==r.end()}let _T=null,LT=null,FT=!1;function i6(n,t,e){return _T==t&&LT==e?FT:(_T=t,LT=e,FT=e=="up"||e=="down"?n6(n,t,e):s6(n,t,e))}const ri=0,BT=1,Ec=2,bo=3;class py{constructor(t,e,r,s){this.parent=t,this.children=e,this.dom=r,this.contentDOM=s,this.dirty=ri,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let s=this.children[e];if(s==t)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let i,o;if(t==this.contentDOM)i=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(t==this.dom&&this.contentDOM)s=e>or(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let i=t;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&e==t.childNodes.length)for(let i=t;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,s=t;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!e||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))r=!1;else return i}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let s=t;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let s=this.children[e],i=r+s.size;if(r==t&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(t<i)return s.descAt(t-r-s.border);r=i}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>t||o instanceof QI){s=t-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,e);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof JI&&i.side>=0;r--);if(e<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&e&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,e):{node:this.contentDOM,offset:i?or(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,e):{node:this.contentDOM,offset:i?or(i.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&t<=c){let u=o+l.border;if(t>=u&&e<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,e,u);t=o;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=or(h.dom)+1;break}t-=h.size}s==-1&&(s=0)}if(s>-1&&(c>e||a==this.children.length-1)){e=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=or(d.dom);break}e+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:t,to:e,fromOffset:s,toOffset:i}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,s=!1){let i=Math.min(t,e),o=Math.max(t,e);for(let p=0,g=0;p<this.children.length;p++){let m=this.children[p],b=g+m.size;if(i>g&&o<b)return m.setSelection(t-g-m.border,e-g-m.border,r,s);g=b}let a=this.domFromPos(t,t?-1:1),l=e==t?a:this.domFromPos(e,e?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((Ri||Ur)&&t==e){let{node:p,offset:g}=a;if(p.nodeType==3){if(d=!!(g&&p.nodeValue[g-1]==`
`),d&&g==p.nodeValue.length)for(let m=p,b;m;m=m.parentNode){if(b=m.nextSibling){b.nodeName=="BR"&&(a=l={node:b.parentNode,offset:or(b)+1});break}let y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let m=p.childNodes[g-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Ri&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(s=!0)}if(!(s||d&&Ur)&&Ju(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Ju(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||t==e)&&!d){c.collapse(a.node,a.offset);try{t!=e&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>e){let g=a;a=l,l=g}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?t<=o&&e>=r:t<o&&e>r){let a=r+i.border,l=o-i.border;if(t>=a&&e<=l){this.dirty=t==r||e==o?Ec:BT,t==a&&e==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=bo:i.markDirty(t-a,e-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Ec:bo}r=o}this.dirty=Ec}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Ec:BT;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(t){return!1}}class JI extends py{constructor(t,e,r,s){let i,o=e.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!e.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(t,[],o,null),this.widget=e,this.widget=e,i=this}matchesWidget(t){return this.dirty==ri&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class o6 extends py{constructor(t,e,r,s){super(t,[],e,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class Qu extends py{constructor(t,e,r,s,i){super(t,[],r,s),this.mark=e,this.spec=i}static create(t,e,r,s){let i=s.nodeViews[e.type.name],o=i&&i(e,s,r);return(!o||!o.dom)&&(o=ud.renderSpec(document,e.type.spec.toDOM(e,r),null,e.attrs)),new Qu(t,e,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&bo||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=bo&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=ri){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ri}}slice(t,e,r){let s=Qu.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;e<o&&(i=cS(i,e,o,r)),t>0&&(i=cS(i,0,t,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ul extends py{constructor(t,e,r,s,i,o,a,l,c){super(t,[],i,o),this.node=e,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(t,e,r,s,i,o){let a=i.nodeViews[e.type.name],l,c=a&&a(e,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,d=c&&c.contentDOM;if(e.isText){if(!u)u=document.createTextNode(e.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=ud.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!d&&!e.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),e.type.spec.draggable&&(u.draggable=!0));let h=u;return u=eR(u,r,e),c?l=new a6(t,e,r,s,u,d||null,h,c,i,o+1):e.isText?new kw(t,e,r,s,u,h,i):new Ul(t,e,r,s,u,d||null,h,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Z.empty)}return t}matchesNode(t,e,r){return this.dirty==ri&&t.eq(this.node)&&Rb(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,s=e,i=t.composing?this.localCompositionInfo(t,e):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new c6(this,o&&o.node,t);h6(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,t):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?He.none:this.node.child(u).marks,r,t),l.placeWidget(c,t,s)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,t);let p;l.findNodeMatch(c,u,d,h)||a&&t.state.selection.from>s&&t.state.selection.to<s+c.nodeSize&&(p=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,d,p,t)||l.updateNextNode(c,u,d,t,h,s)||l.addNode(c,u,d,t,s),s+=c.nodeSize}),l.syncToMarks([],r,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Ec)&&(o&&this.protectLocalComposition(t,o),ZI(this.contentDOM,this.children,t),wf&&f6(this.dom))}localCompositionInfo(t,e){let{from:r,to:s}=t.state.selection;if(!(t.state.selection instanceof Gt)||r<e||s>e+this.node.content.size)return null;let i=t.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=p6(this.node.content,o,r-e,s-e);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:s}){if(this.getDesc(e))return;let i=e;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new o6(this,i,e,s);t.input.compositionNodes.push(o),this.children=cS(this.children,r,r+s.length,t,o)}update(t,e,r,s){return this.dirty==bo||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,s),!0)}updateInner(t,e,r,s){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=ri}updateOuterDeco(t){if(Rb(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=tR(this.dom,this.nodeDOM,lS(this.outerDeco,this.node,e),lS(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function $T(n,t,e,r,s){eR(r,t,n);let i=new Ul(void 0,n,t,e,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class kw extends Ul{constructor(t,e,r,s,i,o,a){super(t,e,r,s,i,null,o,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,s){return this.dirty==bo||this.dirty!=ri&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=ri||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=t,this.dirty=ri,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let s=this.node.cut(t,e),i=document.createTextNode(s.text);return new kw(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=bo)}get domAtom(){return!1}isText(t){return this.node.text==t}}class QI extends py{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==ri&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class a6 extends Ul{constructor(t,e,r,s,i,o,a,l,c,u){super(t,e,r,s,i,o,a,c,u),this.spec=l}update(t,e,r,s){if(this.dirty==bo)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let i=this.spec.update(t,e,r);return i&&this.updateInner(t,e,r,s),i}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,s){this.spec.setSelection?this.spec.setSelection(t,e,r.root):super.setSelection(t,e,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function ZI(n,t,e){let r=n.firstChild,s=!1;for(let i=0;i<t.length;i++){let o=t[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=jT(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof Qu){let l=r?r.previousSibling:n.lastChild;ZI(o.contentDOM,o.children,e),r=l?l.nextSibling:n.firstChild}}for(;r;)r=jT(r),s=!0;s&&e.trackWrites==n&&(e.trackWrites=null)}const Bp=function(n){n&&(this.nodeName=n)};Bp.prototype=Object.create(null);const kc=[new Bp];function lS(n,t,e){if(n.length==0)return kc;let r=e?kc[0]:new Bp,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new Bp(o.nodeName));for(let a in o){let l=o[a];l!=null&&(e&&s.length==1&&s.push(r=new Bp(t.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function tR(n,t,e,r){if(e==kc&&r==kc)return t;let s=t;for(let i=0;i<r.length;i++){let o=r[i],a=e[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=kc[0]),s=l}l6(s,a||kc[0],o)}return s}function l6(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],s=e.class?e.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(t.style);)n.style.removeProperty(s[1])}e.style&&(n.style.cssText+=e.style)}}function eR(n,t,e){return tR(n,n,kc,lS(t,e,n.nodeType!=1))}function Rb(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function jT(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class c6{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=u6(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r){let s=0,i=this.stack.length>>1,o=Math.min(i,t.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=ri,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(t[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Qu.create(this.top,t[i],e,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(t,e,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,e,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(t,e,r,s,i){let o=this.top.children[s];return o.dirty==bo&&o.dom==o.contentDOM&&(o.dirty=Ec),o.update(t,e,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}t=e}}updateNextNode(t,e,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Ul){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=bo&&Rb(e,l.outerDeco));if(!h&&l.update(t,e,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,t,e,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Ec,d.updateChildren(s,o+1),d.dirty=ri),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,r,s,i,o){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!Rb(r,t.outerDeco)||!s.eq(t.innerDeco))return null;let a=Ul.create(this.top,e,r,s,i,o);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,e,r,s,i){let o=Ul.create(this.top,t,e,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(t,e,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(t)&&(t==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new JI(this.top,t,e,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof Qu;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof kw)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ur||Tr)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new QI(this.top,[],r,null);e!=this.top?e.children.push(s):e.children.splice(this.index++,0,s),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function u6(n,t){let e=t,r=e.children.length,s=n.childCount,i=new Map,o=[];t:for(;s>0;){let a;for(;;)if(r){let c=e.children[r-1];if(c instanceof Qu)e=c,r=c.children.length;else{a=c,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function d6(n,t){return n.type.side-t.type.side}function h6(n,t,e,r){let s=t.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,t.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,d;for(;o<s.length&&s[o].to==i;){let b=s[o++];b.widget&&(u?(d||(d=[u])).push(b):u=b)}if(u)if(d){d.sort(d6);for(let b=0;b<d.length;b++)e(d[b],c,!!l)}else e(u,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<n.childCount)p=c,h=n.child(c++);else break;for(let b=0;b<a.length;b++)a[b].to<=i&&a.splice(b--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let g=i+h.nodeSize;if(h.isText){let b=g;o<s.length&&s[o].from<b&&(b=s[o].from);for(let y=0;y<a.length;y++)a[y].to<b&&(b=a[y].to);b<g&&(l=h.cut(b-i),h=h.cut(0,b-i),g=b,p=-1)}else for(;o<s.length&&s[o].to<g;)o++;let m=h.isInline&&!h.isLeaf?a.filter(b=>!b.inline):a.slice();r(h,m,t.forChild(i,h),p),i=g}}function f6(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function p6(n,t,e,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=e){if(i>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let c=a<r?l.lastIndexOf(t,r-a-1):-1;if(c>=0&&c+t.length+a>=e)return a+c;if(e==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}function cS(n,t,e,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=e||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),s&&(i.push(s),s=void 0),u>e&&i.push(l.slice(e-c,l.size,r)))}return i}function zE(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let s=n.docView.nearestDesc(e.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Ew(e)){for(l=o;s&&!s.node;)s=s.parent;let d=s.node;if(s&&d.isAtom&&Dt.isSelectable(d)&&s.parent&&!(d.isInline&&j5(e.focusNode,e.focusOffset,s.dom))){let h=s.posBefore;c=new Dt(o==h?a:r.resolve(h))}}else{if(e instanceof n.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let d=o,h=o;for(let p=0;p<e.rangeCount;p++){let g=e.getRangeAt(p);d=Math.min(d,n.docView.posFromDOM(g.startContainer,g.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(d<0)return null;[l,o]=h==n.state.selection.anchor?[h,d]:[d,h],a=r.resolve(o)}else l=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=t=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=UE(n,u,a,d)}return c}function nR(n){return n.editable?n.hasFocus():sR(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function ba(n,t=!1){let e=n.state.selection;if(rR(n,e),!!nR(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Tr){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Ju(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)m6(n);else{let{anchor:r,head:s}=e,i,o;HT&&!(e instanceof Gt)&&(e.$from.parent.inlineContent||(i=VT(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(o=VT(n,e.to))),n.docView.setSelection(r,s,n,t),HT&&(i&&zT(i),o&&zT(o)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&g6(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const HT=Ur||Tr&&UI<63;function VT(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),s=r<e.childNodes.length?e.childNodes[r]:null,i=r?e.childNodes[r-1]:null;if(Ur&&s&&s.contentEditable=="false")return Ax(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Ax(s);if(i)return Ax(i)}}function Ax(n){return n.contentEditable="true",Ur&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function zT(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function g6(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,s=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=s)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!nR(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function m6(n){let t=n.domSelection(),e=document.createRange();if(!t)return;let r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?e.setStart(r.parentNode,or(r)+1):e.setStart(r,0),e.collapse(!0),t.removeAllRanges(),t.addRange(e),!s&&!n.state.selection.visible&&ls&&zl<=11&&(r.disabled=!0,r.disabled=!1)}function rR(n,t){if(t instanceof Dt){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(UT(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else UT(n)}function UT(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function UE(n,t,e,r){return n.someProp("createSelectionBetween",s=>s(n,t,e))||Gt.between(t,e,r)}function WT(n){return n.editable&&!n.hasFocus()?!1:sR(n)}function sR(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function y6(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return Ju(t.node,t.offset,e.anchorNode,e.anchorOffset)}function uS(n,t){let{$anchor:e,$head:r}=n.selection,s=t>0?e.max(r):e.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(t>0?s.after():s.before()):null:s;return i&&re.findFrom(i,t)}function Xa(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function KT(n,t,e){let r=n.state.selection;if(r instanceof Gt)if(e.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(t<0?-1:1));return Xa(n,new Gt(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(t>0?"forward":"backward")){let s=uS(n.state,t);return s&&s instanceof Dt?Xa(n,s):!1}else if(!(Xs&&e.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=t<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?Dt.isSelectable(i)?Xa(n,new Dt(t<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):fy?Xa(n,new Gt(n.state.doc.resolve(t<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Dt&&r.node.isInline)return Xa(n,new Gt(t>0?r.$to:r.$from));{let s=uS(n.state,t);return s?Xa(n,s):!1}}}function Db(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function $p(n,t){let e=n.pmViewDesc;return e&&e.size==0&&(t<0||n.nextSibling||n.nodeName!="BR")}function vd(n,t){return t<0?b6(n):v6(n)}function b6(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let s,i,o=!1;for(Ri&&e.nodeType==1&&r<Db(e)&&$p(e.childNodes[r],-1)&&(o=!0);;)if(r>0){if(e.nodeType!=1)break;{let a=e.childNodes[r-1];if($p(a,-1))s=e,i=--r;else if(a.nodeType==3)e=a,r=e.nodeValue.length;else break}}else{if(iR(e))break;{let a=e.previousSibling;for(;a&&$p(a,-1);)s=e.parentNode,i=or(a),a=a.previousSibling;if(a)e=a,r=Db(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}o?dS(n,e,r):s&&dS(n,s,i)}function v6(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let s=Db(e),i,o;for(;;)if(r<s){if(e.nodeType!=1)break;let a=e.childNodes[r];if($p(a,1))i=e,o=++r;else break}else{if(iR(e))break;{let a=e.nextSibling;for(;a&&$p(a,1);)i=a.parentNode,o=or(a)+1,a=a.nextSibling;if(a)e=a,r=0,s=Db(e);else{if(e=e.parentNode,e==n.dom)break;r=s=0}}}i&&dS(n,i,o)}function iR(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function w6(n,t){for(;n&&t==n.childNodes.length&&!hy(n);)t=or(n)+1,n=n.parentNode;for(;n&&t<n.childNodes.length;){let e=n.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=0}}function x6(n,t){for(;n&&!t&&!hy(n);)t=or(n),n=n.parentNode;for(;n&&t;){let e=n.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=n.childNodes.length}}function dS(n,t,e){if(t.nodeType!=3){let i,o;(o=w6(t,e))?(t=o,e=0):(i=x6(t,e))&&(t=i,e=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Ew(r)){let i=document.createRange();i.setEnd(t,e),i.setStart(t,e),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&ba(n)},50)}function GT(n,t){let e=n.state.doc.resolve(t);if(!(Tr||z5)&&e.parent.inlineContent){let s=n.coordsAtPos(t);if(t>e.start()){let i=n.coordsAtPos(t-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(t<e.end()){let i=n.coordsAtPos(t+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function YT(n,t,e){let r=n.state.selection;if(r instanceof Gt&&!r.empty||e.indexOf("s")>-1||Xs&&e.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let o=uS(n.state,t);if(o&&o instanceof Dt)return Xa(n,o)}if(!s.parent.inlineContent){let o=t<0?s:i,a=r instanceof Rs?re.near(o,t):re.findFrom(o,t);return a?Xa(n,a):!1}return!1}function XT(n,t){if(!(n.state.selection instanceof Gt))return!0;let{$head:e,$anchor:r,empty:s}=n.state.selection;if(!e.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return t<0?o.delete(e.pos-i.nodeSize,e.pos):o.delete(e.pos,e.pos+i.nodeSize),n.dispatch(o),!0}return!1}function qT(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function S6(n){if(!Ur||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;qT(n,r,"true"),setTimeout(()=>qT(n,r,"false"),20)}return!1}function A6(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function E6(n,t){let e=t.keyCode,r=A6(t);if(e==8||Xs&&e==72&&r=="c")return XT(n,-1)||vd(n,-1);if(e==46&&!t.shiftKey||Xs&&e==68&&r=="c")return XT(n,1)||vd(n,1);if(e==13||e==27)return!0;if(e==37||Xs&&e==66&&r=="c"){let s=e==37?GT(n,n.state.selection.from)=="ltr"?-1:1:-1;return KT(n,s,r)||vd(n,s)}else if(e==39||Xs&&e==70&&r=="c"){let s=e==39?GT(n,n.state.selection.from)=="ltr"?1:-1:1;return KT(n,s,r)||vd(n,s)}else{if(e==38||Xs&&e==80&&r=="c")return YT(n,-1,r)||vd(n,-1);if(e==40||Xs&&e==78&&r=="c")return S6(n)||YT(n,1,r)||vd(n,1);if(r==(Xs?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function WE(n,t){n.someProp("transformCopied",p=>{t=p(t,n)});let e=[],{content:r,openStart:s,openEnd:i}=t;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let p=r.firstChild;e.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=n.someProp("clipboardSerializer")||ud.fromSchema(n.state.schema),a=dR(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=uR[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let g=a.createElement(u[p]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${d?` -${d}`:""} ${JSON.stringify(e)}`);let h=n.someProp("clipboardTextSerializer",p=>p(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function oR(n,t,e,r,s){let i=s.parent.type.spec.code,o,a;if(!e&&!t)return null;let l=t&&(r||i||!e);if(l){if(n.someProp("transformPastedText",h=>{t=h(t,i||r,n)}),i)return t?new ft(Z.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):ft.empty;let d=n.someProp("clipboardTextParser",h=>h(t,s,r,n));if(d)a=d;else{let h=s.marks(),{schema:p}=n.state,g=ud.fromSchema(p);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(m=>{let b=o.appendChild(document.createElement("p"));m&&b.appendChild(g.serializeNode(p.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{e=d(e,n)}),o=M6(e),fy&&P6(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Vl.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!k6.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=O6(JT(a,+u[1],+u[2]),u[4]);else if(a=ft.maxOpen(C6(a.content,s),!0),a.openStart||a.openEnd){let d=0,h=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=JT(a,d,h)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const k6=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function C6(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let s=t.node(e).contentMatchAt(t.index(e)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&lR(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=cR(o[o.length-1],i.length));let u=aR(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return Z.from(o)}return n}function aR(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,Z.from(n));return n}function lR(n,t,e,r,s){if(s<n.length&&s<t.length&&n[s]==t[s]){let i=lR(n,t,e,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?e.type:n[s+1]))return r.copy(r.content.append(Z.from(aR(e,n,s+1))))}}function cR(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,cR(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(Z.empty,!0);return n.copy(e.append(r))}function hS(n,t,e,r,s,i){let o=t<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=hS(a,t,e,r,s+1,i)),s>=e&&(a=t<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(Z.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,o.copy(a))}function JT(n,t,e){return t<n.openStart&&(n=new ft(hS(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new ft(hS(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const uR={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let QT=null;function dR(){return QT||(QT=document.implementation.createHTMLDocument("title"))}let Ex=null;function T6(n){let t=window.trustedTypes;return t?(Ex||(Ex=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),Ex.createHTML(n)):n}function M6(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=dR().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&uR[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),e.innerHTML=T6(n),s)for(let i=0;i<s.length;i++)e=e.querySelector(s[i])||e;return e}function P6(n){let t=n.querySelectorAll(Tr?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function O6(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=e.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=Z.from(l.create(r[a+1],s)),i++,o++}return new ft(s,i,o)}const Wr={},Kr={},I6={touchstart:!0,touchmove:!0};class R6{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function D6(n){for(let t in Wr){let e=Wr[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{_6(n,r)&&!KE(n,r)&&(n.editable||!(r.type in Kr))&&e(n,r)},I6[t]?{passive:!0}:void 0)}Ur&&n.dom.addEventListener("input",()=>null),fS(n)}function Fl(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function N6(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function fS(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>KE(n,r))})}function KE(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function _6(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function L6(n,t){!KE(n,t)&&Wr[t.type]&&(n.editable||!(t.type in Kr))&&Wr[t.type](n,t)}Kr.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!fR(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(pa&&Tr&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),wf&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,vc(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||E6(n,e)?e.preventDefault():Fl(n,"key")};Kr.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)};Kr.keypress=(n,t)=>{let e=t;if(fR(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||Xs&&e.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof Gt)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(e.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),e.preventDefault()}};function Cw(n){return{left:n.clientX,top:n.clientY}}function F6(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function GE(n,t,e,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(t,a=>o>i.depth?a(n,e,i.nodeAfter,i.before(o),s,!0):a(n,e,i.node(o),i.before(o),s,!1)))return!0;return!1}function eh(n,t,e){if(n.focused||n.focus(),n.state.selection.eq(t))return;let r=n.state.tr.setSelection(t);r.setMeta("pointer",!0),n.dispatch(r)}function B6(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&Dt.isSelectable(r)?(eh(n,new Dt(e)),!0):!1}function $6(n,t){if(t==-1)return!1;let e=n.state.selection,r,s;e instanceof Dt&&(r=e.node);let i=n.state.doc.resolve(t);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(Dt.isSelectable(a)){r&&e.$from.depth>0&&o>=e.$from.depth&&i.before(e.$from.depth+1)==e.$from.pos?s=i.before(e.$from.depth):s=i.before(o);break}}return s!=null?(eh(n,Dt.create(n.state.doc,s)),!0):!1}function j6(n,t,e,r,s){return GE(n,"handleClickOn",t,e,r)||n.someProp("handleClick",i=>i(n,t,r))||(s?$6(n,e):B6(n,e))}function H6(n,t,e,r){return GE(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",s=>s(n,t,r))}function V6(n,t,e,r){return GE(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",s=>s(n,t,r))||z6(n,e,r)}function z6(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(eh(n,Gt.create(r,0,r.content.size)),!0):!1;let s=r.resolve(t);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)eh(n,Gt.create(r,a+1,a+1+o.content.size));else if(Dt.isSelectable(o))eh(n,Dt.create(r,a));else continue;return!0}}function YE(n){return Nb(n)}const hR=Xs?"metaKey":"ctrlKey";Wr.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=YE(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&F6(e,n.input.lastClick)&&!e[hR]&&n.input.lastClick.button==e.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:e.clientX,y:e.clientY,type:i,button:e.button};let o=n.posAtCoords(Cw(e));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new U6(n,o,e,!!r)):(i=="doubleClick"?H6:V6)(n,o.pos,o.inside,e)?e.preventDefault():Fl(n,"pointer"))};class U6{constructor(t,e,r,s){this.view=t,this.pos=e,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[hR],this.allowDefault=r.shiftKey;let i,o;if(e.inside>-1)i=t.state.doc.nodeAt(e.inside),o=e.inside;else{let u=t.state.doc.resolve(e.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=t.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof Dt&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ri&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Fl(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ba(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Cw(t))),this.updateAllowDefault(t),this.allowDefault||!e?Fl(this.view,"pointer"):j6(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Ur&&this.mightDrag&&!this.mightDrag.node.isAtom||Tr&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(eh(this.view,re.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):Fl(this.view,"pointer")}move(t){this.updateAllowDefault(t),Fl(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Wr.touchstart=n=>{n.input.lastTouch=Date.now(),YE(n),Fl(n,"pointer")};Wr.touchmove=n=>{n.input.lastTouch=Date.now(),Fl(n,"pointer")};Wr.contextmenu=n=>YE(n);function fR(n,t){return n.composing?!0:Ur&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const W6=pa?5e3:-1;Kr.compositionstart=Kr.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$to;if(t.selection instanceof Gt&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||e.marks(),Nb(n,!0),n.markCursor=null;else if(Nb(n,!t.selection.empty),Ri&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}pR(n,W6)};Kr.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,pR(n,20))};function pR(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Nb(n),t))}function gR(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=G6());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function K6(n){let t=n.domSelectionRange();if(!t.focusNode)return null;let e=B5(t.focusNode,t.focusOffset),r=$5(t.focusNode,t.focusOffset);if(e&&r&&e!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(e==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=e.pmViewDesc;if(!(!o||!o.isText(e.nodeValue)))return r}}return e||r}function G6(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Nb(n,t=!1){if(!(pa&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),gR(n),t||n.docView&&n.docView.dirty){let e=zE(n),r=n.state.selection;return e&&!e.eq(r)?n.dispatch(n.state.tr.setSelection(e)):(n.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function Y6(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const Sg=ls&&zl<15||wf&&U5<604;Wr.copy=Kr.cut=(n,t)=>{let e=t,r=n.state.selection,s=e.type=="cut";if(r.empty)return;let i=Sg?null:e.clipboardData,o=r.content(),{dom:a,text:l}=WE(n,o);i?(e.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):Y6(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function X6(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function q6(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?Ag(n,r.value,null,s,t):Ag(n,r.textContent,r.innerHTML,s,t)},50)}function Ag(n,t,e,r,s){let i=oR(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||ft.empty)))return!0;if(!i)return!1;let o=X6(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function mR(n){let t=n.getData("text/plain")||n.getData("Text");if(t)return t;let e=n.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}Kr.paste=(n,t)=>{let e=t;if(n.composing&&!pa)return;let r=Sg?null:e.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Ag(n,mR(r),r.getData("text/html"),s,e)?e.preventDefault():q6(n,e)};class yR{constructor(t,e,r){this.slice=t,this.move=e,this.node=r}}const J6=Xs?"altKey":"ctrlKey";function bR(n,t){let e=n.someProp("dragCopies",r=>!r(t));return e??!t[J6]}Wr.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(Cw(e)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof Dt?s.to-1:s.to))){if(r&&r.mightDrag)o=Dt.create(n.state.doc,r.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let d=n.docView.nearestDesc(e.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(o=Dt.create(n.state.doc,d.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=WE(n,a);(!e.dataTransfer.files.length||!Tr||UI>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(Sg?"Text":"text/html",l.innerHTML),e.dataTransfer.effectAllowed="copyMove",Sg||e.dataTransfer.setData("text/plain",c),n.dragging=new yR(u,bR(n,e),o)};Wr.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)};Kr.dragover=Kr.dragenter=(n,t)=>t.preventDefault();Kr.drop=(n,t)=>{let e=t,r=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let s=n.posAtCoords(Cw(e));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",g=>{o=g(o,n)}):o=oR(n,mR(e.dataTransfer),Sg?null:e.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&bR(n,e));if(n.someProp("handleDrop",g=>g(n,e,o||ft.empty,a))){e.preventDefault();return}if(!o)return;e.preventDefault();let l=o?_I(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:g}=r;g?g.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&Dt.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Dt(p));else{let g=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,b,y,v)=>g=v),c.setSelection(UE(n,p,c.doc.resolve(g)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Wr.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&ba(n)},20))};Wr.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Wr.beforeinput=(n,t)=>{if(Tr&&pa&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,vc(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Kr)Wr[n]=Kr[n];function Eg(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class _b{constructor(t,e){this.toDOM=t,this.spec=e||ju,this.side=this.spec.side||0}map(t,e,r,s){let{pos:i,deleted:o}=t.mapResult(e.from+s,this.side<0?-1:1);return o?null:new ti(i-r,i-r,this)}valid(){return!0}eq(t){return this==t||t instanceof _b&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Eg(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Wl{constructor(t,e){this.attrs=t,this.spec=e||ju}map(t,e,r,s){let i=t.map(e.from+s,this.spec.inclusiveStart?-1:1)-r,o=t.map(e.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new ti(i,o,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Wl&&Eg(this.attrs,t.attrs)&&Eg(this.spec,t.spec)}static is(t){return t.type instanceof Wl}destroy(){}}class XE{constructor(t,e){this.attrs=t,this.spec=e||ju}map(t,e,r,s){let i=t.mapResult(e.from+s,1);if(i.deleted)return null;let o=t.mapResult(e.to+s,-1);return o.deleted||o.pos<=i.pos?null:new ti(i.pos-r,o.pos-r,this)}valid(t,e){let{index:r,offset:s}=t.content.findIndex(e.from),i;return s==e.from&&!(i=t.child(r)).isText&&s+i.nodeSize==e.to}eq(t){return this==t||t instanceof XE&&Eg(this.attrs,t.attrs)&&Eg(this.spec,t.spec)}destroy(){}}class ti{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new ti(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new ti(t,t,new _b(e,r))}static inline(t,e,r,s){return new ti(t,e,new Wl(r,s))}static node(t,e,r,s){return new ti(t,e,new XE(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Wl}get widget(){return this.type instanceof _b}}const Md=[],ju={};class Dn{constructor(t,e){this.local=t.length?t:Md,this.children=e.length?e:Md}static create(t,e){return e.length?Lb(e,t,0,ju):vr}find(t,e,r){let s=[];return this.findInner(t??0,e??1e9,s,0,r),s}findInner(t,e,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=e&&a.to>=t&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<e&&this.children[o+1]>t){let a=this.children[o]+1;this.children[o+2].findInner(t-a,e-a,r,s+a,i)}}map(t,e,r){return this==vr||t.maps.length==0?this:this.mapInner(t,e,0,0,r||ju)}mapInner(t,e,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,r,s);l&&l.type.valid(e,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?Q6(this.children,o||[],t,e,r,s,i):o?new Dn(o.sort(Hu),Md):vr}add(t,e){return e.length?this==vr?Dn.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let s,i=0;t.forEach((a,l)=>{let c=l+r,u;if(u=wR(e,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,Lb(u,a,c+1,ju)),i+=3}});let o=vR(i?xR(e):e,-r);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||o.splice(a--,1);return new Dn(o.length?this.local.concat(o).sort(Hu):this.local,s||this.children)}remove(t){return t.length==0||this==vr?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+e,l=r[i+1]+e;for(let u=0,d;u<t.length;u++)(d=t[u])&&d.from>a&&d.to<l&&(t[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=vr?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<t.length;i++)if(o=t[i])for(let a=0;a<s.length;a++)s[a].eq(o,e)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Dn(s,r):vr}forChild(t,e){if(this==vr)return this;if(e.isLeaf)return Dn.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(r=this.children[a+2]);break}let i=t+1,o=i+e.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Wl){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new Dn(s.sort(Hu),Md);return r?new tl([a,r]):a}return r||vr}eq(t){if(this==t)return!0;if(!(t instanceof Dn)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return qE(this.localsInner(t))}localsInner(t){if(this==vr)return Md;if(t.inlineContent||!this.local.some(Wl.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Wl||e.push(this.local[r]);return e}forEachSet(t){t(this)}}Dn.empty=new Dn([],[]);Dn.removeOverlap=qE;const vr=Dn.empty;class tl{constructor(t){this.members=t}map(t,e){const r=this.members.map(s=>s.map(t,e,ju));return tl.from(r)}forChild(t,e){if(e.isLeaf)return Dn.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(t,e);i!=vr&&(i instanceof tl?r=r.concat(i.members):r.push(i))}return tl.from(r)}eq(t){if(!(t instanceof tl)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(t);if(i.length)if(!e)e=i;else{r&&(e=e.slice(),r=!1);for(let o=0;o<i.length;o++)e.push(i[o])}}return e?qE(r?e:e.sort(Hu)):Md}static from(t){switch(t.length){case 0:return vr;case 1:return t[0];default:return new tl(t.every(e=>e instanceof Dn)?t:t.reduce((e,r)=>e.concat(r instanceof Dn?r:r.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function Q6(n,t,e,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<e.maps.length;c++){let d=0;e.maps[c].forEach((h,p,g,m)=>{let b=m-g-(p-h);for(let y=0;y<a.length;y+=3){let v=a[y+1];if(v<0||h>v+u-d)continue;let x=a[y]+u-d;p>=x?a[y+1]=h<=x?-2:-1:h>=u&&b&&(a[y]+=b,a[y+1]+=b)}d+=b}),u=e.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=e.map(n[c]+i),d=u-s;if(d<0||d>=r.content.size){l=!0;continue}let h=e.map(n[c+1]+i,-1),p=h-s,{index:g,offset:m}=r.content.findIndex(d),b=r.maybeChild(g);if(b&&m==d&&m+b.nodeSize==p){let y=a[c+2].mapInner(e,b,u+1,n[c]+i+1,o);y!=vr?(a[c]=d,a[c+1]=p,a[c+2]=y):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=Z6(a,n,t,e,s,i,o),u=Lb(c,r,0,o);t=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let p=u.children[d];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Dn(t.sort(Hu),a)}function vR(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let s=n[r];e.push(new ti(s.from+t,s.to+t,s.type))}return e}function Z6(n,t,e,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,s,c);d?e.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],t[l]+i+1);return e}function wR(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>e&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function xR(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function Lb(n,t,e,r){let s=[],i=!1;t.forEach((a,l)=>{let c=wR(n,a,l+e);if(c){i=!0;let u=Lb(c,a,e+l+1,r);u!=vr&&s.push(l,l+a.nodeSize,u)}});let o=vR(i?xR(n):n,-e).sort(Hu);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new Dn(o,s):vr}function Hu(n,t){return n.from-t.from||n.to-t.to}function qE(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let s=e+1;s<t.length;s++){let i=t[s];if(i.from==r.from){i.to!=r.to&&(t==n&&(t=n.slice()),t[s]=i.copy(i.from,r.to),ZT(t,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,i.from),ZT(t,s,r.copy(i.from,r.to)));break}}}return t}function ZT(n,t,e){for(;t<n.length&&Hu(e,n[t])>0;)t++;n.splice(t,0,e)}function kx(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=vr&&t.push(r)}),n.cursorWrapper&&t.push(Dn.create(n.state.doc,[n.cursorWrapper.deco])),tl.from(t)}const tV={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},eV=ls&&zl<=11;class nV{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class rV{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new nV,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);ls&&zl<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),eV&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,tV)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(WT(this.view)){if(this.suppressingSelectionUpdates)return ba(this.view);if(ls&&zl<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Ju(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let i=t.focusNode;i;i=vf(i))e.add(i);for(let i=t.anchorNode;i;i=vf(i))if(e.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let r=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&WT(t)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(t.editable)for(let u=0;u<e.length;u++){let d=this.registerMutation(e[u],l);d&&(i=i<0?d.from:Math.min(d.from,i),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(Ri&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let p=h.parentNode;p&&p.nodeName=="LI"&&(!d||oV(t,d)!=p)&&h.remove()}}}let c=null;i<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Ew(r)&&(c=zE(t))&&c.eq(re.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,ba(t),this.currentSelection.set(r),t.scrollToSelection()):(i>-1||s)&&(i>-1&&(t.docView.markDirty(i,o),sV(t)),this.handleDOMChange(i,o,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||ba(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let u=0;u<t.addedNodes.length;u++){let d=t.addedNodes[u];e.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let s=t.previousSibling,i=t.nextSibling;if(ls&&zl<=11&&t.addedNodes.length)for(let u=0;u<t.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=t.addedNodes[u];(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(s=d),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(i=h)}let o=s&&s.parentNode==t.target?or(s)+1:0,a=r.localPosFromDOM(t.target,o,-1),l=i&&i.parentNode==t.target?or(i):t.target.childNodes.length,c=r.localPosFromDOM(t.target,l,1);return{from:a,to:c}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let tM=new WeakMap,eM=!1;function sV(n){if(!tM.has(n)&&(tM.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ri,eM)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),eM=!0}}function nM(n,t){let e=t.startContainer,r=t.startOffset,s=t.endContainer,i=t.endOffset,o=n.domAtPos(n.state.selection.anchor);return Ju(o.node,o.offset,s,i)&&([e,r,s,i]=[s,i,e,r]),{anchorNode:e,anchorOffset:r,focusNode:s,focusOffset:i}}function iV(n,t){if(t.getComposedRanges){let s=t.getComposedRanges(n.root)[0];if(s)return nM(n,s)}let e;function r(s){s.preventDefault(),s.stopImmediatePropagation(),e=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),e?nM(n,e):null}function oV(n,t){for(let e=t.parentNode;e&&e!=n.dom;e=e.parentNode){let r=n.docView.nearestDesc(e,!0);if(r&&r.node.isBlock)return e}return null}function aV(n,t,e){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(t,e),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Ew(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Tr&&n.input.lastKeyCode===8)for(let b=i;b>s;b--){let y=r.childNodes[b-1],v=y.pmViewDesc;if(y.nodeName=="BR"&&!v){i=b;break}if(!v||v.size)break}let d=n.state.doc,h=n.someProp("domParser")||Vl.fromSchema(n.state.schema),p=d.resolve(o),g=null,m=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:lV,context:p});if(c&&c[0].pos!=null){let b=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=b),g={anchor:b+o,head:y+o}}return{doc:m,sel:g,from:o,to:a}}function lV(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ur&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||Ur&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const cV=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function uV(n,t,e,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,t<0){let C=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,R=zE(n,C);if(R&&!n.state.selection.eq(R)){if(Tr&&pa&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",B=>B(n,vc(13,"Enter"))))return;let N=n.state.tr.setSelection(R);C=="pointer"?N.setMeta("pointer",!0):C=="key"&&N.scrollIntoView(),i&&N.setMeta("composition",i),n.dispatch(N)}return}let o=n.state.doc.resolve(t),a=o.sharedDepth(e);t=o.before(a+1),e=n.state.doc.resolve(e).after(a+1);let l=n.state.selection,c=aV(n,t,e),u=n.state.doc,d=u.slice(c.from,c.to),h,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,p="end"):(h=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let g=fV(d.content,c.doc.content,c.from,h,p);if(g&&n.input.domChangeCount++,(wf&&n.input.lastIOSEnter>Date.now()-225||pa)&&s.some(C=>C.nodeType==1&&!cV.test(C.nodeName))&&(!g||g.endA>=g.endB)&&n.someProp("handleKeyDown",C=>C(n,vc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!g)if(r&&l instanceof Gt&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let C=rM(n,n.state.doc,c.sel);if(C&&!C.eq(n.state.selection)){let R=n.state.tr.setSelection(C);i&&R.setMeta("composition",i),n.dispatch(R)}}return}n.state.selection.from<n.state.selection.to&&g.start==g.endB&&n.state.selection instanceof Gt&&(g.start>n.state.selection.from&&g.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?g.start=n.state.selection.from:g.endA<n.state.selection.to&&g.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(g.endB+=n.state.selection.to-g.endA,g.endA=n.state.selection.to)),ls&&zl<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>c.from&&c.doc.textBetween(g.start-c.from-1,g.start-c.from+1)=="  "&&(g.start--,g.endA--,g.endB--);let m=c.doc.resolveNoCache(g.start-c.from),b=c.doc.resolveNoCache(g.endB-c.from),y=u.resolve(g.start),v=m.sameParent(b)&&m.parent.inlineContent&&y.end()>=g.endA,x;if((wf&&n.input.lastIOSEnter>Date.now()-225&&(!v||s.some(C=>C.nodeName=="DIV"||C.nodeName=="P"))||!v&&m.pos<c.doc.content.size&&(!m.sameParent(b)||!m.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(m.pos,b.pos,"",""))&&(x=re.findFrom(c.doc.resolve(m.pos+1),1,!0))&&x.head>m.pos)&&n.someProp("handleKeyDown",C=>C(n,vc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>g.start&&hV(u,g.start,g.endA,m,b)&&n.someProp("handleKeyDown",C=>C(n,vc(8,"Backspace")))){pa&&Tr&&n.domObserver.suppressSelectionUpdates();return}Tr&&g.endB==g.start&&(n.input.lastChromeDelete=Date.now()),pa&&!v&&m.start()!=b.start()&&b.parentOffset==0&&m.depth==b.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==g.endA&&(g.endB-=2,b=c.doc.resolveNoCache(g.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(C){return C(n,vc(13,"Enter"))})},20));let S=g.start,w=g.endA,E,T,I;if(v){if(m.pos==b.pos)ls&&zl<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>ba(n),20)),E=n.state.tr.delete(S,w),T=u.resolve(g.start).marksAcross(u.resolve(g.endA));else if(g.endA==g.endB&&(I=dV(m.parent.content.cut(m.parentOffset,b.parentOffset),y.parent.content.cut(y.parentOffset,g.endA-y.start()))))E=n.state.tr,I.type=="add"?E.addMark(S,w,I.mark):E.removeMark(S,w,I.mark);else if(m.parent.child(m.index()).isText&&m.index()==b.index()-(b.textOffset?0:1)){let C=m.parent.textBetween(m.parentOffset,b.parentOffset);if(n.someProp("handleTextInput",R=>R(n,S,w,C)))return;E=n.state.tr.insertText(C,S,w)}}if(E||(E=n.state.tr.replace(S,w,c.doc.slice(g.start-c.from,g.endB-c.from))),c.sel){let C=rM(n,E.doc,c.sel);C&&!(Tr&&n.composing&&C.empty&&(g.start!=g.endB||n.input.lastChromeDelete<Date.now()-100)&&(C.head==S||C.head==E.mapping.map(w)-1)||ls&&C.empty&&C.head==S)&&E.setSelection(C)}T&&E.ensureMarks(T),i&&E.setMeta("composition",i),n.dispatch(E.scrollIntoView())}function rM(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:UE(n,t.resolve(e.anchor),t.resolve(e.head))}function dV(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,s=e,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<e.length;u++)i=e[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<t.childCount;u++)c.push(l(t.child(u)));if(Z.from(c).eq(n))return{mark:a,type:o}}function hV(n,t,e,r,s){if(e-t<=s.pos-r.pos||Cx(r,!0,!1)<s.pos)return!1;let i=n.resolve(t);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&e==t+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(Cx(i,!0,!0));return!o.parent.isTextblock||o.pos>e||Cx(o,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Cx(n,t,e){let r=n.depth,s=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,s++,t=!1;if(e){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function fV(n,t,e,r,s){let i=n.findDiffStart(t,e);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(t,e+n.size,e+t.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<t.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<t.size&&sM(t.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&sM(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function sM(n){if(n.length!=2)return!1;let t=n.charCodeAt(0),e=n.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class pV{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new R6,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(cM),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=aM(this),oM(this),this.nodeViews=lM(this),this.docView=$T(this.state.doc,iM(this),kx(this),this.dom,this),this.domObserver=new rV(this,(r,s,i,o)=>uV(this,r,s,i,o)),this.domObserver.start(),D6(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&fS(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(cM),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var r;let s=this.state,i=!1,o=!1;t.storedMarks&&this.composing&&(gR(this),o=!0),this.state=t;let a=s.plugins!=t.plugins||this._props.plugins!=e.plugins;if(a||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let p=lM(this);mV(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(a||e.handleDOMEvents!=this._props.handleDOMEvents)&&fS(this),this.editable=aM(this),oM(this);let l=kx(this),c=iM(this),u=s.plugins!=t.plugins&&!s.doc.eq(t.doc)?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(t.doc,c,l);(d||!t.selection.eq(s.selection))&&(o=!0);let h=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&G5(this);if(o){this.domObserver.stop();let p=d&&(ls||Tr)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&gV(s.selection,t.selection);if(d){let g=Tr?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=K6(this)),(i||!this.docView.update(t.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=$T(t.doc,c,l,this.dom,this)),g&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&y6(this))?ba(this,p):(rR(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&Y5(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof Dt){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&DT(this,e.getBoundingClientRect(),t)}else DT(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}updateDraggedNode(t,e){let r=t.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-e.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new yR(t.slice,t.move,s<0?void 0:Dt.create(this.state.doc,s))}someProp(t,e){let r=this._props&&this._props[t],s;if(r!=null&&(s=e?e(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[t];if(a!=null&&(s=e?e(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[t];if(a!=null&&(s=e?e(a):a))return s}}hasFocus(){if(ls){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&X5(this.dom),ba(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return t6(this,t)}coordsAtPos(t,e=1){return XI(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let s=this.docView.posFromDOM(t,e,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(t,e){return i6(this,e||this.state,t)}pasteHTML(t,e){return Ag(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return Ag(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return WE(this,t)}destroy(){this.docView&&(N6(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],kx(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,L5())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return L6(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){let t=this.domSelection();return t?Ur&&this.root.nodeType===11&&H5(this.dom.ownerDocument)==this.dom&&iV(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function iM(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"?t.class+=" "+e[r]:r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),t.translate||(t.translate="no"),[ti.node(0,n.state.doc.content.size,t)]}function oM(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:ti.widget(n.state.selection.from,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function aM(n){return!n.someProp("editable",t=>t(n.state)===!1)}function gV(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function lM(n){let t=Object.create(null);function e(r){for(let s in r)Object.prototype.hasOwnProperty.call(t,s)||(t[s]=r[s])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function mV(n,t){let e=0,r=0;for(let s in n){if(n[s]!=t[s])return!0;e++}for(let s in t)r++;return e!=r}function cM(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Zl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fb={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yV=typeof navigator<"u"&&/Mac/.test(navigator.platform),bV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ar=0;ar<10;ar++)Zl[48+ar]=Zl[96+ar]=String(ar);for(var ar=1;ar<=24;ar++)Zl[ar+111]="F"+ar;for(var ar=65;ar<=90;ar++)Zl[ar]=String.fromCharCode(ar+32),Fb[ar]=String.fromCharCode(ar);for(var Tx in Zl)Fb.hasOwnProperty(Tx)||(Fb[Tx]=Zl[Tx]);function vV(n){var t=yV&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||bV&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?Fb:Zl)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const wV=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),xV=typeof navigator<"u"&&/Win/.test(navigator.platform);function SV(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,s,i,o;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))wV?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(e="Alt-"+e),s&&(e="Ctrl-"+e),o&&(e="Meta-"+e),i&&(e="Shift-"+e),e}function AV(n){let t=Object.create(null);for(let e in n)t[SV(e)]=n[e];return t}function Mx(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function EV(n){return new cr({props:{handleKeyDown:SR(n)}})}function SR(n){let t=AV(n);return function(e,r){let s=vV(r),i,o=t[Mx(s,r)];if(o&&o(e.state,e.dispatch,e))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=t[Mx(s,r,!1)];if(a&&a(e.state,e.dispatch,e))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(xV&&r.ctrlKey&&r.altKey)&&(i=Zl[r.keyCode])&&i!=s){let a=t[Mx(i,r)];if(a&&a(e.state,e.dispatch,e))return!0}}return!1}}const JE=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function AR(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const ER=(n,t,e)=>{let r=AR(n,e);if(!r)return!1;let s=QE(r);if(!s){let o=r.blockRange(),a=o&&Rf(o);return a==null?!1:(t&&t(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(DR(n,s,t,-1))return!0;if(r.parent.content.size==0&&(xf(i,"end")||Dt.isSelectable(i)))for(let o=r.depth;;o--){let a=Sw(n.doc,r.before(o),r.after(o),ft.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=n.tr.step(a);l.setSelection(xf(i,"end")?re.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):Dt.create(l.doc,s.pos-i.nodeSize)),t(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(t&&t(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},kV=(n,t,e)=>{let r=AR(n,e);if(!r)return!1;let s=QE(r);return s?kR(n,s,t):!1},CV=(n,t,e)=>{let r=TR(n,e);if(!r)return!1;let s=ZE(r);return s?kR(n,s,t):!1};function kR(n,t,e){let r=t.nodeBefore,s=r,i=t.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=t.nodeAfter,a=o,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Sw(n.doc,i,l,ft.empty);if(!c||c.from!=i||c instanceof Un&&c.slice.size>=l-i)return!1;if(e){let u=n.tr.step(c);u.setSelection(Gt.create(u.doc,i)),e(u.scrollIntoView())}return!0}function xf(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const CR=(n,t,e)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=QE(r)}let o=i&&i.nodeBefore;return!o||!Dt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Dt.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function QE(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function TR(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const MR=(n,t,e)=>{let r=TR(n,e);if(!r)return!1;let s=ZE(r);if(!s)return!1;let i=s.nodeAfter;if(DR(n,s,t,1))return!0;if(r.parent.content.size==0&&(xf(i,"start")||Dt.isSelectable(i))){let o=Sw(n.doc,r.before(),r.after(),ft.empty);if(o&&o.slice.size<o.to-o.from){if(t){let a=n.tr.step(o);a.setSelection(xf(i,"start")?re.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):Dt.create(a.doc,a.mapping.map(s.pos))),t(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(t&&t(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},PR=(n,t,e)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=ZE(r)}let o=i&&i.nodeAfter;return!o||!Dt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Dt.create(n.doc,i.pos)).scrollIntoView()),!0)};function ZE(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const TV=(n,t)=>{let e=n.selection,r=e instanceof Dt,s;if(r){if(e.node.isTextblock||!sc(n.doc,e.from))return!1;s=e.from}else if(s=xw(n.doc,e.from,-1),s==null)return!1;if(t){let i=n.tr.join(s);r&&i.setSelection(Dt.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0},MV=(n,t)=>{let e=n.selection,r;if(e instanceof Dt){if(e.node.isTextblock||!sc(n.doc,e.to))return!1;r=e.to}else if(r=xw(n.doc,e.to,1),r==null)return!1;return t&&t(n.tr.join(r).scrollIntoView()),!0},PV=(n,t)=>{let{$from:e,$to:r}=n.selection,s=e.blockRange(r),i=s&&Rf(s);return i==null?!1:(t&&t(n.tr.lift(s,i).scrollIntoView()),!0)},OR=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function tk(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const OV=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let s=e.node(-1),i=e.indexAfter(-1),o=tk(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(t){let a=e.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(re.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},IR=(n,t)=>{let e=n.selection,{$from:r,$to:s}=e;if(e instanceof Rs||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=tk(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(Gt.create(a.doc,o+1)),t(a.scrollIntoView())}return!0},RR=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let i=e.before();if(ya(n.doc,i))return t&&t(n.tr.split(i).scrollIntoView()),!0}let r=e.blockRange(),s=r&&Rf(r);return s==null?!1:(t&&t(n.tr.lift(r,s).scrollIntoView()),!0)};function IV(n){return(t,e)=>{let{$from:r,$to:s}=t.selection;if(t.selection instanceof Dt&&t.selection.node.isBlock)return!r.parentOffset||!ya(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let p=r.depth;;p--)if(r.node(p).isBlock){l=r.end(p)==r.pos+(r.depth-p),c=r.start(p)==r.pos-(r.depth-p),a=tk(r.node(p-1).contentMatchAt(r.indexAfter(p-1))),i.unshift(l&&a?{type:a}:null),o=p;break}else{if(p==1)return!1;i.unshift(null)}let u=t.tr;(t.selection instanceof Gt||t.selection instanceof Rs)&&u.deleteSelection();let d=u.mapping.map(r.pos),h=ya(u.doc,d,i.length,i);if(h||(i[0]=a?{type:a}:null,h=ya(u.doc,d,i.length,i)),!h)return!1;if(u.split(d,i.length,i),!l&&c&&r.node(o).type!=a){let p=u.mapping.map(r.before(o)),g=u.doc.resolve(p);a&&r.node(o-1).canReplaceWith(g.index(),g.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return e&&e(u.scrollIntoView()),!0}}const RV=IV(),DV=(n,t)=>{let{$from:e,to:r}=n.selection,s,i=e.sharedDepth(r);return i==0?!1:(s=e.before(i),t&&t(n.tr.setSelection(Dt.create(n.doc,s))),!0)};function NV(n,t,e){let r=t.nodeBefore,s=t.nodeAfter,i=t.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&t.parent.canReplace(i-1,i)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(i,i+1)||!(s.isTextblock||sc(n.doc,t.pos))?!1:(e&&e(n.tr.join(t.pos).scrollIntoView()),!0)}function DR(n,t,e,r){let s=t.nodeBefore,i=t.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&NV(n,t,e))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(e){let p=t.pos+i.nodeSize,g=Z.empty;for(let y=o.length-1;y>=0;y--)g=Z.from(o[y].create(null,g));g=Z.from(s.copy(g));let m=n.tr.step(new Kn(t.pos-1,p,t.pos,p,new ft(g,1,0),o.length,!0)),b=m.doc.resolve(p+2*o.length);b.nodeAfter&&b.nodeAfter.type==s.type&&sc(m.doc,b.pos)&&m.join(b.pos),e(m.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:re.findFrom(t,1),d=u&&u.$from.blockRange(u.$to),h=d&&Rf(d);if(h!=null&&h>=t.depth)return e&&e(n.tr.lift(d,h).scrollIntoView()),!0;if(c&&xf(i,"start",!0)&&xf(s,"end")){let p=s,g=[];for(;g.push(p),!p.isTextblock;)p=p.lastChild;let m=i,b=1;for(;!m.isTextblock;m=m.firstChild)b++;if(p.canReplace(p.childCount,p.childCount,m.content)){if(e){let y=Z.empty;for(let x=g.length-1;x>=0;x--)y=Z.from(g[x].copy(y));let v=n.tr.step(new Kn(t.pos-g.length,t.pos+i.nodeSize,t.pos+b,t.pos+i.nodeSize-b,new ft(y,g.length,0),0,!0));e(v.scrollIntoView())}return!0}}return!1}function NR(n){return function(t,e){let r=t.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(e&&e(t.tr.setSelection(Gt.create(t.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const _V=NR(-1),LV=NR(1);function FV(n,t=null){return function(e,r){let{$from:s,$to:i}=e.selection,o=s.blockRange(i),a=o&&jE(o,n,t);return a?(r&&r(e.tr.wrap(o,a).scrollIntoView()),!0):!1}}function uM(n,t=null){return function(e,r){let s=!1;for(let i=0;i<e.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=e.selection.ranges[i];e.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,t)))if(l.type==n)s=!0;else{let u=e.doc.resolve(c),d=u.index();s=u.parent.canReplaceWith(d,d+1,n)}})}if(!s)return!1;if(r){let i=e.tr;for(let o=0;o<e.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=e.selection.ranges[o];i.setBlockType(a,l,n,t)}r(i.scrollIntoView())}return!0}}function ek(...n){return function(t,e,r){for(let s=0;s<n.length;s++)if(n[s](t,e,r))return!0;return!1}}ek(JE,ER,CR);ek(JE,MR,PR);ek(OR,IR,RR,RV);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function BV(n,t=null){return function(e,r){let{$from:s,$to:i}=e.selection,o=s.blockRange(i);if(!o)return!1;let a=r?e.tr:null;return $V(a,o,n,t)?(r&&r(a.scrollIntoView()),!0):!1}}function $V(n,t,e,r=null){let s=!1,i=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(e)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=o.resolve(t.start-2);i=new Ob(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new Ob(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let a=jE(i,e,r,t);return a?(n&&jV(n,t,a,s,e),!0):!1}function jV(n,t,e,r,s){let i=Z.empty;for(let u=e.length-1;u>=0;u--)i=Z.from(e[u].type.create(e[u].attrs,i));n.step(new Kn(t.start-(r?2:0),t.end,t.start,t.end,new ft(i,0,0),e.length,!0));let o=0;for(let u=0;u<e.length;u++)e[u].type==s&&(o=u+1);let a=e.length-o,l=t.start+e.length-(r?2:0),c=t.parent;for(let u=t.startIndex,d=t.endIndex,h=!0;u<d;u++,h=!1)!h&&ya(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function HV(n){return function(t,e){let{$from:r,$to:s}=t.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?e?r.node(i.depth-1).type==n?VV(t,e,n,i):zV(t,e,i):!0:!1}}function VV(n,t,e,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new Kn(i-1,o,i,o,new ft(Z.from(e.create(null,r.parent.copy())),1,0),1,!0)),r=new Ob(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=Rf(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return sc(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),t(s.scrollIntoView()),!0}function zV(n,t,e){let r=n.tr,s=e.parent;for(let p=e.end,g=e.endIndex-1,m=e.startIndex;g>m;g--)p-=s.child(g).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(e.start),o=i.nodeAfter;if(r.mapping.map(e.end)!=e.start+i.nodeAfter.nodeSize)return!1;let a=e.startIndex==0,l=e.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?Z.empty:Z.from(s))))return!1;let d=i.pos,h=d+o.nodeSize;return r.step(new Kn(d-(a?1:0),h+(l?1:0),d+1,h-1,new ft((a?Z.empty:Z.from(s.copy(Z.empty))).append(l?Z.empty:Z.from(s.copy(Z.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}function UV(n){return function(t,e){let{$from:r,$to:s}=t.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(e){let c=l.lastChild&&l.lastChild.type==a.type,u=Z.from(c?n.create():null),d=new ft(Z.from(n.create(null,Z.from(a.type.create(null,u)))),c?3:1,0),h=i.start,p=i.end;e(t.tr.step(new Kn(h-(c?3:1),p,h,p,d,1,!0)).scrollIntoView())}return!0}}function Tw(n){const{state:t,transaction:e}=n;let{selection:r}=e,{doc:s}=e,{storedMarks:i}=e;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=e.selection,s=e.doc,i=e.storedMarks,e}}}let Mw=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:s}=e,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!t,c=t||i.tr,u=()=>(!l&&e&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,p])=>[h,(...m)=>{const b=this.buildProps(c,e),y=p(...m)(b);return a.push(y),d}])),run:u};return d}createCan(t){const{rawCommands:e,state:r}=this,s=!1,i=t||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(e).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(t,e=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:t,editor:s,view:o,state:Tw({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}};class WV{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(s=>s.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(s=>s!==e):delete this.callbacks[t]),this}once(t,e){const r=(...s)=>{this.off(t,r),e.apply(this,s)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}}function At(n,t,e){return n.config[t]===void 0&&n.parent?At(n.parent,t,e):typeof n.config[t]=="function"?n.config[t].bind({...e,parent:n.parent?At(n.parent,t,e):null}):n.config[t]}function Pw(n){const t=n.filter(s=>s.type==="extension"),e=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:e,markExtensions:r}}function _R(n){const t=[],{nodeExtensions:e,markExtensions:r}=Pw(n),s=[...e,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=At(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,p])=>{t.push({type:d,name:h,attribute:{...i,...p}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=At(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...i,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,t.push({type:o.name,name:u,attribute:h})})}),t}function Yn(n,t){if(typeof n=="string"){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function Je(...n){return n.filter(t=>!!t).reduce((t,e)=>{const r={...t};return Object.entries(e).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),r[s]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=i}),r},{})}function pS(n,t){return t.filter(e=>e.type===n.type.name).filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,r)=>Je(e,r),{})}function LR(n){return typeof n=="function"}function le(n,t=void 0,...e){return LR(n)?t?n.bind(t)(...e):n(...e):n}function KV(n={}){return Object.keys(n).length===0&&n.constructor===Object}function GV(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function dM(n,t){return"style"in n?n:{...n,getAttrs:e=>{const r=n.getAttrs?n.getAttrs(e):n.attrs;if(r===!1)return!1;const s=t.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(e):GV(e.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function hM(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>t==="attrs"&&KV(e)?!1:e!=null))}function YV(n,t){var e;const r=_R(n),{nodeExtensions:s,markExtensions:i}=Pw(n),o=(e=s.find(c=>At(c,"topNode")))===null||e===void 0?void 0:e.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(y=>y.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},h=n.reduce((y,v)=>{const x=At(v,"extendNodeSchema",d);return{...y,...x?x(c):{}}},{}),p=hM({...h,content:le(At(c,"content",d)),marks:le(At(c,"marks",d)),group:le(At(c,"group",d)),inline:le(At(c,"inline",d)),atom:le(At(c,"atom",d)),selectable:le(At(c,"selectable",d)),draggable:le(At(c,"draggable",d)),code:le(At(c,"code",d)),whitespace:le(At(c,"whitespace",d)),linebreakReplacement:le(At(c,"linebreakReplacement",d)),defining:le(At(c,"defining",d)),isolating:le(At(c,"isolating",d)),attrs:Object.fromEntries(u.map(y=>{var v;return[y.name,{default:(v=y==null?void 0:y.attribute)===null||v===void 0?void 0:v.default}]}))}),g=le(At(c,"parseHTML",d));g&&(p.parseDOM=g.map(y=>dM(y,u)));const m=At(c,"renderHTML",d);m&&(p.toDOM=y=>m({node:y,HTMLAttributes:pS(y,u)}));const b=At(c,"renderText",d);return b&&(p.toText=b),[c.name,p]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},h=n.reduce((b,y)=>{const v=At(y,"extendMarkSchema",d);return{...b,...v?v(c):{}}},{}),p=hM({...h,inclusive:le(At(c,"inclusive",d)),excludes:le(At(c,"excludes",d)),group:le(At(c,"group",d)),spanning:le(At(c,"spanning",d)),code:le(At(c,"code",d)),attrs:Object.fromEntries(u.map(b=>{var y;return[b.name,{default:(y=b==null?void 0:b.attribute)===null||y===void 0?void 0:y.default}]}))}),g=le(At(c,"parseHTML",d));g&&(p.parseDOM=g.map(b=>dM(b,u)));const m=At(c,"renderHTML",d);return m&&(p.toDOM=b=>m({mark:b,HTMLAttributes:pS(b,u)})),[c.name,p]}));return new EI({topNode:o,nodes:a,marks:l})}function Px(n,t){return t.nodes[n]||t.marks[n]||null}function fM(n,t){return Array.isArray(t)?t.some(e=>(typeof e=="string"?e:e.name)===n.name):t}function nk(n,t){const e=ud.fromSchema(t).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(e),s.innerHTML}const XV=(n,t=500)=>{let e="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-t),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";e+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),e};function rk(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Ow{constructor(t){this.find=t.find,this.handler=t.handler}}const qV=(n,t)=>{if(rk(t))return t.exec(n);const e=t(n);if(!e)return null;const r=[e.text];return r.index=e.index,r.input=n,r.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(e.replaceWith)),r};function jy(n){var t;const{editor:e,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=e;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((t=c.nodeBefore||c.nodeAfter)===null||t===void 0)&&t.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=XV(c)+i;return o.forEach(h=>{if(u)return;const p=qV(d,h.find);if(!p)return;const g=l.state.tr,m=Tw({state:l.state,transaction:g}),b={from:r-(p[0].length-i.length),to:s},{commands:y,chain:v,can:x}=new Mw({editor:e,state:m});h.handler({state:m,range:b,match:p,commands:y,chain:v,can:x})===null||!g.steps.length||(g.setMeta(a,{transform:g,from:r,to:s,text:i}),l.dispatch(g),u=!0)}),u}function JV(n){const{editor:t,rules:e}=n,r=new cr({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=nk(Z.from(u),o.schema);const{from:d}=l,h=d+u.length;jy({editor:t,from:d,to:h,text:u,rules:e,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return jy({editor:t,from:i,to:o,text:a,rules:e,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&jy({editor:t,from:i.pos,to:i.pos,text:"",rules:e,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?jy({editor:t,from:o.pos,to:o.pos,text:`
`,rules:e,plugin:r}):!1}},isInputRules:!0});return r}function QV(n){return Object.prototype.toString.call(n).slice(8,-1)}function Hy(n){return QV(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Iw(n,t){const e={...n};return Hy(n)&&Hy(t)&&Object.keys(t).forEach(r=>{Hy(t[r])&&Hy(n[r])?e[r]=Iw(n[r],t[r]):e[r]=t[r]}),e}class cs{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(At(this,"addOptions",{name:this.name}))),this.storage=le(At(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new cs(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Iw(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new cs(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=le(At(e,"addOptions",{name:e.name})),e.storage=le(At(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===e.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===e.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}}function ZV(n){return typeof n=="number"}class tz{constructor(t){this.find=t.find,this.handler=t.handler}}const ez=(n,t,e)=>{if(rk(t))return[...n.matchAll(t)];const r=t(n,e);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function nz(n){const{editor:t,state:e,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Mw({editor:t,state:e}),d=[];return e.doc.nodesBetween(r,s,(p,g)=>{if(!p.isTextblock||p.type.spec.code)return;const m=Math.max(r,g),b=Math.min(s,g+p.content.size),y=p.textBetween(m-g,b-g,void 0,"￼");ez(y,i.find,o).forEach(x=>{if(x.index===void 0)return;const S=m+x.index+1,w=S+x[0].length,E={from:e.tr.mapping.map(S),to:e.tr.mapping.map(w)},T=i.handler({state:e,range:E,match:x,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});d.push(T)})}),d.every(p=>p!==null)}let Vy=null;const rz=n=>{var t;const e=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=e.clipboardData)===null||t===void 0||t.setData("text/html",n),e};function sz(n){const{editor:t,rules:e}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:p,pasteEvt:g})=>{const m=u.tr,b=Tw({state:u,transaction:m});if(!(!nz({editor:t,state:b,from:Math.max(d-1,0),to:h.b-1,rule:p,pasteEvent:g,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return e.map(u=>new cr({view(d){const h=g=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(g.target)?d.dom.parentElement:null,r&&(Vy=t)},p=()=>{Vy&&(Vy=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(i=r===d.dom.parentElement,a=h,!i){const p=Vy;p&&setTimeout(()=>{const g=p.state.selection;g&&p.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(d,h)=>{var p;const g=(p=h.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return o=h,s=!!(g!=null&&g.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,p)=>{const g=d[0],m=g.getMeta("uiEvent")==="paste"&&!s,b=g.getMeta("uiEvent")==="drop"&&!i,y=g.getMeta("applyPasteRules"),v=!!y;if(!m&&!b&&!v)return;if(v){let{text:w}=y;typeof w=="string"?w=w:w=nk(Z.from(w),p.schema);const{from:E}=y,T=E+w.length,I=rz(w);return l({rule:u,state:p,from:E,to:{b:T},pasteEvt:I})}const x=h.doc.content.findDiffStart(p.doc.content),S=h.doc.content.findDiffEnd(p.doc.content);if(!(!ZV(x)||!S||x===S.b))return l({rule:u,state:p,from:x,to:S,pasteEvt:o})}}))}function iz(n){const t=n.filter((e,r)=>n.indexOf(e)!==r);return Array.from(new Set(t))}class jd{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=jd.resolve(t),this.schema=YV(this.extensions,e),this.setupExtensions()}static resolve(t){const e=jd.sort(jd.flatten(t)),r=iz(e.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},s=At(e,"addExtensions",r);return s?[e,...this.flatten(s())]:e}).flat(10)}static sort(t){return t.sort((r,s)=>{const i=At(r,"priority")||100,o=At(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Px(e.name,this.schema)},s=At(e,"addCommands",r);return s?{...t,...s()}:t},{})}get plugins(){const{editor:t}=this,e=jd.sort([...this.extensions].reverse()),r=[],s=[],i=e.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:t,type:Px(o.name,this.schema)},l=[],c=At(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&At(o,"exitable",a)&&(u.ArrowRight=()=>cs.handleExit({editor:t,mark:o})),c){const m=Object.fromEntries(Object.entries(c()).map(([b,y])=>[b,()=>y({editor:t})]));u={...u,...m}}const d=EV(u);l.push(d);const h=At(o,"addInputRules",a);fM(o,t.options.enableInputRules)&&h&&r.push(...h());const p=At(o,"addPasteRules",a);fM(o,t.options.enablePasteRules)&&p&&s.push(...p());const g=At(o,"addProseMirrorPlugins",a);if(g){const m=g();l.push(...m)}return l}).flat();return[JV({editor:t,rules:r}),...sz({editor:t,rules:s}),...i]}get attributes(){return _R(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Pw(this.extensions);return Object.fromEntries(e.filter(r=>!!At(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:t,type:Yn(r.name,this.schema)},o=At(r,"addNodeView",i);if(!o)return[];const a=(l,c,u,d,h)=>{const p=pS(l,s);return o()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:t,extension:r,HTMLAttributes:p})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Px(t.name,this.schema)};t.type==="mark"&&(!((e=le(At(t,"keepOnSplit",r)))!==null&&e!==void 0)||e)&&this.splittableMarks.push(t.name);const s=At(t,"onBeforeCreate",r),i=At(t,"onCreate",r),o=At(t,"onUpdate",r),a=At(t,"onSelectionUpdate",r),l=At(t,"onTransaction",r),c=At(t,"onFocus",r),u=At(t,"onBlur",r),d=At(t,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class Xn{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(At(this,"addOptions",{name:this.name}))),this.storage=le(At(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Xn(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Iw(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new Xn({...this.config,...t});return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=le(At(e,"addOptions",{name:e.name})),e.storage=le(At(e,"addStorage",{name:e.name,options:e.options})),e}}function FR(n,t,e){const{from:r,to:s}=t,{blockSeparator:i=`

`,textSerializers:o={}}=e||{};let a="";return n.nodesBetween(r,s,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=i);const p=o==null?void 0:o[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:d,range:t})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,s-c))}),a}function BR(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const oz=Xn.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new cr({key:new Ls("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:r,selection:s}=t,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=BR(e);return FR(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),az=()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),(e=window==null?void 0:window.getSelection())===null||e===void 0||e.removeAllRanges())}),!0),lz=(n=!1)=>({commands:t})=>t.setContent("",n),cz=()=>({state:n,tr:t,dispatch:e})=>{const{selection:r}=t,{ranges:s}=r;return e&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=t,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(h);if(!p)return;const g=Rf(p);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(p.start,m)}(g||g===0)&&t.lift(p,g)})}),!0},uz=n=>t=>n(t),dz=()=>({state:n,dispatch:t})=>IR(n,t),hz=(n,t)=>({editor:e,tr:r})=>{const{state:s}=e,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(t);return r.insert(o,i.content),r.setSelection(new Gt(r.doc.resolve(o-1))),!0},fz=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,r=e.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(t){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},pz=n=>({tr:t,state:e,dispatch:r})=>{const s=Yn(n,e.schema),i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);t.delete(l,c).scrollIntoView()}return!0}return!1},gz=n=>({tr:t,dispatch:e})=>{const{from:r,to:s}=n;return e&&t.delete(r,s),!0},mz=()=>({state:n,dispatch:t})=>JE(n,t),yz=()=>({commands:n})=>n.keyboardShortcut("Enter"),bz=()=>({state:n,dispatch:t})=>OV(n,t);function Bb(n,t,e={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>e.strict?t[s]===n[s]:rk(t[s])?t[s].test(n[s]):t[s]===n[s]):!0}function $R(n,t,e={}){return n.find(r=>r.type===t&&Bb(Object.fromEntries(Object.keys(e).map(s=>[s,r.attrs[s]])),e))}function pM(n,t,e={}){return!!$R(n,t,e)}function sk(n,t,e){var r;if(!n||!t)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===t))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===t)||(e=e||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!$R([...s.node.marks],t,e)))return;let o=s.index,a=n.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&pM([...n.parent.child(o-1).marks],t,e);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&pM([...n.parent.child(l).marks],t,e);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function oc(n,t){if(typeof n=="string"){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}const vz=(n,t={})=>({tr:e,state:r,dispatch:s})=>{const i=oc(n,r.schema),{doc:o,selection:a}=e,{$from:l,from:c,to:u}=a;if(s){const d=sk(l,i,t);if(d&&d.from<=c&&d.to>=u){const h=Gt.create(o,d.from,d.to);e.setSelection(h)}}return!0},wz=n=>t=>{const e=typeof n=="function"?n(t):n;for(let r=0;r<e.length;r+=1)if(e[r](t))return!0;return!1};function jR(n){return n instanceof Gt}function Cc(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function HR(n,t=null){if(!t)return null;const e=re.atStart(n),r=re.atEnd(n);if(t==="start"||t===!0)return e;if(t==="end")return r;const s=e.from,i=r.to;return t==="all"?Gt.create(n,Cc(0,s,i),Cc(n.content.size,s,i)):Gt.create(n,Cc(t,s,i),Cc(t,s,i))}function xz(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function ik(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Sz=(n=null,t={})=>({editor:e,view:r,tr:s,dispatch:i})=>{t={scrollIntoView:!0,...t};const o=()=>{(ik()||xz())&&r.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&e.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!jR(e.state.selection))return o(),!0;const a=HR(s.doc,n)||e.state.selection,l=e.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},Az=(n,t)=>e=>n.every((r,s)=>t(r,{...e,index:s})),Ez=(n,t)=>({tr:e,commands:r})=>r.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),VR=n=>{const t=n.childNodes;for(let e=t.length-1;e>=0;e-=1){const r=t[e];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&VR(r)}return n};function zy(n){const t=`<body>${n}</body>`,e=new window.DOMParser().parseFromString(t,"text/html").body;return VR(e)}function $b(n,t,e){if(n instanceof Hl||n instanceof Z)return n;e={slice:!0,parseOptions:{},...e};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return Z.fromArray(n.map(a=>t.nodeFromJSON(a)));const o=t.nodeFromJSON(n);return e.errorOnInvalidContent&&o.check(),o}catch(i){if(e.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),$b("",t,e)}if(s){if(e.errorOnInvalidContent){let o=!1,a="";const l=new EI({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(e.slice?Vl.fromSchema(l).parseSlice(zy(n),e.parseOptions):Vl.fromSchema(l).parse(zy(n),e.parseOptions),e.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=Vl.fromSchema(t);return e.slice?i.parseSlice(zy(n),e.parseOptions).content:i.parse(zy(n),e.parseOptions)}return $b("",t,e)}function kz(n,t,e){const r=n.steps.length-1;if(r<t)return;const s=n.steps[r];if(!(s instanceof Un||s instanceof Kn))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(re.near(n.doc.resolve(o),e))}const Cz=n=>!("type"in n),Tz=(n,t,e)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){e={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...e};let a;try{a=$b(t,i.schema,{parseOptions:{preserveWhitespace:"full",...e.parseOptions},errorOnInvalidContent:(o=e.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(g){return i.emit("contentError",{editor:i,error:g,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},u=!0,d=!0;if((Cz(a)?a:[a]).forEach(g=>{g.check(),u=u?g.isText&&g.marks.length===0:!1,d=d?g.isBlock:!1}),l===c&&d){const{parent:g}=r.doc.resolve(l);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(l-=1,c+=1)}let p;if(u){if(Array.isArray(t))p=t.map(g=>g.text||"").join("");else if(t instanceof Z){let g="";t.forEach(m=>{m.text&&(g+=m.text)}),p=g}else typeof t=="object"&&t&&t.text?p=t.text:p=t;r.insertText(p,l,c)}else p=a,r.replaceWith(l,c,p);e.updateSelection&&kz(r,r.steps.length-1,-1),e.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:p}),e.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:p})}return!0},Mz=()=>({state:n,dispatch:t})=>TV(n,t),Pz=()=>({state:n,dispatch:t})=>MV(n,t),Oz=()=>({state:n,dispatch:t})=>ER(n,t),Iz=()=>({state:n,dispatch:t})=>MR(n,t),Rz=()=>({state:n,dispatch:t,tr:e})=>{try{const r=xw(n.doc,n.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},Dz=()=>({state:n,dispatch:t,tr:e})=>{try{const r=xw(n.doc,n.selection.$from.pos,1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},Nz=()=>({state:n,dispatch:t})=>kV(n,t),_z=()=>({state:n,dispatch:t})=>CV(n,t);function zR(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Lz(n){const t=n.split(/-(?!$)/);let e=t[t.length-1];e==="Space"&&(e=" ");let r,s,i,o;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))ik()||zR()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(e=`Alt-${e}`),s&&(e=`Ctrl-${e}`),o&&(e=`Meta-${e}`),i&&(e=`Shift-${e}`),e}const Fz=n=>({editor:t,view:e,tr:r,dispatch:s})=>{const i=Lz(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{e.someProp("handleKeyDown",c=>c(e,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function kg(n,t,e={}){const{from:r,to:s,empty:i}=n.selection,o=t?Yn(t,n.schema):null,a=[];n.doc.nodesBetween(r,s,(d,h)=>{if(d.isText)return;const p=Math.max(r,h),g=Math.min(s,h+d.nodeSize);a.push({node:d,from:p,to:g})});const l=s-r,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Bb(d.node.attrs,e,{strict:!1}));return i?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const Bz=(n,t={})=>({state:e,dispatch:r})=>{const s=Yn(n,e.schema);return kg(e,s,t)?PV(e,r):!1},$z=()=>({state:n,dispatch:t})=>RR(n,t),jz=n=>({state:t,dispatch:e})=>{const r=Yn(n,t.schema);return HV(r)(t,e)},Hz=()=>({state:n,dispatch:t})=>OR(n,t);function Rw(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function gM(n,t){const e=typeof t=="string"?[t]:t;return Object.keys(n).reduce((r,s)=>(e.includes(s)||(r[s]=n[s]),r),{})}const Vz=(n,t)=>({tr:e,state:r,dispatch:s})=>{let i=null,o=null;const a=Rw(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=Yn(n,r.schema)),a==="mark"&&(o=oc(n,r.schema)),s&&e.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&e.setNodeMarkup(u,void 0,gM(c.attrs,t)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&e.addMark(u,u+c.nodeSize,o.create(gM(d.attrs,t)))})})}),!0):!1},zz=()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),Uz=()=>({tr:n,dispatch:t})=>{if(t){const e=new Rs(n.doc);n.setSelection(e)}return!0},Wz=()=>({state:n,dispatch:t})=>CR(n,t),Kz=()=>({state:n,dispatch:t})=>PR(n,t),Gz=()=>({state:n,dispatch:t})=>DV(n,t),Yz=()=>({state:n,dispatch:t})=>LV(n,t),Xz=()=>({state:n,dispatch:t})=>_V(n,t);function gS(n,t,e={},r={}){return $b(n,t,{slice:!1,parseOptions:e,errorOnInvalidContent:r.errorOnInvalidContent})}const qz=(n,t=!1,e={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:u}=i;if(e.preserveWhitespace!=="full"){const d=gS(n,s.schema,e,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!t),!0}return o&&i.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:e,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function UR(n,t){const e=oc(t,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===e.name);return a?{...a.attrs}:{}}function Jz(n,t){const e=new jI(n);return t.forEach(r=>{r.steps.forEach(s=>{e.step(s)})}),e}function Qz(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function Zz(n,t,e){const r=[];return n.nodesBetween(t.from,t.to,(s,i)=>{e(s)&&r.push({node:s,pos:i})}),r}function tU(n,t){for(let e=n.depth;e>0;e-=1){const r=n.node(e);if(t(r))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:r}}}function ok(n){return t=>tU(t.$from,n)}function eU(n,t){const e={from:0,to:n.content.size};return FR(n,e,t)}function nU(n,t){const e=Yn(t,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===e.name);return o?{...o.attrs}:{}}function WR(n,t){const e=Rw(typeof t=="string"?t:t.name,n.schema);return e==="node"?nU(n,t):e==="mark"?UR(n,t):{}}function rU(n,t=JSON.stringify){const e={};return n.filter(r=>{const s=t(r);return Object.prototype.hasOwnProperty.call(e,s)?!1:e[s]=!0})}function sU(n){const t=rU(n);return t.length===1?t:t.filter((e,r)=>!t.filter((i,o)=>o!==r).some(i=>e.oldRange.from>=i.oldRange.from&&e.oldRange.to<=i.oldRange.to&&e.newRange.from>=i.newRange.from&&e.newRange.to<=i.newRange.to))}function iU(n){const{mapping:t,steps:e}=n,r=[];return t.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=e[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=t.slice(i).map(a,-1),u=t.slice(i).map(l),d=t.invert().map(c,-1),h=t.invert().map(u);r.push({oldRange:{from:d,to:h},newRange:{from:c,to:u}})})}),sU(r)}function ak(n,t,e){const r=[];return n===t?e.resolve(n).marks().forEach(s=>{const i=e.resolve(n),o=sk(i,s.type);o&&r.push({mark:s,...o})}):e.nodesBetween(n,t,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function b0(n,t,e){return Object.fromEntries(Object.entries(e).filter(([r])=>{const s=n.find(i=>i.type===t&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function mS(n,t,e={}){const{empty:r,ranges:s}=n.selection,i=t?oc(t,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>Bb(d.attrs,e,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:d,$to:h})=>{const p=d.pos,g=h.pos;n.doc.nodesBetween(p,g,(m,b)=>{if(!m.isText&&!m.marks.length)return;const y=Math.max(p,b),v=Math.min(g,b+m.nodeSize),x=v-y;o+=x,a.push(...m.marks.map(S=>({mark:S,from:y,to:v})))})}),o===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>Bb(d.mark.attrs,e,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=o}function oU(n,t,e={}){if(!t)return kg(n,null,e)||mS(n,null,e);const r=Rw(t,n.schema);return r==="node"?kg(n,t,e):r==="mark"?mS(n,t,e):!1}function mM(n,t){const{nodeExtensions:e}=Pw(t),r=e.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=le(At(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function lk(n,{checkChildren:t=!0,ignoreWhitespace:e=!1}={}){var r;if(e){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(t){let s=!0;return n.content.forEach(i=>{s!==!1&&(lk(i,{ignoreWhitespace:e,checkChildren:t})||(s=!1))}),s}return!1}function aU(n){return n instanceof Dt}function lU(n,t,e){var r;const{selection:s}=t;let i=null;if(jR(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!e.isInSet(a)||!a.some(l=>l.type.excludes(e))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(e):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const p=!h||h.type.allowsMarkType(e),g=!!e.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(e));c=p&&g}return!c}),c})}const cU=(n,t={})=>({tr:e,state:r,dispatch:s})=>{const{selection:i}=e,{empty:o,ranges:a}=i,l=oc(n,r.schema);if(s)if(o){const c=UR(r,l);e.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,p)=>{const g=Math.max(p,u),m=Math.min(p+h.nodeSize,d);h.marks.find(y=>y.type===l)?h.marks.forEach(y=>{l===y.type&&e.addMark(g,m,l.create({...y.attrs,...t}))}):e.addMark(g,m,l.create(t))})});return lU(r,e,l)},uU=(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),dU=(n,t={})=>({state:e,dispatch:r,chain:s})=>{const i=Yn(n,e.schema);let o;return e.selection.$anchor.sameParent(e.selection.$head)&&(o=e.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>uM(i,{...o,...t})(e)?!0:a.clearNodes()).command(({state:a})=>uM(i,{...o,...t})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},hU=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,s=Cc(n,0,r.content.size),i=Dt.create(r,s);t.setSelection(i)}return!0},fU=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=Gt.atStart(r).from,a=Gt.atEnd(r).to,l=Cc(s,o,a),c=Cc(i,o,a),u=Gt.create(r,l,c);t.setSelection(u)}return!0},pU=n=>({state:t,dispatch:e})=>{const r=Yn(n,t.schema);return UV(r)(t,e)};function yM(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const r=e.filter(s=>t==null?void 0:t.includes(s.type.name));n.tr.ensureMarks(r)}}const gU=({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:r,editor:s})=>{const{selection:i,doc:o}=t,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=b0(c,a.node().type.name,a.node().attrs);if(i instanceof Dt&&i.node.isBlock)return!a.parentOffset||!ya(o,a.pos)?!1:(r&&(n&&yM(e,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:Qz(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&h?[{type:h,attrs:u}]:void 0,g=ya(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!g&&ya(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(g=!0,p=h?[{type:h,attrs:u}]:void 0),r){if(g&&(i instanceof Gt&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const m=t.mapping.map(a.before()),b=t.doc.resolve(m);a.node(-1).canReplaceWith(b.index(),b.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}n&&yM(e,s.extensionManager.splittableMarks),t.scrollIntoView()}return g},mU=(n,t={})=>({tr:e,state:r,dispatch:s,editor:i})=>{var o;const a=Yn(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let y=Z.empty;const v=l.index(-1)?1:l.index(-2)?2:3;for(let I=l.depth-v;I>=l.depth-3;I-=1)y=Z.from(l.node(I).copy(y));const x=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S={...b0(h,l.node().type.name,l.node().attrs),...t},w=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(S))||void 0;y=y.append(Z.from(a.createAndFill(null,w)||void 0));const E=l.before(l.depth-(v-1));e.replace(E,l.after(-x),new ft(y,4-v,0));let T=-1;e.doc.nodesBetween(E,e.doc.content.size,(I,C)=>{if(T>-1)return!1;I.isTextblock&&I.content.size===0&&(T=C+1)}),T>-1&&e.setSelection(Gt.near(e.doc.resolve(T))),e.scrollIntoView()}return!0}const p=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,g={...b0(h,d.type.name,d.attrs),...t},m={...b0(h,l.node().type.name,l.node().attrs),...t};e.delete(l.pos,c.pos);const b=p?[{type:a,attrs:g},{type:p,attrs:m}]:[{type:a,attrs:g}];if(!ya(e.doc,l.pos,2))return!1;if(s){const{selection:y,storedMarks:v}=r,{splittableMarks:x}=i.extensionManager,S=v||y.$to.parentOffset&&y.$from.marks();if(e.split(l.pos,2,b).scrollIntoView(),!S||!s)return!0;const w=S.filter(E=>x.includes(E.type.name));e.ensureMarks(w)}return!0},Ox=(n,t)=>{const e=ok(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return e.node.type===(s==null?void 0:s.type)&&sc(n.doc,e.pos)&&n.join(e.pos),!0},Ix=(n,t)=>{const e=ok(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(e.start).after(e.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return e.node.type===(s==null?void 0:s.type)&&sc(n.doc,r)&&n.join(r),!0},yU=(n,t,e,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=s.extensionManager,p=Yn(n,o.schema),g=Yn(t,o.schema),{selection:m,storedMarks:b}=o,{$from:y,$to:v}=m,x=y.blockRange(v),S=b||m.$to.parentOffset&&m.$from.marks();if(!x)return!1;const w=ok(E=>mM(E.type.name,d))(m);if(x.depth>=1&&w&&x.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(g);if(mM(w.node.type.name,d)&&p.validContent(w.node.content)&&a)return l().command(()=>(i.setNodeMarkup(w.pos,p),!0)).command(()=>Ox(i,p)).command(()=>Ix(i,p)).run()}return!e||!S||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>Ox(i,p)).command(()=>Ix(i,p)).run():l().command(()=>{const E=u().wrapInList(p,r),T=S.filter(I=>h.includes(I.type.name));return i.ensureMarks(T),E?!0:c.clearNodes()}).wrapInList(p,r).command(()=>Ox(i,p)).command(()=>Ix(i,p)).run()},bU=(n,t={},e={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=e,o=oc(n,r.schema);return mS(r,o,t)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,t)},vU=(n,t,e={})=>({state:r,commands:s})=>{const i=Yn(n,r.schema),o=Yn(t,r.schema),a=kg(r,i,e);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...e})},wU=(n,t={})=>({state:e,commands:r})=>{const s=Yn(n,e.schema);return kg(e,s,t)?r.lift(s):r.wrapIn(s,t)},xU=()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let r=0;r<e.length;r+=1){const s=e[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(t){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},SU=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:r,ranges:s}=e;return r||t&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},AU=(n,t={})=>({tr:e,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=e,l=oc(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!s)return!0;if(u&&o){let{from:h,to:p}=a;const g=(i=c.marks().find(b=>b.type===l))===null||i===void 0?void 0:i.attrs,m=sk(c,l,g);m&&(h=m.from,p=m.to),e.removeMark(h,p,l)}else d.forEach(h=>{e.removeMark(h.$from.pos,h.$to.pos,l)});return e.removeStoredMark(l),!0},EU=(n,t={})=>({tr:e,state:r,dispatch:s})=>{let i=null,o=null;const a=Rw(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=Yn(n,r.schema)),a==="mark"&&(o=oc(n,r.schema)),s&&e.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,p,g;e.selection.empty?r.doc.nodesBetween(c,u,(m,b)=>{i&&i===m.type&&(p=Math.max(b,c),g=Math.min(b+m.nodeSize,u),d=b,h=m)}):r.doc.nodesBetween(c,u,(m,b)=>{b<c&&i&&i===m.type&&(p=Math.max(b,c),g=Math.min(b+m.nodeSize,u),d=b,h=m),b>=c&&b<=u&&(i&&i===m.type&&e.setNodeMarkup(b,void 0,{...m.attrs,...t}),o&&m.marks.length&&m.marks.forEach(y=>{if(o===y.type){const v=Math.max(b,c),x=Math.min(b+m.nodeSize,u);e.addMark(v,x,o.create({...y.attrs,...t}))}}))}),h&&(d!==void 0&&e.setNodeMarkup(d,void 0,{...h.attrs,...t}),o&&h.marks.length&&h.marks.forEach(m=>{o===m.type&&e.addMark(p,g,o.create({...m.attrs,...t}))}))}),!0):!1},kU=(n,t={})=>({state:e,dispatch:r})=>{const s=Yn(n,e.schema);return FV(s,t)(e,r)},CU=(n,t={})=>({state:e,dispatch:r})=>{const s=Yn(n,e.schema);return BV(s,t)(e,r)};var TU=Object.freeze({__proto__:null,blur:az,clearContent:lz,clearNodes:cz,command:uz,createParagraphNear:dz,cut:hz,deleteCurrentNode:fz,deleteNode:pz,deleteRange:gz,deleteSelection:mz,enter:yz,exitCode:bz,extendMarkRange:vz,first:wz,focus:Sz,forEach:Az,insertContent:Ez,insertContentAt:Tz,joinBackward:Oz,joinDown:Pz,joinForward:Iz,joinItemBackward:Rz,joinItemForward:Dz,joinTextblockBackward:Nz,joinTextblockForward:_z,joinUp:Mz,keyboardShortcut:Fz,lift:Bz,liftEmptyBlock:$z,liftListItem:jz,newlineInCode:Hz,resetAttributes:Vz,scrollIntoView:zz,selectAll:Uz,selectNodeBackward:Wz,selectNodeForward:Kz,selectParentNode:Gz,selectTextblockEnd:Yz,selectTextblockStart:Xz,setContent:qz,setMark:cU,setMeta:uU,setNode:dU,setNodeSelection:hU,setTextSelection:fU,sinkListItem:pU,splitBlock:gU,splitListItem:mU,toggleList:yU,toggleMark:bU,toggleNode:vU,toggleWrap:wU,undoInputRule:xU,unsetAllMarks:SU,unsetMark:AU,updateAttributes:EU,wrapIn:kU,wrapInList:CU});const MU=Xn.create({name:"commands",addCommands(){return{...TU}}}),PU=Xn.create({name:"drop",addProseMirrorPlugins(){return[new cr({key:new Ls("tiptapDrop"),props:{handleDrop:(n,t,e,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:e,moved:r})}}})]}}),OU=Xn.create({name:"editable",addProseMirrorPlugins(){return[new cr({key:new Ls("editable"),props:{editable:()=>this.editor.options.editable}})]}}),IU=new Ls("focusEvents"),RU=Xn.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new cr({key:IU,props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,e)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),DU=Xn.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:p}=d,g=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,m=g.parent.type.spec.isolating,b=d.pos-d.parentOffset,y=m&&g.parent.childCount===1?b===d.pos:re.atStart(c).from===h;return!u||!p.type.isTextblock||p.textContent.length||!y||y&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ik()||zR()?i:s},addProseMirrorPlugins(){return[new cr({key:new Ls("clearDocument"),appendTransaction:(n,t,e)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!t.doc.eq(e.doc),s=n.some(m=>m.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=t.selection,l=re.atStart(t.doc).from,c=re.atEnd(t.doc).to;if(i||!(o===l&&a===c)||!lk(e.doc))return;const h=e.tr,p=Tw({state:e,transaction:h}),{commands:g}=new Mw({editor:this.editor,state:p});if(g.clearNodes(),!!h.steps.length)return h}})]}}),NU=Xn.create({name:"paste",addProseMirrorPlugins(){return[new cr({key:new Ls("tiptapPaste"),props:{handlePaste:(n,t,e)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:e})}}})]}}),_U=Xn.create({name:"tabindex",addProseMirrorPlugins(){return[new cr({key:new Ls("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class wc{get name(){return this.node.type.name}constructor(t,e,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=e,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}e=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:e,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new wc(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new wc(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new wc(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,r)=>{const s=e.isBlock&&!e.isTextblock,i=e.isAtom&&!e.isText,o=this.pos+r+(i?0:1),a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new wc(a,this.editor,s,s?e:null);s&&(l.actualDepth=this.depth+1),t.push(new wc(a,this.editor,s,s?e:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(e).length>0){const i=s.node.attrs,o=Object.keys(e);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==e[l])break}}else r=s;s=s.parent}return r}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(e);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===t&&i.every(l=>e[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(t,e,r))))}),s}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}}const LU=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function FU(n,t,e){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}let BU=class extends WV{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:r,moved:s})=>this.options.onDrop(e,r,s)),this.on("paste",({event:e,slice:r})=>this.options.onPaste(e,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=FU(LU,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const r=LR(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),e.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var t,e;const s=[...this.options.enableCoreExtensions?[OU,oz.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||e===void 0?void 0:e.blockSeparator}),MU,RU,DU,_U,PU,NU].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new jd(s,this)}createCommandManager(){this.commandManager=new Mw({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let e;try{e=gS(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),e=gS(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=HR(e,this.options.autofocus);this.view=new pV(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(t=this.options.editorProps)===null||t===void 0?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:$d.create({doc:e,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const e=this.state.apply(t),r=!this.state.selection.eq(e.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=t.getMeta("focus"),i=t.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return WR(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,s=typeof t=="string"?e:t;return oU(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return nk(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return eU(this.state.doc,{blockSeparator:e,textSerializers:{...BR(this.schema),...r}})}get isEmpty(){return lk(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,e){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new wc(e,this)}get $doc(){return this.$pos(0)}};function Zu(n){return new Ow({find:n.find,handler:({state:t,range:e,match:r})=>{const s=le(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=t,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=e.from+a.indexOf(o),u=c+o.length;if(ak(e.from,e.to,t.doc).filter(p=>p.mark.type.excluded.find(m=>m===n.type&&m!==p.mark.type)).filter(p=>p.to>c).length)return null;u<e.to&&i.delete(u,e.to),c>e.from&&i.delete(e.from+l,c);const h=e.from+l+o.length;i.addMark(e.from+l,h,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function KR(n){return new Ow({find:n.find,handler:({state:t,range:e,match:r})=>{const s=le(n.getAttributes,void 0,r)||{},{tr:i}=t,o=e.from;let a=e.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,o+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function yS(n){return new Ow({find:n.find,handler:({state:t,range:e,match:r})=>{const s=t.doc.resolve(e.from),i=le(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,i)}})}function Sf(n){return new Ow({find:n.find,handler:({state:t,range:e,match:r,chain:s})=>{const i=le(n.getAttributes,void 0,r)||{},o=t.tr.delete(e.from,e.to),l=o.doc.resolve(e.from).blockRange(),c=l&&jE(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:h}=t,{splittableMarks:p}=n.editor.extensionManager,g=h||d.$to.parentOffset&&d.$from.marks();if(g){const m=g.filter(b=>p.includes(b.type.name));o.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,i).run()}const u=o.doc.resolve(e.from-1).nodeBefore;u&&u.type===n.type&&sc(o.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(e.from-1)}})}let us=class bS{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(At(this,"addOptions",{name:this.name}))),this.storage=le(At(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new bS(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Iw(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new bS(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=le(At(e,"addOptions",{name:e.name})),e.storage=le(At(e,"addStorage",{name:e.name,options:e.options})),e}};function tc(n){return new tz({find:n.find,handler:({state:t,range:e,match:r,pasteEvent:s})=>{const i=le(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=t,a=r[r.length-1],l=r[0];let c=e.to;if(a){const u=l.search(/\S/),d=e.from+l.indexOf(a),h=d+a.length;if(ak(e.from,e.to,t.doc).filter(g=>g.mark.type.excluded.find(b=>b===n.type&&b!==g.mark.type)).filter(g=>g.to>d).length)return null;h<e.to&&o.delete(h,e.to),d>e.from&&o.delete(e.from+u,d),c=e.from+u+a.length,o.addMark(e.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function bM(n){return oE((t,e)=>({get(){return t(),n},set(r){n=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}}))}class $U extends BU{constructor(t={}){return super(t),this.contentComponent=null,this.appContext=null,this.reactiveState=bM(this.view.state),this.reactiveExtensionStorage=bM(this.extensionStorage),this.on("beforeTransaction",({nextState:e})=>{this.reactiveState.value=e,this.reactiveExtensionStorage.value=this.extensionStorage}),sy(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){const r=super.registerPlugin(t,e);return this.reactiveState&&(this.reactiveState.value=r),r}unregisterPlugin(t){const e=super.unregisterPlugin(t);return this.reactiveState&&e&&(this.reactiveState.value=e),e}}const jU=Mf({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const t=ot(),e=_s();return SP(()=>{const r=n.editor;r&&r.options.element&&t.value&&od(()=>{if(!t.value||!r.options.element.firstChild)return;const s=ee(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=e.ctx._,e&&(r.appContext={...e.appContext,provides:e.provides}),r.setOptions({element:s}),r.createNodeViews()})}),ad(()=>{const r=n.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:t}},render(){return ly("div",{ref:n=>{this.rootEl=n}})}}),HU=/^\s*>\s$/,VU=us.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Sf({find:HU,type:this.type})]}}),zU=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,UU=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,WU=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,KU=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,GU=cs.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Zu({find:zU,type:this.type}),Zu({find:WU,type:this.type})]},addPasteRules(){return[tc({find:UU,type:this.type}),tc({find:KU,type:this.type})]}}),YU="listItem",vM="textStyle",wM=/^\s*([-+*])\s$/,XU=us.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(YU,this.editor.getAttributes(vM)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Sf({find:wM,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Sf({find:wM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(vM),editor:this.editor})),[n]}}),qU=/(^|[^`])`([^`]+)`(?!`)/,JU=/(^|[^`])`([^`]+)`(?!`)/g,QU=cs.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Zu({find:qU,type:this.type})]},addPasteRules(){return[tc({find:JU,type:this.type})]}}),ZU=/^```([a-z]+)?[\s\n]$/,t8=/^~~~([a-z]+)?[\s\n]$/,e8=us.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var t;const{languageClassPrefix:e}=this.options,i=[...((t=n.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(o=>o.startsWith(e)).map(o=>o.replace(e,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:t}){return["pre",Je(this.options.HTMLAttributes,t),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:t})=>t.setNode(this.name,n),toggleCodeBlock:n=>({commands:t})=>t.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:t}=this.editor.state.selection,e=t.pos===1;return!n||t.parent.type.name!==this.name?!1:e||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=n,{selection:e}=t,{$from:r,empty:s}=e;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=n,{selection:e,doc:r}=t,{$from:s,empty:i}=e;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(re.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[yS({find:ZU,type:this.type,getAttributes:n=>({language:n[1]})}),yS({find:t8,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new cr({key:new Ls("codeBlockVSCodeHandler"),props:{handlePaste:(n,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const e=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!e||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(e.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(Gt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),n8=us.create({name:"doc",topNode:!0,content:"block+"});function r8(n={}){return new cr({view(t){return new s8(t,n)}})}class s8{constructor(t,e){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=e.width)!==null&&r!==void 0?r:1,this.color=e.color===!1?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return t.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){this.cursorPos!=null&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),e=!t.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(e){let d=t.nodeBefore,h=t.nodeAfter;if(d||h){let p=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(p){let g=p.getBoundingClientRect(),m=d?g.bottom:g.top;d&&h&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let b=this.width/2*a;r={left:g.left,right:g.right,top:m-b,bottom:m+b}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*o;r={left:d.left-h,right:d.left+h,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",e),this.element.classList.toggle("prosemirror-dropcursor-inline",!e);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=l.getBoundingClientRect(),h=d.width/l.offsetWidth,p=d.height/l.offsetHeight;c=d.left-l.scrollLeft*h,u=d.top-l.scrollTop*p}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,e,t):s;if(e&&!i){let o=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=_I(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}const i8=Xn.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[r8(this.options)]}});class yn extends re{constructor(t){super(t,t)}map(t,e){let r=t.resolve(e.map(this.head));return yn.valid(r)?new yn(r):re.near(r)}content(){return ft.empty}eq(t){return t instanceof yn&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new yn(t.resolve(e.pos))}getBookmark(){return new ck(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!o8(t)||!a8(t))return!1;let r=e.type.spec.allowGapCursor;if(r!=null)return r;let s=e.contentMatchAt(t.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(t,e,r=!1){t:for(;;){if(!r&&yn.valid(t))return t;let s=t.pos,i=null;for(let o=t.depth;;o--){let a=t.node(o);if(e>0?t.indexAfter(o)<a.childCount:t.index(o)>0){i=a.child(e>0?t.indexAfter(o):t.index(o)-1);break}else if(o==0)return null;s+=e;let l=t.doc.resolve(s);if(yn.valid(l))return l}for(;;){let o=e>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!Dt.isSelectable(i)){t=t.doc.resolve(s+i.nodeSize*e),r=!1;continue t}break}i=o,s+=e;let a=t.doc.resolve(s);if(yn.valid(a))return a}return null}}}yn.prototype.visible=!1;yn.findFrom=yn.findGapCursorFrom;re.jsonID("gapcursor",yn);class ck{constructor(t){this.pos=t}map(t){return new ck(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return yn.valid(e)?new yn(e):re.near(e)}}function o8(n){for(let t=n.depth;t>=0;t--){let e=n.index(t),r=n.node(t);if(e==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(e-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function a8(n){for(let t=n.depth;t>=0;t--){let e=n.indexAfter(t),r=n.node(t);if(e==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(e);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function l8(){return new cr({props:{decorations:h8,createSelectionBetween(n,t,e){return t.pos==e.pos&&yn.valid(e)?new yn(e):null},handleClick:u8,handleKeyDown:c8,handleDOMEvents:{beforeinput:d8}}})}const c8=SR({ArrowLeft:Uy("horiz",-1),ArrowRight:Uy("horiz",1),ArrowUp:Uy("vert",-1),ArrowDown:Uy("vert",1)});function Uy(n,t){const e=n=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,s,i){let o=r.selection,a=t>0?o.$to:o.$from,l=o.empty;if(o instanceof Gt){if(!i.endOfTextblock(e)||a.depth==0)return!1;l=!1,a=r.doc.resolve(t>0?a.after():a.before())}let c=yn.findGapCursorFrom(a,t,l);return c?(s&&s(r.tr.setSelection(new yn(c))),!0):!1}}function u8(n,t,e){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(t);if(!yn.valid(r))return!1;let s=n.posAtCoords({left:e.clientX,top:e.clientY});return s&&s.inside>-1&&Dt.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new yn(r))),!0)}function d8(n,t){if(t.inputType!="insertCompositionText"||!(n.state.selection instanceof yn))return!1;let{$from:e}=n.state.selection,r=e.parent.contentMatchAt(e.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=Z.empty;for(let o=r.length-1;o>=0;o--)s=Z.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(e.pos,e.pos,new ft(s,0,0));return i.setSelection(Gt.near(i.doc.resolve(e.pos+1))),n.dispatch(i),!1}function h8(n){if(!(n.selection instanceof yn))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Dn.create(n.doc,[ti.widget(n.selection.head,t,{key:"gapcursor"})])}const f8=Xn.create({name:"gapCursor",addProseMirrorPlugins(){return[l8()]},extendNodeSchema(n){var t;const e={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(t=le(At(n,"allowGapCursor",e)))!==null&&t!==void 0?t:null}}}),p8=us.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Je(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:t,state:e,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=e;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),g8=us.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:t}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Je(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.setNode(this.name,n):!1,toggleHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,t)=>({...n,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(n=>yS({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var jb=200,Gn=function(){};Gn.prototype.append=function(t){return t.length?(t=Gn.from(t),!this.length&&t||t.length<jb&&this.leafAppend(t)||this.length<jb&&t.leafPrepend(this)||this.appendInner(t)):this};Gn.prototype.prepend=function(t){return t.length?Gn.from(t).append(this):this};Gn.prototype.appendInner=function(t){return new m8(this,t)};Gn.prototype.slice=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=this.length),t>=e?Gn.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))};Gn.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Gn.prototype.forEach=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length),e<=r?this.forEachInner(t,e,r,0):this.forEachInvertedInner(t,e,r,0)};Gn.prototype.map=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(t(i,o))},e,r),s};Gn.from=function(t){return t instanceof Gn?t:t&&t.length?new GR(t):Gn.empty};var GR=function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new t(this.values.slice(s,i))},t.prototype.getInner=function(s){return this.values[s]},t.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(s){if(this.length+s.length<=jb)return new t(this.values.concat(s.flatten()))},t.prototype.leafPrepend=function(s){if(this.length+s.length<=jb)return new t(s.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t}(Gn);Gn.empty=new GR([]);var m8=function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},t.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},t.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},t.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new t(this.left,s)},t.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new t(s,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(Gn);const y8=500;class ki{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;e&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=t.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){s||(s=this.remapping(r,h+1),i=s.maps.length),i--,u.push(d);return}if(s){u.push(new Hi(d.map));let p=d.step.map(s.slice(i)),g;p&&o.maybeStep(p).doc&&(g=o.mapping.maps[o.mapping.maps.length-1],c.push(new Hi(g,void 0,void 0,c.length+u.length))),i--,g&&s.appendMap(g,i)}else o.maybeStep(d.step);if(d.selection)return a=s?d.selection.map(s.slice(i)):d.selection,l=new ki(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(t,e,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<t.steps.length;u++){let d=t.steps[u].invert(t.docs[u]),h=new Hi(t.mapping.maps[u],d,e),p;(p=l&&l.merge(h))&&(h=p,u?i.pop():a=a.slice(0,a.length-1)),i.push(h),e&&(o++,e=void 0),s||(l=h)}let c=o-r.depth;return c>v8&&(a=b8(a,c),o-=c),new ki(a.append(i),o)}remapping(t,e){let r=new wg;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=t?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},t,e),r}addMaps(t){return this.eventCount==0?this:new ki(this.items.append(t.map(e=>new Hi(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-e),i=t.mapping,o=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},s);let l=e;this.items.forEach(h=>{let p=i.getMirror(--l);if(p==null)return;o=Math.min(o,p);let g=i.maps[p];if(h.step){let m=t.steps[p].invert(t.docs[p]),b=h.selection&&h.selection.map(i.slice(l+1,p));b&&a++,r.push(new Hi(g,m,b))}else r.push(new Hi(g))},s);let c=[];for(let h=e;h<o;h++)c.push(new Hi(i.maps[h]));let u=this.items.slice(0,s).append(c).append(r),d=new ki(u,a);return d.emptyItemCount()>y8&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=t)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(e.slice(r)),c=l&&l.getMap();if(r--,c&&e.appendMap(c,r),l){let u=o.selection&&o.selection.map(e.slice(r));u&&i++;let d=new Hi(c.invert(),l,u),h,p=s.length-1;(h=s.length&&s[p].merge(d))?s[p]=h:s.push(d)}}else o.map&&r--},this.items.length,0),new ki(Gn.from(s.reverse()),i)}}ki.empty=new ki(Gn.empty,0);function b8(n,t){let e;return n.forEach((r,s)=>{if(r.selection&&t--==0)return e=s,!1}),n.slice(e)}class Hi{constructor(t,e,r,s){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=s}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new Hi(e.getMap().invert(),e,this.selection)}}}class qa{constructor(t,e,r,s,i){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const v8=20;function w8(n,t,e,r){let s=e.getMeta(Vu),i;if(s)return s.historyState;e.getMeta(A8)&&(n=new qa(n.done,n.undone,null,0,-1));let o=e.getMeta("appendedTransaction");if(e.steps.length==0)return n;if(o&&o.getMeta(Vu))return o.getMeta(Vu).redo?new qa(n.done.addTransform(e,void 0,r,v0(t)),n.undone,xM(e.mapping.maps),n.prevTime,n.prevComposition):new qa(n.done,n.undone.addTransform(e,void 0,r,v0(t)),null,n.prevTime,n.prevComposition);if(e.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=e.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(e.time||0)-r.newGroupDelay||!x8(e,n.prevRanges)),c=o?Rx(n.prevRanges,e.mapping):xM(e.mapping.maps);return new qa(n.done.addTransform(e,l?t.selection.getBookmark():void 0,r,v0(t)),ki.empty,c,e.time,a??n.prevComposition)}else return(i=e.getMeta("rebased"))?new qa(n.done.rebased(e,i),n.undone.rebased(e,i),Rx(n.prevRanges,e.mapping),n.prevTime,n.prevComposition):new qa(n.done.addMaps(e.mapping.maps),n.undone.addMaps(e.mapping.maps),Rx(n.prevRanges,e.mapping),n.prevTime,n.prevComposition)}function x8(n,t){if(!t)return!1;if(!n.docChanged)return!0;let e=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<t.length;i+=2)r<=t[i+1]&&s>=t[i]&&(e=!0)}),e}function xM(n){let t=[];for(let e=n.length-1;e>=0&&t.length==0;e--)n[e].forEach((r,s,i,o)=>t.push(i,o));return t}function Rx(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let s=t.map(n[r],1),i=t.map(n[r+1],-1);s<=i&&e.push(s,i)}return e}function S8(n,t,e){let r=v0(t),s=Vu.get(t).spec.config,i=(e?n.undone:n.done).popEvent(t,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(e?n.done:n.undone).addTransform(i.transform,t.selection.getBookmark(),s,r),l=new qa(e?a:i.remaining,e?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Vu,{redo:e,historyState:l})}let Dx=!1,SM=null;function v0(n){let t=n.plugins;if(SM!=t){Dx=!1,SM=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){Dx=!0;break}}return Dx}const Vu=new Ls("history"),A8=new Ls("closeHistory");function E8(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new cr({key:Vu,state:{init(){return new qa(ki.empty,ki.empty,null,0,-1)},apply(t,e,r){return w8(e,r,t,n)}},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,s=r=="historyUndo"?XR:r=="historyRedo"?qR:null;return s?(e.preventDefault(),s(t.state,t.dispatch)):!1}}}})}function YR(n,t){return(e,r)=>{let s=Vu.getState(e);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=S8(s,e,n);i&&r(t?i.scrollIntoView():i)}return!0}}const XR=YR(!1,!0),qR=YR(!0,!0),k8=Xn.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:t})=>XR(n,t),redo:()=>({state:n,dispatch:t})=>qR(n,t)}},addProseMirrorPlugins(){return[E8(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),C8=us.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Je(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:t})=>{const{selection:e}=t,{$from:r,$to:s}=e,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):aU(e)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(Gt.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(Dt.create(o.doc,c.pos)):o.setSelection(Gt.create(o.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(o.insert(u,d),o.setSelection(Gt.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[KR({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),T8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,M8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,P8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,O8=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,I8=cs.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Zu({find:T8,type:this.type}),Zu({find:P8,type:this.type})]},addPasteRules(){return[tc({find:M8,type:this.type}),tc({find:O8,type:this.type})]}}),R8=us.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Je(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),D8="listItem",AM="textStyle",EM=/^(\d+)\.\s$/,N8=us.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:t,...e}=n;return t===1?["ol",Je(this.options.HTMLAttributes,e),0]:["ol",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(D8,this.editor.getAttributes(AM)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Sf({find:EM,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Sf({find:EM,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(AM)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[n]}}),_8=us.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),L8=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,F8=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,JR=cs.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Zu({find:L8,type:this.type})]},addPasteRules(){return[tc({find:F8,type:this.type})]}}),B8=us.create({name:"text",group:"inline"}),$8=Xn.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(GU.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(VU.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(XU.configure(this.options.bulletList)),this.options.code!==!1&&n.push(QU.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(e8.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(n8.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(i8.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(f8.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(p8.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(g8.configure(this.options.heading)),this.options.history!==!1&&n.push(k8.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(C8.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(I8.configure(this.options.italic)),this.options.listItem!==!1&&n.push(R8.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(N8.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(_8.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(JR.configure(this.options.strike)),this.options.text!==!1&&n.push(B8.configure(this.options.text)),n}}),j8=cs.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),H8=cs.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(n){return n!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sub",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setSubscript:()=>({commands:n})=>n.setMark(this.name),toggleSubscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSubscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),V8=cs.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(n){return n!=="super"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sup",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setSuperscript:()=>({commands:n})=>n.setMark(this.name),toggleSuperscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSuperscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),z8=Xn.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>{const t=n.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:n=>n.textAlign?{style:`text-align: ${n.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:n=>({commands:t})=>this.options.alignments.includes(n)?this.options.types.map(e=>t.updateAttributes(e,{textAlign:n})).every(e=>e):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(t=>n.resetAttributes(t,"textAlign")).every(t=>t),toggleTextAlign:n=>({editor:t,commands:e})=>this.options.alignments.includes(n)?t.isActive({textAlign:n})?e.unsetTextAlign():e.setTextAlign(n):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),U8=n=>{if(!n.children.length)return;const t=n.querySelectorAll("span");t&&t.forEach(e=>{var r,s;const i=e.getAttribute("style"),o=(s=(r=e.parentElement)===null||r===void 0?void 0:r.closest("span"))===null||s===void 0?void 0:s.getAttribute("style");e.setAttribute("style",`${o};${i}`)})},W8=cs.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&U8(n),{}):!1}]},renderHTML({HTMLAttributes:n}){return["span",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:n})=>{const{selection:t}=n;return n.doc.nodesBetween(t.from,t.to,(e,r)=>{if(e.isTextblock)return!0;e.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(i=>!!i))||n.removeMark(r,r+e.nodeSize,this.type)}),!0}}}}),K8=Xn.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:n=>n.style.fontFamily,renderHTML:n=>n.fontFamily?{style:`font-family: ${n.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:n=>({chain:t})=>t().setMark("textStyle",{fontFamily:n}).run(),unsetFontFamily:()=>({chain:n})=>n().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),G8=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Y8=us.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",Je(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:t})=>t.insertContent({type:this.name,attrs:n})}},addInputRules(){return[KR({find:G8,type:this.type,getAttributes:n=>{const[,,t,e,r]=n;return{src:e,alt:t,title:r}}})]}}),X8="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",q8="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",Af=(n,t)=>{for(const e in t)n[e]=t[e];return n},vS="numeric",wS="ascii",xS="alpha",jp="asciinumeric",tp="alphanumeric",SS="domain",QR="emoji",J8="scheme",Q8="slashscheme",Nx="whitespace";function Z8(n,t){return n in t||(t[n]=[]),t[n]}function Tc(n,t,e){t[vS]&&(t[jp]=!0,t[tp]=!0),t[wS]&&(t[jp]=!0,t[xS]=!0),t[jp]&&(t[tp]=!0),t[xS]&&(t[tp]=!0),t[tp]&&(t[SS]=!0),t[QR]&&(t[SS]=!0);for(const r in t){const s=Z8(r,e);s.indexOf(n)<0&&s.push(n)}}function tW(n,t){const e={};for(const r in t)t[r].indexOf(n)>=0&&(e[r]=!0);return e}function is(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}is.groups={};is.prototype={accepts(){return!!this.t},go(n){const t=this,e=t.j[n];if(e)return e;for(let r=0;r<t.jr.length;r++){const s=t.jr[r][0],i=t.jr[r][1];if(i&&s.test(n))return i}return t.jd},has(n,t=!1){return t?n in this.j:!!this.go(n)},ta(n,t,e,r){for(let s=0;s<n.length;s++)this.tt(n[s],t,e,r)},tr(n,t,e,r){r=r||is.groups;let s;return t&&t.j?s=t:(s=new is(t),e&&r&&Tc(t,e,r)),this.jr.push([n,s]),s},ts(n,t,e,r){let s=this;const i=n.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(n[o]);return s.tt(n[i-1],t,e,r)},tt(n,t,e,r){r=r||is.groups;const s=this;if(t&&t.j)return s.j[n]=t,t;const i=t;let o,a=s.go(n);if(a?(o=new is,Af(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new is,i){if(r)if(o.t&&typeof o.t=="string"){const l=Af(tW(o.t,r),e);Tc(i,l,r)}else e&&Tc(i,e,r);o.t=i}return s.j[n]=o,o}};const ie=(n,t,e,r,s)=>n.ta(t,e,r,s),hn=(n,t,e,r,s)=>n.tr(t,e,r,s),kM=(n,t,e,r,s)=>n.ts(t,e,r,s),nt=(n,t,e,r,s)=>n.tt(t,e,r,s),Mo="WORD",AS="UWORD",ZR="ASCIINUMERICAL",tD="ALPHANUMERICAL",Cg="LOCALHOST",ES="TLD",kS="UTLD",w0="SCHEME",Pd="SLASH_SCHEME",uk="NUM",CS="WS",dk="NL",Hp="OPENBRACE",Vp="CLOSEBRACE",Hb="OPENBRACKET",Vb="CLOSEBRACKET",zb="OPENPAREN",Ub="CLOSEPAREN",Wb="OPENANGLEBRACKET",Kb="CLOSEANGLEBRACKET",Gb="FULLWIDTHLEFTPAREN",Yb="FULLWIDTHRIGHTPAREN",Xb="LEFTCORNERBRACKET",qb="RIGHTCORNERBRACKET",Jb="LEFTWHITECORNERBRACKET",Qb="RIGHTWHITECORNERBRACKET",Zb="FULLWIDTHLESSTHAN",tv="FULLWIDTHGREATERTHAN",ev="AMPERSAND",nv="APOSTROPHE",rv="ASTERISK",Ja="AT",sv="BACKSLASH",iv="BACKTICK",ov="CARET",el="COLON",hk="COMMA",av="DOLLAR",Vi="DOT",lv="EQUALS",fk="EXCLAMATION",Hs="HYPHEN",zp="PERCENT",cv="PIPE",uv="PLUS",dv="POUND",Up="QUERY",pk="QUOTE",eD="FULLWIDTHMIDDLEDOT",gk="SEMI",zi="SLASH",Wp="TILDE",hv="UNDERSCORE",nD="EMOJI",fv="SYM";var rD=Object.freeze({__proto__:null,ALPHANUMERICAL:tD,AMPERSAND:ev,APOSTROPHE:nv,ASCIINUMERICAL:ZR,ASTERISK:rv,AT:Ja,BACKSLASH:sv,BACKTICK:iv,CARET:ov,CLOSEANGLEBRACKET:Kb,CLOSEBRACE:Vp,CLOSEBRACKET:Vb,CLOSEPAREN:Ub,COLON:el,COMMA:hk,DOLLAR:av,DOT:Vi,EMOJI:nD,EQUALS:lv,EXCLAMATION:fk,FULLWIDTHGREATERTHAN:tv,FULLWIDTHLEFTPAREN:Gb,FULLWIDTHLESSTHAN:Zb,FULLWIDTHMIDDLEDOT:eD,FULLWIDTHRIGHTPAREN:Yb,HYPHEN:Hs,LEFTCORNERBRACKET:Xb,LEFTWHITECORNERBRACKET:Jb,LOCALHOST:Cg,NL:dk,NUM:uk,OPENANGLEBRACKET:Wb,OPENBRACE:Hp,OPENBRACKET:Hb,OPENPAREN:zb,PERCENT:zp,PIPE:cv,PLUS:uv,POUND:dv,QUERY:Up,QUOTE:pk,RIGHTCORNERBRACKET:qb,RIGHTWHITECORNERBRACKET:Qb,SCHEME:w0,SEMI:gk,SLASH:zi,SLASH_SCHEME:Pd,SYM:fv,TILDE:Wp,TLD:ES,UNDERSCORE:hv,UTLD:kS,UWORD:AS,WORD:Mo,WS:CS});const Co=/[a-z]/,$f=new RegExp("\\p{L}","u"),_x=new RegExp("\\p{Emoji}","u"),To=/\d/,Lx=/\s/,CM="\r",Fx=`
`,eW="️",nW="‍",Bx="￼";let Wy=null,Ky=null;function rW(n=[]){const t={};is.groups=t;const e=new is;Wy==null&&(Wy=TM(X8)),Ky==null&&(Ky=TM(q8)),nt(e,"'",nv),nt(e,"{",Hp),nt(e,"}",Vp),nt(e,"[",Hb),nt(e,"]",Vb),nt(e,"(",zb),nt(e,")",Ub),nt(e,"<",Wb),nt(e,">",Kb),nt(e,"（",Gb),nt(e,"）",Yb),nt(e,"「",Xb),nt(e,"」",qb),nt(e,"『",Jb),nt(e,"』",Qb),nt(e,"＜",Zb),nt(e,"＞",tv),nt(e,"&",ev),nt(e,"*",rv),nt(e,"@",Ja),nt(e,"`",iv),nt(e,"^",ov),nt(e,":",el),nt(e,",",hk),nt(e,"$",av),nt(e,".",Vi),nt(e,"=",lv),nt(e,"!",fk),nt(e,"-",Hs),nt(e,"%",zp),nt(e,"|",cv),nt(e,"+",uv),nt(e,"#",dv),nt(e,"?",Up),nt(e,'"',pk),nt(e,"/",zi),nt(e,";",gk),nt(e,"~",Wp),nt(e,"_",hv),nt(e,"\\",sv),nt(e,"・",eD);const r=hn(e,To,uk,{[vS]:!0});hn(r,To,r);const s=hn(r,Co,ZR,{[jp]:!0}),i=hn(r,$f,tD,{[tp]:!0}),o=hn(e,Co,Mo,{[wS]:!0});hn(o,To,s),hn(o,Co,o),hn(s,To,s),hn(s,Co,s);const a=hn(e,$f,AS,{[xS]:!0});hn(a,Co),hn(a,To,i),hn(a,$f,a),hn(i,To,i),hn(i,Co),hn(i,$f,i);const l=nt(e,Fx,dk,{[Nx]:!0}),c=nt(e,CM,CS,{[Nx]:!0}),u=hn(e,Lx,CS,{[Nx]:!0});nt(e,Bx,u),nt(c,Fx,l),nt(c,Bx,u),hn(c,Lx,u),nt(u,CM),nt(u,Fx),hn(u,Lx,u),nt(u,Bx,u);const d=hn(e,_x,nD,{[QR]:!0});nt(d,"#"),hn(d,_x,d),nt(d,eW,d);const h=nt(d,nW);nt(h,"#"),hn(h,_x,d);const p=[[Co,o],[To,s]],g=[[Co,null],[$f,a],[To,i]];for(let m=0;m<Wy.length;m++)Fa(e,Wy[m],ES,Mo,p);for(let m=0;m<Ky.length;m++)Fa(e,Ky[m],kS,AS,g);Tc(ES,{tld:!0,ascii:!0},t),Tc(kS,{utld:!0,alpha:!0},t),Fa(e,"file",w0,Mo,p),Fa(e,"mailto",w0,Mo,p),Fa(e,"http",Pd,Mo,p),Fa(e,"https",Pd,Mo,p),Fa(e,"ftp",Pd,Mo,p),Fa(e,"ftps",Pd,Mo,p),Tc(w0,{scheme:!0,ascii:!0},t),Tc(Pd,{slashscheme:!0,ascii:!0},t),n=n.sort((m,b)=>m[0]>b[0]?1:-1);for(let m=0;m<n.length;m++){const b=n[m][0],v=n[m][1]?{[J8]:!0}:{[Q8]:!0};b.indexOf("-")>=0?v[SS]=!0:Co.test(b)?To.test(b)?v[jp]=!0:v[wS]=!0:v[vS]=!0,kM(e,b,b,v)}return kM(e,"localhost",Cg,{ascii:!0}),e.jd=new is(fv),{start:e,tokens:Af({groups:t},rD)}}function sD(n,t){const e=sW(t.replace(/[A-Z]/g,a=>a.toLowerCase())),r=e.length,s=[];let i=0,o=0;for(;o<r;){let a=n,l=null,c=0,u=null,d=-1,h=-1;for(;o<r&&(l=a.go(e[o]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=e[o].length,h++),c+=e[o].length,i+=e[o].length,o++;i-=d,o-=h,c-=d,s.push({t:u.t,v:t.slice(i-c,i),s:i-c,e:i})}return s}function sW(n){const t=[],e=n.length;let r=0;for(;r<e;){let s=n.charCodeAt(r),i,o=s<55296||s>56319||r+1===e||(i=n.charCodeAt(r+1))<56320||i>57343?n[r]:n.slice(r,r+2);t.push(o),r+=o.length}return t}function Fa(n,t,e,r,s){let i;const o=t.length;for(let a=0;a<o-1;a++){const l=t[a];n.j[l]?i=n.j[l]:(i=new is(r),i.jr=s.slice(),n.j[l]=i),n=i}return i=new is(e),i.jr=s.slice(),n.j[t[o-1]]=i,i}function TM(n){const t=[],e=[];let r=0,s="0123456789";for(;r<n.length;){let i=0;for(;s.indexOf(n[r+i])>=0;)i++;if(i>0){t.push(e.join(""));for(let o=parseInt(n.substring(r,r+i),10);o>0;o--)e.pop();r+=i}else e.push(n[r]),r++}return t}const Tg={defaultProtocol:"http",events:null,format:MM,formatHref:MM,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function mk(n,t=null){let e=Af({},Tg);n&&(e=Af(e,n instanceof mk?n.o:n));const r=e.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=e,t&&(this.defaultRender=t),this.ignoreTags=s}mk.prototype={o:Tg,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,t,e){const r=t!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=e.t in s?s[e.t]:Tg[n],typeof s=="function"&&r&&(s=s(t,e))):typeof s=="function"&&r&&(s=s(t,e.t,e)),s)},getObj(n,t,e){let r=this.o[n];return typeof r=="function"&&t!=null&&(r=r(t,e.t,e)),r},render(n){const t=n.render(this);return(this.get("render",null,n)||this.defaultRender)(t,n.t,n)}};function MM(n){return n}function iD(n,t){this.t="token",this.v=n,this.tk=t}iD.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const t=this.toString(),e=n.get("truncate",t,this),r=n.get("format",t,this);return e&&r.length>e?r.substring(0,e)+"…":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Tg.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const t=this,e=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",e,this),s=n.get("tagName",e,t),i=this.toFormattedString(n),o={},a=n.get("className",e,t),l=n.get("target",e,t),c=n.get("rel",e,t),u=n.getObj("attributes",e,t),d=n.getObj("events",e,t);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&Af(o,u),{tagName:s,attributes:o,content:i,eventListeners:d}}};function Dw(n,t){class e extends iD{constructor(s,i){super(s,i),this.t=n}}for(const r in t)e.prototype[r]=t[r];return e.t=n,e}const PM=Dw("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),OM=Dw("text"),iW=Dw("nl"),Gy=Dw("url",{isLink:!0,toHref(n=Tg.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Cg&&n[1].t===el}}),Bs=n=>new is(n);function oW({groups:n}){const t=n.domain.concat([ev,rv,Ja,sv,iv,ov,av,lv,Hs,uk,zp,cv,uv,dv,zi,fv,Wp,hv]),e=[nv,el,hk,Vi,fk,zp,Up,pk,gk,Wb,Kb,Hp,Vp,Vb,Hb,zb,Ub,Gb,Yb,Xb,qb,Jb,Qb,Zb,tv],r=[ev,nv,rv,sv,iv,ov,av,lv,Hs,Hp,Vp,zp,cv,uv,dv,Up,zi,fv,Wp,hv],s=Bs(),i=nt(s,Wp);ie(i,r,i),ie(i,n.domain,i);const o=Bs(),a=Bs(),l=Bs();ie(s,n.domain,o),ie(s,n.scheme,a),ie(s,n.slashscheme,l),ie(o,r,i),ie(o,n.domain,o);const c=nt(o,Ja);nt(i,Ja,c),nt(a,Ja,c),nt(l,Ja,c);const u=nt(i,Vi);ie(u,r,i),ie(u,n.domain,i);const d=Bs();ie(c,n.domain,d),ie(d,n.domain,d);const h=nt(d,Vi);ie(h,n.domain,d);const p=Bs(PM);ie(h,n.tld,p),ie(h,n.utld,p),nt(c,Cg,p);const g=nt(d,Hs);nt(g,Hs,g),ie(g,n.domain,d),ie(p,n.domain,d),nt(p,Vi,h),nt(p,Hs,g);const m=nt(p,el);ie(m,n.numeric,PM);const b=nt(o,Hs),y=nt(o,Vi);nt(b,Hs,b),ie(b,n.domain,o),ie(y,r,i),ie(y,n.domain,o);const v=Bs(Gy);ie(y,n.tld,v),ie(y,n.utld,v),ie(v,n.domain,o),ie(v,r,i),nt(v,Vi,y),nt(v,Hs,b),nt(v,Ja,c);const x=nt(v,el),S=Bs(Gy);ie(x,n.numeric,S);const w=Bs(Gy),E=Bs();ie(w,t,w),ie(w,e,E),ie(E,t,w),ie(E,e,E),nt(v,zi,w),nt(S,zi,w);const T=nt(a,el),I=nt(l,el),C=nt(I,zi),R=nt(C,zi);ie(a,n.domain,o),nt(a,Vi,y),nt(a,Hs,b),ie(l,n.domain,o),nt(l,Vi,y),nt(l,Hs,b),ie(T,n.domain,w),nt(T,zi,w),nt(T,Up,w),ie(R,n.domain,w),ie(R,t,w),nt(R,zi,w);const N=[[Hp,Vp],[Hb,Vb],[zb,Ub],[Wb,Kb],[Gb,Yb],[Xb,qb],[Jb,Qb],[Zb,tv]];for(let B=0;B<N.length;B++){const[$,L]=N[B],F=nt(w,$);nt(E,$,F),nt(F,L,w);const _=Bs(Gy);ie(F,t,_);const j=Bs();ie(F,e),ie(_,t,_),ie(_,e,j),ie(j,t,_),ie(j,e,j),nt(_,L,w),nt(j,L,w)}return nt(s,Cg,v),nt(s,dk,iW),{start:s,tokens:rD}}function aW(n,t,e){let r=e.length,s=0,i=[],o=[];for(;s<r;){let a=n,l=null,c=null,u=0,d=null,h=-1;for(;s<r&&!(l=a.go(e[s].t));)o.push(e[s++]);for(;s<r&&(c=l||a.go(e[s].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,s++,u++;if(h<0)s-=u,s<r&&(o.push(e[s]),s++);else{o.length>0&&(i.push($x(OM,t,o)),o=[]),s-=h,u-=h;const p=d.t,g=e.slice(s-u,s);i.push($x(p,t,g))}}return o.length>0&&i.push($x(OM,t,o)),i}function $x(n,t,e){const r=e[0].s,s=e[e.length-1].e,i=t.slice(r,s);return new n(i,e)}const lW=typeof console<"u"&&console&&console.warn||(()=>{}),cW="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Xe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function uW(){return is.groups={},Xe.scanner=null,Xe.parser=null,Xe.tokenQueue=[],Xe.pluginQueue=[],Xe.customSchemes=[],Xe.initialized=!1,Xe}function IM(n,t=!1){if(Xe.initialized&&lW(`linkifyjs: already initialized - will not register custom scheme "${n}" ${cW}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Xe.customSchemes.push([n,t])}function dW(){Xe.scanner=rW(Xe.customSchemes);for(let n=0;n<Xe.tokenQueue.length;n++)Xe.tokenQueue[n][1]({scanner:Xe.scanner});Xe.parser=oW(Xe.scanner.tokens);for(let n=0;n<Xe.pluginQueue.length;n++)Xe.pluginQueue[n][1]({scanner:Xe.scanner,parser:Xe.parser});return Xe.initialized=!0,Xe}function yk(n){return Xe.initialized||dW(),aW(Xe.parser.start,n,sD(Xe.scanner.start,n))}yk.scan=sD;function oD(n,t=null,e=null){if(t&&typeof t=="object"){if(e)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);e=t,t=null}const r=new mk(e),s=yk(n),i=[];for(let o=0;o<s.length;o++){const a=s[o];a.isLink&&(!t||a.t===t)&&r.check(a)&&i.push(a.toFormattedObject(r))}return i}function hW(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function fW(n){return new cr({key:new Ls("autolink"),appendTransaction:(t,e,r)=>{const s=t.some(c=>c.docChanged)&&!e.doc.eq(r.doc),i=t.some(c=>c.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,a=Jz(e.doc,[...t]);if(iU(a).forEach(({newRange:c})=>{const u=Zz(r.doc,c,p=>p.isTextblock);let d,h;if(u.length>1?(d=u[0],h=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],h=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&h){const p=h.split(" ").filter(y=>y!=="");if(p.length<=0)return!1;const g=p[p.length-1],m=d.pos+h.lastIndexOf(g);if(!g)return!1;const b=yk(g).map(y=>y.toObject(n.defaultProtocol));if(!hW(b))return!1;b.filter(y=>y.isLink).map(y=>({...y,from:m+y.start+1,to:m+y.end+1})).filter(y=>r.schema.marks.code?!r.doc.rangeHasMark(y.from,y.to,r.schema.marks.code):!0).filter(y=>n.validate(y.value)).filter(y=>n.shouldAutoLink(y.value)).forEach(y=>{ak(y.from,y.to,r.doc).some(v=>v.mark.type===n.type)||o.addMark(y.from,y.to,n.type.create({href:y.href}))})}}),!!o.steps.length)return o}})}function pW(n){return new cr({key:new Ls("handleClickLink"),props:{handleClick:(t,e,r)=>{var s,i;if(r.button!==0||!t.editable)return!1;let o=r.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(h=>h.nodeName==="A"))return!1;const l=WR(t.state,n.type.name),c=r.target,u=(s=c==null?void 0:c.href)!==null&&s!==void 0?s:l.href,d=(i=c==null?void 0:c.target)!==null&&i!==void 0?i:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function gW(n){return new cr({key:new Ls("handlePasteLink"),props:{handlePaste:(t,e,r)=>{const{state:s}=t,{selection:i}=s,{empty:o}=i;if(o)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=oD(a,{defaultProtocol:n.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:n.editor.commands.setMark(n.type,{href:l.href})}}})}const mW=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function dc(n,t){const e=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&e.push(s)}),!n||n.replace(mW,"").match(new RegExp(`^(?:(?:${e.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const yW=cs.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){IM(n);return}IM(n.scheme,n.optionalSlashes)})},onDestroy(){uW()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,t)=>!!dc(n,t.protocols),validate:n=>!!n,shouldAutoLink:n=>!!n}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const t=n.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!dc(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:t=>!!dc(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Je(this.options.HTMLAttributes,n),0]:["a",Je(this.options.HTMLAttributes,{...n,href:""}),0]},addCommands(){return{setLink:n=>({chain:t})=>{const{href:e}=n;return this.options.isAllowedUri(e,{defaultValidate:r=>!!dc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:t})=>{const{href:e}=n;return this.options.isAllowedUri(e,{defaultValidate:r=>!!dc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[tc({find:n=>{const t=[];if(n){const{protocols:e,defaultProtocol:r}=this.options,s=oD(n).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!dc(o,e),protocols:e,defaultProtocol:r}));s.length&&s.forEach(i=>t.push({text:i.value,data:{href:i.href},index:i.start}))}return t},type:this.type,getAttributes:n=>{var t;return{href:(t=n.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:t,defaultProtocol:e}=this.options;return this.options.autolink&&n.push(fW({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!dc(s,t),protocols:t,defaultProtocol:e}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&n.push(pW({type:this.type})),this.options.linkOnPaste&&n.push(gW({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),n}}),bW=us.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",Je(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),vW=/^\s*(\[([( |x])?\])\s$/,wW=us.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const t=n.getAttribute("data-checked");return t===""||t==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:t}){return["li",Je(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:t,getPos:e,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",c=>c.preventDefault()),a.addEventListener("change",c=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:u}=c.target;r.isEditable&&typeof e=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const h=e();if(typeof h!="number")return!1;const p=d.doc.nodeAt(h);return d.setNodeMarkup(h,void 0,{...p==null?void 0:p.attrs,checked:u}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{s.setAttribute(c,u)}),s.dataset.checked=n.attrs.checked,a.checked=n.attrs.checked,i.append(a,o),s.append(i,l),Object.entries(t).forEach(([c,u])=>{s.setAttribute(c,u)}),{dom:s,contentDOM:l,update:c=>c.type!==this.type?!1:(s.dataset.checked=c.attrs.checked,a.checked=c.attrs.checked,!0)}}},addInputRules(){return[Sf({find:vW,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),xW=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,SW=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,AW=cs.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:t})=>t.setMark(this.name,n),toggleHighlight:n=>({commands:t})=>t.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Zu({find:xW,type:this.type})]},addPasteRules(){return[tc({find:SW,type:this.type})]}}),EW=Xn.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var t;return(t=n.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:t})=>t().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),kW={class:"flex items-center justify-between mb-6"},CW={class:"text-2xl font-bold text-gray-900 dark:text-white"},TW={class:"flex space-x-2"},MW=["disabled"],PW={key:0,class:"text-center py-8"},OW={key:1,class:"card"},IW={class:"mb-4"},RW={class:"mb-4"},DW={class:"mb-4"},NW={class:"flex items-center"},_W=["onKeydown"],LW={key:0,class:"mt-2 flex flex-wrap gap-2"},FW=["onClick"],BW={class:"mb-4"},$W={class:"border border-gray-300 dark:border-gray-700 rounded-lg overflow-hidden bg-white dark:bg-slate-900"},jW={class:"border-b border-gray-300 dark:border-gray-700 p-2"},HW={class:"flex flex-wrap gap-1 mb-2"},VW=["value"],zW={class:"relative"},UW={key:0,class:"absolute top-full left-0 mt-1 p-2 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-10"},WW={class:"grid grid-cols-5 gap-1"},KW=["onClick"],GW={class:"flex flex-wrap gap-1"},YW={class:"flex flex-wrap gap-1 mt-2"},XW={class:"p-4 min-h-[300px] prose dark:prose-invert max-w-none"},qW={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},JW={__name:"NoteEditor",setup(n){const t=Pf(),e=pw(),r=bw(),s=Ee(()=>t.params.id==="new"),i=Ee(()=>s.value?null:Number(t.params.id)),o=ot(""),a=ot(""),l=ot(null),c=ot([]),u=ot(""),d=ot(!1),h=ot(!1),p=ot(!1),g=ot(!1),m=ot("#000000"),b=ot("Arial"),y=["Arial","Times New Roman","Courier New","Georgia","Verdana","Helvetica"],v=ot(null);qn(async()=>{if(!s.value){d.value=!0;try{const L=await r.getNoteById(i.value);L?(o.value=L.title,a.value=L.content,l.value=L.subjectId,c.value=L.tags||[]):e.push("/notes")}catch(L){console.error("Error loading note:",L)}finally{d.value=!1}}v.value=new $U({extensions:[$8,j8,JR,H8,V8,z8.configure({types:["heading","paragraph"]}),K8.configure({types:["textStyle"]}),W8,yW.configure({openOnClick:!1}),Y8,bW,wW.configure({nested:!0}),AW.configure({multicolor:!0}),EW],content:a.value,onUpdate:({editor:L})=>{a.value=L.getHTML()}})}),Mi(a,L=>{v.value&&v.value.getHTML()!==L&&v.value.commands.setContent(L)});const x=()=>{u.value.trim()&&!c.value.includes(u.value.trim())&&(c.value.push(u.value.trim()),u.value="")},S=L=>{c.value.splice(L,1)},w=async()=>{if(!o.value.trim()){alert("Por favor ingresa un título para la nota");return}h.value=!0;try{const L={title:o.value.trim(),content:v.value.getHTML(),subjectId:l.value,tags:c.value};s.value?await r.addNote(L):await r.updateNote(i.value,L),e.push("/notes")}catch(L){console.error("Error saving note:",L),alert("Error al guardar la nota")}finally{h.value=!1}},E=()=>{p.value=!0},T=()=>{p.value=!1},I=async()=>{try{await r.deleteNote(i.value),e.push("/notes")}catch(L){console.error("Error deleting note:",L),alert("Error al eliminar la nota")}},C=()=>{const L=prompt("URL");L?v.value.chain().focus().extendMarkRange("link").setLink({href:L}).run():v.value.chain().focus().extendMarkRange("link").unsetLink().run()},R=()=>{const L=prompt("URL de la imagen");L&&v.value.chain().focus().setImage({src:L}).run()},N=L=>{v.value.chain().focus().setTextAlign(L).run()},B=L=>{b.value=L,v.value.chain().focus().setFontFamily(L).run()},$=L=>{m.value=L,v.value.chain().focus().setColor(L).run(),g.value=!1};return(L,F)=>{var _,j,X,wt,qt,$t,Pt,jt,me,xe,Ot,z,rt,et,ht,Zt,fe;return K(),Y("div",null,[A("div",kW,[A("h1",CW,pt(s.value?"Nueva Nota":"Editar Nota"),1),A("div",TW,[s.value?Re("",!0):(K(),Y("button",{key:0,onClick:E,class:"btn bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}," Eliminar ")),A("button",{onClick:w,class:"btn btn-primary",disabled:h.value},pt(h.value?"Guardando...":"Guardar"),9,MW)])]),d.value?(K(),Y("div",PW,F[24]||(F[24]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando nota...",-1)]))):(K(),Y("div",OW,[A("div",IW,[F[25]||(F[25]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Título "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"text","onUpdate:modelValue":F[0]||(F[0]=O=>o.value=O),placeholder:"Título de la nota",class:"input"},null,512),[[cn,o.value]])]),A("div",RW,[bt(yf,{modelValue:l.value,"onUpdate:modelValue":F[1]||(F[1]=O=>l.value=O),required:!0},null,8,["modelValue"])]),A("div",DW,[F[27]||(F[27]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Etiquetas ",-1)),A("div",NW,[Le(A("input",{type:"text","onUpdate:modelValue":F[2]||(F[2]=O=>u.value=O),placeholder:"Añadir etiqueta",class:"input",onKeydown:rO(uw(x,["prevent"]),["enter"])},null,40,_W),[[cn,u.value]]),A("button",{onClick:x,class:"ml-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Añadir ")]),c.value.length>0?(K(),Y("div",LW,[(K(!0),Y(ae,null,ln(c.value,(O,D)=>(K(),Y("div",{key:D,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},[ge(pt(O)+" ",1),A("button",{onClick:U=>S(D),class:"ml-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"},F[26]||(F[26]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,FW)]))),128))])):Re("",!0)]),A("div",BW,[F[41]||(F[41]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Contenido "),A("span",{class:"text-red-500"},"*")],-1)),A("div",$W,[A("div",jW,[A("div",HW,[A("button",{onClick:F[3]||(F[3]=O=>v.value.chain().focus().toggleBold().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(_=v.value)==null?void 0:_.isActive("bold")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Negrita"},F[28]||(F[28]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2),A("button",{onClick:F[4]||(F[4]=O=>v.value.chain().focus().toggleItalic().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(j=v.value)==null?void 0:j.isActive("italic")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Cursiva"},F[29]||(F[29]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})],-1)]),2),A("button",{onClick:F[5]||(F[5]=O=>v.value.chain().focus().toggleUnderline().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(X=v.value)==null?void 0:X.isActive("underline")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Subrayado"},F[30]||(F[30]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})],-1)]),2),A("button",{onClick:F[6]||(F[6]=O=>v.value.chain().focus().toggleStrike().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(wt=v.value)==null?void 0:wt.isActive("strike")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Tachado"},F[31]||(F[31]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"})],-1)]),2),A("button",{onClick:F[7]||(F[7]=O=>v.value.chain().focus().toggleSubscript().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(qt=v.value)==null?void 0:qt.isActive("subscript")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Subíndice"}," x₂ ",2),A("button",{onClick:F[8]||(F[8]=O=>v.value.chain().focus().toggleSuperscript().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":($t=v.value)==null?void 0:$t.isActive("superscript")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Superíndice"}," x² ",2),Le(A("select",{"onUpdate:modelValue":F[9]||(F[9]=O=>b.value=O),onChange:F[10]||(F[10]=O=>B(O.target.value)),class:"p-2 rounded bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-700"},[(K(),Y(ae,null,ln(y,O=>A("option",{key:O,value:O},pt(O),9,VW)),64))],544),[[mo,b.value]]),A("div",zW,[A("button",{onClick:F[11]||(F[11]=O=>g.value=!g.value),class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center",title:"Color de texto"},[A("div",{class:"w-5 h-5 rounded",style:Wn({backgroundColor:m.value})},null,4)]),g.value?(K(),Y("div",UW,[A("div",WW,[(K(),Y(ae,null,ln(["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#808080","#800000","#008000"],O=>A("button",{key:O,onClick:D=>$(O),class:"w-6 h-6 rounded",style:Wn({backgroundColor:O})},null,12,KW)),64))]),Le(A("input",{type:"color","onUpdate:modelValue":F[12]||(F[12]=O=>m.value=O),onChange:F[13]||(F[13]=O=>$(m.value)),class:"mt-2 w-full h-8"},null,544),[[cn,m.value]])])):Re("",!0)])]),A("div",GW,[A("button",{onClick:F[14]||(F[14]=O=>v.value.chain().focus().toggleHeading({level:1}).run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(Pt=v.value)==null?void 0:Pt.isActive("heading",{level:1})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Título 1"}," H1 ",2),A("button",{onClick:F[15]||(F[15]=O=>v.value.chain().focus().toggleHeading({level:2}).run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(jt=v.value)==null?void 0:jt.isActive("heading",{level:2})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Título 2"}," H2 ",2),A("button",{onClick:F[16]||(F[16]=O=>v.value.chain().focus().toggleHeading({level:3}).run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(me=v.value)==null?void 0:me.isActive("heading",{level:3})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Título 3"}," H3 ",2),A("button",{onClick:F[17]||(F[17]=O=>N("left")),class:Kt([{"bg-gray-200 dark:bg-gray-700":(xe=v.value)==null?void 0:xe.isActive({textAlign:"left"})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Alinear a la izquierda"},F[32]||(F[32]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h10M4 18h16"})],-1)]),2),A("button",{onClick:F[18]||(F[18]=O=>N("center")),class:Kt([{"bg-gray-200 dark:bg-gray-700":(Ot=v.value)==null?void 0:Ot.isActive({textAlign:"center"})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Centrar"},F[33]||(F[33]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M6 12h12M4 18h16"})],-1)]),2),A("button",{onClick:F[19]||(F[19]=O=>N("right")),class:Kt([{"bg-gray-200 dark:bg-gray-700":(z=v.value)==null?void 0:z.isActive({textAlign:"right"})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Alinear a la derecha"},F[34]||(F[34]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M10 12h10M4 18h16"})],-1)]),2),A("button",{onClick:F[20]||(F[20]=O=>N("justify")),class:Kt([{"bg-gray-200 dark:bg-gray-700":(rt=v.value)==null?void 0:rt.isActive({textAlign:"justify"})},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Justificar"},F[35]||(F[35]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)]),2)]),A("div",YW,[A("button",{onClick:F[21]||(F[21]=O=>v.value.chain().focus().toggleBulletList().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(et=v.value)==null?void 0:et.isActive("bulletList")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Lista con viñetas"},F[36]||(F[36]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})],-1)]),2),A("button",{onClick:F[22]||(F[22]=O=>v.value.chain().focus().toggleOrderedList().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(ht=v.value)==null?void 0:ht.isActive("orderedList")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Lista numerada"},F[37]||(F[37]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16m-7 6h7"})],-1)]),2),A("button",{onClick:F[23]||(F[23]=O=>v.value.chain().focus().toggleTaskList().run()),class:Kt([{"bg-gray-200 dark:bg-gray-700":(Zt=v.value)==null?void 0:Zt.isActive("taskList")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Lista de tareas"},F[38]||(F[38]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1)]),2),A("button",{onClick:C,class:Kt([{"bg-gray-200 dark:bg-gray-700":(fe=v.value)==null?void 0:fe.isActive("link")},"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"]),title:"Insertar enlace"},F[39]||(F[39]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)]),2),A("button",{onClick:R,class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:"Insertar imagen"},F[40]||(F[40]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]))])]),A("div",XW,[bt(ee(jU),{editor:v.value},null,8,["editor"])])])])])),p.value?(K(),Y("div",qW,[A("div",{class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},[F[42]||(F[42]=A("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},"Confirmar Eliminación",-1)),F[43]||(F[43]=A("p",{class:"text-gray-600 dark:text-gray-300 mb-6"}," ¿Estás seguro de que deseas eliminar esta nota? Esta acción no se puede deshacer. ",-1)),A("div",{class:"flex justify-end space-x-3"},[A("button",{onClick:T,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:I,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Eliminar ")])])])):Re("",!0)])}}},QW={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},ZW={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},t7={class:"md:col-span-2"},e7={key:0,class:"text-center py-8"},n7={key:1,class:"text-center py-8"},r7={key:2,class:"space-y-4"},s7={class:"flex-grow"},i7={class:"flex items-center gap-2 mb-1"},o7={class:"text-xs text-gray-600 dark:text-gray-300"},a7={class:"text-lg font-semibold text-gray-900 dark:text-white"},l7={key:0,class:"text-sm text-gray-600 dark:text-gray-300 mt-1 line-clamp-2"},c7={class:"flex flex-wrap items-center gap-2 mt-2"},u7={class:"text-sm text-gray-500 dark:text-gray-400"},d7={class:"flex flex-row md:flex-col gap-2"},h7=["onClick"],f7=["onClick"],p7={__name:"TasksPage",setup(n){const t=yw(),e=Ra(),r=ot(null),s=ot(""),i=ot("all");qn(async()=>{await e.fetchSubjects(),await t.fetchTasks(),"Notification"in window&&Notification.permission==="default"&&await t.requestNotificationPermission()});const o=Ee(()=>{let b=t.tasks;if(r.value&&(b=b.filter(y=>y.subjectId===r.value)),i.value!=="all"&&(b=b.filter(y=>y.status===i.value)),s.value){const y=s.value.toLowerCase();b=b.filter(v=>v.title.toLowerCase().includes(y)||v.description&&v.description.toLowerCase().includes(y))}return[...b].sort((y,v)=>new Date(y.dueDate)-new Date(v.dueDate))}),a=b=>Zs(new Date(b),"d MMM, yyyy",{locale:Nl}),l=b=>e.subjects.find(y=>y.id===b)||{name:"Sin materia",color:"#94a3b8"},c=b=>{s.value=b},u=()=>{r.value=null,s.value="",i.value="all"},d=b=>{const y={low:"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800",medium:"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800",high:"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800"};return y[b]||y.medium},h=b=>{const y={pending:"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800","in-progress":"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800",completed:"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800"};return y[b]||y.pending},p=b=>({low:"Baja",medium:"Media",high:"Alta"})[b]||"Media",g=b=>({pending:"Pendiente","in-progress":"En Progreso",completed:"Completada"})[b]||"Pendiente",m=async(b,y)=>{try{const v=await t.getTaskById(b);v&&await t.updateTask(b,{...v,status:y})}catch(v){console.error("Error updating task status:",v)}};return(b,y)=>{const v=Ia("router-link");return K(),Y("div",null,[A("div",QW,[y[3]||(y[3]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Tareas",-1)),bt(v,{to:"/tasks/new",class:"btn btn-primary flex items-center justify-center"},{default:Se(()=>y[2]||(y[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ge(" Nueva Tarea ")])),_:1,__:[2]})]),A("div",ZW,[A("div",t7,[bt(FE,{placeholder:"Buscar tarea...",onSearch:c})]),A("div",null,[bt(yf,{modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=x=>r.value=x)},null,8,["modelValue"])]),A("div",null,[y[5]||(y[5]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Estado ",-1)),Le(A("select",{"onUpdate:modelValue":y[1]||(y[1]=x=>i.value=x),class:"input"},y[4]||(y[4]=[A("option",{value:"all"},"Todos",-1),A("option",{value:"pending"},"Pendientes",-1),A("option",{value:"in-progress"},"En Progreso",-1),A("option",{value:"completed"},"Completadas",-1)]),512),[[mo,i.value]])])]),ee(t).loading?(K(),Y("div",e7,y[6]||(y[6]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando tareas...",-1)]))):o.value.length===0?(K(),Y("div",n7,[y[7]||(y[7]=A("p",{class:"text-gray-500 dark:text-gray-400"},"No se encontraron tareas",-1)),r.value||s.value||i.value!=="all"?(K(),Y("button",{key:0,onClick:u,class:"mt-2 text-primary-600 dark:text-primary-400 hover:underline"}," Borrar filtros ")):Re("",!0)])):(K(),Y("div",r7,[(K(!0),Y(ae,null,ln(o.value,x=>(K(),Y("div",{key:x.id,class:"card flex flex-col md:flex-row md:items-center gap-4"},[A("div",s7,[A("div",i7,[A("span",{class:"inline-block w-3 h-3 rounded-full",style:Wn({backgroundColor:l(x.subjectId).color})},null,4),A("span",o7,pt(l(x.subjectId).name),1)]),bt(v,{to:`/tasks/${x.id}`,class:"block"},{default:Se(()=>[A("h3",a7,pt(x.title),1)]),_:2},1032,["to"]),x.description?(K(),Y("p",l7,pt(x.description),1)):Re("",!0),A("div",c7,[A("span",u7," Vence: "+pt(a(x.dueDate)),1),A("span",{class:Kt(["inline-block px-2 py-1 text-xs rounded-full border",d(x.priority)])},pt(p(x.priority)),3),A("span",{class:Kt(["inline-block px-2 py-1 text-xs rounded-full border",h(x.status)])},pt(g(x.status)),3)])]),A("div",d7,[bt(v,{to:`/tasks/${x.id}`,class:"px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg text-sm hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},{default:Se(()=>y[8]||(y[8]=[ge(" Editar ")])),_:2,__:[8]},1032,["to"]),x.status!=="completed"?(K(),Y("button",{key:0,onClick:S=>m(x.id,"completed"),class:"px-3 py-2 bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-lg text-sm hover:bg-green-200 dark:hover:bg-green-800/30 transition-colors"}," Completar ",8,h7)):(K(),Y("button",{key:1,onClick:S=>m(x.id,"pending"),class:"px-3 py-2 bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-lg text-sm hover:bg-yellow-200 dark:hover:bg-yellow-800/30 transition-colors"}," Reabrir ",8,f7))])]))),128))]))])}}},g7={class:"flex items-center justify-between mb-6"},m7={class:"text-2xl font-bold text-gray-900 dark:text-white"},y7={class:"flex space-x-2"},b7=["disabled"],v7={key:0,class:"text-center py-8"},w7={key:1,class:"card"},x7={class:"mb-4"},S7={class:"mb-4"},A7={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},E7={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},k7={class:"text-sm text-gray-500 dark:text-gray-400 mt-4"},C7={key:0},T7={key:1},M7={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},P7={__name:"TaskEditor",setup(n){const t=Pf(),e=pw(),r=yw(),s=Ee(()=>t.params.id==="new"),i=Ee(()=>s.value?null:Number(t.params.id)),o=ot(""),a=ot(""),l=ot(""),c=ot(null),u=ot("medium"),d=ot("pending"),h=ot(!1),p=ot(!1),g=ot(!1);qn(async()=>{if(s.value){const S=new Date;S.setDate(S.getDate()+1),l.value=m(S.toISOString())}else{h.value=!0;try{const S=await r.getTaskById(i.value);S?(o.value=S.title,a.value=S.description||"",l.value=m(S.dueDate),c.value=S.subjectId,u.value=S.priority||"medium",d.value=S.status||"pending"):e.push("/tasks")}catch(S){console.error("Error loading task:",S)}finally{h.value=!1}}});const m=S=>Zs(new Date(S),"yyyy-MM-dd"),b=async()=>{if(!o.value.trim()){alert("Por favor ingresa un título para la tarea");return}if(!l.value){alert("Por favor selecciona una fecha de vencimiento");return}if(!c.value){alert("Por favor selecciona una materia");return}p.value=!0;try{const S={title:o.value.trim(),description:a.value.trim(),dueDate:new Date(l.value).toISOString(),subjectId:c.value,priority:u.value,status:d.value};s.value?await r.addTask(S):await r.updateTask(i.value,S),e.push("/tasks")}catch(S){console.error("Error saving task:",S),alert("Error al guardar la tarea")}finally{p.value=!1}},y=()=>{g.value=!0},v=()=>{g.value=!1},x=async()=>{try{await r.deleteTask(i.value),e.push("/tasks")}catch(S){console.error("Error deleting task:",S),alert("Error al eliminar la tarea")}};return(S,w)=>(K(),Y("div",null,[A("div",g7,[A("h1",m7,pt(s.value?"Nueva Tarea":"Editar Tarea"),1),A("div",y7,[s.value?Re("",!0):(K(),Y("button",{key:0,onClick:y,class:"btn bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}," Eliminar ")),A("button",{onClick:b,class:"btn btn-primary",disabled:p.value},pt(p.value?"Guardando...":"Guardar"),9,b7)])]),h.value?(K(),Y("div",v7,w[7]||(w[7]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando tarea...",-1)]))):(K(),Y("div",w7,[A("div",x7,[w[8]||(w[8]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Título "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"text","onUpdate:modelValue":w[0]||(w[0]=E=>o.value=E),placeholder:"Título de la tarea",class:"input"},null,512),[[cn,o.value]])]),A("div",S7,[w[9]||(w[9]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Descripción ",-1)),Le(A("textarea",{"onUpdate:modelValue":w[1]||(w[1]=E=>a.value=E),placeholder:"Descripción de la tarea",rows:"4",class:"input"},null,512),[[cn,a.value]])]),A("div",A7,[A("div",null,[w[10]||(w[10]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Fecha de vencimiento "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"date","onUpdate:modelValue":w[2]||(w[2]=E=>l.value=E),class:"input"},null,512),[[cn,l.value]])]),A("div",null,[bt(yf,{modelValue:c.value,"onUpdate:modelValue":w[3]||(w[3]=E=>c.value=E),required:!0},null,8,["modelValue"])])]),A("div",E7,[A("div",null,[w[12]||(w[12]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Prioridad ",-1)),Le(A("select",{"onUpdate:modelValue":w[4]||(w[4]=E=>u.value=E),class:"input"},w[11]||(w[11]=[A("option",{value:"low"},"Baja",-1),A("option",{value:"medium"},"Media",-1),A("option",{value:"high"},"Alta",-1)]),512),[[mo,u.value]])]),A("div",null,[w[14]||(w[14]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Estado ",-1)),Le(A("select",{"onUpdate:modelValue":w[5]||(w[5]=E=>d.value=E),class:"input"},w[13]||(w[13]=[A("option",{value:"pending"},"Pendiente",-1),A("option",{value:"in-progress"},"En Progreso",-1),A("option",{value:"completed"},"Completada",-1)]),512),[[mo,d.value]])])]),A("div",k7,["Notification"in S.window&&S.Notification.permission==="granted"?(K(),Y("p",C7," Se enviará una notificación un día antes de la fecha de vencimiento. ")):"Notification"in S.window&&S.Notification.permission!=="denied"?(K(),Y("p",T7,[A("button",{onClick:w[6]||(w[6]=(...E)=>ee(r).requestNotificationPermission&&ee(r).requestNotificationPermission(...E)),class:"text-primary-600 dark:text-primary-400 hover:underline"}," Habilitar notificaciones "),w[15]||(w[15]=ge(" para recibir recordatorios de tareas. "))])):Re("",!0)])])),g.value?(K(),Y("div",M7,[A("div",{class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},[w[16]||(w[16]=A("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},"Confirmar Eliminación",-1)),w[17]||(w[17]=A("p",{class:"text-gray-600 dark:text-gray-300 mb-6"}," ¿Estás seguro de que deseas eliminar esta tarea? Esta acción no se puede deshacer. ",-1)),A("div",{class:"flex justify-end space-x-3"},[A("button",{onClick:v,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:x,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Eliminar ")])])])):Re("",!0)]))}};var O7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aD(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),e}var I7={exports:{}};const R7=aD(J3);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function RM(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function vo(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?RM(Object(e),!0).forEach(function(r){D7(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):RM(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function x0(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?x0=function(t){return typeof t}:x0=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(n)}function D7(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function oi(){return oi=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},oi.apply(this,arguments)}function N7(n,t){if(n==null)return{};var e={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(e[s]=n[s]);return e}function _7(n,t){if(n==null)return{};var e=N7(n,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r])}return e}function L7(n){return F7(n)||B7(n)||$7(n)||j7()}function F7(n){if(Array.isArray(n))return TS(n)}function B7(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function $7(n,t){if(n){if(typeof n=="string")return TS(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return TS(n,t)}}function TS(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function j7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var H7="1.14.0";function va(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Da=va(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),gy=va(/Edge/i),DM=va(/firefox/i),Kp=va(/safari/i)&&!va(/chrome/i)&&!va(/android/i),lD=va(/iP(ad|od|hone)/i),V7=va(/chrome/i)&&va(/android/i),cD={capture:!1,passive:!1};function pe(n,t,e){n.addEventListener(t,e,!Da&&cD)}function de(n,t,e){n.removeEventListener(t,e,!Da&&cD)}function pv(n,t){if(t){if(t[0]===">"&&(t=t.substring(1)),n)try{if(n.matches)return n.matches(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t)}catch{return!1}return!1}}function z7(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function Ai(n,t,e,r){if(n){e=e||document;do{if(t!=null&&(t[0]===">"?n.parentNode===e&&pv(n,t):pv(n,t))||r&&n===e)return n;if(n===e)break}while(n=z7(n))}return null}var NM=/\s+/g;function an(n,t,e){if(n&&t)if(n.classList)n.classList[e?"add":"remove"](t);else{var r=(" "+n.className+" ").replace(NM," ").replace(" "+t+" "," ");n.className=(r+(e?" "+t:"")).replace(NM," ")}}function Et(n,t,e){var r=n&&n.style;if(r){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(e=n.currentStyle),t===void 0?e:e[t];!(t in r)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),r[t]=e+(typeof e=="string"?"":"px")}}function zu(n,t){var e="";if(typeof n=="string")e=n;else do{var r=Et(n,"transform");r&&r!=="none"&&(e=r+" "+e)}while(!t&&(n=n.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(e)}function uD(n,t,e){if(n){var r=n.getElementsByTagName(t),s=0,i=r.length;if(e)for(;s<i;s++)e(r[s],s);return r}return[]}function po(){var n=document.scrollingElement;return n||document.documentElement}function rn(n,t,e,r,s){if(!(!n.getBoundingClientRect&&n!==window)){var i,o,a,l,c,u,d;if(n!==window&&n.parentNode&&n!==po()?(i=n.getBoundingClientRect(),o=i.top,a=i.left,l=i.bottom,c=i.right,u=i.height,d=i.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||e)&&n!==window&&(s=s||n.parentNode,!Da))do if(s&&s.getBoundingClientRect&&(Et(s,"transform")!=="none"||e&&Et(s,"position")!=="static")){var h=s.getBoundingClientRect();o-=h.top+parseInt(Et(s,"border-top-width")),a-=h.left+parseInt(Et(s,"border-left-width")),l=o+i.height,c=a+i.width;break}while(s=s.parentNode);if(r&&n!==window){var p=zu(s||n),g=p&&p.a,m=p&&p.d;p&&(o/=m,a/=g,d/=g,u/=m,l=o+u,c=a+d)}return{top:o,left:a,bottom:l,right:c,width:d,height:u}}}function _M(n,t,e){for(var r=Bl(n,!0),s=rn(n)[t];r;){var i=rn(r)[e],o=void 0;if(o=s>=i,!o)return r;if(r===po())break;r=Bl(r,!1)}return!1}function Ef(n,t,e,r){for(var s=0,i=0,o=n.children;i<o.length;){if(o[i].style.display!=="none"&&o[i]!==Vt.ghost&&(r||o[i]!==Vt.dragged)&&Ai(o[i],e.draggable,n,!1)){if(s===t)return o[i];s++}i++}return null}function bk(n,t){for(var e=n.lastElementChild;e&&(e===Vt.ghost||Et(e,"display")==="none"||t&&!pv(e,t));)e=e.previousElementSibling;return e||null}function mn(n,t){var e=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==Vt.clone&&(!t||pv(n,t))&&e++;return e}function LM(n){var t=0,e=0,r=po();if(n)do{var s=zu(n),i=s.a,o=s.d;t+=n.scrollLeft*i,e+=n.scrollTop*o}while(n!==r&&(n=n.parentNode));return[t,e]}function U7(n,t){for(var e in n)if(n.hasOwnProperty(e)){for(var r in t)if(t.hasOwnProperty(r)&&t[r]===n[e][r])return Number(e)}return-1}function Bl(n,t){if(!n||!n.getBoundingClientRect)return po();var e=n,r=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var s=Et(e);if(e.clientWidth<e.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return po();if(r||t)return e;r=!0}}while(e=e.parentNode);return po()}function W7(n,t){if(n&&t)for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function jx(n,t){return Math.round(n.top)===Math.round(t.top)&&Math.round(n.left)===Math.round(t.left)&&Math.round(n.height)===Math.round(t.height)&&Math.round(n.width)===Math.round(t.width)}var Gp;function dD(n,t){return function(){if(!Gp){var e=arguments,r=this;e.length===1?n.call(r,e[0]):n.apply(r,e),Gp=setTimeout(function(){Gp=void 0},t)}}}function K7(){clearTimeout(Gp),Gp=void 0}function hD(n,t,e){n.scrollLeft+=t,n.scrollTop+=e}function vk(n){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(n).cloneNode(!0):e?e(n).clone(!0)[0]:n.cloneNode(!0)}function FM(n,t){Et(n,"position","absolute"),Et(n,"top",t.top),Et(n,"left",t.left),Et(n,"width",t.width),Et(n,"height",t.height)}function Hx(n){Et(n,"position",""),Et(n,"top",""),Et(n,"left",""),Et(n,"width",""),Et(n,"height","")}var Ar="Sortable"+new Date().getTime();function G7(){var n=[],t;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(s){if(!(Et(s,"display")==="none"||s===Vt.ghost)){n.push({target:s,rect:rn(s)});var i=vo({},n[n.length-1].rect);if(s.thisAnimationDuration){var o=zu(s,!0);o&&(i.top-=o.f,i.left-=o.e)}s.fromRect=i}})}},addAnimationState:function(r){n.push(r)},removeAnimationState:function(r){n.splice(U7(n,{target:r}),1)},animateAll:function(r){var s=this;if(!this.options.animation){clearTimeout(t),typeof r=="function"&&r();return}var i=!1,o=0;n.forEach(function(a){var l=0,c=a.target,u=c.fromRect,d=rn(c),h=c.prevFromRect,p=c.prevToRect,g=a.rect,m=zu(c,!0);m&&(d.top-=m.f,d.left-=m.e),c.toRect=d,c.thisAnimationDuration&&jx(h,d)&&!jx(u,d)&&(g.top-d.top)/(g.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(l=X7(g,h,p,s.options)),jx(d,u)||(c.prevFromRect=u,c.prevToRect=d,l||(l=s.options.animation),s.animate(c,g,d,l)),l&&(i=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(t),i?t=setTimeout(function(){typeof r=="function"&&r()},o):typeof r=="function"&&r(),n=[]},animate:function(r,s,i,o){if(o){Et(r,"transition",""),Et(r,"transform","");var a=zu(this.el),l=a&&a.a,c=a&&a.d,u=(s.left-i.left)/(l||1),d=(s.top-i.top)/(c||1);r.animatingX=!!u,r.animatingY=!!d,Et(r,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=Y7(r),Et(r,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),Et(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){Et(r,"transition",""),Et(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},o)}}}}function Y7(n){return n.offsetWidth}function X7(n,t,e,r){return Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*r.animation}var wd=[],Vx={initializeByDefault:!0},my={mount:function(t){for(var e in Vx)Vx.hasOwnProperty(e)&&!(e in t)&&(t[e]=Vx[e]);wd.forEach(function(r){if(r.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),wd.push(t)},pluginEvent:function(t,e,r){var s=this;this.eventCanceled=!1,r.cancel=function(){s.eventCanceled=!0};var i=t+"Global";wd.forEach(function(o){e[o.pluginName]&&(e[o.pluginName][i]&&e[o.pluginName][i](vo({sortable:e},r)),e.options[o.pluginName]&&e[o.pluginName][t]&&e[o.pluginName][t](vo({sortable:e},r)))})},initializePlugins:function(t,e,r,s){wd.forEach(function(a){var l=a.pluginName;if(!(!t.options[l]&&!a.initializeByDefault)){var c=new a(t,e,t.options);c.sortable=t,c.options=t.options,t[l]=c,oi(r,c.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var o=this.modifyOption(t,i,t.options[i]);typeof o<"u"&&(t.options[i]=o)}},getEventProperties:function(t,e){var r={};return wd.forEach(function(s){typeof s.eventProperties=="function"&&oi(r,s.eventProperties.call(e[s.pluginName],t))}),r},modifyOption:function(t,e,r){var s;return wd.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[e]=="function"&&(s=i.optionListeners[e].call(t[i.pluginName],r))}),s}};function ep(n){var t=n.sortable,e=n.rootEl,r=n.name,s=n.targetEl,i=n.cloneEl,o=n.toEl,a=n.fromEl,l=n.oldIndex,c=n.newIndex,u=n.oldDraggableIndex,d=n.newDraggableIndex,h=n.originalEvent,p=n.putSortable,g=n.extraEventProperties;if(t=t||e&&e[Ar],!!t){var m,b=t.options,y="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Da&&!gy?m=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent(r,!0,!0)),m.to=o||e,m.from=a||e,m.item=s||e,m.clone=i,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=u,m.newDraggableIndex=d,m.originalEvent=h,m.pullMode=p?p.lastPutMode:void 0;var v=vo(vo({},g),my.getEventProperties(r,t));for(var x in v)m[x]=v[x];e&&e.dispatchEvent(m),b[y]&&b[y].call(t,m)}}var q7=["evt"],Yr=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.evt,i=_7(r,q7);my.pluginEvent.bind(Vt)(t,e,vo({dragEl:at,parentEl:fn,ghostEl:Jt,rootEl:Qe,nextEl:gc,lastDownEl:S0,cloneEl:pn,cloneHidden:nl,dragStarted:np,putSortable:Jn,activeSortable:Vt.active,originalEvent:s,oldIndex:Hd,oldDraggableIndex:Yp,newIndex:fs,newDraggableIndex:Qa,hideGhostForTarget:mD,unhideGhostForTarget:yD,cloneNowHidden:function(){nl=!0},cloneNowShown:function(){nl=!1},dispatchSortableEvent:function(a){Ir({sortable:e,name:a,originalEvent:s})}},i))};function Ir(n){ep(vo({putSortable:Jn,cloneEl:pn,targetEl:at,rootEl:Qe,oldIndex:Hd,oldDraggableIndex:Yp,newIndex:fs,newDraggableIndex:Qa},n))}var at,fn,Jt,Qe,gc,S0,pn,nl,Hd,fs,Yp,Qa,Yy,Jn,Od=!1,gv=!1,mv=[],hc,ai,zx,Ux,BM,$M,np,xd,Xp,qp=!1,Xy=!1,A0,ur,Wx=[],MS=!1,yv=[],Nw=typeof document<"u",qy=lD,jM=gy||Da?"cssFloat":"float",J7=Nw&&!V7&&!lD&&"draggable"in document.createElement("div"),fD=function(){if(Nw){if(Da)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),pD=function(t,e){var r=Et(t),s=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),i=Ef(t,0,e),o=Ef(t,1,e),a=i&&Et(i),l=o&&Et(o),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+rn(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+rn(o).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&a.float!=="none"){var d=a.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return i&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||c>=s&&r[jM]==="none"||o&&r[jM]==="none"&&c+u>s)?"vertical":"horizontal"},Q7=function(t,e,r){var s=r?t.left:t.top,i=r?t.right:t.bottom,o=r?t.width:t.height,a=r?e.left:e.top,l=r?e.right:e.bottom,c=r?e.width:e.height;return s===a||i===l||s+o/2===a+c/2},Z7=function(t,e){var r;return mv.some(function(s){var i=s[Ar].options.emptyInsertThreshold;if(!(!i||bk(s))){var o=rn(s),a=t>=o.left-i&&t<=o.right+i,l=e>=o.top-i&&e<=o.bottom+i;if(a&&l)return r=s}}),r},gD=function(t){function e(i,o){return function(a,l,c,u){var d=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(i==null&&(o||d))return!0;if(i==null||i===!1)return!1;if(o&&i==="clone")return i;if(typeof i=="function")return e(i(a,l,c,u),o)(a,l,c,u);var h=(o?a:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var r={},s=t.group;(!s||x0(s)!="object")&&(s={name:s}),r.name=s.name,r.checkPull=e(s.pull,!0),r.checkPut=e(s.put),r.revertClone=s.revertClone,t.group=r},mD=function(){!fD&&Jt&&Et(Jt,"display","none")},yD=function(){!fD&&Jt&&Et(Jt,"display","")};Nw&&document.addEventListener("click",function(n){if(gv)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),gv=!1,!1},!0);var fc=function(t){if(at){t=t.touches?t.touches[0]:t;var e=Z7(t.clientX,t.clientY);if(e){var r={};for(var s in t)t.hasOwnProperty(s)&&(r[s]=t[s]);r.target=r.rootEl=e,r.preventDefault=void 0,r.stopPropagation=void 0,e[Ar]._onDragOver(r)}}},tK=function(t){at&&at.parentNode[Ar]._isOutsideThisEl(t.target)};function Vt(n,t){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=t=oi({},t),n[Ar]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return pD(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,a){o.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Vt.supportPointer!==!1&&"PointerEvent"in window&&!Kp,emptyInsertThreshold:5};my.initializePlugins(this,n,e);for(var r in e)!(r in t)&&(t[r]=e[r]);gD(t);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=t.forceFallback?!1:J7,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?pe(n,"pointerdown",this._onTapStart):(pe(n,"mousedown",this._onTapStart),pe(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(pe(n,"dragover",this),pe(n,"dragenter",this)),mv.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),oi(this,G7())}Vt.prototype={constructor:Vt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(xd=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,at):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,r=this.el,s=this.options,i=s.preventOnFilter,o=t.type,a=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(a||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,u=s.filter;if(lK(r),!at&&!(/mousedown|pointerdown/.test(o)&&t.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Kp&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Ai(l,s.draggable,r,!1),!(l&&l.animated)&&S0!==l)){if(Hd=mn(l),Yp=mn(l,s.draggable),typeof u=="function"){if(u.call(this,t,l,this)){Ir({sortable:e,rootEl:c,name:"filter",targetEl:l,toEl:r,fromEl:r}),Yr("filter",e,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=Ai(c,d.trim(),r,!1),d)return Ir({sortable:e,rootEl:d,name:"filter",targetEl:l,fromEl:r,toEl:r}),Yr("filter",e,{evt:t}),!0}),u)){i&&t.cancelable&&t.preventDefault();return}s.handle&&!Ai(c,s.handle,r,!1)||this._prepareDragStart(t,a,l)}}},_prepareDragStart:function(t,e,r){var s=this,i=s.el,o=s.options,a=i.ownerDocument,l;if(r&&!at&&r.parentNode===i){var c=rn(r);if(Qe=i,at=r,fn=at.parentNode,gc=at.nextSibling,S0=r,Yy=o.group,Vt.dragged=at,hc={target:at,clientX:(e||t).clientX,clientY:(e||t).clientY},BM=hc.clientX-c.left,$M=hc.clientY-c.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,at.style["will-change"]="all",l=function(){if(Yr("delayEnded",s,{evt:t}),Vt.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!DM&&s.nativeDraggable&&(at.draggable=!0),s._triggerDragStart(t,e),Ir({sortable:s,name:"choose",originalEvent:t}),an(at,o.chosenClass,!0)},o.ignore.split(",").forEach(function(u){uD(at,u.trim(),Kx)}),pe(a,"dragover",fc),pe(a,"mousemove",fc),pe(a,"touchmove",fc),pe(a,"mouseup",s._onDrop),pe(a,"touchend",s._onDrop),pe(a,"touchcancel",s._onDrop),DM&&this.nativeDraggable&&(this.options.touchStartThreshold=4,at.draggable=!0),Yr("delayStart",this,{evt:t}),o.delay&&(!o.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(gy||Da))){if(Vt.eventCanceled){this._onDrop();return}pe(a,"mouseup",s._disableDelayedDrag),pe(a,"touchend",s._disableDelayedDrag),pe(a,"touchcancel",s._disableDelayedDrag),pe(a,"mousemove",s._delayedDragTouchMoveHandler),pe(a,"touchmove",s._delayedDragTouchMoveHandler),o.supportPointer&&pe(a,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){at&&Kx(at),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;de(t,"mouseup",this._disableDelayedDrag),de(t,"touchend",this._disableDelayedDrag),de(t,"touchcancel",this._disableDelayedDrag),de(t,"mousemove",this._delayedDragTouchMoveHandler),de(t,"touchmove",this._delayedDragTouchMoveHandler),de(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?pe(document,"pointermove",this._onTouchMove):e?pe(document,"touchmove",this._onTouchMove):pe(document,"mousemove",this._onTouchMove):(pe(at,"dragend",this),pe(Qe,"dragstart",this._onDragStart));try{document.selection?E0(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(Od=!1,Qe&&at){Yr("dragStarted",this,{evt:e}),this.nativeDraggable&&pe(document,"dragover",tK);var r=this.options;!t&&an(at,r.dragClass,!1),an(at,r.ghostClass,!0),Vt.active=this,t&&this._appendGhost(),Ir({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(ai){this._lastX=ai.clientX,this._lastY=ai.clientY,mD();for(var t=document.elementFromPoint(ai.clientX,ai.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ai.clientX,ai.clientY),t!==e);)e=t;if(at.parentNode[Ar]._isOutsideThisEl(t),e)do{if(e[Ar]){var r=void 0;if(r=e[Ar]._onDragOver({clientX:ai.clientX,clientY:ai.clientY,target:t,rootEl:e}),r&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);yD()}},_onTouchMove:function(t){if(hc){var e=this.options,r=e.fallbackTolerance,s=e.fallbackOffset,i=t.touches?t.touches[0]:t,o=Jt&&zu(Jt,!0),a=Jt&&o&&o.a,l=Jt&&o&&o.d,c=qy&&ur&&LM(ur),u=(i.clientX-hc.clientX+s.x)/(a||1)+(c?c[0]-Wx[0]:0)/(a||1),d=(i.clientY-hc.clientY+s.y)/(l||1)+(c?c[1]-Wx[1]:0)/(l||1);if(!Vt.active&&!Od){if(r&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<r)return;this._onDragStart(t,!0)}if(Jt){o?(o.e+=u-(zx||0),o.f+=d-(Ux||0)):o={a:1,b:0,c:0,d:1,e:u,f:d};var h="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");Et(Jt,"webkitTransform",h),Et(Jt,"mozTransform",h),Et(Jt,"msTransform",h),Et(Jt,"transform",h),zx=u,Ux=d,ai=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Jt){var t=this.options.fallbackOnBody?document.body:Qe,e=rn(at,!0,qy,!0,t),r=this.options;if(qy){for(ur=t;Et(ur,"position")==="static"&&Et(ur,"transform")==="none"&&ur!==document;)ur=ur.parentNode;ur!==document.body&&ur!==document.documentElement?(ur===document&&(ur=po()),e.top+=ur.scrollTop,e.left+=ur.scrollLeft):ur=po(),Wx=LM(ur)}Jt=at.cloneNode(!0),an(Jt,r.ghostClass,!1),an(Jt,r.fallbackClass,!0),an(Jt,r.dragClass,!0),Et(Jt,"transition",""),Et(Jt,"transform",""),Et(Jt,"box-sizing","border-box"),Et(Jt,"margin",0),Et(Jt,"top",e.top),Et(Jt,"left",e.left),Et(Jt,"width",e.width),Et(Jt,"height",e.height),Et(Jt,"opacity","0.8"),Et(Jt,"position",qy?"absolute":"fixed"),Et(Jt,"zIndex","100000"),Et(Jt,"pointerEvents","none"),Vt.ghost=Jt,t.appendChild(Jt),Et(Jt,"transform-origin",BM/parseInt(Jt.style.width)*100+"% "+$M/parseInt(Jt.style.height)*100+"%")}},_onDragStart:function(t,e){var r=this,s=t.dataTransfer,i=r.options;if(Yr("dragStart",this,{evt:t}),Vt.eventCanceled){this._onDrop();return}Yr("setupClone",this),Vt.eventCanceled||(pn=vk(at),pn.draggable=!1,pn.style["will-change"]="",this._hideClone(),an(pn,this.options.chosenClass,!1),Vt.clone=pn),r.cloneId=E0(function(){Yr("clone",r),!Vt.eventCanceled&&(r.options.removeCloneOnHide||Qe.insertBefore(pn,at),r._hideClone(),Ir({sortable:r,name:"clone"}))}),!e&&an(at,i.dragClass,!0),e?(gv=!0,r._loopId=setInterval(r._emulateDragOver,50)):(de(document,"mouseup",r._onDrop),de(document,"touchend",r._onDrop),de(document,"touchcancel",r._onDrop),s&&(s.effectAllowed="move",i.setData&&i.setData.call(r,s,at)),pe(document,"drop",r),Et(at,"transform","translateZ(0)")),Od=!0,r._dragStartId=E0(r._dragStarted.bind(r,e,t)),pe(document,"selectstart",r),np=!0,Kp&&Et(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,r=t.target,s,i,o,a=this.options,l=a.group,c=Vt.active,u=Yy===l,d=a.sort,h=Jn||c,p,g=this,m=!1;if(MS)return;function b(X,wt){Yr(X,g,vo({evt:t,isOwner:u,axis:p?"vertical":"horizontal",revert:o,dragRect:s,targetRect:i,canSort:d,fromSortable:h,target:r,completed:v,onMove:function($t,Pt){return Jy(Qe,e,at,s,$t,rn($t),t,Pt)},changed:x},wt))}function y(){b("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function v(X){return b("dragOverCompleted",{insertion:X}),X&&(u?c._hideClone():c._showClone(g),g!==h&&(an(at,Jn?Jn.options.ghostClass:c.options.ghostClass,!1),an(at,a.ghostClass,!0)),Jn!==g&&g!==Vt.active?Jn=g:g===Vt.active&&Jn&&(Jn=null),h===g&&(g._ignoreWhileAnimating=r),g.animateAll(function(){b("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(r===at&&!at.animated||r===e&&!r.animated)&&(xd=null),!a.dragoverBubble&&!t.rootEl&&r!==document&&(at.parentNode[Ar]._isOutsideThisEl(t.target),!X&&fc(t)),!a.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function x(){fs=mn(at),Qa=mn(at,a.draggable),Ir({sortable:g,name:"change",toEl:e,newIndex:fs,newDraggableIndex:Qa,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),r=Ai(r,a.draggable,e,!0),b("dragOver"),Vt.eventCanceled)return m;if(at.contains(t.target)||r.animated&&r.animatingX&&r.animatingY||g._ignoreWhileAnimating===r)return v(!1);if(gv=!1,c&&!a.disabled&&(u?d||(o=fn!==Qe):Jn===this||(this.lastPutMode=Yy.checkPull(this,c,at,t))&&l.checkPut(this,c,at,t))){if(p=this._getDirection(t,r)==="vertical",s=rn(at),b("dragOverValid"),Vt.eventCanceled)return m;if(o)return fn=Qe,y(),this._hideClone(),b("revert"),Vt.eventCanceled||(gc?Qe.insertBefore(at,gc):Qe.appendChild(at)),v(!0);var S=bk(e,a.draggable);if(!S||sK(t,p,this)&&!S.animated){if(S===at)return v(!1);if(S&&e===t.target&&(r=S),r&&(i=rn(r)),Jy(Qe,e,at,s,r,i,t,!!r)!==!1)return y(),e.appendChild(at),fn=e,x(),v(!0)}else if(S&&rK(t,p,this)){var w=Ef(e,0,a,!0);if(w===at)return v(!1);if(r=w,i=rn(r),Jy(Qe,e,at,s,r,i,t,!1)!==!1)return y(),e.insertBefore(at,w),fn=e,x(),v(!0)}else if(r.parentNode===e){i=rn(r);var E=0,T,I=at.parentNode!==e,C=!Q7(at.animated&&at.toRect||s,r.animated&&r.toRect||i,p),R=p?"top":"left",N=_M(r,"top","top")||_M(at,"top","top"),B=N?N.scrollTop:void 0;xd!==r&&(T=i[R],qp=!1,Xy=!C&&a.invertSwap||I),E=iK(t,r,i,p,C?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,Xy,xd===r);var $;if(E!==0){var L=mn(at);do L-=E,$=fn.children[L];while($&&(Et($,"display")==="none"||$===Jt))}if(E===0||$===r)return v(!1);xd=r,Xp=E;var F=r.nextElementSibling,_=!1;_=E===1;var j=Jy(Qe,e,at,s,r,i,t,_);if(j!==!1)return(j===1||j===-1)&&(_=j===1),MS=!0,setTimeout(nK,30),y(),_&&!F?e.appendChild(at):r.parentNode.insertBefore(at,_?F:r),N&&hD(N,0,B-N.scrollTop),fn=at.parentNode,T!==void 0&&!Xy&&(A0=Math.abs(T-rn(r)[R])),x(),v(!0)}if(e.contains(at))return v(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){de(document,"mousemove",this._onTouchMove),de(document,"touchmove",this._onTouchMove),de(document,"pointermove",this._onTouchMove),de(document,"dragover",fc),de(document,"mousemove",fc),de(document,"touchmove",fc)},_offUpEvents:function(){var t=this.el.ownerDocument;de(t,"mouseup",this._onDrop),de(t,"touchend",this._onDrop),de(t,"pointerup",this._onDrop),de(t,"touchcancel",this._onDrop),de(document,"selectstart",this)},_onDrop:function(t){var e=this.el,r=this.options;if(fs=mn(at),Qa=mn(at,r.draggable),Yr("drop",this,{evt:t}),fn=at&&at.parentNode,fs=mn(at),Qa=mn(at,r.draggable),Vt.eventCanceled){this._nulling();return}Od=!1,Xy=!1,qp=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),PS(this.cloneId),PS(this._dragStartId),this.nativeDraggable&&(de(document,"drop",this),de(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Kp&&Et(document.body,"user-select",""),Et(at,"transform",""),t&&(np&&(t.cancelable&&t.preventDefault(),!r.dropBubble&&t.stopPropagation()),Jt&&Jt.parentNode&&Jt.parentNode.removeChild(Jt),(Qe===fn||Jn&&Jn.lastPutMode!=="clone")&&pn&&pn.parentNode&&pn.parentNode.removeChild(pn),at&&(this.nativeDraggable&&de(at,"dragend",this),Kx(at),at.style["will-change"]="",np&&!Od&&an(at,Jn?Jn.options.ghostClass:this.options.ghostClass,!1),an(at,this.options.chosenClass,!1),Ir({sortable:this,name:"unchoose",toEl:fn,newIndex:null,newDraggableIndex:null,originalEvent:t}),Qe!==fn?(fs>=0&&(Ir({rootEl:fn,name:"add",toEl:fn,fromEl:Qe,originalEvent:t}),Ir({sortable:this,name:"remove",toEl:fn,originalEvent:t}),Ir({rootEl:fn,name:"sort",toEl:fn,fromEl:Qe,originalEvent:t}),Ir({sortable:this,name:"sort",toEl:fn,originalEvent:t})),Jn&&Jn.save()):fs!==Hd&&fs>=0&&(Ir({sortable:this,name:"update",toEl:fn,originalEvent:t}),Ir({sortable:this,name:"sort",toEl:fn,originalEvent:t})),Vt.active&&((fs==null||fs===-1)&&(fs=Hd,Qa=Yp),Ir({sortable:this,name:"end",toEl:fn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Yr("nulling",this),Qe=at=fn=Jt=gc=pn=S0=nl=hc=ai=np=fs=Qa=Hd=Yp=xd=Xp=Jn=Yy=Vt.dragged=Vt.ghost=Vt.clone=Vt.active=null,yv.forEach(function(t){t.checked=!0}),yv.length=zx=Ux=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":at&&(this._onDragOver(t),eK(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,r=this.el.children,s=0,i=r.length,o=this.options;s<i;s++)e=r[s],Ai(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||aK(e));return t},sort:function(t,e){var r={},s=this.el;this.toArray().forEach(function(i,o){var a=s.children[o];Ai(a,this.options.draggable,s,!1)&&(r[i]=a)},this),e&&this.captureAnimationState(),t.forEach(function(i){r[i]&&(s.removeChild(r[i]),s.appendChild(r[i]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return Ai(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var r=this.options;if(e===void 0)return r[t];var s=my.modifyOption(this,t,e);typeof s<"u"?r[t]=s:r[t]=e,t==="group"&&gD(r)},destroy:function(){Yr("destroy",this);var t=this.el;t[Ar]=null,de(t,"mousedown",this._onTapStart),de(t,"touchstart",this._onTapStart),de(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(de(t,"dragover",this),de(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),mv.splice(mv.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!nl){if(Yr("hideClone",this),Vt.eventCanceled)return;Et(pn,"display","none"),this.options.removeCloneOnHide&&pn.parentNode&&pn.parentNode.removeChild(pn),nl=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(nl){if(Yr("showClone",this),Vt.eventCanceled)return;at.parentNode==Qe&&!this.options.group.revertClone?Qe.insertBefore(pn,at):gc?Qe.insertBefore(pn,gc):Qe.appendChild(pn),this.options.group.revertClone&&this.animate(at,pn),Et(pn,"display",""),nl=!1}}};function eK(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function Jy(n,t,e,r,s,i,o,a){var l,c=n[Ar],u=c.options.onMove,d;return window.CustomEvent&&!Da&&!gy?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=n,l.dragged=e,l.draggedRect=r,l.related=s||t,l.relatedRect=i||rn(t),l.willInsertAfter=a,l.originalEvent=o,n.dispatchEvent(l),u&&(d=u.call(c,l,o)),d}function Kx(n){n.draggable=!1}function nK(){MS=!1}function rK(n,t,e){var r=rn(Ef(e.el,0,e.options,!0)),s=10;return t?n.clientX<r.left-s||n.clientY<r.top&&n.clientX<r.right:n.clientY<r.top-s||n.clientY<r.bottom&&n.clientX<r.left}function sK(n,t,e){var r=rn(bk(e.el,e.options.draggable)),s=10;return t?n.clientX>r.right+s||n.clientX<=r.right&&n.clientY>r.bottom&&n.clientX>=r.left:n.clientX>r.right&&n.clientY>r.top||n.clientX<=r.right&&n.clientY>r.bottom+s}function iK(n,t,e,r,s,i,o,a){var l=r?n.clientY:n.clientX,c=r?e.height:e.width,u=r?e.top:e.left,d=r?e.bottom:e.right,h=!1;if(!o){if(a&&A0<c*s){if(!qp&&(Xp===1?l>u+c*i/2:l<d-c*i/2)&&(qp=!0),qp)h=!0;else if(Xp===1?l<u+A0:l>d-A0)return-Xp}else if(l>u+c*(1-s)/2&&l<d-c*(1-s)/2)return oK(t)}return h=h||o,h&&(l<u+c*i/2||l>d-c*i/2)?l>u+c/2?1:-1:0}function oK(n){return mn(at)<mn(n)?1:-1}function aK(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,e=t.length,r=0;e--;)r+=t.charCodeAt(e);return r.toString(36)}function lK(n){yv.length=0;for(var t=n.getElementsByTagName("input"),e=t.length;e--;){var r=t[e];r.checked&&yv.push(r)}}function E0(n){return setTimeout(n,0)}function PS(n){return clearTimeout(n)}Nw&&pe(document,"touchmove",function(n){(Vt.active||Od)&&n.cancelable&&n.preventDefault()});Vt.utils={on:pe,off:de,css:Et,find:uD,is:function(t,e){return!!Ai(t,e,t,!1)},extend:W7,throttle:dD,closest:Ai,toggleClass:an,clone:vk,index:mn,nextTick:E0,cancelNextTick:PS,detectDirection:pD,getChild:Ef};Vt.get=function(n){return n[Ar]};Vt.mount=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Vt.utils=vo(vo({},Vt.utils),r.utils)),my.mount(r)})};Vt.create=function(n,t){return new Vt(n,t)};Vt.version=H7;var An=[],rp,OS,IS=!1,Gx,Yx,bv,sp;function cK(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return n.prototype={dragStarted:function(e){var r=e.originalEvent;this.sortable.nativeDraggable?pe(document,"dragover",this._handleAutoScroll):this.options.supportPointer?pe(document,"pointermove",this._handleFallbackAutoScroll):r.touches?pe(document,"touchmove",this._handleFallbackAutoScroll):pe(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var r=e.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?de(document,"dragover",this._handleAutoScroll):(de(document,"pointermove",this._handleFallbackAutoScroll),de(document,"touchmove",this._handleFallbackAutoScroll),de(document,"mousemove",this._handleFallbackAutoScroll)),HM(),k0(),K7()},nulling:function(){bv=OS=rp=IS=sp=Gx=Yx=null,An.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,r){var s=this,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(i,o);if(bv=e,r||this.options.forceAutoScrollFallback||gy||Da||Kp){Xx(e,this.options,a,r);var l=Bl(a,!0);IS&&(!sp||i!==Gx||o!==Yx)&&(sp&&HM(),sp=setInterval(function(){var c=Bl(document.elementFromPoint(i,o),!0);c!==l&&(l=c,k0()),Xx(e,s.options,c,r)},10),Gx=i,Yx=o)}else{if(!this.options.bubbleScroll||Bl(a,!0)===po()){k0();return}Xx(e,this.options,Bl(a,!1),!1)}}},oi(n,{pluginName:"scroll",initializeByDefault:!0})}function k0(){An.forEach(function(n){clearInterval(n.pid)}),An=[]}function HM(){clearInterval(sp)}var Xx=dD(function(n,t,e,r){if(t.scroll){var s=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,o=t.scrollSensitivity,a=t.scrollSpeed,l=po(),c=!1,u;OS!==e&&(OS=e,k0(),rp=t.scroll,u=t.scrollFn,rp===!0&&(rp=Bl(e,!0)));var d=0,h=rp;do{var p=h,g=rn(p),m=g.top,b=g.bottom,y=g.left,v=g.right,x=g.width,S=g.height,w=void 0,E=void 0,T=p.scrollWidth,I=p.scrollHeight,C=Et(p),R=p.scrollLeft,N=p.scrollTop;p===l?(w=x<T&&(C.overflowX==="auto"||C.overflowX==="scroll"||C.overflowX==="visible"),E=S<I&&(C.overflowY==="auto"||C.overflowY==="scroll"||C.overflowY==="visible")):(w=x<T&&(C.overflowX==="auto"||C.overflowX==="scroll"),E=S<I&&(C.overflowY==="auto"||C.overflowY==="scroll"));var B=w&&(Math.abs(v-s)<=o&&R+x<T)-(Math.abs(y-s)<=o&&!!R),$=E&&(Math.abs(b-i)<=o&&N+S<I)-(Math.abs(m-i)<=o&&!!N);if(!An[d])for(var L=0;L<=d;L++)An[L]||(An[L]={});(An[d].vx!=B||An[d].vy!=$||An[d].el!==p)&&(An[d].el=p,An[d].vx=B,An[d].vy=$,clearInterval(An[d].pid),(B!=0||$!=0)&&(c=!0,An[d].pid=setInterval((function(){r&&this.layer===0&&Vt.active._onTouchMove(bv);var F=An[this.layer].vy?An[this.layer].vy*a:0,_=An[this.layer].vx?An[this.layer].vx*a:0;typeof u=="function"&&u.call(Vt.dragged.parentNode[Ar],_,F,n,bv,An[this.layer].el)!=="continue"||hD(An[this.layer].el,_,F)}).bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==l&&(h=Bl(h,!1)));IS=c}},30),bD=function(t){var e=t.originalEvent,r=t.putSortable,s=t.dragEl,i=t.activeSortable,o=t.dispatchSortableEvent,a=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(e){var c=r||i;a();var u=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,d=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(d)&&(o("spill"),this.onSpill({dragEl:s,putSortable:r}))}};function wk(){}wk.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,r=t.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var s=Ef(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(e,s):this.sortable.el.appendChild(e),this.sortable.animateAll(),r&&r.animateAll()},drop:bD};oi(wk,{pluginName:"revertOnSpill"});function xk(){}xk.prototype={onSpill:function(t){var e=t.dragEl,r=t.putSortable,s=r||this.sortable;s.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),s.animateAll()},drop:bD};oi(xk,{pluginName:"removeOnSpill"});var $s;function uK(){function n(){this.defaults={swapClass:"sortable-swap-highlight"}}return n.prototype={dragStart:function(e){var r=e.dragEl;$s=r},dragOverValid:function(e){var r=e.completed,s=e.target,i=e.onMove,o=e.activeSortable,a=e.changed,l=e.cancel;if(o.options.swap){var c=this.sortable.el,u=this.options;if(s&&s!==c){var d=$s;i(s)!==!1?(an(s,u.swapClass,!0),$s=s):$s=null,d&&d!==$s&&an(d,u.swapClass,!1)}a(),r(!0),l()}},drop:function(e){var r=e.activeSortable,s=e.putSortable,i=e.dragEl,o=s||this.sortable,a=this.options;$s&&an($s,a.swapClass,!1),$s&&(a.swap||s&&s.options.swap)&&i!==$s&&(o.captureAnimationState(),o!==r&&r.captureAnimationState(),dK(i,$s),o.animateAll(),o!==r&&r.animateAll())},nulling:function(){$s=null}},oi(n,{pluginName:"swap",eventProperties:function(){return{swapItem:$s}}})}function dK(n,t){var e=n.parentNode,r=t.parentNode,s,i;!e||!r||e.isEqualNode(t)||r.isEqualNode(n)||(s=mn(n),i=mn(t),e.isEqualNode(r)&&s<i&&i++,e.insertBefore(t,e.children[s]),r.insertBefore(n,r.children[i]))}var Xt=[],hs=[],jf,li,Hf=!1,Xr=!1,Sd=!1,Ue,Vf,Qy;function hK(){function n(t){for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this));t.options.supportPointer?pe(document,"pointerup",this._deselectMultiDrag):(pe(document,"mouseup",this._deselectMultiDrag),pe(document,"touchend",this._deselectMultiDrag)),pe(document,"keydown",this._checkKeyDown),pe(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,i){var o="";Xt.length&&li===t?Xt.forEach(function(a,l){o+=(l?", ":"")+a.textContent}):o=i.textContent,s.setData("Text",o)}}}return n.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var r=e.dragEl;Ue=r},delayEnded:function(){this.isMultiDrag=~Xt.indexOf(Ue)},setupClone:function(e){var r=e.sortable,s=e.cancel;if(this.isMultiDrag){for(var i=0;i<Xt.length;i++)hs.push(vk(Xt[i])),hs[i].sortableIndex=Xt[i].sortableIndex,hs[i].draggable=!1,hs[i].style["will-change"]="",an(hs[i],this.options.selectedClass,!1),Xt[i]===Ue&&an(hs[i],this.options.chosenClass,!1);r._hideClone(),s()}},clone:function(e){var r=e.sortable,s=e.rootEl,i=e.dispatchSortableEvent,o=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Xt.length&&li===r&&(VM(!0,s),i("clone"),o()))},showClone:function(e){var r=e.cloneNowShown,s=e.rootEl,i=e.cancel;this.isMultiDrag&&(VM(!1,s),hs.forEach(function(o){Et(o,"display","")}),r(),Qy=!1,i())},hideClone:function(e){var r=this;e.sortable;var s=e.cloneNowHidden,i=e.cancel;this.isMultiDrag&&(hs.forEach(function(o){Et(o,"display","none"),r.options.removeCloneOnHide&&o.parentNode&&o.parentNode.removeChild(o)}),s(),Qy=!0,i())},dragStartGlobal:function(e){e.sortable,!this.isMultiDrag&&li&&li.multiDrag._deselectMultiDrag(),Xt.forEach(function(r){r.sortableIndex=mn(r)}),Xt=Xt.sort(function(r,s){return r.sortableIndex-s.sortableIndex}),Sd=!0},dragStarted:function(e){var r=this,s=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Xt.forEach(function(o){o!==Ue&&Et(o,"position","absolute")});var i=rn(Ue,!1,!0,!0);Xt.forEach(function(o){o!==Ue&&FM(o,i)}),Xr=!0,Hf=!0}s.animateAll(function(){Xr=!1,Hf=!1,r.options.animation&&Xt.forEach(function(o){Hx(o)}),r.options.sort&&Zy()})}},dragOver:function(e){var r=e.target,s=e.completed,i=e.cancel;Xr&&~Xt.indexOf(r)&&(s(!1),i())},revert:function(e){var r=e.fromSortable,s=e.rootEl,i=e.sortable,o=e.dragRect;Xt.length>1&&(Xt.forEach(function(a){i.addAnimationState({target:a,rect:Xr?rn(a):o}),Hx(a),a.fromRect=o,r.removeAnimationState(a)}),Xr=!1,fK(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(e){var r=e.sortable,s=e.isOwner,i=e.insertion,o=e.activeSortable,a=e.parentEl,l=e.putSortable,c=this.options;if(i){if(s&&o._hideClone(),Hf=!1,c.animation&&Xt.length>1&&(Xr||!s&&!o.options.sort&&!l)){var u=rn(Ue,!1,!0,!0);Xt.forEach(function(h){h!==Ue&&(FM(h,u),a.appendChild(h))}),Xr=!0}if(!s)if(Xr||Zy(),Xt.length>1){var d=Qy;o._showClone(r),o.options.animation&&!Qy&&d&&hs.forEach(function(h){o.addAnimationState({target:h,rect:Vf}),h.fromRect=Vf,h.thisAnimationDuration=null})}else o._showClone(r)}},dragOverAnimationCapture:function(e){var r=e.dragRect,s=e.isOwner,i=e.activeSortable;if(Xt.forEach(function(a){a.thisAnimationDuration=null}),i.options.animation&&!s&&i.multiDrag.isMultiDrag){Vf=oi({},r);var o=zu(Ue,!0);Vf.top-=o.f,Vf.left-=o.e}},dragOverAnimationComplete:function(){Xr&&(Xr=!1,Zy())},drop:function(e){var r=e.originalEvent,s=e.rootEl,i=e.parentEl,o=e.sortable,a=e.dispatchSortableEvent,l=e.oldIndex,c=e.putSortable,u=c||this.sortable;if(r){var d=this.options,h=i.children;if(!Sd)if(d.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),an(Ue,d.selectedClass,!~Xt.indexOf(Ue)),~Xt.indexOf(Ue))Xt.splice(Xt.indexOf(Ue),1),jf=null,ep({sortable:o,rootEl:s,name:"deselect",targetEl:Ue});else{if(Xt.push(Ue),ep({sortable:o,rootEl:s,name:"select",targetEl:Ue}),r.shiftKey&&jf&&o.el.contains(jf)){var p=mn(jf),g=mn(Ue);if(~p&&~g&&p!==g){var m,b;for(g>p?(b=p,m=g):(b=g,m=p+1);b<m;b++)~Xt.indexOf(h[b])||(an(h[b],d.selectedClass,!0),Xt.push(h[b]),ep({sortable:o,rootEl:s,name:"select",targetEl:h[b]}))}}else jf=Ue;li=u}if(Sd&&this.isMultiDrag){if(Xr=!1,(i[Ar].options.sort||i!==s)&&Xt.length>1){var y=rn(Ue),v=mn(Ue,":not(."+this.options.selectedClass+")");if(!Hf&&d.animation&&(Ue.thisAnimationDuration=null),u.captureAnimationState(),!Hf&&(d.animation&&(Ue.fromRect=y,Xt.forEach(function(S){if(S.thisAnimationDuration=null,S!==Ue){var w=Xr?rn(S):y;S.fromRect=w,u.addAnimationState({target:S,rect:w})}})),Zy(),Xt.forEach(function(S){h[v]?i.insertBefore(S,h[v]):i.appendChild(S),v++}),l===mn(Ue))){var x=!1;Xt.forEach(function(S){if(S.sortableIndex!==mn(S)){x=!0;return}}),x&&a("update")}Xt.forEach(function(S){Hx(S)}),u.animateAll()}li=u}(s===i||c&&c.lastPutMode!=="clone")&&hs.forEach(function(S){S.parentNode&&S.parentNode.removeChild(S)})}},nullingGlobal:function(){this.isMultiDrag=Sd=!1,hs.length=0},destroyGlobal:function(){this._deselectMultiDrag(),de(document,"pointerup",this._deselectMultiDrag),de(document,"mouseup",this._deselectMultiDrag),de(document,"touchend",this._deselectMultiDrag),de(document,"keydown",this._checkKeyDown),de(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(typeof Sd<"u"&&Sd)&&li===this.sortable&&!(e&&Ai(e.target,this.options.draggable,this.sortable.el,!1))&&!(e&&e.button!==0))for(;Xt.length;){var r=Xt[0];an(r,this.options.selectedClass,!1),Xt.shift(),ep({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},oi(n,{pluginName:"multiDrag",utils:{select:function(e){var r=e.parentNode[Ar];!r||!r.options.multiDrag||~Xt.indexOf(e)||(li&&li!==r&&(li.multiDrag._deselectMultiDrag(),li=r),an(e,r.options.selectedClass,!0),Xt.push(e))},deselect:function(e){var r=e.parentNode[Ar],s=Xt.indexOf(e);!r||!r.options.multiDrag||!~s||(an(e,r.options.selectedClass,!1),Xt.splice(s,1))}},eventProperties:function(){var e=this,r=[],s=[];return Xt.forEach(function(i){r.push({multiDragElement:i,index:i.sortableIndex});var o;Xr&&i!==Ue?o=-1:Xr?o=mn(i,":not(."+e.options.selectedClass+")"):o=mn(i),s.push({multiDragElement:i,index:o})}),{items:L7(Xt),clones:[].concat(hs),oldIndicies:r,newIndicies:s}},optionListeners:{multiDragKey:function(e){return e=e.toLowerCase(),e==="ctrl"?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function fK(n,t){Xt.forEach(function(e,r){var s=t.children[e.sortableIndex+(n?Number(r):0)];s?t.insertBefore(e,s):t.appendChild(e)})}function VM(n,t){hs.forEach(function(e,r){var s=t.children[e.sortableIndex+(n?Number(r):0)];s?t.insertBefore(e,s):t.appendChild(e)})}function Zy(){Xt.forEach(function(n){n!==Ue&&n.parentNode&&n.parentNode.removeChild(n)})}Vt.mount(new cK);Vt.mount(xk,wk);const pK=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:hK,Sortable:Vt,Swap:uK,default:Vt},Symbol.toStringTag,{value:"Module"})),gK=aD(pK);(function(n,t){(function(r,s){n.exports=s(R7,gK)})(typeof self<"u"?self:O7,function(e,r){return function(s){var i={};function o(a){if(i[a])return i[a].exports;var l=i[a]={i:a,l:!1,exports:{}};return s[a].call(l.exports,l,l.exports,o),l.l=!0,l.exports}return o.m=s,o.c=i,o.d=function(a,l,c){o.o(a,l)||Object.defineProperty(a,l,{enumerable:!0,get:c})},o.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,l){if(l&1&&(a=o(a)),l&8||l&4&&typeof a=="object"&&a&&a.__esModule)return a;var c=Object.create(null);if(o.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),l&2&&typeof a!="string")for(var u in a)o.d(c,u,(function(d){return a[d]}).bind(null,u));return c},o.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(l,"a",l),l},o.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},o.p="",o(o.s="fb15")}({"00ee":function(s,i,o){var a=o("b622"),l=a("toStringTag"),c={};c[l]="z",s.exports=String(c)==="[object z]"},"0366":function(s,i,o){var a=o("1c0b");s.exports=function(l,c,u){if(a(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(d){return l.call(c,d)};case 2:return function(d,h){return l.call(c,d,h)};case 3:return function(d,h,p){return l.call(c,d,h,p)}}return function(){return l.apply(c,arguments)}}},"057f":function(s,i,o){var a=o("fc6a"),l=o("241c").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],d=function(h){try{return l(h)}catch{return u.slice()}};s.exports.f=function(p){return u&&c.call(p)=="[object Window]"?d(p):l(a(p))}},"06cf":function(s,i,o){var a=o("83ab"),l=o("d1e7"),c=o("5c6c"),u=o("fc6a"),d=o("c04e"),h=o("5135"),p=o("0cfb"),g=Object.getOwnPropertyDescriptor;i.f=a?g:function(b,y){if(b=u(b),y=d(y,!0),p)try{return g(b,y)}catch{}if(h(b,y))return c(!l.f.call(b,y),b[y])}},"0cfb":function(s,i,o){var a=o("83ab"),l=o("d039"),c=o("cc12");s.exports=!a&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,i,o){var a=o("23e7"),l=o("d58f").left,c=o("a640"),u=o("ae40"),d=c("reduce"),h=u("reduce",{1:0});a({target:"Array",proto:!0,forced:!d||!h},{reduce:function(g){return l(this,g,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,i,o){var a=o("c6b6"),l=o("9263");s.exports=function(c,u){var d=c.exec;if(typeof d=="function"){var h=d.call(c,u);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(a(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},"159b":function(s,i,o){var a=o("da84"),l=o("fdbc"),c=o("17c2"),u=o("9112");for(var d in l){var h=a[d],p=h&&h.prototype;if(p&&p.forEach!==c)try{u(p,"forEach",c)}catch{p.forEach=c}}},"17c2":function(s,i,o){var a=o("b727").forEach,l=o("a640"),c=o("ae40"),u=l("forEach"),d=c("forEach");s.exports=!u||!d?function(p){return a(this,p,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,i,o){var a=o("d066");s.exports=a("document","documentElement")},"1c0b":function(s,i){s.exports=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o}},"1c7e":function(s,i,o){var a=o("b622"),l=a("iterator"),c=!1;try{var u=0,d={next:function(){return{done:!!u++}},return:function(){c=!0}};d[l]=function(){return this},Array.from(d,function(){throw 2})}catch{}s.exports=function(h,p){if(!p&&!c)return!1;var g=!1;try{var m={};m[l]=function(){return{next:function(){return{done:g=!0}}}},h(m)}catch{}return g}},"1d80":function(s,i){s.exports=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o}},"1dde":function(s,i,o){var a=o("d039"),l=o("b622"),c=o("2d00"),u=l("species");s.exports=function(d){return c>=51||!a(function(){var h=[],p=h.constructor={};return p[u]=function(){return{foo:1}},h[d](Boolean).foo!==1})}},"23cb":function(s,i,o){var a=o("a691"),l=Math.max,c=Math.min;s.exports=function(u,d){var h=a(u);return h<0?l(h+d,0):c(h,d)}},"23e7":function(s,i,o){var a=o("da84"),l=o("06cf").f,c=o("9112"),u=o("6eeb"),d=o("ce4e"),h=o("e893"),p=o("94ca");s.exports=function(g,m){var b=g.target,y=g.global,v=g.stat,x,S,w,E,T,I;if(y?S=a:v?S=a[b]||d(b,{}):S=(a[b]||{}).prototype,S)for(w in m){if(T=m[w],g.noTargetGet?(I=l(S,w),E=I&&I.value):E=S[w],x=p(y?w:b+(v?".":"#")+w,g.forced),!x&&E!==void 0){if(typeof T==typeof E)continue;h(T,E)}(g.sham||E&&E.sham)&&c(T,"sham",!0),u(S,w,T,g)}}},"241c":function(s,i,o){var a=o("ca84"),l=o("7839"),c=l.concat("length","prototype");i.f=Object.getOwnPropertyNames||function(d){return a(d,c)}},"25f0":function(s,i,o){var a=o("6eeb"),l=o("825a"),c=o("d039"),u=o("ad6d"),d="toString",h=RegExp.prototype,p=h[d],g=c(function(){return p.call({source:"a",flags:"b"})!="/a/b"}),m=p.name!=d;(g||m)&&a(RegExp.prototype,d,function(){var y=l(this),v=String(y.source),x=y.flags,S=String(x===void 0&&y instanceof RegExp&&!("flags"in h)?u.call(y):x);return"/"+v+"/"+S},{unsafe:!0})},"2ca0":function(s,i,o){var a=o("23e7"),l=o("06cf").f,c=o("50c4"),u=o("5a34"),d=o("1d80"),h=o("ab13"),p=o("c430"),g="".startsWith,m=Math.min,b=h("startsWith"),y=!p&&!b&&!!function(){var v=l(String.prototype,"startsWith");return v&&!v.writable}();a({target:"String",proto:!0,forced:!y&&!b},{startsWith:function(x){var S=String(d(this));u(x);var w=c(m(arguments.length>1?arguments[1]:void 0,S.length)),E=String(x);return g?g.call(S,E,w):S.slice(w,w+E.length)===E}})},"2d00":function(s,i,o){var a=o("da84"),l=o("342f"),c=a.process,u=c&&c.versions,d=u&&u.v8,h,p;d?(h=d.split("."),p=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(p=h[1]))),s.exports=p&&+p},"342f":function(s,i,o){var a=o("d066");s.exports=a("navigator","userAgent")||""},"35a1":function(s,i,o){var a=o("f5df"),l=o("3f8c"),c=o("b622"),u=c("iterator");s.exports=function(d){if(d!=null)return d[u]||d["@@iterator"]||l[a(d)]}},"37e8":function(s,i,o){var a=o("83ab"),l=o("9bf2"),c=o("825a"),u=o("df75");s.exports=a?Object.defineProperties:function(h,p){c(h);for(var g=u(p),m=g.length,b=0,y;m>b;)l.f(h,y=g[b++],p[y]);return h}},"3bbe":function(s,i,o){var a=o("861d");s.exports=function(l){if(!a(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(s,i,o){var a=o("6547").charAt,l=o("69f3"),c=o("7dd0"),u="String Iterator",d=l.set,h=l.getterFor(u);c(String,"String",function(p){d(this,{type:u,string:String(p),index:0})},function(){var g=h(this),m=g.string,b=g.index,y;return b>=m.length?{value:void 0,done:!0}:(y=a(m,b),g.index+=y.length,{value:y,done:!1})})},"3f8c":function(s,i){s.exports={}},4160:function(s,i,o){var a=o("23e7"),l=o("17c2");a({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(s,i,o){var a=o("da84");s.exports=a},"44ad":function(s,i,o){var a=o("d039"),l=o("c6b6"),c="".split;s.exports=a(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},"44d2":function(s,i,o){var a=o("b622"),l=o("7c73"),c=o("9bf2"),u=a("unscopables"),d=Array.prototype;d[u]==null&&c.f(d,u,{configurable:!0,value:l(null)}),s.exports=function(h){d[u][h]=!0}},"44e7":function(s,i,o){var a=o("861d"),l=o("c6b6"),c=o("b622"),u=c("match");s.exports=function(d){var h;return a(d)&&((h=d[u])!==void 0?!!h:l(d)=="RegExp")}},4930:function(s,i,o){var a=o("d039");s.exports=!!Object.getOwnPropertySymbols&&!a(function(){return!String(Symbol())})},"4d64":function(s,i,o){var a=o("fc6a"),l=o("50c4"),c=o("23cb"),u=function(d){return function(h,p,g){var m=a(h),b=l(m.length),y=c(g,b),v;if(d&&p!=p){for(;b>y;)if(v=m[y++],v!=v)return!0}else for(;b>y;y++)if((d||y in m)&&m[y]===p)return d||y||0;return!d&&-1}};s.exports={includes:u(!0),indexOf:u(!1)}},"4de4":function(s,i,o){var a=o("23e7"),l=o("b727").filter,c=o("1dde"),u=o("ae40"),d=c("filter"),h=u("filter");a({target:"Array",proto:!0,forced:!d||!h},{filter:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,i,o){var a=o("0366"),l=o("7b0b"),c=o("9bdd"),u=o("e95a"),d=o("50c4"),h=o("8418"),p=o("35a1");s.exports=function(m){var b=l(m),y=typeof this=="function"?this:Array,v=arguments.length,x=v>1?arguments[1]:void 0,S=x!==void 0,w=p(b),E=0,T,I,C,R,N,B;if(S&&(x=a(x,v>2?arguments[2]:void 0,2)),w!=null&&!(y==Array&&u(w)))for(R=w.call(b),N=R.next,I=new y;!(C=N.call(R)).done;E++)B=S?c(R,x,[C.value,E],!0):C.value,h(I,E,B);else for(T=d(b.length),I=new y(T);T>E;E++)B=S?x(b[E],E):b[E],h(I,E,B);return I.length=E,I}},"4fad":function(s,i,o){var a=o("23e7"),l=o("6f53").entries;a({target:"Object",stat:!0},{entries:function(u){return l(u)}})},"50c4":function(s,i,o){var a=o("a691"),l=Math.min;s.exports=function(c){return c>0?l(a(c),9007199254740991):0}},5135:function(s,i){var o={}.hasOwnProperty;s.exports=function(a,l){return o.call(a,l)}},5319:function(s,i,o){var a=o("d784"),l=o("825a"),c=o("7b0b"),u=o("50c4"),d=o("a691"),h=o("1d80"),p=o("8aa5"),g=o("14c3"),m=Math.max,b=Math.min,y=Math.floor,v=/\$([$&'`]|\d\d?|<[^>]*>)/g,x=/\$([$&'`]|\d\d?)/g,S=function(w){return w===void 0?w:String(w)};a("replace",2,function(w,E,T,I){var C=I.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,R=I.REPLACE_KEEPS_$0,N=C?"$":"$0";return[function(L,F){var _=h(this),j=L==null?void 0:L[w];return j!==void 0?j.call(L,_,F):E.call(String(_),L,F)},function($,L){if(!C&&R||typeof L=="string"&&L.indexOf(N)===-1){var F=T(E,$,this,L);if(F.done)return F.value}var _=l($),j=String(this),X=typeof L=="function";X||(L=String(L));var wt=_.global;if(wt){var qt=_.unicode;_.lastIndex=0}for(var $t=[];;){var Pt=g(_,j);if(Pt===null||($t.push(Pt),!wt))break;var jt=String(Pt[0]);jt===""&&(_.lastIndex=p(j,u(_.lastIndex),qt))}for(var me="",xe=0,Ot=0;Ot<$t.length;Ot++){Pt=$t[Ot];for(var z=String(Pt[0]),rt=m(b(d(Pt.index),j.length),0),et=[],ht=1;ht<Pt.length;ht++)et.push(S(Pt[ht]));var Zt=Pt.groups;if(X){var fe=[z].concat(et,rt,j);Zt!==void 0&&fe.push(Zt);var O=String(L.apply(void 0,fe))}else O=B(z,j,rt,et,Zt,L);rt>=xe&&(me+=j.slice(xe,rt)+O,xe=rt+z.length)}return me+j.slice(xe)}];function B($,L,F,_,j,X){var wt=F+$.length,qt=_.length,$t=x;return j!==void 0&&(j=c(j),$t=v),E.call(X,$t,function(Pt,jt){var me;switch(jt.charAt(0)){case"$":return"$";case"&":return $;case"`":return L.slice(0,F);case"'":return L.slice(wt);case"<":me=j[jt.slice(1,-1)];break;default:var xe=+jt;if(xe===0)return Pt;if(xe>qt){var Ot=y(xe/10);return Ot===0?Pt:Ot<=qt?_[Ot-1]===void 0?jt.charAt(1):_[Ot-1]+jt.charAt(1):Pt}me=_[xe-1]}return me===void 0?"":me})}})},5692:function(s,i,o){var a=o("c430"),l=o("c6cd");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,i,o){var a=o("d066"),l=o("241c"),c=o("7418"),u=o("825a");s.exports=a("Reflect","ownKeys")||function(h){var p=l.f(u(h)),g=c.f;return g?p.concat(g(h)):p}},"5a34":function(s,i,o){var a=o("44e7");s.exports=function(l){if(a(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(s,i){s.exports=function(o,a){return{enumerable:!(o&1),configurable:!(o&2),writable:!(o&4),value:a}}},"5db7":function(s,i,o){var a=o("23e7"),l=o("a2bf"),c=o("7b0b"),u=o("50c4"),d=o("1c0b"),h=o("65f0");a({target:"Array",proto:!0},{flatMap:function(g){var m=c(this),b=u(m.length),y;return d(g),y=h(m,0),y.length=l(y,m,m,b,0,1,g,arguments.length>1?arguments[1]:void 0),y}})},6547:function(s,i,o){var a=o("a691"),l=o("1d80"),c=function(u){return function(d,h){var p=String(l(d)),g=a(h),m=p.length,b,y;return g<0||g>=m?u?"":void 0:(b=p.charCodeAt(g),b<55296||b>56319||g+1===m||(y=p.charCodeAt(g+1))<56320||y>57343?u?p.charAt(g):b:u?p.slice(g,g+2):(b-55296<<10)+(y-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,i,o){var a=o("861d"),l=o("e8b5"),c=o("b622"),u=c("species");s.exports=function(d,h){var p;return l(d)&&(p=d.constructor,typeof p=="function"&&(p===Array||l(p.prototype))?p=void 0:a(p)&&(p=p[u],p===null&&(p=void 0))),new(p===void 0?Array:p)(h===0?0:h)}},"69f3":function(s,i,o){var a=o("7f9a"),l=o("da84"),c=o("861d"),u=o("9112"),d=o("5135"),h=o("f772"),p=o("d012"),g=l.WeakMap,m,b,y,v=function(C){return y(C)?b(C):m(C,{})},x=function(C){return function(R){var N;if(!c(R)||(N=b(R)).type!==C)throw TypeError("Incompatible receiver, "+C+" required");return N}};if(a){var S=new g,w=S.get,E=S.has,T=S.set;m=function(C,R){return T.call(S,C,R),R},b=function(C){return w.call(S,C)||{}},y=function(C){return E.call(S,C)}}else{var I=h("state");p[I]=!0,m=function(C,R){return u(C,I,R),R},b=function(C){return d(C,I)?C[I]:{}},y=function(C){return d(C,I)}}s.exports={set:m,get:b,has:y,enforce:v,getterFor:x}},"6eeb":function(s,i,o){var a=o("da84"),l=o("9112"),c=o("5135"),u=o("ce4e"),d=o("8925"),h=o("69f3"),p=h.get,g=h.enforce,m=String(String).split("String");(s.exports=function(b,y,v,x){var S=x?!!x.unsafe:!1,w=x?!!x.enumerable:!1,E=x?!!x.noTargetGet:!1;if(typeof v=="function"&&(typeof y=="string"&&!c(v,"name")&&l(v,"name",y),g(v).source=m.join(typeof y=="string"?y:"")),b===a){w?b[y]=v:u(y,v);return}else S?!E&&b[y]&&(w=!0):delete b[y];w?b[y]=v:l(b,y,v)})(Function.prototype,"toString",function(){return typeof this=="function"&&p(this).source||d(this)})},"6f53":function(s,i,o){var a=o("83ab"),l=o("df75"),c=o("fc6a"),u=o("d1e7").f,d=function(h){return function(p){for(var g=c(p),m=l(g),b=m.length,y=0,v=[],x;b>y;)x=m[y++],(!a||u.call(g,x))&&v.push(h?[x,g[x]]:g[x]);return v}};s.exports={entries:d(!0),values:d(!1)}},"73d9":function(s,i,o){var a=o("44d2");a("flatMap")},7418:function(s,i){i.f=Object.getOwnPropertySymbols},"746f":function(s,i,o){var a=o("428f"),l=o("5135"),c=o("e538"),u=o("9bf2").f;s.exports=function(d){var h=a.Symbol||(a.Symbol={});l(h,d)||u(h,d,{value:c.f(d)})}},7839:function(s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,i,o){var a=o("1d80");s.exports=function(l){return Object(a(l))}},"7c73":function(s,i,o){var a=o("825a"),l=o("37e8"),c=o("7839"),u=o("d012"),d=o("1be4"),h=o("cc12"),p=o("f772"),g=">",m="<",b="prototype",y="script",v=p("IE_PROTO"),x=function(){},S=function(C){return m+y+g+C+m+"/"+y+g},w=function(C){C.write(S("")),C.close();var R=C.parentWindow.Object;return C=null,R},E=function(){var C=h("iframe"),R="java"+y+":",N;return C.style.display="none",d.appendChild(C),C.src=String(R),N=C.contentWindow.document,N.open(),N.write(S("document.F=Object")),N.close(),N.F},T,I=function(){try{T=document.domain&&new ActiveXObject("htmlfile")}catch{}I=T?w(T):E();for(var C=c.length;C--;)delete I[b][c[C]];return I()};u[v]=!0,s.exports=Object.create||function(R,N){var B;return R!==null?(x[b]=a(R),B=new x,x[b]=null,B[v]=R):B=I(),N===void 0?B:l(B,N)}},"7dd0":function(s,i,o){var a=o("23e7"),l=o("9ed3"),c=o("e163"),u=o("d2bb"),d=o("d44e"),h=o("9112"),p=o("6eeb"),g=o("b622"),m=o("c430"),b=o("3f8c"),y=o("ae93"),v=y.IteratorPrototype,x=y.BUGGY_SAFARI_ITERATORS,S=g("iterator"),w="keys",E="values",T="entries",I=function(){return this};s.exports=function(C,R,N,B,$,L,F){l(N,R,B);var _=function(Ot){if(Ot===$&&$t)return $t;if(!x&&Ot in wt)return wt[Ot];switch(Ot){case w:return function(){return new N(this,Ot)};case E:return function(){return new N(this,Ot)};case T:return function(){return new N(this,Ot)}}return function(){return new N(this)}},j=R+" Iterator",X=!1,wt=C.prototype,qt=wt[S]||wt["@@iterator"]||$&&wt[$],$t=!x&&qt||_($),Pt=R=="Array"&&wt.entries||qt,jt,me,xe;if(Pt&&(jt=c(Pt.call(new C)),v!==Object.prototype&&jt.next&&(!m&&c(jt)!==v&&(u?u(jt,v):typeof jt[S]!="function"&&h(jt,S,I)),d(jt,j,!0,!0),m&&(b[j]=I))),$==E&&qt&&qt.name!==E&&(X=!0,$t=function(){return qt.call(this)}),(!m||F)&&wt[S]!==$t&&h(wt,S,$t),b[R]=$t,$)if(me={values:_(E),keys:L?$t:_(w),entries:_(T)},F)for(xe in me)(x||X||!(xe in wt))&&p(wt,xe,me[xe]);else a({target:R,proto:!0,forced:x||X},me);return me}},"7f9a":function(s,i,o){var a=o("da84"),l=o("8925"),c=a.WeakMap;s.exports=typeof c=="function"&&/native code/.test(l(c))},"825a":function(s,i,o){var a=o("861d");s.exports=function(l){if(!a(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(s,i,o){var a=o("d039");s.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,i,o){var a=o("c04e"),l=o("9bf2"),c=o("5c6c");s.exports=function(u,d,h){var p=a(d);p in u?l.f(u,p,c(0,h)):u[p]=h}},"861d":function(s,i){s.exports=function(o){return typeof o=="object"?o!==null:typeof o=="function"}},8875:function(s,i,o){var a,l,c;(function(u,d){l=[],a=d,c=typeof a=="function"?a.apply(i,l):a,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function u(){var d=Object.getOwnPropertyDescriptor(document,"currentScript");if(!d&&"currentScript"in document&&document.currentScript||d&&d.get!==u&&document.currentScript)return document.currentScript;try{throw new Error}catch(T){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,p=/@([^@]*):(\d+):(\d+)\s*$/ig,g=h.exec(T.stack)||p.exec(T.stack),m=g&&g[1]||!1,b=g&&g[2]||!1,y=document.location.href.replace(document.location.hash,""),v,x,S,w=document.getElementsByTagName("script");m===y&&(v=document.documentElement.outerHTML,x=new RegExp("(?:[^\\n]+?\\n){0,"+(b-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),S=v.replace(x,"$1").trim());for(var E=0;E<w.length;E++)if(w[E].readyState==="interactive"||w[E].src===m||m===y&&w[E].innerHTML&&w[E].innerHTML.trim()===S)return w[E];return null}}return u})},8925:function(s,i,o){var a=o("c6cd"),l=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(c){return l.call(c)}),s.exports=a.inspectSource},"8aa5":function(s,i,o){var a=o("6547").charAt;s.exports=function(l,c,u){return c+(u?a(l,c).length:1)}},"8bbf":function(s,i){s.exports=e},"90e3":function(s,i){var o=0,a=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++o+a).toString(36)}},9112:function(s,i,o){var a=o("83ab"),l=o("9bf2"),c=o("5c6c");s.exports=a?function(u,d,h){return l.f(u,d,c(1,h))}:function(u,d,h){return u[d]=h,u}},9263:function(s,i,o){var a=o("ad6d"),l=o("9f7f"),c=RegExp.prototype.exec,u=String.prototype.replace,d=c,h=function(){var b=/a/,y=/b*/g;return c.call(b,"a"),c.call(y,"a"),b.lastIndex!==0||y.lastIndex!==0}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0,m=h||g||p;m&&(d=function(y){var v=this,x,S,w,E,T=p&&v.sticky,I=a.call(v),C=v.source,R=0,N=y;return T&&(I=I.replace("y",""),I.indexOf("g")===-1&&(I+="g"),N=String(y).slice(v.lastIndex),v.lastIndex>0&&(!v.multiline||v.multiline&&y[v.lastIndex-1]!==`
`)&&(C="(?: "+C+")",N=" "+N,R++),S=new RegExp("^(?:"+C+")",I)),g&&(S=new RegExp("^"+C+"$(?!\\s)",I)),h&&(x=v.lastIndex),w=c.call(T?S:v,N),T?w?(w.input=w.input.slice(R),w[0]=w[0].slice(R),w.index=v.lastIndex,v.lastIndex+=w[0].length):v.lastIndex=0:h&&w&&(v.lastIndex=v.global?w.index+w[0].length:x),g&&w&&w.length>1&&u.call(w[0],S,function(){for(E=1;E<arguments.length-2;E++)arguments[E]===void 0&&(w[E]=void 0)}),w}),s.exports=d},"94ca":function(s,i,o){var a=o("d039"),l=/#|\.prototype\./,c=function(g,m){var b=d[u(g)];return b==p?!0:b==h?!1:typeof m=="function"?a(m):!!m},u=c.normalize=function(g){return String(g).replace(l,".").toLowerCase()},d=c.data={},h=c.NATIVE="N",p=c.POLYFILL="P";s.exports=c},"99af":function(s,i,o){var a=o("23e7"),l=o("d039"),c=o("e8b5"),u=o("861d"),d=o("7b0b"),h=o("50c4"),p=o("8418"),g=o("65f0"),m=o("1dde"),b=o("b622"),y=o("2d00"),v=b("isConcatSpreadable"),x=9007199254740991,S="Maximum allowed index exceeded",w=y>=51||!l(function(){var C=[];return C[v]=!1,C.concat()[0]!==C}),E=m("concat"),T=function(C){if(!u(C))return!1;var R=C[v];return R!==void 0?!!R:c(C)},I=!w||!E;a({target:"Array",proto:!0,forced:I},{concat:function(R){var N=d(this),B=g(N,0),$=0,L,F,_,j,X;for(L=-1,_=arguments.length;L<_;L++)if(X=L===-1?N:arguments[L],T(X)){if(j=h(X.length),$+j>x)throw TypeError(S);for(F=0;F<j;F++,$++)F in X&&p(B,$,X[F])}else{if($>=x)throw TypeError(S);p(B,$++,X)}return B.length=$,B}})},"9bdd":function(s,i,o){var a=o("825a");s.exports=function(l,c,u,d){try{return d?c(a(u)[0],u[1]):c(u)}catch(p){var h=l.return;throw h!==void 0&&a(h.call(l)),p}}},"9bf2":function(s,i,o){var a=o("83ab"),l=o("0cfb"),c=o("825a"),u=o("c04e"),d=Object.defineProperty;i.f=a?d:function(p,g,m){if(c(p),g=u(g,!0),c(m),l)try{return d(p,g,m)}catch{}if("get"in m||"set"in m)throw TypeError("Accessors not supported");return"value"in m&&(p[g]=m.value),p}},"9ed3":function(s,i,o){var a=o("ae93").IteratorPrototype,l=o("7c73"),c=o("5c6c"),u=o("d44e"),d=o("3f8c"),h=function(){return this};s.exports=function(p,g,m){var b=g+" Iterator";return p.prototype=l(a,{next:c(1,m)}),u(p,b,!1,!0),d[b]=h,p}},"9f7f":function(s,i,o){var a=o("d039");function l(c,u){return RegExp(c,u)}i.UNSUPPORTED_Y=a(function(){var c=l("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),i.BROKEN_CARET=a(function(){var c=l("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,i,o){var a=o("e8b5"),l=o("50c4"),c=o("0366"),u=function(d,h,p,g,m,b,y,v){for(var x=m,S=0,w=y?c(y,v,3):!1,E;S<g;){if(S in p){if(E=w?w(p[S],S,h):p[S],b>0&&a(E))x=u(d,h,E,l(E.length),x,b-1)-1;else{if(x>=9007199254740991)throw TypeError("Exceed the acceptable array length");d[x]=E}x++}S++}return x};s.exports=u},a352:function(s,i){s.exports=r},a434:function(s,i,o){var a=o("23e7"),l=o("23cb"),c=o("a691"),u=o("50c4"),d=o("7b0b"),h=o("65f0"),p=o("8418"),g=o("1dde"),m=o("ae40"),b=g("splice"),y=m("splice",{ACCESSORS:!0,0:0,1:2}),v=Math.max,x=Math.min,S=9007199254740991,w="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!b||!y},{splice:function(T,I){var C=d(this),R=u(C.length),N=l(T,R),B=arguments.length,$,L,F,_,j,X;if(B===0?$=L=0:B===1?($=0,L=R-N):($=B-2,L=x(v(c(I),0),R-N)),R+$-L>S)throw TypeError(w);for(F=h(C,L),_=0;_<L;_++)j=N+_,j in C&&p(F,_,C[j]);if(F.length=L,$<L){for(_=N;_<R-L;_++)j=_+L,X=_+$,j in C?C[X]=C[j]:delete C[X];for(_=R;_>R-L+$;_--)delete C[_-1]}else if($>L)for(_=R-L;_>N;_--)j=_+L-1,X=_+$-1,j in C?C[X]=C[j]:delete C[X];for(_=0;_<$;_++)C[_+N]=arguments[_+2];return C.length=R-L+$,F}})},a4d3:function(s,i,o){var a=o("23e7"),l=o("da84"),c=o("d066"),u=o("c430"),d=o("83ab"),h=o("4930"),p=o("fdbf"),g=o("d039"),m=o("5135"),b=o("e8b5"),y=o("861d"),v=o("825a"),x=o("7b0b"),S=o("fc6a"),w=o("c04e"),E=o("5c6c"),T=o("7c73"),I=o("df75"),C=o("241c"),R=o("057f"),N=o("7418"),B=o("06cf"),$=o("9bf2"),L=o("d1e7"),F=o("9112"),_=o("6eeb"),j=o("5692"),X=o("f772"),wt=o("d012"),qt=o("90e3"),$t=o("b622"),Pt=o("e538"),jt=o("746f"),me=o("d44e"),xe=o("69f3"),Ot=o("b727").forEach,z=X("hidden"),rt="Symbol",et="prototype",ht=$t("toPrimitive"),Zt=xe.set,fe=xe.getterFor(rt),O=Object[et],D=l.Symbol,U=c("JSON","stringify"),q=B.f,G=$.f,Q=R.f,ct=L.f,st=j("symbols"),it=j("op-symbols"),tt=j("string-to-symbol-registry"),Tt=j("symbol-to-string-registry"),lt=j("wks"),St=l.QObject,Nt=!St||!St[et]||!St[et].findChild,se=d&&g(function(){return T(G({},"a",{get:function(){return G(this,"a",{value:7}).a}})).a!=7})?function(Ht,kt,Ft){var ye=q(O,kt);ye&&delete O[kt],G(Ht,kt,Ft),ye&&Ht!==O&&G(O,kt,ye)}:G,Ce=function(Ht,kt){var Ft=st[Ht]=T(D[et]);return Zt(Ft,{type:rt,tag:Ht,description:kt}),d||(Ft.description=kt),Ft},H=p?function(Ht){return typeof Ht=="symbol"}:function(Ht){return Object(Ht)instanceof D},V=function(kt,Ft,ye){kt===O&&V(it,Ft,ye),v(kt);var Ae=w(Ft,!0);return v(ye),m(st,Ae)?(ye.enumerable?(m(kt,z)&&kt[z][Ae]&&(kt[z][Ae]=!1),ye=T(ye,{enumerable:E(0,!1)})):(m(kt,z)||G(kt,z,E(1,{})),kt[z][Ae]=!0),se(kt,Ae,ye)):G(kt,Ae,ye)},W=function(kt,Ft){v(kt);var ye=S(Ft),Ae=I(ye).concat(Wt(ye));return Ot(Ae,function(Gr){(!d||dt.call(ye,Gr))&&V(kt,Gr,ye[Gr])}),kt},J=function(kt,Ft){return Ft===void 0?T(kt):W(T(kt),Ft)},dt=function(kt){var Ft=w(kt,!0),ye=ct.call(this,Ft);return this===O&&m(st,Ft)&&!m(it,Ft)?!1:ye||!m(this,Ft)||!m(st,Ft)||m(this,z)&&this[z][Ft]?ye:!0},It=function(kt,Ft){var ye=S(kt),Ae=w(Ft,!0);if(!(ye===O&&m(st,Ae)&&!m(it,Ae))){var Gr=q(ye,Ae);return Gr&&m(st,Ae)&&!(m(ye,z)&&ye[z][Ae])&&(Gr.enumerable=!0),Gr}},Yt=function(kt){var Ft=Q(S(kt)),ye=[];return Ot(Ft,function(Ae){!m(st,Ae)&&!m(wt,Ae)&&ye.push(Ae)}),ye},Wt=function(kt){var Ft=kt===O,ye=Q(Ft?it:S(kt)),Ae=[];return Ot(ye,function(Gr){m(st,Gr)&&(!Ft||m(O,Gr))&&Ae.push(st[Gr])}),Ae};if(h||(D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor");var kt=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),Ft=qt(kt),ye=function(Ae){this===O&&ye.call(it,Ae),m(this,z)&&m(this[z],Ft)&&(this[z][Ft]=!1),se(this,Ft,E(1,Ae))};return d&&Nt&&se(O,Ft,{configurable:!0,set:ye}),Ce(Ft,kt)},_(D[et],"toString",function(){return fe(this).tag}),_(D,"withoutSetter",function(Ht){return Ce(qt(Ht),Ht)}),L.f=dt,$.f=V,B.f=It,C.f=R.f=Yt,N.f=Wt,Pt.f=function(Ht){return Ce($t(Ht),Ht)},d&&(G(D[et],"description",{configurable:!0,get:function(){return fe(this).description}}),u||_(O,"propertyIsEnumerable",dt,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:D}),Ot(I(lt),function(Ht){jt(Ht)}),a({target:rt,stat:!0,forced:!h},{for:function(Ht){var kt=String(Ht);if(m(tt,kt))return tt[kt];var Ft=D(kt);return tt[kt]=Ft,Tt[Ft]=kt,Ft},keyFor:function(kt){if(!H(kt))throw TypeError(kt+" is not a symbol");if(m(Tt,kt))return Tt[kt]},useSetter:function(){Nt=!0},useSimple:function(){Nt=!1}}),a({target:"Object",stat:!0,forced:!h,sham:!d},{create:J,defineProperty:V,defineProperties:W,getOwnPropertyDescriptor:It}),a({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:Yt,getOwnPropertySymbols:Wt}),a({target:"Object",stat:!0,forced:g(function(){N.f(1)})},{getOwnPropertySymbols:function(kt){return N.f(x(kt))}}),U){var Te=!h||g(function(){var Ht=D();return U([Ht])!="[null]"||U({a:Ht})!="{}"||U(Object(Ht))!="{}"});a({target:"JSON",stat:!0,forced:Te},{stringify:function(kt,Ft,ye){for(var Ae=[kt],Gr=1,zw;arguments.length>Gr;)Ae.push(arguments[Gr++]);if(zw=Ft,!(!y(Ft)&&kt===void 0||H(kt)))return b(Ft)||(Ft=function(b_,wy){if(typeof zw=="function"&&(wy=zw.call(this,b_,wy)),!H(wy))return wy}),Ae[1]=Ft,U.apply(null,Ae)}})}D[et][ht]||F(D[et],ht,D[et].valueOf),me(D,rt),wt[z]=!0},a630:function(s,i,o){var a=o("23e7"),l=o("4df4"),c=o("1c7e"),u=!c(function(d){Array.from(d)});a({target:"Array",stat:!0,forced:u},{from:l})},a640:function(s,i,o){var a=o("d039");s.exports=function(l,c){var u=[][l];return!!u&&a(function(){u.call(null,c||function(){throw 1},1)})}},a691:function(s,i){var o=Math.ceil,a=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(l>0?a:o)(l)}},ab13:function(s,i,o){var a=o("b622"),l=a("match");s.exports=function(c){var u=/./;try{"/./"[c](u)}catch{try{return u[l]=!1,"/./"[c](u)}catch{}}return!1}},ac1f:function(s,i,o){var a=o("23e7"),l=o("9263");a({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(s,i,o){var a=o("825a");s.exports=function(){var l=a(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},ae40:function(s,i,o){var a=o("83ab"),l=o("d039"),c=o("5135"),u=Object.defineProperty,d={},h=function(p){throw p};s.exports=function(p,g){if(c(d,p))return d[p];g||(g={});var m=[][p],b=c(g,"ACCESSORS")?g.ACCESSORS:!1,y=c(g,0)?g[0]:h,v=c(g,1)?g[1]:void 0;return d[p]=!!m&&!l(function(){if(b&&!a)return!0;var x={length:-1};b?u(x,1,{enumerable:!0,get:h}):x[1]=1,m.call(x,y,v)})}},ae93:function(s,i,o){var a=o("e163"),l=o("9112"),c=o("5135"),u=o("b622"),d=o("c430"),h=u("iterator"),p=!1,g=function(){return this},m,b,y;[].keys&&(y=[].keys(),"next"in y?(b=a(a(y)),b!==Object.prototype&&(m=b)):p=!0),m==null&&(m={}),!d&&!c(m,h)&&l(m,h,g),s.exports={IteratorPrototype:m,BUGGY_SAFARI_ITERATORS:p}},b041:function(s,i,o){var a=o("00ee"),l=o("f5df");s.exports=a?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(s,i,o){var a=o("83ab"),l=o("9bf2").f,c=Function.prototype,u=c.toString,d=/^\s*function ([^ (]*)/,h="name";a&&!(h in c)&&l(c,h,{configurable:!0,get:function(){try{return u.call(this).match(d)[1]}catch{return""}}})},b622:function(s,i,o){var a=o("da84"),l=o("5692"),c=o("5135"),u=o("90e3"),d=o("4930"),h=o("fdbf"),p=l("wks"),g=a.Symbol,m=h?g:g&&g.withoutSetter||u;s.exports=function(b){return c(p,b)||(d&&c(g,b)?p[b]=g[b]:p[b]=m("Symbol."+b)),p[b]}},b64b:function(s,i,o){var a=o("23e7"),l=o("7b0b"),c=o("df75"),u=o("d039"),d=u(function(){c(1)});a({target:"Object",stat:!0,forced:d},{keys:function(p){return c(l(p))}})},b727:function(s,i,o){var a=o("0366"),l=o("44ad"),c=o("7b0b"),u=o("50c4"),d=o("65f0"),h=[].push,p=function(g){var m=g==1,b=g==2,y=g==3,v=g==4,x=g==6,S=g==5||x;return function(w,E,T,I){for(var C=c(w),R=l(C),N=a(E,T,3),B=u(R.length),$=0,L=I||d,F=m?L(w,B):b?L(w,0):void 0,_,j;B>$;$++)if((S||$ in R)&&(_=R[$],j=N(_,$,C),g)){if(m)F[$]=j;else if(j)switch(g){case 3:return!0;case 5:return _;case 6:return $;case 2:h.call(F,_)}else if(v)return!1}return x?-1:y||v?v:F}};s.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6)}},c04e:function(s,i,o){var a=o("861d");s.exports=function(l,c){if(!a(l))return l;var u,d;if(c&&typeof(u=l.toString)=="function"&&!a(d=u.call(l))||typeof(u=l.valueOf)=="function"&&!a(d=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!a(d=u.call(l)))return d;throw TypeError("Can't convert object to primitive value")}},c430:function(s,i){s.exports=!1},c6b6:function(s,i){var o={}.toString;s.exports=function(a){return o.call(a).slice(8,-1)}},c6cd:function(s,i,o){var a=o("da84"),l=o("ce4e"),c="__core-js_shared__",u=a[c]||l(c,{});s.exports=u},c740:function(s,i,o){var a=o("23e7"),l=o("b727").findIndex,c=o("44d2"),u=o("ae40"),d="findIndex",h=!0,p=u(d);d in[]&&Array(1)[d](function(){h=!1}),a({target:"Array",proto:!0,forced:h||!p},{findIndex:function(m){return l(this,m,arguments.length>1?arguments[1]:void 0)}}),c(d)},c8ba:function(s,i){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch{typeof window=="object"&&(o=window)}s.exports=o},c975:function(s,i,o){var a=o("23e7"),l=o("4d64").indexOf,c=o("a640"),u=o("ae40"),d=[].indexOf,h=!!d&&1/[1].indexOf(1,-0)<0,p=c("indexOf"),g=u("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:h||!p||!g},{indexOf:function(b){return h?d.apply(this,arguments)||0:l(this,b,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,i,o){var a=o("5135"),l=o("fc6a"),c=o("4d64").indexOf,u=o("d012");s.exports=function(d,h){var p=l(d),g=0,m=[],b;for(b in p)!a(u,b)&&a(p,b)&&m.push(b);for(;h.length>g;)a(p,b=h[g++])&&(~c(m,b)||m.push(b));return m}},caad:function(s,i,o){var a=o("23e7"),l=o("4d64").includes,c=o("44d2"),u=o("ae40"),d=u("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!d},{includes:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,i,o){var a=o("da84"),l=o("861d"),c=a.document,u=l(c)&&l(c.createElement);s.exports=function(d){return u?c.createElement(d):{}}},ce4e:function(s,i,o){var a=o("da84"),l=o("9112");s.exports=function(c,u){try{l(a,c,u)}catch{a[c]=u}return u}},d012:function(s,i){s.exports={}},d039:function(s,i){s.exports=function(o){try{return!!o()}catch{return!0}}},d066:function(s,i,o){var a=o("428f"),l=o("da84"),c=function(u){return typeof u=="function"?u:void 0};s.exports=function(u,d){return arguments.length<2?c(a[u])||c(l[u]):a[u]&&a[u][d]||l[u]&&l[u][d]}},d1e7:function(s,i,o){var a={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!a.call({1:2},1);i.f=c?function(d){var h=l(this,d);return!!h&&h.enumerable}:a},d28b:function(s,i,o){var a=o("746f");a("iterator")},d2bb:function(s,i,o){var a=o("825a"),l=o("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},d;try{d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,d.call(u,[]),c=u instanceof Array}catch{}return function(p,g){return a(p),l(g),c?d.call(p,g):p.__proto__=g,p}}():void 0)},d3b7:function(s,i,o){var a=o("00ee"),l=o("6eeb"),c=o("b041");a||l(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,i,o){var a=o("9bf2").f,l=o("5135"),c=o("b622"),u=c("toStringTag");s.exports=function(d,h,p){d&&!l(d=p?d:d.prototype,u)&&a(d,u,{configurable:!0,value:h})}},d58f:function(s,i,o){var a=o("1c0b"),l=o("7b0b"),c=o("44ad"),u=o("50c4"),d=function(h){return function(p,g,m,b){a(g);var y=l(p),v=c(y),x=u(y.length),S=h?x-1:0,w=h?-1:1;if(m<2)for(;;){if(S in v){b=v[S],S+=w;break}if(S+=w,h?S<0:x<=S)throw TypeError("Reduce of empty array with no initial value")}for(;h?S>=0:x>S;S+=w)S in v&&(b=g(b,v[S],S,y));return b}};s.exports={left:d(!1),right:d(!0)}},d784:function(s,i,o){o("ac1f");var a=o("6eeb"),l=o("d039"),c=o("b622"),u=o("9263"),d=o("9112"),h=c("species"),p=!l(function(){var v=/./;return v.exec=function(){var x=[];return x.groups={a:"7"},x},"".replace(v,"$<a>")!=="7"}),g=function(){return"a".replace(/./,"$0")==="$0"}(),m=c("replace"),b=function(){return/./[m]?/./[m]("a","$0")==="":!1}(),y=!l(function(){var v=/(?:)/,x=v.exec;v.exec=function(){return x.apply(this,arguments)};var S="ab".split(v);return S.length!==2||S[0]!=="a"||S[1]!=="b"});s.exports=function(v,x,S,w){var E=c(v),T=!l(function(){var $={};return $[E]=function(){return 7},""[v]($)!=7}),I=T&&!l(function(){var $=!1,L=/a/;return v==="split"&&(L={},L.constructor={},L.constructor[h]=function(){return L},L.flags="",L[E]=/./[E]),L.exec=function(){return $=!0,null},L[E](""),!$});if(!T||!I||v==="replace"&&!(p&&g&&!b)||v==="split"&&!y){var C=/./[E],R=S(E,""[v],function($,L,F,_,j){return L.exec===u?T&&!j?{done:!0,value:C.call(L,F,_)}:{done:!0,value:$.call(F,L,_)}:{done:!1}},{REPLACE_KEEPS_$0:g,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:b}),N=R[0],B=R[1];a(String.prototype,v,N),a(RegExp.prototype,E,x==2?function($,L){return B.call($,this,L)}:function($){return B.call($,this)})}w&&d(RegExp.prototype[E],"sham",!0)}},d81d:function(s,i,o){var a=o("23e7"),l=o("b727").map,c=o("1dde"),u=o("ae40"),d=c("map"),h=u("map");a({target:"Array",proto:!0,forced:!d||!h},{map:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,i,o){(function(a){var l=function(c){return c&&c.Math==Math&&c};s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof a=="object"&&a)||Function("return this")()}).call(this,o("c8ba"))},dbb4:function(s,i,o){var a=o("23e7"),l=o("83ab"),c=o("56ef"),u=o("fc6a"),d=o("06cf"),h=o("8418");a({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(g){for(var m=u(g),b=d.f,y=c(m),v={},x=0,S,w;y.length>x;)w=b(m,S=y[x++]),w!==void 0&&h(v,S,w);return v}})},dbf1:function(s,i,o){(function(a){o.d(i,"a",function(){return c});function l(){return typeof window<"u"?window.console:a.console}var c=l()}).call(this,o("c8ba"))},ddb0:function(s,i,o){var a=o("da84"),l=o("fdbc"),c=o("e260"),u=o("9112"),d=o("b622"),h=d("iterator"),p=d("toStringTag"),g=c.values;for(var m in l){var b=a[m],y=b&&b.prototype;if(y){if(y[h]!==g)try{u(y,h,g)}catch{y[h]=g}if(y[p]||u(y,p,m),l[m]){for(var v in c)if(y[v]!==c[v])try{u(y,v,c[v])}catch{y[v]=c[v]}}}}},df75:function(s,i,o){var a=o("ca84"),l=o("7839");s.exports=Object.keys||function(u){return a(u,l)}},e01a:function(s,i,o){var a=o("23e7"),l=o("83ab"),c=o("da84"),u=o("5135"),d=o("861d"),h=o("9bf2").f,p=o("e893"),g=c.Symbol;if(l&&typeof g=="function"&&(!("description"in g.prototype)||g().description!==void 0)){var m={},b=function(){var E=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),T=this instanceof b?new g(E):E===void 0?g():g(E);return E===""&&(m[T]=!0),T};p(b,g);var y=b.prototype=g.prototype;y.constructor=b;var v=y.toString,x=String(g("test"))=="Symbol(test)",S=/^Symbol\((.*)\)[^)]+$/;h(y,"description",{configurable:!0,get:function(){var E=d(this)?this.valueOf():this,T=v.call(E);if(u(m,E))return"";var I=x?T.slice(7,-1):T.replace(S,"$1");return I===""?void 0:I}}),a({global:!0,forced:!0},{Symbol:b})}},e163:function(s,i,o){var a=o("5135"),l=o("7b0b"),c=o("f772"),u=o("e177"),d=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(p){return p=l(p),a(p,d)?p[d]:typeof p.constructor=="function"&&p instanceof p.constructor?p.constructor.prototype:p instanceof Object?h:null}},e177:function(s,i,o){var a=o("d039");s.exports=!a(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(s,i,o){var a=o("fc6a"),l=o("44d2"),c=o("3f8c"),u=o("69f3"),d=o("7dd0"),h="Array Iterator",p=u.set,g=u.getterFor(h);s.exports=d(Array,"Array",function(m,b){p(this,{type:h,target:a(m),index:0,kind:b})},function(){var m=g(this),b=m.target,y=m.kind,v=m.index++;return!b||v>=b.length?(m.target=void 0,{value:void 0,done:!0}):y=="keys"?{value:v,done:!1}:y=="values"?{value:b[v],done:!1}:{value:[v,b[v]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},e439:function(s,i,o){var a=o("23e7"),l=o("d039"),c=o("fc6a"),u=o("06cf").f,d=o("83ab"),h=l(function(){u(1)}),p=!d||h;a({target:"Object",stat:!0,forced:p,sham:!d},{getOwnPropertyDescriptor:function(m,b){return u(c(m),b)}})},e538:function(s,i,o){var a=o("b622");i.f=a},e893:function(s,i,o){var a=o("5135"),l=o("56ef"),c=o("06cf"),u=o("9bf2");s.exports=function(d,h){for(var p=l(h),g=u.f,m=c.f,b=0;b<p.length;b++){var y=p[b];a(d,y)||g(d,y,m(h,y))}}},e8b5:function(s,i,o){var a=o("c6b6");s.exports=Array.isArray||function(c){return a(c)=="Array"}},e95a:function(s,i,o){var a=o("b622"),l=o("3f8c"),c=a("iterator"),u=Array.prototype;s.exports=function(d){return d!==void 0&&(l.Array===d||u[c]===d)}},f5df:function(s,i,o){var a=o("00ee"),l=o("c6b6"),c=o("b622"),u=c("toStringTag"),d=l(function(){return arguments}())=="Arguments",h=function(p,g){try{return p[g]}catch{}};s.exports=a?l:function(p){var g,m,b;return p===void 0?"Undefined":p===null?"Null":typeof(m=h(g=Object(p),u))=="string"?m:d?l(g):(b=l(g))=="Object"&&typeof g.callee=="function"?"Arguments":b}},f772:function(s,i,o){var a=o("5692"),l=o("90e3"),c=a("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},fb15:function(s,i,o){if(o.r(i),typeof window<"u"){var a=window.document.currentScript;{var l=o("8875");a=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var c=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(o.p=c[1])}o("99af"),o("4de4"),o("4160"),o("c975"),o("d81d"),o("a434"),o("159b"),o("a4d3"),o("e439"),o("dbb4"),o("b64b");function u(H,V,W){return V in H?Object.defineProperty(H,V,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[V]=W,H}function d(H,V){var W=Object.keys(H);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(H);V&&(J=J.filter(function(dt){return Object.getOwnPropertyDescriptor(H,dt).enumerable})),W.push.apply(W,J)}return W}function h(H){for(var V=1;V<arguments.length;V++){var W=arguments[V]!=null?arguments[V]:{};V%2?d(Object(W),!0).forEach(function(J){u(H,J,W[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(W)):d(Object(W)).forEach(function(J){Object.defineProperty(H,J,Object.getOwnPropertyDescriptor(W,J))})}return H}function p(H){if(Array.isArray(H))return H}o("e01a"),o("d28b"),o("e260"),o("d3b7"),o("3ca3"),o("ddb0");function g(H,V){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(H)))){var W=[],J=!0,dt=!1,It=void 0;try{for(var Yt=H[Symbol.iterator](),Wt;!(J=(Wt=Yt.next()).done)&&(W.push(Wt.value),!(V&&W.length===V));J=!0);}catch(Te){dt=!0,It=Te}finally{try{!J&&Yt.return!=null&&Yt.return()}finally{if(dt)throw It}}return W}}o("a630"),o("fb6a"),o("b0c0"),o("25f0");function m(H,V){(V==null||V>H.length)&&(V=H.length);for(var W=0,J=new Array(V);W<V;W++)J[W]=H[W];return J}function b(H,V){if(H){if(typeof H=="string")return m(H,V);var W=Object.prototype.toString.call(H).slice(8,-1);if(W==="Object"&&H.constructor&&(W=H.constructor.name),W==="Map"||W==="Set")return Array.from(H);if(W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W))return m(H,V)}}function y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v(H,V){return p(H)||g(H,V)||b(H,V)||y()}function x(H){if(Array.isArray(H))return m(H)}function S(H){if(typeof Symbol<"u"&&Symbol.iterator in Object(H))return Array.from(H)}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(H){return x(H)||S(H)||b(H)||w()}var T=o("a352"),I=o.n(T);function C(H){H.parentElement!==null&&H.parentElement.removeChild(H)}function R(H,V,W){var J=W===0?H.children[0]:H.children[W-1].nextSibling;H.insertBefore(V,J)}var N=o("dbf1");o("13d5"),o("4fad"),o("ac1f"),o("5319");function B(H){var V=Object.create(null);return function(J){var dt=V[J];return dt||(V[J]=H(J))}}var $=/-(\w)/g,L=B(function(H){return H.replace($,function(V,W){return W.toUpperCase()})});o("5db7"),o("73d9");var F=["Start","Add","Remove","Update","End"],_=["Choose","Unchoose","Sort","Filter","Clone"],j=["Move"],X=[j,F,_].flatMap(function(H){return H}).map(function(H){return"on".concat(H)}),wt={manage:j,manageAndEmit:F,emit:_};function qt(H){return X.indexOf(H)!==-1}o("caad"),o("2ca0");var $t=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Pt(H){return $t.includes(H)}function jt(H){return["transition-group","TransitionGroup"].includes(H)}function me(H){return["id","class","role","style"].includes(H)||H.startsWith("data-")||H.startsWith("aria-")||H.startsWith("on")}function xe(H){return H.reduce(function(V,W){var J=v(W,2),dt=J[0],It=J[1];return V[dt]=It,V},{})}function Ot(H){var V=H.$attrs,W=H.componentData,J=W===void 0?{}:W,dt=xe(Object.entries(V).filter(function(It){var Yt=v(It,2),Wt=Yt[0];return Yt[1],me(Wt)}));return h(h({},dt),J)}function z(H){var V=H.$attrs,W=H.callBackBuilder,J=xe(rt(V));Object.entries(W).forEach(function(It){var Yt=v(It,2),Wt=Yt[0],Te=Yt[1];wt[Wt].forEach(function(Ht){J["on".concat(Ht)]=Te(Ht)})});var dt="[data-draggable]".concat(J.draggable||"");return h(h({},J),{},{draggable:dt})}function rt(H){return Object.entries(H).filter(function(V){var W=v(V,2),J=W[0];return W[1],!me(J)}).map(function(V){var W=v(V,2),J=W[0],dt=W[1];return[L(J),dt]}).filter(function(V){var W=v(V,2),J=W[0];return W[1],!qt(J)})}o("c740");function et(H,V){if(!(H instanceof V))throw new TypeError("Cannot call a class as a function")}function ht(H,V){for(var W=0;W<V.length;W++){var J=V[W];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(H,J.key,J)}}function Zt(H,V,W){return V&&ht(H.prototype,V),H}var fe=function(V){var W=V.el;return W},O=function(V,W){return V.__draggable_context=W},D=function(V){return V.__draggable_context},U=function(){function H(V){var W=V.nodes,J=W.header,dt=W.default,It=W.footer,Yt=V.root,Wt=V.realList;et(this,H),this.defaultNodes=dt,this.children=[].concat(E(J),E(dt),E(It)),this.externalComponent=Yt.externalComponent,this.rootTransition=Yt.transition,this.tag=Yt.tag,this.realList=Wt}return Zt(H,[{key:"render",value:function(W,J){var dt=this.tag,It=this.children,Yt=this._isRootComponent,Wt=Yt?{default:function(){return It}}:It;return W(dt,J,Wt)}},{key:"updated",value:function(){var W=this.defaultNodes,J=this.realList;W.forEach(function(dt,It){O(fe(dt),{element:J[It],index:It})})}},{key:"getUnderlyingVm",value:function(W){return D(W)}},{key:"getVmIndexFromDomIndex",value:function(W,J){var dt=this.defaultNodes,It=dt.length,Yt=J.children,Wt=Yt.item(W);if(Wt===null)return It;var Te=D(Wt);if(Te)return Te.index;if(It===0)return 0;var Ht=fe(dt[0]),kt=E(Yt).findIndex(function(Ft){return Ft===Ht});return W<kt?0:It}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),H}(),q=o("8bbf");function G(H,V){var W=H[V];return W?W():[]}function Q(H){var V=H.$slots,W=H.realList,J=H.getKey,dt=W||[],It=["header","footer"].map(function(Ft){return G(V,Ft)}),Yt=v(It,2),Wt=Yt[0],Te=Yt[1],Ht=V.item;if(!Ht)throw new Error("draggable element must have an item slot");var kt=dt.flatMap(function(Ft,ye){return Ht({element:Ft,index:ye}).map(function(Ae){return Ae.key=J(Ft),Ae.props=h(h({},Ae.props||{}),{},{"data-draggable":!0}),Ae})});if(kt.length!==dt.length)throw new Error("Item slot must have only one child");return{header:Wt,footer:Te,default:kt}}function ct(H){var V=jt(H),W=!Pt(H)&&!V;return{transition:V,externalComponent:W,tag:W?Object(q.resolveComponent)(H):V?q.TransitionGroup:H}}function st(H){var V=H.$slots,W=H.tag,J=H.realList,dt=H.getKey,It=Q({$slots:V,realList:J,getKey:dt}),Yt=ct(W);return new U({nodes:It,root:Yt,realList:J})}function it(H,V){var W=this;Object(q.nextTick)(function(){return W.$emit(H.toLowerCase(),V)})}function tt(H){var V=this;return function(W,J){if(V.realList!==null)return V["onDrag".concat(H)](W,J)}}function Tt(H){var V=this,W=tt.call(this,H);return function(J,dt){W.call(V,J,dt),it.call(V,H,J)}}var lt=null,St={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(V){return V}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Nt=["update:modelValue","change"].concat(E([].concat(E(wt.manageAndEmit),E(wt.emit)).map(function(H){return H.toLowerCase()}))),se=Object(q.defineComponent)({name:"draggable",inheritAttrs:!1,props:St,emits:Nt,data:function(){return{error:!1}},render:function(){try{this.error=!1;var V=this.$slots,W=this.$attrs,J=this.tag,dt=this.componentData,It=this.realList,Yt=this.getKey,Wt=st({$slots:V,tag:J,realList:It,getKey:Yt});this.componentStructure=Wt;var Te=Ot({$attrs:W,componentData:dt});return Wt.render(q.h,Te)}catch(Ht){return this.error=!0,Object(q.h)("pre",{style:{color:"red"}},Ht.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&N.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var V=this;if(!this.error){var W=this.$attrs,J=this.$el,dt=this.componentStructure;dt.updated();var It=z({$attrs:W,callBackBuilder:{manageAndEmit:function(Te){return Tt.call(V,Te)},emit:function(Te){return it.bind(V,Te)},manage:function(Te){return tt.call(V,Te)}}}),Yt=J.nodeType===1?J:J.parentElement;this._sortable=new I.a(Yt,It),this.targetDomElement=Yt,Yt.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var V=this.list;return V||this.modelValue},getKey:function(){var V=this.itemKey;return typeof V=="function"?V:function(W){return W[V]}}},watch:{$attrs:{handler:function(V){var W=this._sortable;W&&rt(V).forEach(function(J){var dt=v(J,2),It=dt[0],Yt=dt[1];W.option(It,Yt)})},deep:!0}},methods:{getUnderlyingVm:function(V){return this.componentStructure.getUnderlyingVm(V)||null},getUnderlyingPotencialDraggableComponent:function(V){return V.__draggable_component__},emitChanges:function(V){var W=this;Object(q.nextTick)(function(){return W.$emit("change",V)})},alterList:function(V){if(this.list){V(this.list);return}var W=E(this.modelValue);V(W),this.$emit("update:modelValue",W)},spliceList:function(){var V=arguments,W=function(dt){return dt.splice.apply(dt,E(V))};this.alterList(W)},updatePosition:function(V,W){var J=function(It){return It.splice(W,0,It.splice(V,1)[0])};this.alterList(J)},getRelatedContextFromMoveEvent:function(V){var W=V.to,J=V.related,dt=this.getUnderlyingPotencialDraggableComponent(W);if(!dt)return{component:dt};var It=dt.realList,Yt={list:It,component:dt};if(W!==J&&It){var Wt=dt.getUnderlyingVm(J)||{};return h(h({},Wt),Yt)}return Yt},getVmIndexFromDomIndex:function(V){return this.componentStructure.getVmIndexFromDomIndex(V,this.targetDomElement)},onDragStart:function(V){this.context=this.getUnderlyingVm(V.item),V.item._underlying_vm_=this.clone(this.context.element),lt=V.item},onDragAdd:function(V){var W=V.item._underlying_vm_;if(W!==void 0){C(V.item);var J=this.getVmIndexFromDomIndex(V.newIndex);this.spliceList(J,0,W);var dt={element:W,newIndex:J};this.emitChanges({added:dt})}},onDragRemove:function(V){if(R(this.$el,V.item,V.oldIndex),V.pullMode==="clone"){C(V.clone);return}var W=this.context,J=W.index,dt=W.element;this.spliceList(J,1);var It={element:dt,oldIndex:J};this.emitChanges({removed:It})},onDragUpdate:function(V){C(V.item),R(V.from,V.item,V.oldIndex);var W=this.context.index,J=this.getVmIndexFromDomIndex(V.newIndex);this.updatePosition(W,J);var dt={element:this.context.element,oldIndex:W,newIndex:J};this.emitChanges({moved:dt})},computeFutureIndex:function(V,W){if(!V.element)return 0;var J=E(W.to.children).filter(function(Wt){return Wt.style.display!=="none"}),dt=J.indexOf(W.related),It=V.component.getVmIndexFromDomIndex(dt),Yt=J.indexOf(lt)!==-1;return Yt||!W.willInsertAfter?It:It+1},onDragMove:function(V,W){var J=this.move,dt=this.realList;if(!J||!dt)return!0;var It=this.getRelatedContextFromMoveEvent(V),Yt=this.computeFutureIndex(It,V),Wt=h(h({},this.context),{},{futureIndex:Yt}),Te=h(h({},V),{},{relatedContext:It,draggedContext:Wt});return J(Te,W)},onDragEnd:function(){lt=null}}}),Ce=se;i.default=Ce},fb6a:function(s,i,o){var a=o("23e7"),l=o("861d"),c=o("e8b5"),u=o("23cb"),d=o("50c4"),h=o("fc6a"),p=o("8418"),g=o("b622"),m=o("1dde"),b=o("ae40"),y=m("slice"),v=b("slice",{ACCESSORS:!0,0:0,1:2}),x=g("species"),S=[].slice,w=Math.max;a({target:"Array",proto:!0,forced:!y||!v},{slice:function(T,I){var C=h(this),R=d(C.length),N=u(T,R),B=u(I===void 0?R:I,R),$,L,F;if(c(C)&&($=C.constructor,typeof $=="function"&&($===Array||c($.prototype))?$=void 0:l($)&&($=$[x],$===null&&($=void 0)),$===Array||$===void 0))return S.call(C,N,B);for(L=new($===void 0?Array:$)(w(B-N,0)),F=0;N<B;N++,F++)N in C&&p(L,F,C[N]);return L.length=F,L}})},fc6a:function(s,i,o){var a=o("44ad"),l=o("1d80");s.exports=function(c){return a(l(c))}},fdbc:function(s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,i,o){var a=o("4930");s.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(I7);const mK={class:"mb-6 flex overflow-x-auto pb-2"},yK=["onClick"],bK={key:0,class:"text-center py-8"},vK={key:1,class:"card relative overflow-hidden"},wK={class:"relative min-h-[900px]"},xK={class:"absolute top-0 left-0 w-20 h-full border-r border-gray-200 dark:border-gray-700"},SK={class:"ml-20 relative"},AK={class:"absolute top-0 left-0 w-full h-full p-2"},EK=["onClick"],kK={class:"flex justify-between items-start h-full"},CK={class:"font-medium text-gray-900 dark:text-white text-sm"},TK={class:"text-xs text-gray-600 dark:text-gray-300 mt-1"},MK={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},PK=["onClick"],OK={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},IK={class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},RK={class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},DK={class:"space-y-4"},NK={class:"grid grid-cols-2 gap-4"},_K={class:"grid grid-cols-2 gap-4"},LK=["value"],FK={key:0,value:null,disabled:""},BK=["value"],$K={__name:"PlannerPage",setup(n){const t=LE(),e=Ra(),r=[{name:"Lunes",value:"lunes"},{name:"Martes",value:"martes"},{name:"Miércoles",value:"miércoles"},{name:"Jueves",value:"jueves"},{name:"Viernes",value:"viernes"},{name:"Sábado",value:"sábado"},{name:"Domingo",value:"domingo"}],s=ot(u()),i=c(),o=ot(!1),a=ot(null),l=ot({title:"",description:"",startTime:"08:00",endTime:"09:00",day:u(),subjectId:null});function c(){const w=[];for(let E=7;E<=22;E++){const T=E.toString().padStart(2,"0")+":00";w.push(T)}return w}function u(){const w=new Date().getDay();return r[[6,0,1,2,3,4,5][w]].value}qn(async()=>{await e.fetchSubjects(),await t.fetchEvents()});const d=Ee(()=>t.events.filter(E=>E.day===s.value).sort((E,T)=>E.startTime.localeCompare(T.startTime)));Ee(()=>{const w={};return i.forEach(E=>{w[E]=[]}),d.value.forEach(E=>{const T=E.startTime.substring(0,5),I=i.find(C=>C<=T)||i[0];w[I]&&w[I].push(E)}),w});const h=w=>e.subjects.find(E=>E.id===w)||{name:"Sin materia",color:"#94a3b8"},p=()=>{l.value={title:"",description:"",startTime:"08:00",endTime:"09:00",day:s.value,subjectId:null},o.value=!0,a.value=null},g=w=>{l.value={...w},o.value=!0,a.value=w.id},m=()=>{o.value=!1,a.value=null},b=async()=>{try{if(!l.value.title.trim()){alert("Por favor ingresa un título para el evento");return}if(!l.value.subjectId){alert("Por favor selecciona una materia");return}if(l.value.startTime>=l.value.endTime){alert("La hora de inicio debe ser anterior a la hora de fin");return}const w={...l.value,title:l.value.title.trim(),description:l.value.description.trim()};a.value?await t.updateEvent(a.value,w):await t.addEvent(w),m()}catch(w){console.error("Error saving event:",w),alert("Error al guardar el evento")}},y=async w=>{if(confirm("¿Estás seguro de que deseas eliminar este evento?"))try{await t.deleteEvent(w)}catch(E){console.error("Error deleting event:",E),alert("Error al eliminar el evento")}},v=w=>{const E=S(w.startTime);return`${S(w.endTime)-E}px`},x=w=>{const E=S("07:00");return`${S(w.startTime)-E}px`},S=w=>{const[E,T]=w.split(":").map(Number);return E*60+T};return(w,E)=>(K(),Y("div",null,[A("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},[E[7]||(E[7]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Planificador de Estudio",-1)),A("button",{onClick:p,class:"btn btn-primary flex items-center justify-center"},E[6]||(E[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ge(" Nuevo Evento ")]))]),A("div",mK,[(K(),Y(ae,null,ln(r,T=>A("button",{key:T.value,onClick:I=>s.value=T.value,class:Kt(["px-4 py-2 mx-1 rounded-lg text-center min-w-[100px] whitespace-nowrap transition-colors",s.value===T.value?"bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 font-medium":"bg-white dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},pt(T.name),11,yK)),64))]),ee(t).loading?(K(),Y("div",bK,E[8]||(E[8]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando horario...",-1)]))):(K(),Y("div",vK,[A("div",wK,[A("div",xK,[(K(!0),Y(ae,null,ln(ee(i),T=>(K(),Y("div",{key:T,class:"h-[60px] flex items-start px-2 pt-2 text-sm text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700"},pt(T),1))),128))]),A("div",SK,[(K(!0),Y(ae,null,ln(ee(i),T=>(K(),Y("div",{key:T,class:"h-[60px] border-t border-gray-200 dark:border-gray-700"}))),128)),A("div",AK,[(K(!0),Y(ae,null,ln(d.value,T=>(K(),Y("div",{key:T.id,class:"absolute p-2 rounded-lg w-[calc(100%-16px)] cursor-pointer transition-all hover:shadow-md",style:Wn({top:x(T),height:v(T),backgroundColor:h(T.subjectId).color+"20",borderLeft:`4px solid ${h(T.subjectId).color}`}),onClick:I=>g(T)},[A("div",kK,[A("div",null,[A("h3",CK,pt(T.title),1),A("p",TK,pt(T.startTime.substring(0,5))+" - "+pt(T.endTime.substring(0,5)),1),T.description?(K(),Y("p",MK,pt(T.description),1)):Re("",!0)]),A("button",{onClick:uw(I=>y(T.id),["stop"]),class:"p-1 text-gray-500 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"},E[9]||(E[9]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,PK)])],12,EK))),128))])])])])),o.value?(K(),Y("div",OK,[A("div",IK,[A("h3",RK,pt(a.value?"Editar Evento":"Nuevo Evento"),1),A("div",DK,[A("div",null,[E[10]||(E[10]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Título "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"text","onUpdate:modelValue":E[0]||(E[0]=T=>l.value.title=T),placeholder:"Ej: Clase de Matemáticas",class:"input"},null,512),[[cn,l.value.title]])]),A("div",null,[E[11]||(E[11]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Descripción ",-1)),Le(A("textarea",{"onUpdate:modelValue":E[1]||(E[1]=T=>l.value.description=T),placeholder:"Descripción o notas adicionales",rows:"2",class:"input"},null,512),[[cn,l.value.description]])]),A("div",NK,[A("div",null,[E[12]||(E[12]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Hora de inicio "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"time","onUpdate:modelValue":E[2]||(E[2]=T=>l.value.startTime=T),class:"input"},null,512),[[cn,l.value.startTime]])]),A("div",null,[E[13]||(E[13]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Hora de fin "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"time","onUpdate:modelValue":E[3]||(E[3]=T=>l.value.endTime=T),class:"input"},null,512),[[cn,l.value.endTime]])])]),A("div",_K,[A("div",null,[E[14]||(E[14]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Día "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("select",{"onUpdate:modelValue":E[4]||(E[4]=T=>l.value.day=T),class:"input"},[(K(),Y(ae,null,ln(r,T=>A("option",{key:T.value,value:T.value},pt(T.name),9,LK)),64))],512),[[mo,l.value.day]])]),A("div",null,[E[15]||(E[15]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Materia "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("select",{"onUpdate:modelValue":E[5]||(E[5]=T=>l.value.subjectId=T),class:"input",required:!0},[l.value.subjectId?Re("",!0):(K(),Y("option",FK,"Selecciona una materia")),(K(!0),Y(ae,null,ln(ee(e).subjects,T=>(K(),Y("option",{key:T.id,value:T.id},pt(T.name),9,BK))),128))],512),[[mo,l.value.subjectId]])])])]),A("div",{class:"flex justify-end space-x-3 mt-6"},[A("button",{onClick:m,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:b,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"}," Guardar ")])])])):Re("",!0)]))}},vD=ld("grades",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.grades.toArray(),e.value=null}catch(c){console.error("Error fetching grades:",c),e.value="Error al cargar las calificaciones"}finally{t.value=!1}}async function s(c){t.value=!0;try{n.value=await ce.grades.where("subjectId").equals(c).toArray(),e.value=null}catch(u){console.error("Error fetching grades by subject:",u),e.value="Error al cargar las calificaciones de la materia"}finally{t.value=!1}}async function i(c){try{const u=new Date().toISOString(),d={...c,createdAt:u},h=await ce.grades.add(d);return await r(),h}catch(u){throw console.error("Error adding grade:",u),e.value="Error al añadir la calificación",u}}async function o(c,u){try{await ce.grades.update(c,u),await r()}catch(d){throw console.error("Error updating grade:",d),e.value="Error al actualizar la calificación",d}}async function a(c){try{await ce.grades.delete(c),await r()}catch(u){throw console.error("Error deleting grade:",u),e.value="Error al eliminar la calificación",u}}const l=Ee(()=>c=>{const u=n.value.filter(h=>h.subjectId===c);if(u.length===0)return 0;if(u.every(h=>h.weight!==void 0&&h.weight!==null)){const h=u.reduce((g,m)=>g+(m.weight||0),0),p=u.reduce((g,m)=>{const b=m.score/m.maxScore;return g+b*(m.weight||0)},0);return h>0?p/h*100:0}else return u.reduce((p,g)=>p+g.score/g.maxScore,0)/u.length*100});return{grades:n,loading:t,error:e,fetchGrades:r,fetchGradesBySubject:s,addGrade:i,updateGrade:o,deleteGrade:a,calculateSubjectAverage:l}}),jK={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},HK={class:"flex items-center gap-2"},VK=["value"],zK={key:0,class:"text-center py-8"},UK={key:1,class:"text-center py-8"},WK={key:2,class:"space-y-6"},KK={class:"flex flex-col md:flex-row md:items-center justify-between mb-4"},GK={class:"flex items-center"},YK={class:"text-xl font-semibold text-gray-900 dark:text-white"},XK={class:"mt-2 md:mt-0 flex items-center"},qK={class:"text-lg font-semibold mr-3"},JK=["onClick"],QK={class:"overflow-x-auto"},ZK={class:"w-full"},tG={class:"py-3 px-4 text-gray-900 dark:text-white"},eG={class:"py-3 px-4 text-gray-900 dark:text-white"},nG={class:"py-3 px-4"},rG={class:"py-3 px-4 text-gray-900 dark:text-white"},sG={class:"py-3 px-4 text-gray-600 dark:text-gray-400"},iG={class:"py-3 px-4"},oG={class:"flex items-center space-x-2"},aG=["onClick"],lG=["onClick"],cG={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},uG={class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},dG={class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},hG={class:"space-y-4"},fG={class:"grid grid-cols-2 gap-4"},pG=["max"],gG={class:"grid grid-cols-2 gap-4"},mG={key:0},yG={key:0,value:null,disabled:""},bG=["value"],vG={__name:"GradesPage",setup(n){const t=vD(),e=Ra(),r=ot(null),s=ot({title:"",score:null,maxScore:100,weight:1,date:Zs(new Date,"yyyy-MM-dd"),subjectId:null}),i=ot(!1),o=ot(null);qn(async()=>{await e.fetchSubjects(),await t.fetchGrades()});const a=Ee(()=>{const b={};if(e.subjects.forEach(y=>{const v=t.grades.filter(x=>x.subjectId===y.id);(v.length>0||!r.value||r.value===y.id)&&(b[y.id]={subject:y,grades:v.sort((x,S)=>new Date(S.date)-new Date(x.date)),average:t.calculateSubjectAverage(y.id)})}),r.value){const y={};return b[r.value]&&(y[r.value]=b[r.value]),y}return b}),l=b=>Zs(new Date(b),"d MMM, yyyy",{locale:Nl}),c=b=>b.toFixed(1)+"%",u=b=>b>=90?"A":b>=80?"B":b>=70?"C":b>=60?"D":"F",d=b=>{s.value={title:"",score:null,maxScore:100,weight:1,date:Zs(new Date,"yyyy-MM-dd"),subjectId:b},i.value=!0,o.value=null},h=()=>{i.value=!1,o.value=null},p=async b=>{const y=t.grades.find(v=>v.id===b);y&&(s.value={...y,date:Zs(new Date(y.date),"yyyy-MM-dd")},i.value=!0,o.value=b)},g=async()=>{try{if(!s.value.title.trim()){alert("Por favor ingresa un título para la calificación");return}if(s.value.score===null||isNaN(s.value.score)){alert("Por favor ingresa una calificación válida");return}if(s.value.maxScore<=0){alert("La calificación máxima debe ser mayor a 0");return}const b={...s.value,score:Number(s.value.score),maxScore:Number(s.value.maxScore),weight:Number(s.value.weight),date:new Date(s.value.date).toISOString()};o.value?await t.updateGrade(o.value,b):await t.addGrade(b),h()}catch(b){console.error("Error saving grade:",b),alert("Error al guardar la calificación")}},m=async b=>{if(confirm("¿Estás seguro de que deseas eliminar esta calificación?"))try{await t.deleteGrade(b)}catch(y){console.error("Error deleting grade:",y),alert("Error al eliminar la calificación")}};return(b,y)=>(K(),Y("div",null,[A("div",jK,[y[11]||(y[11]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Calificaciones",-1)),A("div",HK,[Le(A("select",{"onUpdate:modelValue":y[0]||(y[0]=v=>r.value=v),class:"px-3 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-700 dark:text-gray-300"},[y[9]||(y[9]=A("option",{value:null},"Todas las materias",-1)),(K(!0),Y(ae,null,ln(ee(e).subjects,v=>(K(),Y("option",{key:v.id,value:v.id},pt(v.name),9,VK))),128))],512),[[mo,r.value]]),A("button",{onClick:y[1]||(y[1]=v=>d(r.value)),class:"btn btn-primary flex items-center"},y[10]||(y[10]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ge(" Nueva Calificación ")]))])]),ee(t).loading?(K(),Y("div",zK,y[12]||(y[12]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando calificaciones...",-1)]))):Object.keys(a.value).length===0?(K(),Y("div",UK,[y[13]||(y[13]=A("p",{class:"text-gray-500 dark:text-gray-400"},"No hay calificaciones registradas",-1)),A("button",{onClick:y[2]||(y[2]=v=>d(null)),class:"mt-4 btn btn-primary"}," Añadir primera calificación ")])):(K(),Y("div",WK,[(K(!0),Y(ae,null,ln(a.value,(v,x)=>(K(),Y("div",{key:x,class:"card"},[A("div",KK,[A("div",GK,[A("span",{class:"inline-block w-4 h-4 rounded-full mr-2",style:Wn({backgroundColor:v.subject.color})},null,4),A("h2",YK,pt(v.subject.name),1)]),A("div",XK,[A("div",qK,[y[14]||(y[14]=ge(" Promedio: ")),A("span",{class:Kt(v.average>=70?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},pt(c(v.average))+" ("+pt(u(v.average))+") ",3)]),A("button",{onClick:S=>d(Number(x)),class:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},y[15]||(y[15]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)]),8,JK)])]),A("div",QK,[A("table",ZK,[y[18]||(y[18]=A("thead",null,[A("tr",{class:"text-left border-b border-gray-200 dark:border-gray-700"},[A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Título"),A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Calificación"),A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Porcentaje"),A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Peso"),A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Fecha"),A("th",{class:"py-2 px-4 text-gray-600 dark:text-gray-300"},"Acciones")])],-1)),A("tbody",null,[(K(!0),Y(ae,null,ln(v.grades,S=>(K(),Y("tr",{key:S.id,class:"border-b border-gray-100 dark:border-gray-800"},[A("td",tG,pt(S.title),1),A("td",eG,pt(S.score)+"/"+pt(S.maxScore),1),A("td",nG,[A("span",{class:Kt(S.score/S.maxScore*100>=70?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},pt(c(S.score/S.maxScore*100)),3)]),A("td",rG,pt(S.weight),1),A("td",sG,pt(l(S.date)),1),A("td",iG,[A("div",oG,[A("button",{onClick:w=>p(S.id),class:"p-1 text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400"},y[16]||(y[16]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,aG),A("button",{onClick:w=>m(S.id),class:"p-1 text-gray-500 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"},y[17]||(y[17]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,lG)])])]))),128))])])])]))),128))])),i.value?(K(),Y("div",cG,[A("div",uG,[A("h3",dG,pt(o.value?"Editar Calificación":"Nueva Calificación"),1),A("div",hG,[A("div",null,[y[19]||(y[19]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Título "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"text","onUpdate:modelValue":y[3]||(y[3]=v=>s.value.title=v),placeholder:"Ej: Examen Parcial",class:"input"},null,512),[[cn,s.value.title]])]),A("div",fG,[A("div",null,[y[20]||(y[20]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Calificación "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"number","onUpdate:modelValue":y[4]||(y[4]=v=>s.value.score=v),min:"0",max:s.value.maxScore,class:"input"},null,8,pG),[[cn,s.value.score,void 0,{number:!0}]])]),A("div",null,[y[21]||(y[21]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Máximo "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"number","onUpdate:modelValue":y[5]||(y[5]=v=>s.value.maxScore=v),min:"1",class:"input"},null,512),[[cn,s.value.maxScore,void 0,{number:!0}]])])]),A("div",gG,[A("div",null,[y[22]||(y[22]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Peso ",-1)),Le(A("input",{type:"number","onUpdate:modelValue":y[6]||(y[6]=v=>s.value.weight=v),min:"0.1",step:"0.1",class:"input"},null,512),[[cn,s.value.weight,void 0,{number:!0}]])]),A("div",null,[y[23]||(y[23]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Fecha ",-1)),Le(A("input",{type:"date","onUpdate:modelValue":y[7]||(y[7]=v=>s.value.date=v),class:"input"},null,512),[[cn,s.value.date]])])]),o.value?Re("",!0):(K(),Y("div",mG,[y[24]||(y[24]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Materia "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("select",{"onUpdate:modelValue":y[8]||(y[8]=v=>s.value.subjectId=v),class:"input",required:!0},[s.value.subjectId?Re("",!0):(K(),Y("option",yG,"Selecciona una materia")),(K(!0),Y(ae,null,ln(ee(e).subjects,v=>(K(),Y("option",{key:v.id,value:v.id},pt(v.name),9,bG))),128))],512),[[mo,s.value.subjectId]])]))]),A("div",{class:"flex justify-end space-x-3 mt-6"},[A("button",{onClick:h,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:g,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"}," Guardar ")])])])):Re("",!0)]))}},Sk=ld("pdfs",()=>{const n=ot([]),t=ot(!1),e=ot(null);async function r(){t.value=!0;try{n.value=await ce.pdfs.toArray(),e.value=null}catch(u){console.error("Error fetching PDFs:",u),e.value="Error al cargar los PDFs"}finally{t.value=!1}}async function s(u){t.value=!0;try{n.value=await ce.pdfs.where("subjectId").equals(u).toArray(),e.value=null}catch(d){console.error("Error fetching PDFs by subject:",d),e.value="Error al cargar los PDFs de la materia"}finally{t.value=!1}}async function i(u,d){try{const h=new Date().toISOString(),p=await d.arrayBuffer(),g={...u,file:p,size:d.size,createdAt:h,updatedAt:h},m=await ce.pdfs.add(g);return await r(),m}catch(h){throw console.error("Error adding PDF:",h),e.value="Error al añadir el PDF",h}}async function o(u,d,h){try{const p=new Date().toISOString(),g=await ce.pdfs.get(u);let m={...d,updatedAt:p};if(h){const b=await h.arrayBuffer();m={...m,file:b,size:h.size}}await ce.pdfs.update(u,m),await r()}catch(p){throw console.error("Error updating PDF:",p),e.value="Error al actualizar el PDF",p}}async function a(u){try{await ce.pdfs.delete(u),await r()}catch(d){throw console.error("Error deleting PDF:",d),e.value="Error al eliminar el PDF",d}}const l=Ee(()=>async u=>u?await ce.pdfs.get(Number(u)):null);async function c(u){t.value=!0;try{const d=await ce.pdfs.toArray(),h=u.toLowerCase();n.value=d.filter(p=>p.title.toLowerCase().includes(h)),e.value=null}catch(d){console.error("Error searching PDFs:",d),e.value="Error al buscar los PDFs"}finally{t.value=!1}}return{pdfs:n,loading:t,error:e,fetchPdfs:r,fetchPdfsBySubject:s,addPdf:i,updatePdf:o,deletePdf:a,getPdfById:l,searchPdfs:c}}),wG={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},xG={class:"md:col-span-2"},SG={key:0,class:"text-center py-8"},AG={key:1,class:"text-center py-8"},EG={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},kG={class:"mb-2 flex items-center"},CG={class:"text-xs text-gray-600 dark:text-gray-300"},TG={class:"flex items-start gap-3"},MG={class:"flex-grow"},PG={class:"text-lg font-semibold text-gray-900 dark:text-white mb-1"},OG={class:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},IG={class:"mt-4 flex justify-between"},RG=["onClick"],DG={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},NG={class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},_G={class:"space-y-4"},LG={key:0},FG={key:1,class:"text-left"},BG={class:"flex items-start gap-3"},$G={class:"flex-grow"},jG={class:"text-base font-medium text-gray-900 dark:text-white"},HG={class:"text-sm text-gray-500 dark:text-gray-400"},VG={class:"flex justify-end space-x-3 mt-6"},zG=["disabled"],UG={__name:"PdfsPage",setup(n){const t=Sk(),e=Ra(),r=ot(null),s=ot(""),i=ot(!1),o=ot(null),a=ot(null),l=ot({title:"",subjectId:null});qn(async()=>{await e.fetchSubjects(),await t.fetchPdfs()});const c=Ee(()=>{let S=t.pdfs;if(r.value&&(S=S.filter(w=>w.subjectId===r.value)),s.value){const w=s.value.toLowerCase();S=S.filter(E=>E.title.toLowerCase().includes(w))}return[...S].sort((w,E)=>new Date(E.createdAt)-new Date(w.createdAt))}),u=S=>Zs(new Date(S),"d MMM, yyyy",{locale:Nl}),d=S=>S<1024?S+" bytes":S<1048576?(S/1024).toFixed(1)+" KB":(S/1048576).toFixed(1)+" MB",h=S=>e.subjects.find(w=>w.id===S)||{name:"Sin materia",color:"#94a3b8"},p=S=>{s.value=S},g=()=>{r.value=null,s.value=""},m=()=>{l.value={title:"",subjectId:null},o.value=null,i.value=!0},b=()=>{i.value=!1},y=S=>{const w=S.target.files[0];w&&w.type==="application/pdf"?(o.value=w,l.value.title||(l.value.title=w.name.replace(".pdf",""))):(alert("Por favor selecciona un archivo PDF válido"),o.value=null,a.value&&(a.value.value=""))},v=async()=>{if(!o.value){alert("Por favor selecciona un archivo PDF");return}if(!l.value.title.trim()){alert("Por favor ingresa un título para el documento");return}if(!l.value.subjectId){alert("Por favor selecciona una materia");return}try{await t.addPdf(l.value,o.value),b()}catch(S){console.error("Error uploading PDF:",S),alert("Error al subir el PDF")}},x=async S=>{if(confirm("¿Estás seguro de que deseas eliminar este documento?"))try{await t.deletePdf(S)}catch(w){console.error("Error deleting PDF:",w),alert("Error al eliminar el PDF")}};return(S,w)=>{const E=Ia("router-link");return K(),Y("div",null,[A("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},[w[5]||(w[5]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Documentos PDF",-1)),A("button",{onClick:m,class:"btn btn-primary flex items-center justify-center"},w[4]||(w[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})],-1),ge(" Subir PDF ")]))]),A("div",wG,[A("div",xG,[bt(FE,{placeholder:"Buscar documentos...",onSearch:p})]),A("div",null,[bt(yf,{modelValue:r.value,"onUpdate:modelValue":w[0]||(w[0]=T=>r.value=T)},null,8,["modelValue"])])]),ee(t).loading?(K(),Y("div",SG,w[6]||(w[6]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando documentos...",-1)]))):c.value.length===0?(K(),Y("div",AG,[w[7]||(w[7]=A("p",{class:"text-gray-500 dark:text-gray-400"},"No se encontraron documentos",-1)),r.value||s.value?(K(),Y("button",{key:0,onClick:g,class:"mt-2 text-primary-600 dark:text-primary-400 hover:underline"}," Borrar filtros ")):Re("",!0),A("button",{onClick:m,class:"mt-4 btn btn-primary"}," Subir tu primer PDF ")])):(K(),Y("div",EG,[(K(!0),Y(ae,null,ln(c.value,T=>(K(),Y("div",{key:T.id,class:"card hover:shadow-lg transition-shadow cursor-pointer"},[A("div",kG,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:h(T.subjectId).color})},null,4),A("span",CG,pt(h(T.subjectId).name),1)]),A("div",TG,[w[8]||(w[8]=A("div",{class:"flex-shrink-0 w-10 h-12 bg-red-100 dark:bg-red-900/30 rounded flex items-center justify-center"},[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),A("div",MG,[bt(E,{to:`/pdfs/${T.id}`},{default:Se(()=>[A("h3",PG,pt(T.title),1)]),_:2},1032,["to"]),A("div",OG,[A("span",null,pt(d(T.size)),1),A("span",null,pt(u(T.createdAt)),1)])])]),A("div",IG,[bt(E,{to:`/pdfs/${T.id}`,class:"px-3 py-1.5 bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-300 rounded-lg text-sm hover:bg-primary-200 dark:hover:bg-primary-800/30 transition-colors"},{default:Se(()=>w[9]||(w[9]=[ge(" Abrir ")])),_:2,__:[9]},1032,["to"]),A("button",{onClick:uw(I=>x(T.id),["stop"]),class:"px-3 py-1.5 bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-lg text-sm hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"}," Eliminar ",8,RG)])]))),128))])),i.value?(K(),Y("div",DG,[A("div",NG,[w[15]||(w[15]=A("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-4"}," Subir Nuevo PDF ",-1)),A("div",_G,[A("div",{class:Kt(["border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-6 text-center",{"border-primary-500 dark:border-primary-500":o.value}])},[o.value?(K(),Y("div",FG,[A("div",BG,[w[13]||(w[13]=A("div",{class:"flex-shrink-0 w-10 h-12 bg-red-100 dark:bg-red-900/30 rounded flex items-center justify-center"},[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),A("div",$G,[A("h4",jG,pt(o.value.name),1),A("p",HG,pt(d(o.value.size)),1)]),A("button",{onClick:w[1]||(w[1]=T=>{o.value=null,a.value.value&&(a.value.value.value="")}),class:"p-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"},w[12]||(w[12]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):(K(),Y("div",LG,[w[10]||(w[10]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),w[11]||(w[11]=A("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-300"}," Arrastra y suelta un archivo PDF aquí, o haz clic para seleccionar ",-1)),A("input",{type:"file",ref_key:"fileInputRef",ref:a,onChange:y,accept:"application/pdf",class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"},null,544)]))],2),A("div",null,[w[14]||(w[14]=A("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[ge(" Título "),A("span",{class:"text-red-500"},"*")],-1)),Le(A("input",{type:"text","onUpdate:modelValue":w[2]||(w[2]=T=>l.value.title=T),placeholder:"Título del documento",class:"input"},null,512),[[cn,l.value.title]])]),A("div",null,[bt(yf,{modelValue:l.value.subjectId,"onUpdate:modelValue":w[3]||(w[3]=T=>l.value.subjectId=T),required:!0},null,8,["modelValue"])])]),A("div",VG,[A("button",{onClick:b,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:v,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",disabled:!o.value}," Subir ",8,zG)])])])):Re("",!0)])}}};var Jp={};Jp.d=(n,t)=>{for(var e in t)Jp.o(t,e)&&!Jp.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})};Jp.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Ut=globalThis.pdfjsLib={};Jp.d(Ut,{AbortException:()=>ec,AnnotationEditorLayer:()=>jA,AnnotationEditorParamsType:()=>ve,AnnotationEditorType:()=>te,AnnotationEditorUIManager:()=>ed,AnnotationLayer:()=>$Y,AnnotationMode:()=>rl,ColorPicker:()=>Ev,DOMSVGFactory:()=>Ik,DrawLayer:()=>zA,FeatureTest:()=>jr,GlobalWorkerOptions:()=>ha,ImageKind:()=>C0,InvalidPDFException:()=>DS,MissingPDFException:()=>Mg,OPS:()=>ui,OutputScale:()=>_S,PDFDataRangeTransport:()=>xN,PDFDateString:()=>Tk,PDFWorker:()=>rh,PasswordResponses:()=>YG,PermissionFlag:()=>GG,PixelsPerInch:()=>nc,RenderingCancelledException:()=>kk,TextLayer:()=>Pg,TouchManager:()=>Sv,UnexpectedResponseException:()=>vv,Util:()=>Mt,VerbosityLevel:()=>_w,XfaLayer:()=>AN,build:()=>vY,createValidAbsoluteUrl:()=>QG,fetchData:()=>$w,getDocument:()=>uY,getFilenameFromUrl:()=>a9,getPdfFilenameFromUrl:()=>l9,getXfaPageViewport:()=>c9,isDataScheme:()=>jw,isPdfFile:()=>Ck,noContextMenu:()=>Di,normalizeUnicode:()=>s9,setLayerDimensions:()=>td,shadow:()=>he,stopEvent:()=>Ps,version:()=>bY});const Er=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),wD=[1,0,0,1,0,0],RS=[.001,0,0,.001,0,0],WG=1e7,qx=1.35,Cs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},rl={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},KG="pdfjs_internal_editor_",te={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ve={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},GG={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},dr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},C0={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Mn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},zf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},_w={ERRORS:0,WARNINGS:1,INFOS:5},ui={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},YG={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Lw=_w.WARNINGS;function XG(n){Number.isInteger(n)&&(Lw=n)}function qG(){return Lw}function Fw(n){Lw>=_w.INFOS&&console.log(`Info: ${n}`)}function ne(n){Lw>=_w.WARNINGS&&console.log(`Warning: ${n}`)}function Ve(n){throw new Error(n)}function En(n,t){n||Ve(t)}function JG(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function QG(n,t=null,e=null){if(!n)return null;try{if(e&&typeof n=="string"){if(e.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(e.tryConvertEncoding)try{n=r9(n)}catch{}}const r=t?new URL(n,t):new URL(n);if(JG(r))return r}catch{}return null}function he(n,t,e,r=!1){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!0,writable:!1}),e}const ac=function(){function t(e,r){this.message=e,this.name=r}return t.prototype=new Error,t.constructor=t,t}();class zM extends ac{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Jx extends ac{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class DS extends ac{constructor(t){super(t,"InvalidPDFException")}}class Mg extends ac{constructor(t){super(t,"MissingPDFException")}}class vv extends ac{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class ZG extends ac{constructor(t){super(t,"FormatError")}}class ec extends ac{constructor(t){super(t,"AbortException")}}function xD(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ve("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const r=[];for(let s=0;s<t;s+=e){const i=Math.min(s+e,t),o=n.subarray(s,i);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function Bw(n){typeof n!="string"&&Ve("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=n.charCodeAt(r)&255;return e}function t9(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Ak(n){const t=Object.create(null);for(const[e,r]of n)t[e]=r;return t}function e9(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function n9(){try{return new Function(""),!0}catch{return!1}}class jr{static get isLittleEndian(){return he(this,"isLittleEndian",e9())}static get isEvalSupported(){return he(this,"isEvalSupported",n9())}static get isOffscreenCanvasSupported(){return he(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return he(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?he(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):he(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return he(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Qx=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var wa,T0,NS;class Mt{static makeHexColor(t,e,r){return`#${Qx[t]}${Qx[e]}${Qx[r]}`}static scaleMinMax(t,e){let r;t[0]?(t[0]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[3],e[3]*=t[3]):(r=e[0],e[0]=e[1],e[1]=r,r=e[2],e[2]=e[3],e[3]=r,t[1]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const r=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[r,s]}static applyInverseTransform(t,e){const r=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/r,i=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/r;return[s,i]}static getAxialAlignedBoundingBox(t,e){const r=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),i=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],r=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],i=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],a=(r+o)/2,l=Math.sqrt((r+o)**2-4*(r*o-i*s))/2,c=a+l||1,u=a-l||1;return[Math.sqrt(c),Math.sqrt(u)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const r=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(r>s)return null;const i=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return i>o?null:[r,i,s,o]}static bezierBoundingBox(t,e,r,s,i,o,a,l,c){return c?(c[0]=Math.min(c[0],t,a),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,a),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,a),Math.min(e,l),Math.max(t,a),Math.max(e,l)],P(this,wa,NS).call(this,t,r,i,a,e,s,o,l,3*(-t+3*(r-i)+a),6*(t-2*r+i),3*(r-t),c),P(this,wa,NS).call(this,t,r,i,a,e,s,o,l,3*(-e+3*(s-o)+l),6*(e-2*s+o),3*(s-e),c),c}}wa=new WeakSet,T0=function(t,e,r,s,i,o,a,l,c,u){if(c<=0||c>=1)return;const d=1-c,h=c*c,p=h*c,g=d*(d*(d*t+3*c*e)+3*h*r)+p*s,m=d*(d*(d*i+3*c*o)+3*h*a)+p*l;u[0]=Math.min(u[0],g),u[1]=Math.min(u[1],m),u[2]=Math.max(u[2],g),u[3]=Math.max(u[3],m)},NS=function(t,e,r,s,i,o,a,l,c,u,d,h){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&P(this,wa,T0).call(this,t,e,r,s,i,o,a,l,-d/u,h);return}const p=u**2-4*d*c;if(p<0)return;const g=Math.sqrt(p),m=2*c;P(this,wa,T0).call(this,t,e,r,s,i,o,a,l,(-u+g)/m,h),P(this,wa,T0).call(this,t,e,r,s,i,o,a,l,(-u-g)/m,h)},M(Mt,wa);function r9(n){return decodeURIComponent(escape(n))}let Zx=null,UM=null;function s9(n){return Zx||(Zx=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,UM=new Map([["ﬅ","ſt"]])),n.replaceAll(Zx,(t,e,r)=>e?e.normalize("NFKC"):UM.get(r))}function i9(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),xD(n)}const Ek="pdfjs_internal_id_";function o9(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(xD(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});const Po="http://www.w3.org/2000/svg",xc=class xc{};_t(xc,"CSS",96),_t(xc,"PDF",72),_t(xc,"PDF_TO_CSS_UNITS",xc.CSS/xc.PDF);let nc=xc;async function $w(n,t="text"){if(ip(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,r)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}r(new Error(s.statusText))}},s.send(null)})}class yy{constructor({viewBox:t,userUnit:e,scale:r,rotation:s,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=t,this.userUnit=e,this.scale=r,this.rotation=s,this.offsetX=i,this.offsetY=o,r*=e;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let u,d,h,p;switch(s%=360,s<0&&(s+=360),s){case 180:u=-1,d=0,h=0,p=1;break;case 90:u=0,d=1,h=1,p=0;break;case 270:u=0,d=-1,h=-1,p=0;break;case 0:u=1,d=0,h=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,p=-p);let g,m,b,y;u===0?(g=Math.abs(c-t[1])*r+i,m=Math.abs(l-t[0])*r+o,b=(t[3]-t[1])*r,y=(t[2]-t[0])*r):(g=Math.abs(l-t[0])*r+i,m=Math.abs(c-t[1])*r+o,b=(t[2]-t[0])*r,y=(t[3]-t[1])*r),this.transform=[u*r,d*r,h*r,p*r,g-u*r*l-h*r*c,m-d*r*l-p*r*c],this.width=b,this.height=y}get rawDims(){const{userUnit:t,viewBox:e}=this,r=e.map(s=>s*t);return he(this,"rawDims",{pageWidth:r[2]-r[0],pageHeight:r[3]-r[1],pageX:r[0],pageY:r[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:r=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}={}){return new yy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:s,dontFlip:i})}convertToViewportPoint(t,e){return Mt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Mt.applyTransform([t[0],t[1]],this.transform),r=Mt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],r[0],r[1]]}convertToPdfPoint(t,e){return Mt.applyInverseTransform([t,e],this.transform)}}class kk extends ac{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function jw(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Ck(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function a9(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function l9(n,t="document.pdf"){if(typeof n!="string")return t;if(jw(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(n);let i=r.exec(s[1])||r.exec(s[2])||r.exec(s[3]);if(i&&(i=i[0],i.includes("%")))try{i=r.exec(decodeURIComponent(i))[0]}catch{}return i||t}class WM{constructor(){_t(this,"started",Object.create(null));_t(this,"times",[])}time(t){t in this.started&&ne(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ne(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:r}of this.times)e=Math.max(r.length,e);for(const{name:r,start:s,end:i}of this.times)t.push(`${r.padEnd(e)} ${i-s}ms
`);return t.join("")}}function ip(n,t){try{const{protocol:e}=t?new URL(n,t):new URL(n);return e==="http:"||e==="https:"}catch{return!1}}function Di(n){n.preventDefault()}function Ps(n){n.preventDefault(),n.stopPropagation()}var Ig;class Tk{static toDateObject(t){if(!t||typeof t!="string")return null;f(this,Ig)||k(this,Ig,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=f(this,Ig).exec(t);if(!e)return null;const r=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(e[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let u=parseInt(e[8],10);u=u>=0&&u<=23?u:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(o+=u,a+=d):c==="+"&&(o-=u,a-=d),new Date(Date.UTC(r,s,i,o,a,l))}}Ig=new WeakMap,M(Tk,Ig);function c9(n,{scale:t=1,rotation:e=0}){const{width:r,height:s}=n.attributes.style,i=[0,0,parseInt(r),parseInt(s)];return new yy({viewBox:i,userUnit:1,scale:t,rotation:e})}function Mk(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function u9(n){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of n.keys()){t.style.color=e;const r=window.getComputedStyle(t).color;n.set(e,Mk(r))}t.remove()}function tn(n){const{a:t,b:e,c:r,d:s,e:i,f:o}=n.getTransform();return[t,e,r,s,i,o]}function Li(n){const{a:t,b:e,c:r,d:s,e:i,f:o}=n.getTransform().invertSelf();return[t,e,r,s,i,o]}function td(n,t,e=!1,r=!0){if(t instanceof yy){const{pageWidth:s,pageHeight:i}=t.rawDims,{style:o}=n,a=jr.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${i}px`,u=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=a?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!e||t.rotation%180===0?(o.width=u,o.height=d):(o.width=d,o.height=u)}r&&n.setAttribute("data-main-rotation",t.rotation)}class _S{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var sl,Mc,di,Pc,Rg,Dg,Tv,SD,Hr,AD,ED,M0,kD,FS;const No=class No{constructor(t){M(this,Hr);M(this,sl,null);M(this,Mc,null);M(this,di);M(this,Pc,null);M(this,Rg,null);k(this,di,t),f(No,Dg)||k(No,Dg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=k(this,sl,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=f(this,di)._uiManager._signal;t.addEventListener("contextmenu",Di,{signal:e}),t.addEventListener("pointerdown",P(No,Tv,SD),{signal:e});const r=k(this,Pc,document.createElement("div"));r.className="buttons",t.append(r);const s=f(this,di).toolbarPosition;if(s){const{style:i}=t,o=f(this,di)._uiManager.direction==="ltr"?1-s[0]:s[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return P(this,Hr,kD).call(this),t}get div(){return f(this,sl)}hide(){var t;f(this,sl).classList.add("hidden"),(t=f(this,Mc))==null||t.hideDropdown()}show(){var t;f(this,sl).classList.remove("hidden"),(t=f(this,Rg))==null||t.shown()}async addAltText(t){const e=await t.render();P(this,Hr,M0).call(this,e),f(this,Pc).prepend(e,f(this,Hr,FS)),k(this,Rg,t)}addColorPicker(t){k(this,Mc,t);const e=t.renderButton();P(this,Hr,M0).call(this,e),f(this,Pc).prepend(e,f(this,Hr,FS))}remove(){var t;f(this,sl).remove(),(t=f(this,Mc))==null||t.destroy(),k(this,Mc,null)}};sl=new WeakMap,Mc=new WeakMap,di=new WeakMap,Pc=new WeakMap,Rg=new WeakMap,Dg=new WeakMap,Tv=new WeakSet,SD=function(t){t.stopPropagation()},Hr=new WeakSet,AD=function(t){f(this,di)._focusEventsAllowed=!1,Ps(t)},ED=function(t){f(this,di)._focusEventsAllowed=!0,Ps(t)},M0=function(t){const e=f(this,di)._uiManager._signal;t.addEventListener("focusin",P(this,Hr,AD).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",P(this,Hr,ED).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Di,{signal:e})},kD=function(){const{editorType:t,_uiManager:e}=f(this,di),r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",f(No,Dg)[t]),P(this,Hr,M0).call(this,r),r.addEventListener("click",s=>{e.delete()},{signal:e._signal}),f(this,Pc).append(r)},FS=function(){const t=document.createElement("div");return t.className="divider",t},M(No,Tv),M(No,Dg,null);let LS=No;var Ng,Oc,Ic,rc,CD,TD,MD;class d9{constructor(t){M(this,rc);M(this,Ng,null);M(this,Oc,null);M(this,Ic);k(this,Ic,t)}show(t,e,r){const[s,i]=P(this,rc,TD).call(this,e,r),{style:o}=f(this,Oc)||k(this,Oc,P(this,rc,CD).call(this));t.append(f(this,Oc)),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){f(this,Oc).remove()}}Ng=new WeakMap,Oc=new WeakMap,Ic=new WeakMap,rc=new WeakSet,CD=function(){const t=k(this,Oc,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Di,{signal:f(this,Ic)._signal});const e=k(this,Ng,document.createElement("div"));return e.className="buttons",t.append(e),P(this,rc,MD).call(this),t},TD=function(t,e){let r=0,s=0;for(const i of t){const o=i.y+i.height;if(o<r)continue;const a=i.x+(e?i.width:0);if(o>r){s=a,r=o;continue}e?a>s&&(s=a):a<s&&(s=a)}return[e?1-s:s,r]},MD=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=f(this,Ic)._signal;t.addEventListener("contextmenu",Di,{signal:r}),t.addEventListener("click",()=>{f(this,Ic).highlightSelection("floating_button")},{signal:r}),f(this,Ng).append(t)};function wv(n,t,e){for(const r of e)t.addEventListener(r,n[r].bind(n))}var Mv;class h9{constructor(){M(this,Mv,0)}get id(){return`${KG}${Pr(this,Mv)._++}`}}Mv=new WeakMap;var sh,_g,pr,ih,P0;const _k=class _k{constructor(){M(this,ih);M(this,sh,i9());M(this,_g,0);M(this,pr,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const i=s.decode().then(()=>(r.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return he(this,"_isSVGFittingCanvas",i)}async getFromFile(t){const{lastModified:e,name:r,size:s,type:i}=t;return P(this,ih,P0).call(this,`${e}_${r}_${s}_${i}`,t)}async getFromUrl(t){return P(this,ih,P0).call(this,t,t)}async getFromBlob(t,e){const r=await e;return P(this,ih,P0).call(this,t,r)}async getFromId(t){f(this,pr)||k(this,pr,new Map);const e=f(this,pr).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:r}=e;return delete e.blobPromise,this.getFromBlob(e.id,r)}return this.getFromUrl(e.url)}getFromCanvas(t,e){f(this,pr)||k(this,pr,new Map);let r=f(this,pr).get(t);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),r={bitmap:s.transferToImageBitmap(),id:`image_${f(this,sh)}_${Pr(this,_g)._++}`,refCounter:1,isSvg:!1},f(this,pr).set(t,r),f(this,pr).set(r.id,r),r}getSvgUrl(t){const e=f(this,pr).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var s;f(this,pr)||k(this,pr,new Map);const e=f(this,pr).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:r}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),e.blobPromise=i.convertToBlob()}(s=r.close)==null||s.call(r),e.bitmap=null}isValidId(t){return t.startsWith(`image_${f(this,sh)}_`)}};sh=new WeakMap,_g=new WeakMap,pr=new WeakMap,ih=new WeakSet,P0=async function(t,e){f(this,pr)||k(this,pr,new Map);let r=f(this,pr).get(t);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${f(this,sh)}_${Pr(this,_g)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(r.url=e,s=await $w(e,"blob")):e instanceof File?s=r.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const i=_k._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,u)=>{a.onload=()=>{r.bitmap=a,r.isSvg=!0,c()},o.onload=async()=>{const d=r.svgUrl=o.result;a.src=await i?`${d}#svgView(preserveAspectRatio(none))`:d},a.onerror=o.onerror=u});o.readAsDataURL(s),await l}else r.bitmap=await createImageBitmap(s);r.refCounter=1}catch(s){ne(s),r=null}return f(this,pr).set(t,r),r&&f(this,pr).set(r.id,r),r};let BS=_k;var bn,il,Lg,sn;class f9{constructor(t=128){M(this,bn,[]);M(this,il,!1);M(this,Lg);M(this,sn,-1);k(this,Lg,t)}add({cmd:t,undo:e,post:r,mustExec:s,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&t(),f(this,il))return;const l={cmd:t,undo:e,post:r,type:i};if(f(this,sn)===-1){f(this,bn).length>0&&(f(this,bn).length=0),k(this,sn,0),f(this,bn).push(l);return}if(o&&f(this,bn)[f(this,sn)].type===i){a&&(l.undo=f(this,bn)[f(this,sn)].undo),f(this,bn)[f(this,sn)]=l;return}const c=f(this,sn)+1;c===f(this,Lg)?f(this,bn).splice(0,1):(k(this,sn,c),c<f(this,bn).length&&f(this,bn).splice(c)),f(this,bn).push(l)}undo(){if(f(this,sn)===-1)return;k(this,il,!0);const{undo:t,post:e}=f(this,bn)[f(this,sn)];t(),e==null||e(),k(this,il,!1),k(this,sn,f(this,sn)-1)}redo(){if(f(this,sn)<f(this,bn).length-1){k(this,sn,f(this,sn)+1),k(this,il,!0);const{cmd:t,post:e}=f(this,bn)[f(this,sn)];t(),e==null||e(),k(this,il,!1)}}hasSomethingToUndo(){return f(this,sn)!==-1}hasSomethingToRedo(){return f(this,sn)<f(this,bn).length-1}cleanType(t){if(f(this,sn)!==-1){for(let e=f(this,sn);e>=0;e--)if(f(this,bn)[e].type!==t){f(this,bn).splice(e+1,f(this,sn)-e),k(this,sn,e);return}f(this,bn).length=0,k(this,sn,-1)}}destroy(){k(this,bn,null)}}bn=new WeakMap,il=new WeakMap,Lg=new WeakMap,sn=new WeakMap;var Pv,PD;class by{constructor(t){M(this,Pv);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=jr.platform;for(const[r,s,i={}]of t)for(const o of r){const a=o.startsWith("mac+");e&&a?(this.callbacks.set(o.slice(4),{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1))):!e&&!a&&(this.callbacks.set(o,{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const r=this.callbacks.get(P(this,Pv,PD).call(this,e));if(!r)return;const{callback:s,options:{bubbles:i=!1,args:o=[],checker:a=null}}=r;a&&!a(t,e)||(s.bind(t,...o,e)(),i||Ps(e))}}Pv=new WeakSet,PD=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Ov=class Ov{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return u9(t),he(this,"_colors",t)}convert(t){const e=Mk(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[r,s]of this._colors)if(s.every((i,o)=>i===e[o]))return Ov._colorsMapping.get(r);return e}getHexCode(t){const e=this._colors.get(t);return e?Mt.makeHexColor(...e):t}};_t(Ov,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let $S=Ov;var oh,ps,On,Qn,ah,Fo,lh,Vs,ol,Rc,ch,Dc,Ki,hi,Nc,Fg,Bg,uh,$g,Gi,al,dh,ll,Yi,Iv,cl,jg,ul,_c,Hg,Vg,Bn,De,Bo,Lc,zg,Ug,dl,Xi,$o,Wg,zs,ut,O0,jS,OD,ID,I0,RD,DD,ND,HS,_D,VS,zS,LD,Rr,Oo,FD,BD,US,$D,op,WS;const Vd=class Vd{constructor(t,e,r,s,i,o,a,l,c,u,d,h,p){M(this,ut);M(this,oh,new AbortController);M(this,ps,null);M(this,On,new Map);M(this,Qn,new Map);M(this,ah,null);M(this,Fo,null);M(this,lh,null);M(this,Vs,new f9);M(this,ol,null);M(this,Rc,null);M(this,ch,0);M(this,Dc,new Set);M(this,Ki,null);M(this,hi,null);M(this,Nc,new Set);_t(this,"_editorUndoBar",null);M(this,Fg,!1);M(this,Bg,!1);M(this,uh,!1);M(this,$g,null);M(this,Gi,null);M(this,al,null);M(this,dh,null);M(this,ll,!1);M(this,Yi,null);M(this,Iv,new h9);M(this,cl,!1);M(this,jg,!1);M(this,ul,null);M(this,_c,null);M(this,Hg,null);M(this,Vg,null);M(this,Bn,te.NONE);M(this,De,new Set);M(this,Bo,null);M(this,Lc,null);M(this,zg,null);M(this,Ug,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});M(this,dl,[0,0]);M(this,Xi,null);M(this,$o,null);M(this,Wg,null);M(this,zs,null);const g=this._signal=f(this,oh).signal;k(this,$o,t),k(this,Wg,e),k(this,ah,r),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:g}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),s._on("setpreference",this.onSetPreference.bind(this),{signal:g}),s._on("switchannotationeditorparams",m=>this.updateParams(m.type,m.value),{signal:g}),P(this,ut,RD).call(this),P(this,ut,LD).call(this),P(this,ut,HS).call(this),k(this,Fo,i.annotationStorage),k(this,$g,i.filterFactory),k(this,Lc,o),k(this,dh,a||null),k(this,Fg,l),k(this,Bg,c),k(this,uh,u),k(this,Vg,d||null),this.viewParameters={realScale:nc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=h||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const t=Vd.prototype,e=o=>f(o,$o).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return he(this,"_keyboardManager",new by([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,$o).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,$o).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}]]))}destroy(){var t,e,r,s,i;(t=f(this,zs))==null||t.resolve(),k(this,zs,null),(e=f(this,oh))==null||e.abort(),k(this,oh,null),this._signal=null;for(const o of f(this,Qn).values())o.destroy();f(this,Qn).clear(),f(this,On).clear(),f(this,Nc).clear(),k(this,ps,null),f(this,De).clear(),f(this,Vs).destroy(),(r=f(this,ah))==null||r.destroy(),(s=f(this,Yi))==null||s.hide(),k(this,Yi,null),f(this,Gi)&&(clearTimeout(f(this,Gi)),k(this,Gi,null)),f(this,Xi)&&(clearTimeout(f(this,Xi)),k(this,Xi,null)),(i=this._editorUndoBar)==null||i.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return f(this,Vg)}get useNewAltTextFlow(){return f(this,Bg)}get useNewAltTextWhenAddingImage(){return f(this,uh)}get hcmFilter(){return he(this,"hcmFilter",f(this,Lc)?f(this,$g).addHCMFilter(f(this,Lc).foreground,f(this,Lc).background):"none")}get direction(){return he(this,"direction",getComputedStyle(f(this,$o)).direction)}get highlightColors(){return he(this,"highlightColors",f(this,dh)?new Map(f(this,dh).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return he(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),k(this,Rc,t)}setMainHighlightColorPicker(t){k(this,Hg,t)}editAltText(t,e=!1){var r;(r=f(this,ah))==null||r.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":k(this,uh,e);break}}onPageChanging({pageNumber:t}){k(this,ch,t-1)}focusMainContainer(){f(this,$o).focus()}findParent(t,e){for(const r of f(this,Qn).values()){const{x:s,y:i,width:o,height:a}=r.div.getBoundingClientRect();if(t>=s&&t<=s+o&&e>=i&&e<=i+a)return r}return null}disableUserSelect(t=!1){f(this,Wg).classList.toggle("noUserSelect",t)}addShouldRescale(t){f(this,Nc).add(t)}removeShouldRescale(t){f(this,Nc).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*nc.PDF_TO_CSS_UNITS;for(const r of f(this,Nc))r.onScaleChanging();(e=f(this,Rc))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:r,anchorOffset:s,focusNode:i,focusOffset:o}=e,a=e.toString(),c=P(this,ut,O0).call(this,e).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;e.empty();const d=P(this,ut,jS).call(this,c),h=f(this,Bn)===te.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:r,anchorOffset:s,focusNode:i,focusOffset:o,text:a}),h&&this.showAllEditors("highlight",!0,!0)};if(h){this.switchToMode(te.HIGHLIGHT,p);return}p()}addToAnnotationStorage(t){!t.isEmpty()&&f(this,Fo)&&!f(this,Fo).has(t.id)&&f(this,Fo).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,f(this,ll)&&(k(this,ll,!1),P(this,ut,I0).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of f(this,De))if(e.div.contains(t)){k(this,_c,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!f(this,_c))return;const[t,e]=f(this,_c);k(this,_c,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){P(this,ut,HS).call(this),P(this,ut,VS).call(this)}removeEditListeners(){P(this,ut,_D).call(this),P(this,ut,zS).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const r of f(this,hi))if(r.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const r of f(this,hi))if(r.isHandlingMimeForPasting(e.type)){r.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var r;if(t.preventDefault(),(r=f(this,ps))==null||r.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of f(this,De)){const i=s.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const i of e.items)for(const o of f(this,hi))if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let r=e.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(i){ne(`paste: "${i.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const s=this.currentLayer;try{const i=[];for(const l of r){const c=await s.deserialize(l);if(!c)return;i.push(c)}const o=()=>{for(const l of i)P(this,ut,US).call(this,l);P(this,ut,WS).call(this,i)},a=()=>{for(const l of i)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(i){ne(`paste: "${i.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),f(this,Bn)!==te.NONE&&!this.isEditorHandlingKeyboard&&Vd._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,f(this,ll)&&(k(this,ll,!1),P(this,ut,I0).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(P(this,ut,DD).call(this),P(this,ut,VS).call(this),P(this,ut,Rr).call(this,{isEditing:f(this,Bn)!==te.NONE,isEmpty:P(this,ut,op).call(this),hasSomethingToUndo:f(this,Vs).hasSomethingToUndo(),hasSomethingToRedo:f(this,Vs).hasSomethingToRedo(),hasSelectedEditor:!1})):(P(this,ut,ND).call(this),P(this,ut,zS).call(this),P(this,ut,Rr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!f(this,hi)){k(this,hi,t);for(const e of f(this,hi))P(this,ut,Oo).call(this,e.defaultPropertiesToUpdate)}}getId(){return f(this,Iv).id}get currentLayer(){return f(this,Qn).get(f(this,ch))}getLayer(t){return f(this,Qn).get(t)}get currentPageIndex(){return f(this,ch)}addLayer(t){f(this,Qn).set(t.pageIndex,t),f(this,cl)?t.enable():t.disable()}removeLayer(t){f(this,Qn).delete(t.pageIndex)}async updateMode(t,e=null,r=!1){var s;if(f(this,Bn)!==t&&!(f(this,zs)&&(await f(this,zs).promise,!f(this,zs)))){if(k(this,zs,Promise.withResolvers()),k(this,Bn,t),t===te.NONE){this.setEditingState(!1),P(this,ut,BD).call(this),(s=this._editorUndoBar)==null||s.hide(),f(this,zs).resolve();return}this.setEditingState(!0),await P(this,ut,FD).call(this),this.unselectAll();for(const i of f(this,Qn).values())i.updateMode(t);if(!e){r&&this.addNewEditorFromKeyboard(),f(this,zs).resolve();return}for(const i of f(this,On).values())i.annotationElementId===e?(this.setSelected(i),i.enterInEditMode()):i.unselect();f(this,zs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==f(this,Bn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var r;if(f(this,hi)){switch(t){case ve.CREATE:this.currentLayer.addNewEditor();return;case ve.HIGHLIGHT_DEFAULT_COLOR:(r=f(this,Hg))==null||r.updateColor(e);break;case ve.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(f(this,zg)||k(this,zg,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of f(this,De))s.updateParams(t,e);for(const s of f(this,hi))s.updateDefaultParams(t,e)}}showAllEditors(t,e,r=!1){var i;for(const o of f(this,On).values())o.editorType===t&&o.show(e);(((i=f(this,zg))==null?void 0:i.get(ve.HIGHLIGHT_SHOW_ALL))??!0)!==e&&P(this,ut,Oo).call(this,[[ve.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(f(this,jg)!==t){k(this,jg,t);for(const e of f(this,Qn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const r of f(this,On).values())r.pageIndex===t&&e.push(r);return e}getEditor(t){return f(this,On).get(t)}addEditor(t){f(this,On).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(f(this,Gi)&&clearTimeout(f(this,Gi)),k(this,Gi,setTimeout(()=>{this.focusMainContainer(),k(this,Gi,null)},0))),f(this,On).delete(t.id),this.unselect(t),(!t.annotationElementId||!f(this,Dc).has(t.annotationElementId))&&((e=f(this,Fo))==null||e.remove(t.id))}addDeletedAnnotationElement(t){f(this,Dc).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return f(this,Dc).has(t)}removeDeletedAnnotationElement(t){f(this,Dc).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){f(this,ps)!==t&&(k(this,ps,t),t&&P(this,ut,Oo).call(this,t.propertiesToUpdate))}updateUI(t){f(this,ut,$D)===t&&P(this,ut,Oo).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){P(this,ut,Oo).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(f(this,De).has(t)){f(this,De).delete(t),t.unselect(),P(this,ut,Rr).call(this,{hasSelectedEditor:this.hasSelection});return}f(this,De).add(t),t.select(),P(this,ut,Oo).call(this,t.propertiesToUpdate),P(this,ut,Rr).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=f(this,Rc))==null||e.commitOrRemove();for(const r of f(this,De))r!==t&&r.unselect();f(this,De).clear(),f(this,De).add(t),t.select(),P(this,ut,Oo).call(this,t.propertiesToUpdate),P(this,ut,Rr).call(this,{hasSelectedEditor:!0})}isSelected(t){return f(this,De).has(t)}get firstSelectedEditor(){return f(this,De).values().next().value}unselect(t){t.unselect(),f(this,De).delete(t),P(this,ut,Rr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return f(this,De).size!==0}get isEnterHandled(){return f(this,De).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;f(this,Vs).undo(),P(this,ut,Rr).call(this,{hasSomethingToUndo:f(this,Vs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:P(this,ut,op).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){f(this,Vs).redo(),P(this,ut,Rr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:f(this,Vs).hasSomethingToRedo(),isEmpty:P(this,ut,op).call(this)})}addCommands(t){f(this,Vs).add(t),P(this,ut,Rr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:P(this,ut,op).call(this)})}cleanUndoStack(t){f(this,Vs).cleanType(t)}delete(){var i;this.commitOrRemove();const t=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...f(this,De)],r=()=>{var o;(o=this._editorUndoBar)==null||o.show(s,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},s=()=>{for(const o of e)P(this,ut,US).call(this,o)};this.addCommands({cmd:r,undo:s,mustExec:!0})}commitOrRemove(){var t;(t=f(this,ps))==null||t.commitOrRemove()}hasSomethingToControl(){return f(this,ps)||this.hasSelection}selectAll(){for(const t of f(this,De))t.commit();P(this,ut,WS).call(this,f(this,On).values())}unselectAll(){var t;if(!(f(this,ps)&&(f(this,ps).commitOrRemove(),f(this,Bn)!==te.NONE))&&!((t=f(this,Rc))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of f(this,De))e.unselect();f(this,De).clear(),P(this,ut,Rr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;f(this,dl)[0]+=t,f(this,dl)[1]+=e;const[s,i]=f(this,dl),o=[...f(this,De)],a=1e3;f(this,Xi)&&clearTimeout(f(this,Xi)),k(this,Xi,setTimeout(()=>{k(this,Xi,null),f(this,dl)[0]=f(this,dl)[1]=0,this.addCommands({cmd:()=>{for(const l of o)f(this,On).has(l.id)&&l.translateInPage(s,i)},undo:()=>{for(const l of o)f(this,On).has(l.id)&&l.translateInPage(-s,-i)},mustExec:!1})},a));for(const l of o)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),k(this,Ki,new Map);for(const t of f(this,De))f(this,Ki).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!f(this,Ki))return!1;this.disableUserSelect(!1);const t=f(this,Ki);k(this,Ki,null);let e=!1;for(const[{x:s,y:i,pageIndex:o},a]of t)a.newX=s,a.newY=i,a.newPageIndex=o,e||(e=s!==a.savedX||i!==a.savedY||o!==a.savedPageIndex);if(!e)return!1;const r=(s,i,o,a)=>{if(f(this,On).has(s.id)){const l=f(this,Qn).get(a);l?s._setParentAndPosition(l,i,o):(s.pageIndex=a,s.x=i,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:i,newY:o,newPageIndex:a}]of t)r(s,i,o,a)},undo:()=>{for(const[s,{savedX:i,savedY:o,savedPageIndex:a}]of t)r(s,i,o,a)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(f(this,Ki))for(const r of f(this,Ki).keys())r.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||f(this,De).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return f(this,ps)===t}getActive(){return f(this,ps)}getMode(){return f(this,Bn)}get imageManager(){return he(this,"imageManager",new BS)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,u=e.rangeCount;c<u;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:r,y:s,width:i,height:o}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(c,u,d,h)=>({x:(u-s)/o,y:1-(c+d-r)/i,width:h/o,height:d/i});break;case"180":a=(c,u,d,h)=>({x:1-(c+d-r)/i,y:1-(u+h-s)/o,width:d/i,height:h/o});break;case"270":a=(c,u,d,h)=>({x:1-(u+h-s)/o,y:(c-r)/i,width:h/o,height:d/i});break;default:a=(c,u,d,h)=>({x:(c-r)/i,y:(u-s)/o,width:d/i,height:h/o});break}const l=[];for(let c=0,u=e.rangeCount;c<u;c++){const d=e.getRangeAt(c);if(!d.collapsed)for(const{x:h,y:p,width:g,height:m}of d.getClientRects())g===0||m===0||l.push(a(h,p,g,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(f(this,lh)||k(this,lh,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=f(this,lh))==null||e.delete(t)}renderAnnotationElement(t){var s;const e=(s=f(this,lh))==null?void 0:s.get(t.data.id);if(!e)return;const r=f(this,Fo).getRawValue(e);r&&(f(this,Bn)===te.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}};oh=new WeakMap,ps=new WeakMap,On=new WeakMap,Qn=new WeakMap,ah=new WeakMap,Fo=new WeakMap,lh=new WeakMap,Vs=new WeakMap,ol=new WeakMap,Rc=new WeakMap,ch=new WeakMap,Dc=new WeakMap,Ki=new WeakMap,hi=new WeakMap,Nc=new WeakMap,Fg=new WeakMap,Bg=new WeakMap,uh=new WeakMap,$g=new WeakMap,Gi=new WeakMap,al=new WeakMap,dh=new WeakMap,ll=new WeakMap,Yi=new WeakMap,Iv=new WeakMap,cl=new WeakMap,jg=new WeakMap,ul=new WeakMap,_c=new WeakMap,Hg=new WeakMap,Vg=new WeakMap,Bn=new WeakMap,De=new WeakMap,Bo=new WeakMap,Lc=new WeakMap,zg=new WeakMap,Ug=new WeakMap,dl=new WeakMap,Xi=new WeakMap,$o=new WeakMap,Wg=new WeakMap,zs=new WeakMap,ut=new WeakSet,O0=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},jS=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const r of f(this,Qn).values())if(r.hasTextLayer(t))return r;return null},OD=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const r=P(this,ut,O0).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(r);s&&(f(this,Yi)||k(this,Yi,new d9(this)),f(this,Yi).show(r,s,this.direction==="ltr"))},ID=function(){var i,o,a;const t=document.getSelection();if(!t||t.isCollapsed){f(this,Bo)&&((i=f(this,Yi))==null||i.hide(),k(this,Bo,null),P(this,ut,Rr).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===f(this,Bo))return;const s=P(this,ut,O0).call(this,t).closest(".textLayer");if(!s){f(this,Bo)&&((o=f(this,Yi))==null||o.hide(),k(this,Bo,null),P(this,ut,Rr).call(this,{hasSelectedText:!1}));return}if((a=f(this,Yi))==null||a.hide(),k(this,Bo,e),P(this,ut,Rr).call(this,{hasSelectedText:!0}),!(f(this,Bn)!==te.HIGHLIGHT&&f(this,Bn)!==te.NONE)&&(f(this,Bn)===te.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),k(this,ll,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=f(this,Bn)===te.HIGHLIGHT?P(this,ut,jS).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,u=this.combinedSignal(c),d=h=>{h.type==="pointerup"&&h.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),h.type==="pointerup"&&P(this,ut,I0).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}},I0=function(t=""){f(this,Bn)===te.HIGHLIGHT?this.highlightSelection(t):f(this,Fg)&&P(this,ut,OD).call(this)},RD=function(){document.addEventListener("selectionchange",P(this,ut,ID).bind(this),{signal:this._signal})},DD=function(){if(f(this,al))return;k(this,al,new AbortController);const t=this.combinedSignal(f(this,al));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},ND=function(){var t;(t=f(this,al))==null||t.abort(),k(this,al,null)},HS=function(){if(f(this,ul))return;k(this,ul,new AbortController);const t=this.combinedSignal(f(this,ul));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},_D=function(){var t;(t=f(this,ul))==null||t.abort(),k(this,ul,null)},VS=function(){if(f(this,ol))return;k(this,ol,new AbortController);const t=this.combinedSignal(f(this,ol));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},zS=function(){var t;(t=f(this,ol))==null||t.abort(),k(this,ol,null)},LD=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Rr=function(t){Object.entries(t).some(([r,s])=>f(this,Ug)[r]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(f(this,Ug),t)}),f(this,Bn)===te.HIGHLIGHT&&t.hasSelectedEditor===!1&&P(this,ut,Oo).call(this,[[ve.HIGHLIGHT_FREE,!0]]))},Oo=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},FD=async function(){if(!f(this,cl)){k(this,cl,!0);const t=[];for(const e of f(this,Qn).values())t.push(e.enable());await Promise.all(t);for(const e of f(this,On).values())e.enable()}},BD=function(){if(this.unselectAll(),f(this,cl)){k(this,cl,!1);for(const t of f(this,Qn).values())t.disable();for(const t of f(this,On).values())t.disable()}},US=function(t){const e=f(this,Qn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},$D=function(){let t=null;for(t of f(this,De));return t},op=function(){if(f(this,On).size===0)return!0;if(f(this,On).size===1)for(const t of f(this,On).values())return t.isEmpty();return!1},WS=function(t){for(const e of f(this,De))e.unselect();f(this,De).clear();for(const e of t)e.isEmpty()||(f(this,De).add(e),e.select());P(this,ut,Rr).call(this,{hasSelectedEditor:this.hasSelection})},_t(Vd,"TRANSLATE_SMALL",1),_t(Vd,"TRANSLATE_BIG",10);let ed=Vd;var $n,qi,fi,hh,Ji,gs,fh,Qi,Zr,jo,Fc,Zi,hl,Ci,ap,R0;const Dr=class Dr{constructor(t){M(this,Ci);M(this,$n,null);M(this,qi,!1);M(this,fi,null);M(this,hh,null);M(this,Ji,null);M(this,gs,null);M(this,fh,!1);M(this,Qi,null);M(this,Zr,null);M(this,jo,null);M(this,Fc,null);M(this,Zi,!1);k(this,Zr,t),k(this,Zi,t._uiManager.useNewAltTextFlow),f(Dr,hl)||k(Dr,hl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Dr._l10n??(Dr._l10n=t)}async render(){const t=k(this,fi,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=k(this,hh,document.createElement("span"));t.append(e),f(this,Zi)?(t.classList.add("new"),t.setAttribute("data-l10n-id",f(Dr,hl).missing),e.setAttribute("data-l10n-id",f(Dr,hl)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=f(this,Zr)._uiManager._signal;t.addEventListener("contextmenu",Di,{signal:r}),t.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:r});const s=i=>{i.preventDefault(),f(this,Zr)._uiManager.editAltText(f(this,Zr)),f(this,Zi)&&f(this,Zr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:f(this,Ci,ap)}})};return t.addEventListener("click",s,{capture:!0,signal:r}),t.addEventListener("keydown",i=>{i.target===t&&i.key==="Enter"&&(k(this,fh,!0),s(i))},{signal:r}),await P(this,Ci,R0).call(this),t}finish(){f(this,fi)&&(f(this,fi).focus({focusVisible:f(this,fh)}),k(this,fh,!1))}isEmpty(){return f(this,Zi)?f(this,$n)===null:!f(this,$n)&&!f(this,qi)}hasData(){return f(this,Zi)?f(this,$n)!==null||!!f(this,jo):this.isEmpty()}get guessedText(){return f(this,jo)}async setGuessedText(t){f(this,$n)===null&&(k(this,jo,t),k(this,Fc,await Dr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),P(this,Ci,R0).call(this))}toggleAltTextBadge(t=!1){var e;if(!f(this,Zi)||f(this,$n)){(e=f(this,Qi))==null||e.remove(),k(this,Qi,null);return}if(!f(this,Qi)){const r=k(this,Qi,document.createElement("div"));r.className="noAltTextBadge",f(this,Zr).div.append(r)}f(this,Qi).classList.toggle("hidden",!t)}serialize(t){let e=f(this,$n);return!t&&f(this,jo)===e&&(e=f(this,Fc)),{altText:e,decorative:f(this,qi),guessedText:f(this,jo),textWithDisclaimer:f(this,Fc)}}get data(){return{altText:f(this,$n),decorative:f(this,qi)}}set data({altText:t,decorative:e,guessedText:r,textWithDisclaimer:s,cancel:i=!1}){r&&(k(this,jo,r),k(this,Fc,s)),!(f(this,$n)===t&&f(this,qi)===e)&&(i||(k(this,$n,t),k(this,qi,e)),P(this,Ci,R0).call(this))}toggle(t=!1){f(this,fi)&&(!t&&f(this,gs)&&(clearTimeout(f(this,gs)),k(this,gs,null)),f(this,fi).disabled=!t)}shown(){f(this,Zr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:f(this,Ci,ap)}})}destroy(){var t,e;(t=f(this,fi))==null||t.remove(),k(this,fi,null),k(this,hh,null),k(this,Ji,null),(e=f(this,Qi))==null||e.remove(),k(this,Qi,null)}};$n=new WeakMap,qi=new WeakMap,fi=new WeakMap,hh=new WeakMap,Ji=new WeakMap,gs=new WeakMap,fh=new WeakMap,Qi=new WeakMap,Zr=new WeakMap,jo=new WeakMap,Fc=new WeakMap,Zi=new WeakMap,hl=new WeakMap,Ci=new WeakSet,ap=function(){return f(this,$n)&&"added"||f(this,$n)===null&&this.guessedText&&"review"||"missing"},R0=async function(){var s,i,o;const t=f(this,fi);if(!t)return;if(f(this,Zi)){if(t.classList.toggle("done",!!f(this,$n)),t.setAttribute("data-l10n-id",f(Dr,hl)[f(this,Ci,ap)]),(s=f(this,hh))==null||s.setAttribute("data-l10n-id",f(Dr,hl)[`${f(this,Ci,ap)}-label`]),!f(this,$n)){(i=f(this,Ji))==null||i.remove();return}}else{if(!f(this,$n)&&!f(this,qi)){t.classList.remove("done"),(o=f(this,Ji))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=f(this,Ji);if(!e){k(this,Ji,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${f(this,Zr).id}`;const a=100,l=f(this,Zr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(f(this,gs)),k(this,gs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{k(this,gs,setTimeout(()=>{k(this,gs,null),f(this,Ji).classList.add("show"),f(this,Zr)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),t.addEventListener("mouseleave",()=>{var c;f(this,gs)&&(clearTimeout(f(this,gs)),k(this,gs,null)),(c=f(this,Ji))==null||c.classList.remove("show")},{signal:l})}f(this,qi)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=f(this,$n)),e.parentNode||t.append(e);const r=f(this,Zr).getImageForAltText();r==null||r.setAttribute("aria-describedby",e.id)},M(Dr,hl,null),_t(Dr,"_l10n",null);let xv=Dr;var Kg,Bc,Gg,Yg,Xg,qg,Jg,ph,Ho,$c,fl,Ma,jD,HD,KS;const Lk=class Lk{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:r=null,onPinchStart:s=null,onPinching:i=null,onPinchEnd:o=null,signal:a}){M(this,Ma);M(this,Kg);M(this,Bc,!1);M(this,Gg,null);M(this,Yg);M(this,Xg);M(this,qg);M(this,Jg);M(this,ph);M(this,Ho,null);M(this,$c);M(this,fl,null);k(this,Kg,t),k(this,Gg,r),k(this,Yg,e),k(this,Xg,s),k(this,qg,i),k(this,Jg,o),k(this,$c,new AbortController),k(this,ph,AbortSignal.any([a,f(this,$c).signal])),t.addEventListener("touchstart",P(this,Ma,jD).bind(this),{passive:!1,signal:f(this,ph)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return he(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=f(this,$c))==null||t.abort(),k(this,$c,null)}};Kg=new WeakMap,Bc=new WeakMap,Gg=new WeakMap,Yg=new WeakMap,Xg=new WeakMap,qg=new WeakMap,Jg=new WeakMap,ph=new WeakMap,Ho=new WeakMap,$c=new WeakMap,fl=new WeakMap,Ma=new WeakSet,jD=function(t){var s,i,o;if((s=f(this,Yg))!=null&&s.call(this)||t.touches.length<2)return;if(!f(this,fl)){k(this,fl,new AbortController);const a=AbortSignal.any([f(this,ph),f(this,fl).signal]),l=f(this,Kg),c={signal:a,passive:!1};l.addEventListener("touchmove",P(this,Ma,HD).bind(this),c),l.addEventListener("touchend",P(this,Ma,KS).bind(this),c),l.addEventListener("touchcancel",P(this,Ma,KS).bind(this),c),(i=f(this,Xg))==null||i.call(this)}if(Ps(t),t.touches.length!==2||(o=f(this,Gg))!=null&&o.call(this)){k(this,Ho,null);return}let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]),k(this,Ho,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:r.screenX,touch1Y:r.screenY})},HD=function(t){var S;if(!f(this,Ho)||t.touches.length!==2)return;let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]);const{screenX:s,screenY:i}=e,{screenX:o,screenY:a}=r,l=f(this,Ho),{touch0X:c,touch0Y:u,touch1X:d,touch1Y:h}=l,p=d-c,g=h-u,m=o-s,b=a-i,y=Math.hypot(m,b)||1,v=Math.hypot(p,g)||1;if(!f(this,Bc)&&Math.abs(v-y)<=Lk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=i,l.touch1X=o,l.touch1Y=a,t.preventDefault(),!f(this,Bc)){k(this,Bc,!0);return}const x=[(s+o)/2,(i+a)/2];(S=f(this,qg))==null||S.call(this,x,v,y)},KS=function(t){var e;f(this,fl).abort(),k(this,fl,null),(e=f(this,Jg))==null||e.call(this),f(this,Ho)&&(t.preventDefault(),k(this,Ho,null),k(this,Bc,!1))};let Sv=Lk;var jc,pi,Ye,gh,pl,Qg,Hc,Zn,Vc,Vo,gl,Zg,zc,ms,tm,Uc,zo,to,mh,yh,Us,Wc,em,Rv,Lt,GS,nm,YS,D0,VD,zD,XS,N0,qS,UD,WD,KD,JS,GD,QS,YD,XD,qD,ZS,lp;const oe=class oe{constructor(t){M(this,Lt);M(this,jc,null);M(this,pi,null);M(this,Ye,null);M(this,gh,!1);M(this,pl,null);M(this,Qg,"");M(this,Hc,!1);M(this,Zn,null);M(this,Vc,null);M(this,Vo,null);M(this,gl,null);M(this,Zg,"");M(this,zc,!1);M(this,ms,null);M(this,tm,!1);M(this,Uc,!1);M(this,zo,!1);M(this,to,null);M(this,mh,0);M(this,yh,0);M(this,Us,null);M(this,Wc,null);_t(this,"_editToolbar",null);_t(this,"_initialOptions",Object.create(null));_t(this,"_initialData",null);_t(this,"_isVisible",!0);_t(this,"_uiManager",null);_t(this,"_focusEventsAllowed",!0);M(this,em,!1);M(this,Rv,oe._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:r,pageHeight:s,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,s],this.pageTranslation=[i,o];const[a,l]=this.parentDimensions;this.x=t.x/a,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=oe.prototype._resizeWithKeyboard,e=ed.TRANSLATE_SMALL,r=ed.TRANSLATE_BIG;return he(this,"_resizerKeyboardManager",new by([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,r]}],[["Escape","mac+Escape"],oe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return he(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new p9({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(oe._l10n??(oe._l10n=t),oe._l10nResizer||(oe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),oe._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);oe._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ve("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return f(this,em)}set _isDraggable(t){var e;k(this,em,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=f(this,Rv)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):P(this,Lt,lp).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(f(this,zc)?k(this,zc,!1):this.parent.setSelected(this))}focusout(t){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,r,s){const[i,o]=this.parentDimensions;[r,s]=this.screenToPageTranslation(r,s),this.x=(t+r)/i,this.y=(e+s)/o,this.fixAndSetPosition()}translate(t,e){P(this,Lt,GS).call(this,this.parentDimensions,t,e)}translateInPage(t,e){f(this,ms)||k(this,ms,[this.x,this.y,this.width,this.height]),P(this,Lt,GS).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){f(this,ms)||k(this,ms,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[s,i]}=this;if(this.x+=t/s,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,c]=this.getBaseTranslation();o+=l,a+=c;const{style:u}=r;u.left=`${(100*o).toFixed(2)}%`,u.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),r.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!f(this,ms)&&(f(this,ms)[0]!==this.x||f(this,ms)[1]!==this.y)}get _hasBeenResized(){return!!f(this,ms)&&(f(this,ms)[2]!==this.width||f(this,ms)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:r}=oe,s=r/t,i=r/e;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[r,s]}=this;let{x:i,y:o,width:a,height:l}=this;if(a*=r,l*=s,i*=r,o*=s,this._mustFixPosition)switch(t){case 0:i=Math.max(0,Math.min(r-a,i)),o=Math.max(0,Math.min(s-l,o));break;case 90:i=Math.max(0,Math.min(r-l,i)),o=Math.min(s,Math.max(a,o));break;case 180:i=Math.min(r,Math.max(a,i)),o=Math.min(s,Math.max(l,o));break;case 270:i=Math.min(r,Math.max(l,i)),o=Math.max(0,Math.min(s-a,o));break}this.x=i/=r,this.y=o/=s;const[c,u]=this.getBaseTranslation();i+=c,o+=u,e.left=`${(100*i).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var r;return P(r=oe,nm,YS).call(r,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var r;return P(r=oe,nm,YS).call(r,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,r]}=this;return[e*t,r*t]}setDims(t,e){const[r,s]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*t/r).toFixed(2)}%`,f(this,Hc)||(i.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:r}=t,s=r.endsWith("%"),i=!f(this,Hc)&&e.endsWith("%");if(s&&i)return;const[o,a]=this.parentDimensions;s||(t.width=`${(100*parseFloat(r)/o).toFixed(2)}%`),!f(this,Hc)&&!i&&(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=f(this,Ye))==null||t.finish()}async addEditToolbar(){return this._editToolbar||f(this,Uc)?this._editToolbar:(this._editToolbar=new LS(this),this.div.append(this._editToolbar.render()),f(this,Ye)&&await this._editToolbar.addAltText(f(this,Ye)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=f(this,Ye))==null||t.destroy())}addContainer(t){var r;const e=(r=this._editToolbar)==null?void 0:r.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){f(this,Ye)||(xv.initialize(oe._l10n),k(this,Ye,new xv(this)),f(this,jc)&&(f(this,Ye).data=f(this,jc),k(this,jc,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=f(this,Ye))==null?void 0:t.data}set altTextData(t){f(this,Ye)&&(f(this,Ye).data=t)}get guessedAltText(){var t;return(t=f(this,Ye))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=f(this,Ye))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=f(this,Ye))==null?void 0:e.serialize(t)}hasAltText(){return!!f(this,Ye)&&!f(this,Ye).isEmpty()}hasAltTextData(){var t;return((t=f(this,Ye))==null?void 0:t.hasData())??!1}render(){var i;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=f(this,gh)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),P(this,Lt,QS).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[r,s]=this.getInitialTranslation();return this.translate(r,s),wv(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(f(this,Wc)||k(this,Wc,new Sv({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:P(this,Lt,UD).bind(this),onPinching:P(this,Lt,WD).bind(this),onPinchEnd:P(this,Lt,KD).bind(this),signal:this._uiManager._signal}))),(i=this._uiManager._editorUndoBar)==null||i.hide(),this.div}pointerdown(t){const{isMac:e}=jr.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(k(this,zc,!0),this._isDraggable){P(this,Lt,GD).call(this,t);return}P(this,Lt,JS).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){f(this,to)&&clearTimeout(f(this,to)),k(this,to,setTimeout(()=>{var t;k(this,to,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,r){t.changeParent(this),this.x=e,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,r=this.rotation){const s=this.parentScale,[i,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=t/s,u=e/s,d=this.x*i,h=this.y*o,p=this.width*i,g=this.height*o;switch(r){case 0:return[d+c+a,o-h-u-g+l,d+c+p+a,o-h-u+l];case 90:return[d+u+a,o-h+c+l,d+u+g+a,o-h+c+p+l];case 180:return[d-c-p+a,o-h+u+l,d-c+a,o-h+u+g+l];case 270:return[d-u-g+a,o-h-c-p+l,d-u+a,o-h-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[r,s,i,o]=t,a=i-r,l=o-s;switch(this.rotation){case 0:return[r,e-o,a,l];case 90:return[r,e-s,l,a];case 180:return[i,e-s,a,l];case 270:return[i,e-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){k(this,Uc,!0)}disableEditMode(){k(this,Uc,!1)}isInEditMode(){return f(this,Uc)}shouldGetKeyboardEvents(){return f(this,zo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:r,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return e<o&&s>0&&t<i&&r>0}rebuild(){P(this,Lt,QS).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Ve("An editor must be serializable")}static async deserialize(t,e,r){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:r});s.rotation=t.rotation,k(s,jc,t.accessibilityData);const[i,o]=s.pageDimensions,[a,l,c,u]=s.getRectInCurrentCoords(t.rect,o);return s.x=a/i,s.y=l/o,s.width=c/i,s.height=u/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=f(this,gl))==null||t.abort(),k(this,gl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),f(this,to)&&(clearTimeout(f(this,to)),k(this,to,null)),P(this,Lt,lp).call(this),this.removeEditToolbar(),f(this,Us)){for(const r of f(this,Us).values())clearTimeout(r);k(this,Us,null)}this.parent=null,(e=f(this,Wc))==null||e.destroy(),k(this,Wc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(P(this,Lt,VD).call(this),f(this,Zn).classList.remove("hidden"),wv(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),k(this,Vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=f(this,Zn).children;if(!f(this,pi)){k(this,pi,Array.from(e));const o=P(this,Lt,YD).bind(this),a=P(this,Lt,XD).bind(this),l=this._uiManager._signal;for(const c of f(this,pi)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",P(this,Lt,qD).bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",oe._l10nResizer[u])}}const r=f(this,pi)[0];let s=0;for(const o of e){if(o===r)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(f(this,pi).length/4);if(i!==s){if(i<s)for(let a=0;a<s-i;a++)f(this,Zn).append(f(this,Zn).firstChild);else if(i>s)for(let a=0;a<i-s;a++)f(this,Zn).firstChild.before(f(this,Zn).lastChild);let o=0;for(const a of e){const c=f(this,pi)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",oe._l10nResizer[c])}}P(this,Lt,ZS).call(this,0),k(this,zo,!0),f(this,Zn).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){f(this,zo)&&P(this,Lt,qS).call(this,f(this,Zg),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){P(this,Lt,lp).call(this),this.div.focus()}select(){var t,e,r;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,i;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(e=this._editToolbar)==null||e.show(),(r=f(this,Ye))==null||r.toggleAltTextBadge(!1)}unselect(){var t,e,r,s,i;(t=f(this,Zn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(i=f(this,Ye))==null||i.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return f(this,tm)}set isEditing(t){k(this,tm,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){k(this,Hc,!0);const r=t/e,{style:s}=this.div;s.aspectRatio=r,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){f(this,Us)||k(this,Us,new Map);const{action:r}=t;let s=f(this,Us).get(r);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),f(this,Us).delete(r),f(this,Us).size===0&&k(this,Us,null)},oe._telemetryTimeout),f(this,Us).set(r,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),k(this,gh,!1)}disable(){this.div&&(this.div.tabIndex=-1),k(this,gh,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const r=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),r.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};jc=new WeakMap,pi=new WeakMap,Ye=new WeakMap,gh=new WeakMap,pl=new WeakMap,Qg=new WeakMap,Hc=new WeakMap,Zn=new WeakMap,Vc=new WeakMap,Vo=new WeakMap,gl=new WeakMap,Zg=new WeakMap,zc=new WeakMap,ms=new WeakMap,tm=new WeakMap,Uc=new WeakMap,zo=new WeakMap,to=new WeakMap,mh=new WeakMap,yh=new WeakMap,Us=new WeakMap,Wc=new WeakMap,em=new WeakMap,Rv=new WeakMap,Lt=new WeakSet,GS=function([t,e],r,s){[r,s]=this.screenToPageTranslation(r,s),this.x+=r/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},nm=new WeakSet,YS=function(t,e,r){switch(r){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},D0=function(t){switch(t){case 90:{const[e,r]=this.pageDimensions;return[0,-e/r,r/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,r]=this.pageDimensions;return[0,e/r,-r/e,0]}default:return[1,0,0,1]}},VD=function(){if(f(this,Zn))return;k(this,Zn,document.createElement("div")),f(this,Zn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const r of t){const s=document.createElement("div");f(this,Zn).append(s),s.classList.add("resizer",r),s.setAttribute("data-resizer-name",r),s.addEventListener("pointerdown",P(this,Lt,zD).bind(this,r),{signal:e}),s.addEventListener("contextmenu",Di,{signal:e}),s.tabIndex=-1}this.div.prepend(f(this,Zn))},zD=function(t,e){var u;e.preventDefault();const{isMac:r}=jr.platform;if(e.button!==0||e.ctrlKey&&r)return;(u=f(this,Ye))==null||u.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,k(this,Vc,[e.screenX,e.screenY]);const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",P(this,Lt,qS).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Ps,{passive:!1,signal:o}),window.addEventListener("contextmenu",Di,{signal:o}),k(this,Vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const c=()=>{var d;i.abort(),this.parent.togglePointerEvents(!0),(d=f(this,Ye))==null||d.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,P(this,Lt,N0).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})},XS=function(t,e,r,s){this.width=r,this.height=s,this.x=t,this.y=e;const[i,o]=this.parentDimensions;this.setDims(i*r,o*s),this.fixAndSetPosition(),this._onResized()},N0=function(){if(!f(this,Vo))return;const{savedX:t,savedY:e,savedWidth:r,savedHeight:s}=f(this,Vo);k(this,Vo,null);const i=this.x,o=this.y,a=this.width,l=this.height;i===t&&o===e&&a===r&&l===s||this.addCommands({cmd:P(this,Lt,XS).bind(this,i,o,a,l),undo:P(this,Lt,XS).bind(this,t,e,r,s),mustExec:!0})},qS=function(t,e){const[r,s]=this.parentDimensions,i=this.x,o=this.y,a=this.width,l=this.height,c=oe.MIN_SIZE/r,u=oe.MIN_SIZE/s,d=P(this,Lt,D0).call(this,this.rotation),h=(_,j)=>[d[0]*_+d[2]*j,d[1]*_+d[3]*j],p=P(this,Lt,D0).call(this,360-this.rotation),g=(_,j)=>[p[0]*_+p[2]*j,p[1]*_+p[3]*j];let m,b,y=!1,v=!1;switch(t){case"topLeft":y=!0,m=(_,j)=>[0,0],b=(_,j)=>[_,j];break;case"topMiddle":m=(_,j)=>[_/2,0],b=(_,j)=>[_/2,j];break;case"topRight":y=!0,m=(_,j)=>[_,0],b=(_,j)=>[0,j];break;case"middleRight":v=!0,m=(_,j)=>[_,j/2],b=(_,j)=>[0,j/2];break;case"bottomRight":y=!0,m=(_,j)=>[_,j],b=(_,j)=>[0,0];break;case"bottomMiddle":m=(_,j)=>[_/2,j],b=(_,j)=>[_/2,0];break;case"bottomLeft":y=!0,m=(_,j)=>[0,j],b=(_,j)=>[_,0];break;case"middleLeft":v=!0,m=(_,j)=>[0,j/2],b=(_,j)=>[_,j/2];break}const x=m(a,l),S=b(a,l);let w=h(...S);const E=oe._round(i+w[0]),T=oe._round(o+w[1]);let I=1,C=1,R,N;if(e.fromKeyboard)({deltaX:R,deltaY:N}=e);else{const{screenX:_,screenY:j}=e,[X,wt]=f(this,Vc);[R,N]=this.screenToPageTranslation(_-X,j-wt),f(this,Vc)[0]=_,f(this,Vc)[1]=j}if([R,N]=g(R/r,N/s),y){const _=Math.hypot(a,l);I=C=Math.max(Math.min(Math.hypot(S[0]-x[0]-R,S[1]-x[1]-N)/_,1/a,1/l),c/a,u/l)}else v?I=Math.max(c,Math.min(1,Math.abs(S[0]-x[0]-R)))/a:C=Math.max(u,Math.min(1,Math.abs(S[1]-x[1]-N)))/l;const B=oe._round(a*I),$=oe._round(l*C);w=h(...b(B,$));const L=E-w[0],F=T-w[1];f(this,ms)||k(this,ms,[this.x,this.y,this.width,this.height]),this.width=B,this.height=$,this.x=L,this.y=F,this.setDims(r*B,s*$),this.fixAndSetPosition(),this._onResizing()},UD=function(){var t;k(this,Vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=f(this,Ye))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},WD=function(t,e,r){let i=.7*(r/e)+1-.7;if(i===1)return;const o=P(this,Lt,D0).call(this,this.rotation),a=(E,T)=>[o[0]*E+o[2]*T,o[1]*E+o[3]*T],[l,c]=this.parentDimensions,u=this.x,d=this.y,h=this.width,p=this.height,g=oe.MIN_SIZE/l,m=oe.MIN_SIZE/c;i=Math.max(Math.min(i,1/h,1/p),g/h,m/p);const b=oe._round(h*i),y=oe._round(p*i);if(b===h&&y===p)return;f(this,ms)||k(this,ms,[u,d,h,p]);const v=a(h/2,p/2),x=oe._round(u+v[0]),S=oe._round(d+v[1]),w=a(b/2,y/2);this.x=x-w[0],this.y=S-w[1],this.width=b,this.height=y,this.setDims(l*b,c*y),this.fixAndSetPosition(),this._onResizing()},KD=function(){var t;(t=f(this,Ye))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),P(this,Lt,N0).call(this)},JS=function(t){const{isMac:e}=jr.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},GD=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let r=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:i},a=c=>{s.abort(),k(this,pl,null),k(this,zc,!1),this._uiManager.endDragSession()||P(this,Lt,JS).call(this,c),r&&this._onStopDragging()};e&&(k(this,mh,t.clientX),k(this,yh,t.clientY),k(this,pl,t.pointerId),k(this,Qg,t.pointerType),window.addEventListener("pointermove",c=>{r||(r=!0,this._onStartDragging());const{clientX:u,clientY:d,pointerId:h}=c;if(h!==f(this,pl)){Ps(c);return}const[p,g]=this.screenToPageTranslation(u-f(this,mh),d-f(this,yh));k(this,mh,u),k(this,yh,d),this._uiManager.dragSelectedEditors(p,g)},o),window.addEventListener("touchmove",Ps,o),window.addEventListener("pointerdown",c=>{c.pointerType===f(this,Qg)&&(f(this,Wc)||c.isPrimary)&&a(c),Ps(c)},o));const l=c=>{if(!f(this,pl)||f(this,pl)===c.pointerId){a(c);return}Ps(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},QS=function(){if(f(this,gl)||!this.div)return;k(this,gl,new AbortController);const t=this._uiManager.combinedSignal(f(this,gl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},YD=function(t){oe._resizerKeyboardManager.exec(this,t)},XD=function(t){var e;f(this,zo)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==f(this,Zn)&&P(this,Lt,lp).call(this)},qD=function(t){k(this,Zg,f(this,zo)?t:"")},ZS=function(t){if(f(this,pi))for(const e of f(this,pi))e.tabIndex=t},lp=function(){k(this,zo,!1),P(this,Lt,ZS).call(this,-1),P(this,Lt,N0).call(this)},M(oe,nm),_t(oe,"_l10n",null),_t(oe,"_l10nResizer",null),_t(oe,"_borderLineWidth",-1),_t(oe,"_colorManager",new $S),_t(oe,"_zIndex",1),_t(oe,"_telemetryTimeout",1e3);let un=oe;class p9 extends un{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const KM=3285377520,js=4294901760,Fi=65535;class JD{constructor(t){this.h1=t?t&4294967295:KM,this.h2=t?t&4294967295:KM}update(t){let e,r;if(typeof t=="string"){e=new Uint8Array(t.length*2),r=0;for(let m=0,b=t.length;m<b;m++){const y=t.charCodeAt(m);y<=255?e[r++]=y:(e[r++]=y>>>8,e[r++]=y&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),r=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=r>>2,i=r-s*4,o=new Uint32Array(e.buffer,0,s);let a=0,l=0,c=this.h1,u=this.h2;const d=3432918353,h=461845907,p=d&Fi,g=h&Fi;for(let m=0;m<s;m++)m&1?(a=o[m],a=a*d&js|a*p&Fi,a=a<<15|a>>>17,a=a*h&js|a*g&Fi,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[m],l=l*d&js|l*p&Fi,l=l<<15|l>>>17,l=l*h&js|l*g&Fi,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(a=0,i){case 3:a^=e[s*4+2]<<16;case 2:a^=e[s*4+1]<<8;case 1:a^=e[s*4],a=a*d&js|a*p&Fi,a=a<<15|a>>>17,a=a*h&js|a*g&Fi,s&1?c^=a:u^=a}this.h1=c,this.h2=u}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&js|t*36045&Fi,e=e*4283543511&js|((e<<16|t>>>16)*2950163797&js)>>>16,t^=e>>>1,t=t*444984403&js|t*60499&Fi,e=e*3301882366&js|((e<<16|t>>>16)*3120437893&js)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const tA=Object.freeze({map:null,hash:"",transfer:void 0});var Kc,Gc,jn,Dv,QD;class Pk{constructor(){M(this,Dv);M(this,Kc,!1);M(this,Gc,null);M(this,jn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const r=f(this,jn).get(t);return r===void 0?e:Object.assign(e,r)}getRawValue(t){return f(this,jn).get(t)}remove(t){if(f(this,jn).delete(t),f(this,jn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of f(this,jn).values())if(e instanceof un)return;this.onAnnotationEditor(null)}}setValue(t,e){const r=f(this,jn).get(t);let s=!1;if(r!==void 0)for(const[i,o]of Object.entries(e))r[i]!==o&&(s=!0,r[i]=o);else s=!0,f(this,jn).set(t,e);s&&P(this,Dv,QD).call(this),e instanceof un&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return f(this,jn).has(t)}getAll(){return f(this,jn).size>0?Ak(f(this,jn)):null}setAll(t){for(const[e,r]of Object.entries(t))this.setValue(e,r)}get size(){return f(this,jn).size}resetModified(){f(this,Kc)&&(k(this,Kc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ZD(this)}get serializable(){if(f(this,jn).size===0)return tA;const t=new Map,e=new JD,r=[],s=Object.create(null);let i=!1;for(const[o,a]of f(this,jn)){const l=a instanceof un?a.serialize(!1,s):a;l&&(t.set(o,l),e.update(`${o}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const o of t.values())o.bitmap&&r.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:r}:tA}get editorStats(){let t=null;const e=new Map;for(const r of f(this,jn).values()){if(!(r instanceof un))continue;const s=r.telemetryFinalData;if(!s)continue;const{type:i}=s;e.has(i)||e.set(i,Object.getPrototypeOf(r).constructor),t||(t=Object.create(null));const o=t[i]||(t[i]=new Map);for(const[a,l]of Object.entries(s)){if(a==="type")continue;let c=o.get(a);c||(c=new Map,o.set(a,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[r,s]of e)t[r]=s.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){k(this,Gc,null)}get modifiedIds(){if(f(this,Gc))return f(this,Gc);const t=[];for(const e of f(this,jn).values())!(e instanceof un)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return k(this,Gc,{ids:new Set(t),hash:t.join(",")})}}Kc=new WeakMap,Gc=new WeakMap,jn=new WeakMap,Dv=new WeakSet,QD=function(){f(this,Kc)||(k(this,Kc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var rm;class ZD extends Pk{constructor(e){super();M(this,rm);const{map:r,hash:s,transfer:i}=e.serializable,o=structuredClone(r,i?{transfer:i}:null);k(this,rm,{map:o,hash:s,transfer:i})}get print(){Ve("Should not call PrintAnnotationStorage.print")}get serializable(){return f(this,rm)}get modifiedIds(){return he(this,"modifiedIds",{ids:new Set,hash:""})}}rm=new WeakMap;var bh;class g9{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){M(this,bh,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),f(this,bh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||f(this,bh).has(t.loadedName))){if(En(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:s,style:i}=t,o=new FontFace(r,s,i);this.addNativeFontFace(o);try{await o.load(),f(this,bh).add(r),e==null||e(t)}catch{ne(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ve("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(s){throw ne(`Failed to load font '${r.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const s=this._queueLoadingCallback(r);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return he(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Er||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),he(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(En(!s.done,"completeRequest() cannot be called twice."),s.done=!0;r.length>0&&r[0].done;){const i=r.shift();setTimeout(i.callback,0)}}const{loadingRequests:r}=this,s={done:!1,complete:e,callback:t};return r.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return he(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function r(S,w){return S.charCodeAt(w)<<24|S.charCodeAt(w+1)<<16|S.charCodeAt(w+2)<<8|S.charCodeAt(w+3)&255}function s(S,w,E,T){const I=S.substring(0,w),C=S.substring(w+E);return I+T+C}let i,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function u(S,w){if(++c>30){ne("Load test font never loaded."),w();return}if(l.font="30px "+S,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){w();return}setTimeout(u.bind(null,S,w))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=s(h,976,d.length,d);const g=16,m=1482184792;let b=r(h,g);for(i=0,o=d.length-3;i<o;i+=4)b=b-m+r(d,i)|0;i<d.length&&(b=b-m+r(d+"XXX",i)|0),h=s(h,g,4,t9(b));const y=`url(data:font/opentype;base64,${btoa(h)});`,v=`@font-face {font-family:"${d}";src:${y}}`;this.insertRule(v);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const S of[t.loadedName,d]){const w=this._document.createElement("span");w.textContent="Hi",w.style.fontFamily=S,x.append(w)}this._document.body.append(x),u(d,()=>{x.remove(),e.complete()})}}bh=new WeakMap;class m9{constructor(t,{disableFontFace:e=!1,fontExtraProperties:r=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this.disableFontFace=e===!0,this.fontExtraProperties=r===!0,this._inspectFont=s}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${o9(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return(r=this._inspectFont)==null||r.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const r=this.loadedName+"_path_"+e;let s;try{s=t.get(r)}catch(o){ne(`getPathGenerator - ignoring character: "${o}".`)}const i=new Path2D(s||"");return this.fontExtraProperties||t.delete(r),this.compiledGlyphs[e]=i}}const t0={DATA:1,ERROR:2},Sn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function GM(){}function Jr(n){if(n instanceof ec||n instanceof DS||n instanceof Mg||n instanceof zM||n instanceof vv||n instanceof Jx)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ve('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new ec(n.message);case"InvalidPDFException":return new DS(n.message);case"MissingPDFException":return new Mg(n.message);case"PasswordException":return new zM(n.message,n.code);case"UnexpectedResponseException":return new vv(n.message,n.status);case"UnknownErrorException":return new Jx(n.message,n.details)}return new Jx(n.message,n.toString())}var vh,si,tN,eN,nN,_0;class cp{constructor(t,e,r){M(this,si);M(this,vh,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",P(this,si,tN).bind(this),{signal:f(this,vh).signal})}on(t,e){const r=this.actionHandler;if(r[t])throw new Error(`There is already an actionName called "${t}"`);r[t]=e}send(t,e,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},r)}sendWithPromise(t,e,r){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},r)}catch(o){i.reject(o)}return i.promise}sendWithStream(t,e,r,s){const i=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:t,streamId:i,data:e,desiredSize:c.desiredSize},s),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[i].pullCall=u,l.postMessage({sourceName:o,targetName:a,stream:Sn.PULL,streamId:i,desiredSize:c.desiredSize}),u.promise},cancel:c=>{En(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[i].cancelCall=u,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Sn.CANCEL,streamId:i,reason:Jr(c)}),u.promise}},r)}destroy(){var t;(t=f(this,vh))==null||t.abort(),k(this,vh,null)}}vh=new WeakMap,si=new WeakSet,tN=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){P(this,si,nN).call(this,t);return}if(t.callback){const r=t.callbackId,s=this.callbackCapabilities[r];if(!s)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],t.callback===t0.DATA)s.resolve(t.data);else if(t.callback===t0.ERROR)s.reject(Jr(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const r=this.sourceName,s=t.sourceName,i=this.comObj;Promise.try(e,t.data).then(function(o){i.postMessage({sourceName:r,targetName:s,callback:t0.DATA,callbackId:t.callbackId,data:o})},function(o){i.postMessage({sourceName:r,targetName:s,callback:t0.ERROR,callbackId:t.callbackId,reason:Jr(o)})});return}if(t.streamId){P(this,si,eN).call(this,t);return}e(t.data)},eN=function(t){const e=t.streamId,r=this.sourceName,s=t.sourceName,i=this.comObj,o=this,a=this.actionHandler[t.action],l={enqueue(c,u=1,d){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=u,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:r,targetName:s,stream:Sn.ENQUEUE,streamId:e,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:s,stream:Sn.CLOSE,streamId:e}),delete o.streamSinks[e])},error(c){En(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:s,stream:Sn.ERROR,streamId:e,reason:Jr(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,Promise.try(a,t.data,l).then(function(){i.postMessage({sourceName:r,targetName:s,stream:Sn.START_COMPLETE,streamId:e,success:!0})},function(c){i.postMessage({sourceName:r,targetName:s,stream:Sn.START_COMPLETE,streamId:e,reason:Jr(c)})})},nN=function(t){const e=t.streamId,r=this.sourceName,s=t.sourceName,i=this.comObj,o=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case Sn.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Jr(t.reason));break;case Sn.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Jr(t.reason));break;case Sn.PULL:if(!a){i.postMessage({sourceName:r,targetName:s,stream:Sn.PULL_COMPLETE,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||GM).then(function(){i.postMessage({sourceName:r,targetName:s,stream:Sn.PULL_COMPLETE,streamId:e,success:!0})},function(c){i.postMessage({sourceName:r,targetName:s,stream:Sn.PULL_COMPLETE,streamId:e,reason:Jr(c)})});break;case Sn.ENQUEUE:if(En(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Sn.CLOSE:if(En(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),P(this,si,_0).call(this,o,e);break;case Sn.ERROR:En(o,"error should have stream controller"),o.controller.error(Jr(t.reason)),P(this,si,_0).call(this,o,e);break;case Sn.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Jr(t.reason)),P(this,si,_0).call(this,o,e);break;case Sn.CANCEL:if(!a)break;const l=Jr(t.reason);Promise.try(a.onCancel||GM,l).then(function(){i.postMessage({sourceName:r,targetName:s,stream:Sn.CANCEL_COMPLETE,streamId:e,success:!0})},function(c){i.postMessage({sourceName:r,targetName:s,stream:Sn.CANCEL_COMPLETE,streamId:e,reason:Jr(c)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},_0=async function(t,e){var r,s,i;await Promise.allSettled([(r=t.startCall)==null?void 0:r.promise,(s=t.pullCall)==null?void 0:s.promise,(i=t.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[e]};var sm;class rN{constructor({enableHWA:t=!1}){M(this,sm,!1);k(this,sm,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(t,e);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!f(this,sm)})}}reset(t,e,r){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||r<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=r}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ve("Abstract method `_createCanvas` called.")}}sm=new WeakMap;class y9 extends rN{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const r=this._document.createElement("canvas");return r.width=t,r.height=e,r}}class sN{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ve("Abstract method `_fetch` called.")}}class iN extends sN{async _fetch(t){const e=await $w(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Bw(e)}}class oN{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,r,s,i){return"none"}destroy(t=!1){}}var Yc,wh,Uo,Wo,gr,Xc,qc,gt,hr,up,Id,L0,Rd,aN,eA,Dd,dp,hp,nA,fp;class b9 extends oN{constructor({docId:e,ownerDocument:r=globalThis.document}){super();M(this,gt);M(this,Yc);M(this,wh);M(this,Uo);M(this,Wo);M(this,gr);M(this,Xc);M(this,qc,0);k(this,Wo,e),k(this,gr,r)}addFilter(e){if(!e)return"none";let r=f(this,gt,hr).get(e);if(r)return r;const[s,i,o]=P(this,gt,L0).call(this,e),a=e.length===1?s:`${s}${i}${o}`;if(r=f(this,gt,hr).get(a),r)return f(this,gt,hr).set(e,r),r;const l=`g_${f(this,Wo)}_transfer_map_${Pr(this,qc)._++}`,c=P(this,gt,Rd).call(this,l);f(this,gt,hr).set(e,c),f(this,gt,hr).set(a,c);const u=P(this,gt,Dd).call(this,l);return P(this,gt,hp).call(this,s,i,o,u),c}addHCMFilter(e,r){var g;const s=`${e}-${r}`,i="base";let o=f(this,gt,up).get(i);if((o==null?void 0:o.key)===s||(o?((g=o.filter)==null||g.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},f(this,gt,up).set(i,o)),!e||!r))return o.url;const a=P(this,gt,fp).call(this,e);e=Mt.makeHexColor(...a);const l=P(this,gt,fp).call(this,r);if(r=Mt.makeHexColor(...l),f(this,gt,Id).style.color="",e==="#000000"&&r==="#ffffff"||e===r)return o.url;const c=new Array(256);for(let m=0;m<=255;m++){const b=m/255;c[m]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const u=c.join(","),d=`g_${f(this,Wo)}_hcm_filter`,h=o.filter=P(this,gt,Dd).call(this,d);P(this,gt,hp).call(this,u,u,u,h),P(this,gt,eA).call(this,h);const p=(m,b)=>{const y=a[m]/255,v=l[m]/255,x=new Array(b+1);for(let S=0;S<=b;S++)x[S]=y+S/b*(v-y);return x.join(",")};return P(this,gt,hp).call(this,p(0,5),p(1,5),p(2,5),h),o.url=P(this,gt,Rd).call(this,d),o.url}addAlphaFilter(e){let r=f(this,gt,hr).get(e);if(r)return r;const[s]=P(this,gt,L0).call(this,[e]),i=`alpha_${s}`;if(r=f(this,gt,hr).get(i),r)return f(this,gt,hr).set(e,r),r;const o=`g_${f(this,Wo)}_alpha_map_${Pr(this,qc)._++}`,a=P(this,gt,Rd).call(this,o);f(this,gt,hr).set(e,a),f(this,gt,hr).set(i,a);const l=P(this,gt,Dd).call(this,o);return P(this,gt,nA).call(this,s,l),a}addLuminosityFilter(e){let r=f(this,gt,hr).get(e||"luminosity");if(r)return r;let s,i;if(e?([s]=P(this,gt,L0).call(this,[e]),i=`luminosity_${s}`):i="luminosity",r=f(this,gt,hr).get(i),r)return f(this,gt,hr).set(e,r),r;const o=`g_${f(this,Wo)}_luminosity_map_${Pr(this,qc)._++}`,a=P(this,gt,Rd).call(this,o);f(this,gt,hr).set(e,a),f(this,gt,hr).set(i,a);const l=P(this,gt,Dd).call(this,o);return P(this,gt,aN).call(this,l),e&&P(this,gt,nA).call(this,s,l),a}addHighlightHCMFilter(e,r,s,i,o){var v;const a=`${r}-${s}-${i}-${o}`;let l=f(this,gt,up).get(e);if((l==null?void 0:l.key)===a||(l?((v=l.filter)==null||v.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},f(this,gt,up).set(e,l)),!r||!s))return l.url;const[c,u]=[r,s].map(P(this,gt,fp).bind(this));let d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,g]=[i,o].map(P(this,gt,fp).bind(this));h<d&&([d,h,p,g]=[h,d,g,p]),f(this,gt,Id).style.color="";const m=(x,S,w)=>{const E=new Array(256),T=(h-d)/w,I=x/255,C=(S-x)/(255*w);let R=0;for(let N=0;N<=w;N++){const B=Math.round(d+N*T),$=I+N*C;for(let L=R;L<=B;L++)E[L]=$;R=B+1}for(let N=R;N<256;N++)E[N]=E[R-1];return E.join(",")},b=`g_${f(this,Wo)}_hcm_${e}_filter`,y=l.filter=P(this,gt,Dd).call(this,b);return P(this,gt,eA).call(this,y),P(this,gt,hp).call(this,m(p[0],g[0],5),m(p[1],g[1],5),m(p[2],g[2],5),y),l.url=P(this,gt,Rd).call(this,b),l.url}destroy(e=!1){var r,s,i,o;e&&((r=f(this,Xc))!=null&&r.size)||((s=f(this,Uo))==null||s.parentNode.parentNode.remove(),k(this,Uo,null),(i=f(this,wh))==null||i.clear(),k(this,wh,null),(o=f(this,Xc))==null||o.clear(),k(this,Xc,null),k(this,qc,0))}}Yc=new WeakMap,wh=new WeakMap,Uo=new WeakMap,Wo=new WeakMap,gr=new WeakMap,Xc=new WeakMap,qc=new WeakMap,gt=new WeakSet,hr=function(){return f(this,wh)||k(this,wh,new Map)},up=function(){return f(this,Xc)||k(this,Xc,new Map)},Id=function(){if(!f(this,Uo)){const e=f(this,gr).createElement("div"),{style:r}=e;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const s=f(this,gr).createElementNS(Po,"svg");s.setAttribute("width",0),s.setAttribute("height",0),k(this,Uo,f(this,gr).createElementNS(Po,"defs")),e.append(s),s.append(f(this,Uo)),f(this,gr).body.append(e)}return f(this,Uo)},L0=function(e){if(e.length===1){const c=e[0],u=new Array(256);for(let h=0;h<256;h++)u[h]=c[h]/255;const d=u.join(",");return[d,d,d]}const[r,s,i]=e,o=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)o[c]=r[c]/255,a[c]=s[c]/255,l[c]=i[c]/255;return[o.join(","),a.join(","),l.join(",")]},Rd=function(e){if(f(this,Yc)===void 0){k(this,Yc,"");const r=f(this,gr).URL;r!==f(this,gr).baseURI&&(jw(r)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):k(this,Yc,r.split("#",1)[0]))}return`url(${f(this,Yc)}#${e})`},aN=function(e){const r=f(this,gr).createElementNS(Po,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(r)},eA=function(e){const r=f(this,gr).createElementNS(Po,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(r)},Dd=function(e){const r=f(this,gr).createElementNS(Po,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",e),f(this,gt,Id).append(r),r},dp=function(e,r,s){const i=f(this,gr).createElementNS(Po,r);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),e.append(i)},hp=function(e,r,s,i){const o=f(this,gr).createElementNS(Po,"feComponentTransfer");i.append(o),P(this,gt,dp).call(this,o,"feFuncR",e),P(this,gt,dp).call(this,o,"feFuncG",r),P(this,gt,dp).call(this,o,"feFuncB",s)},nA=function(e,r){const s=f(this,gr).createElementNS(Po,"feComponentTransfer");r.append(s),P(this,gt,dp).call(this,s,"feFuncA",e)},fp=function(e){return f(this,gt,Id).style.color=e,Mk(getComputedStyle(f(this,gt,Id)).getPropertyValue("color"))};class lN{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ve("Abstract method `_fetch` called.")}}class cN extends lN{async _fetch(t){const e=await $w(t,"arraybuffer");return new Uint8Array(e)}}Er&&ne("Please use the `legacy` build in Node.js environments.");async function uN(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class v9 extends oN{}class w9 extends rN{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class x9 extends sN{async _fetch(t){return uN(t)}}class S9 extends lN{async _fetch(t){return uN(t)}}const wr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function rA(n,t){if(!t)return;const e=t[2]-t[0],r=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,r),n.clip(s)}class Ok{getPattern(){Ve("Abstract method `getPattern` called.")}}class A9 extends Ok{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)e.addColorStop(r[0],r[1]);return e}getPattern(t,e,r,s){let i;if(s===wr.STROKE||s===wr.FILL){const o=e.current.getClippedPathBoundingBox(s,tn(t))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=e.cachedCanvases.getCanvas("pattern",a,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),r=Mt.transform(r,[1,0,0,1,o[0],o[1]]),u.transform(...e.baseTransform),this.matrix&&u.transform(...this.matrix),rA(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),i=t.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(r);i.setTransform(d)}else rA(t,this._bbox),i=this._createGradient(t);return i}}function t1(n,t,e,r,s,i,o,a){const l=t.coords,c=t.colors,u=n.data,d=n.width*4;let h;l[e+1]>l[r+1]&&(h=e,e=r,r=h,h=i,i=o,o=h),l[r+1]>l[s+1]&&(h=r,r=s,s=h,h=o,o=a,a=h),l[e+1]>l[r+1]&&(h=e,e=r,r=h,h=i,i=o,o=h);const p=(l[e]+t.offsetX)*t.scaleX,g=(l[e+1]+t.offsetY)*t.scaleY,m=(l[r]+t.offsetX)*t.scaleX,b=(l[r+1]+t.offsetY)*t.scaleY,y=(l[s]+t.offsetX)*t.scaleX,v=(l[s+1]+t.offsetY)*t.scaleY;if(g>=v)return;const x=c[i],S=c[i+1],w=c[i+2],E=c[o],T=c[o+1],I=c[o+2],C=c[a],R=c[a+1],N=c[a+2],B=Math.round(g),$=Math.round(v);let L,F,_,j,X,wt,qt,$t;for(let Pt=B;Pt<=$;Pt++){if(Pt<b){const z=Pt<g?0:(g-Pt)/(g-b);L=p-(p-m)*z,F=x-(x-E)*z,_=S-(S-T)*z,j=w-(w-I)*z}else{let z;Pt>v?z=1:b===v?z=0:z=(b-Pt)/(b-v),L=m-(m-y)*z,F=E-(E-C)*z,_=T-(T-R)*z,j=I-(I-N)*z}let jt;Pt<g?jt=0:Pt>v?jt=1:jt=(g-Pt)/(g-v),X=p-(p-y)*jt,wt=x-(x-C)*jt,qt=S-(S-R)*jt,$t=w-(w-N)*jt;const me=Math.round(Math.min(L,X)),xe=Math.round(Math.max(L,X));let Ot=d*Pt+me*4;for(let z=me;z<=xe;z++)jt=(L-z)/(L-X),jt<0?jt=0:jt>1&&(jt=1),u[Ot++]=F-(F-wt)*jt|0,u[Ot++]=_-(_-qt)*jt|0,u[Ot++]=j-(j-$t)*jt|0,u[Ot++]=255}}function E9(n,t,e){const r=t.coords,s=t.colors;let i,o;switch(t.type){case"lattice":const a=t.verticesPerRow,l=Math.floor(r.length/a)-1,c=a-1;for(i=0;i<l;i++){let u=i*a;for(let d=0;d<c;d++,u++)t1(n,e,r[u],r[u+1],r[u+a],s[u],s[u+1],s[u+a]),t1(n,e,r[u+a+1],r[u+1],r[u+a],s[u+a+1],s[u+1],s[u+a])}break;case"triangles":for(i=0,o=r.length;i<o;i+=3)t1(n,e,r[i],r[i+1],r[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}class k9 extends Ok{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,r){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,u=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(u*t[1]*1.1)),3e3),p=c/d,g=u/h,m={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/p,scaleY:1/g},b=d+2*2,y=h+2*2,v=r.getCanvas("mesh",b,y),x=v.context,S=x.createImageData(d,h);if(e){const E=S.data;for(let T=0,I=E.length;T<I;T+=4)E[T]=e[0],E[T+1]=e[1],E[T+2]=e[2],E[T+3]=255}for(const E of this._figures)E9(S,E,m);return x.putImageData(S,2,2),{canvas:v.canvas,offsetX:a-2*p,offsetY:l-2*g,scaleX:p,scaleY:g}}getPattern(t,e,r,s){rA(t,this._bbox);let i;if(s===wr.SHADING)i=Mt.singularValueDecompose2dScale(tn(t));else if(i=Mt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const a=Mt.singularValueDecompose2dScale(this.matrix);i=[i[0]*a[0],i[1]*a[1]]}const o=this._createMeshCanvas(i,s===wr.SHADING?null:this._background,e.cachedCanvases);return s!==wr.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class C9 extends Ok{getPattern(){return"hotpink"}}function T9(n){switch(n[0]){case"RadialAxial":return new A9(n);case"Mesh":return new k9(n);case"Dummy":return new C9}throw new Error(`Unknown IR type: ${n[0]}`)}const YM={COLORED:1,UNCOLORED:2},Nv=class Nv{constructor(t,e,r,s,i){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=r,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:r,paintType:s,tilingType:i,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Fw("TilingType: "+i);const u=e[0],d=e[1],h=e[2],p=e[3],g=h-u,m=p-d,b=Mt.singularValueDecompose2dScale(this.matrix),y=Mt.singularValueDecompose2dScale(this.baseTransform),v=b[0]*y[0],x=b[1]*y[1];let S=g,w=m,E=!1,T=!1;const I=Math.ceil(l*v),C=Math.ceil(c*x),R=Math.ceil(g*v),N=Math.ceil(m*x);I>=R?S=l:E=!0,C>=N?w=c:T=!0;const B=this.getSizeAndScale(S,this.ctx.canvas.width,v),$=this.getSizeAndScale(w,this.ctx.canvas.height,x),L=t.cachedCanvases.getCanvas("pattern",B.size,$.size),F=L.context,_=a.createCanvasGraphics(F);if(_.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(_,s,o),F.translate(-B.scale*u,-$.scale*d),_.transform(B.scale,0,0,$.scale,0,0),F.save(),this.clipBbox(_,u,d,h,p),_.baseTransform=tn(_.ctx),_.executeOperatorList(r),_.endDrawing(),F.restore(),E||T){const j=L.canvas;E&&(S=l),T&&(w=c);const X=this.getSizeAndScale(S,this.ctx.canvas.width,v),wt=this.getSizeAndScale(w,this.ctx.canvas.height,x),qt=X.size,$t=wt.size,Pt=t.cachedCanvases.getCanvas("pattern-workaround",qt,$t),jt=Pt.context,me=E?Math.floor(g/l):0,xe=T?Math.floor(m/c):0;for(let Ot=0;Ot<=me;Ot++)for(let z=0;z<=xe;z++)jt.drawImage(j,qt*Ot,$t*z,qt,$t,0,0,qt,$t);return{canvas:Pt.canvas,scaleX:X.scale,scaleY:wt.scale,offsetX:u,offsetY:d}}return{canvas:L.canvas,scaleX:B.scale,scaleY:$.scale,offsetX:u,offsetY:d}}getSizeAndScale(t,e,r){const s=Math.max(Nv.MAX_PATTERN_SIZE,e);let i=Math.ceil(t*r);return i>=s?i=s:r=i/t,{scale:r,size:i}}clipBbox(t,e,r,s,i){const o=s-e,a=i-r;t.ctx.rect(e,r,o,a),t.current.updateRectMinMax(tn(t.ctx),[e,r,s,i]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,r){const s=t.ctx,i=t.current;switch(e){case YM.COLORED:const o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,i.fillColor=o.fillStyle,i.strokeColor=o.strokeStyle;break;case YM.UNCOLORED:const a=Mt.makeHexColor(r[0],r[1],r[2]);s.fillStyle=a,s.strokeStyle=a,i.fillColor=a,i.strokeColor=a;break;default:throw new ZG(`Unsupported paint type: ${e}`)}}getPattern(t,e,r,s){let i=r;s!==wr.SHADING&&(i=Mt.transform(i,e.baseTransform),this.matrix&&(i=Mt.transform(i,this.matrix)));const o=this.createPatternCanvas(e);let a=new DOMMatrix(i);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=t.createPattern(o.canvas,"repeat");return l.setTransform(a),l}};_t(Nv,"MAX_PATTERN_SIZE",3e3);let sA=Nv;function M9({src:n,srcPos:t=0,dest:e,width:r,height:s,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const a=jr.isLittleEndian?4278190080:255,[l,c]=o?[i,a]:[a,i],u=r>>3,d=r&7,h=n.length;e=new Uint32Array(e.buffer);let p=0;for(let g=0;g<s;g++){for(const b=t+u;t<b;t++){const y=t<h?n[t]:255;e[p++]=y&128?c:l,e[p++]=y&64?c:l,e[p++]=y&32?c:l,e[p++]=y&16?c:l,e[p++]=y&8?c:l,e[p++]=y&4?c:l,e[p++]=y&2?c:l,e[p++]=y&1?c:l}if(d===0)continue;const m=t<h?n[t++]:255;for(let b=0;b<d;b++)e[p++]=m&1<<7-b?c:l}return{srcPos:t,destPos:p}}const XM=16,qM=100,P9=15,JM=10,QM=1e3,rs=16;function O9(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(r,s){t.translate(r,s),this.__originalTranslate(r,s)},n.scale=function(r,s){t.scale(r,s),this.__originalScale(r,s)},n.transform=function(r,s,i,o,a,l){t.transform(r,s,i,o,a,l),this.__originalTransform(r,s,i,o,a,l)},n.setTransform=function(r,s,i,o,a,l){t.setTransform(r,s,i,o,a,l),this.__originalSetTransform(r,s,i,o,a,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(r){t.rotate(r),this.__originalRotate(r)},n.clip=function(r){t.clip(r),this.__originalClip(r)},n.moveTo=function(e,r){t.moveTo(e,r),this.__originalMoveTo(e,r)},n.lineTo=function(e,r){t.lineTo(e,r),this.__originalLineTo(e,r)},n.bezierCurveTo=function(e,r,s,i,o,a){t.bezierCurveTo(e,r,s,i,o,a),this.__originalBezierCurveTo(e,r,s,i,o,a)},n.rect=function(e,r,s,i){t.rect(e,r,s,i),this.__originalRect(e,r,s,i)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class I9{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,r){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,r)):(s=this.canvasFactory.create(e,r),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function e0(n,t,e,r,s,i,o,a,l,c){const[u,d,h,p,g,m]=tn(n);if(d===0&&h===0){const v=o*u+g,x=Math.round(v),S=a*p+m,w=Math.round(S),E=(o+l)*u+g,T=Math.abs(Math.round(E)-x)||1,I=(a+c)*p+m,C=Math.abs(Math.round(I)-w)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(p),x,w),n.drawImage(t,e,r,s,i,0,0,T,C),n.setTransform(u,d,h,p,g,m),[T,C]}if(u===0&&p===0){const v=a*h+g,x=Math.round(v),S=o*d+m,w=Math.round(S),E=(a+c)*h+g,T=Math.abs(Math.round(E)-x)||1,I=(o+l)*d+m,C=Math.abs(Math.round(I)-w)||1;return n.setTransform(0,Math.sign(d),Math.sign(h),0,x,w),n.drawImage(t,e,r,s,i,0,0,C,T),n.setTransform(u,d,h,p,g,m),[C,T]}n.drawImage(t,e,r,s,i,o,a,l,c);const b=Math.hypot(u,d),y=Math.hypot(h,p);return[b*l,y*c]}function R9(n){const{width:t,height:e}=n;if(t>QM||e>QM)return null;const r=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=t+1;let o=new Uint8Array(i*(e+1)),a,l,c;const u=t+7&-8;let d=new Uint8Array(u*e),h=0;for(const y of n.data){let v=128;for(;v>0;)d[h++]=y&v?0:255,v>>=1}let p=0;for(h=0,d[h]!==0&&(o[0]=1,++p),l=1;l<t;l++)d[h]!==d[h+1]&&(o[l]=d[h]?2:1,++p),h++;for(d[h]!==0&&(o[l]=2,++p),a=1;a<e;a++){h=a*u,c=a*i,d[h-u]!==d[h]&&(o[c]=d[h]?1:8,++p);let y=(d[h]?4:0)+(d[h-u]?8:0);for(l=1;l<t;l++)y=(y>>2)+(d[h+1]?4:0)+(d[h-u+1]?8:0),s[y]&&(o[c+l]=s[y],++p),h++;if(d[h-u]!==d[h]&&(o[c+l]=d[h]?2:4,++p),p>r)return null}for(h=u*(e-1),c=a*i,d[h]!==0&&(o[c]=8,++p),l=1;l<t;l++)d[h]!==d[h+1]&&(o[c+l]=d[h]?4:8,++p),h++;if(d[h]!==0&&(o[c+l]=4,++p),p>r)return null;const g=new Int32Array([0,i,-1,0,-i,0,0,0,1]),m=new Path2D;for(a=0;p&&a<=e;a++){let y=a*i;const v=y+t;for(;y<v&&!o[y];)y++;if(y===v)continue;m.moveTo(y%i,a);const x=y;let S=o[y];do{const w=g[S];do y+=w;while(!o[y]);const E=o[y];E!==5&&E!==10?(S=E,o[y]=0):(S=E&51*S>>4,o[y]&=S>>2|S<<2),m.lineTo(y%i,y/i|0),o[y]||--p}while(x!==y);--a}return d=null,o=null,function(y){y.save(),y.scale(1/t,-1/e),y.translate(0,-e),y.fill(m),y.beginPath(),y.restore()}}class ZM{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=wD,this.textMatrixScale=1,this.fontMatrix=RS,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=dr.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,r){[e,r]=Mt.applyTransform([e,r],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(t,e){const r=Mt.applyTransform(e,t),s=Mt.applyTransform(e.slice(2),t),i=Mt.applyTransform([e[0],e[3]],t),o=Mt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,r[0],s[0],i[0],o[0]),this.minY=Math.min(this.minY,r[1],s[1],i[1],o[1]),this.maxX=Math.max(this.maxX,r[0],s[0],i[0],o[0]),this.maxY=Math.max(this.maxY,r[1],s[1],i[1],o[1])}updateScalingPathMinMax(t,e){Mt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,r,s,i,o,a,l,c,u){const d=Mt.bezierBoundingBox(e,r,s,i,o,a,l,c,u);u||this.updateRectMinMax(t,d)}getPathBoundingBox(t=wr.FILL,e=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(t===wr.STROKE){e||Ve("Stroke bounding box must include transform.");const s=Mt.singularValueDecompose2dScale(e),i=s[0]*this.lineWidth/2,o=s[1]*this.lineWidth/2;r[0]-=i,r[1]-=o,r[2]+=i,r[3]+=o}return r}updateClipFromPath(){const t=Mt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=wr.FILL,e=null){return Mt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function t2(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,r=t.width,s=e%rs,i=(e-s)/rs,o=s===0?i:i+1,a=n.createImageData(r,rs);let l=0,c;const u=t.data,d=a.data;let h,p,g,m;if(t.kind===C0.GRAYSCALE_1BPP){const b=u.byteLength,y=new Uint32Array(d.buffer,0,d.byteLength>>2),v=y.length,x=r+7>>3,S=4294967295,w=jr.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(g=h<i?rs:s,c=0,p=0;p<g;p++){const E=b-l;let T=0;const I=E>x?r:E*8-7,C=I&-8;let R=0,N=0;for(;T<C;T+=8)N=u[l++],y[c++]=N&128?S:w,y[c++]=N&64?S:w,y[c++]=N&32?S:w,y[c++]=N&16?S:w,y[c++]=N&8?S:w,y[c++]=N&4?S:w,y[c++]=N&2?S:w,y[c++]=N&1?S:w;for(;T<I;T++)R===0&&(N=u[l++],R=128),y[c++]=N&R?S:w,R>>=1}for(;c<v;)y[c++]=0;n.putImageData(a,0,h*rs)}}else if(t.kind===C0.RGBA_32BPP){for(p=0,m=r*rs*4,h=0;h<i;h++)d.set(u.subarray(l,l+m)),l+=m,n.putImageData(a,0,p),p+=rs;h<o&&(m=r*s*4,d.set(u.subarray(l,l+m)),n.putImageData(a,0,p))}else if(t.kind===C0.RGB_24BPP)for(g=rs,m=r*g,h=0;h<o;h++){for(h>=i&&(g=s,m=r*g),c=0,p=m;p--;)d[c++]=u[l++],d[c++]=u[l++],d[c++]=u[l++],d[c++]=255;n.putImageData(a,0,h*rs)}else throw new Error(`bad image kind: ${t.kind}`)}function e2(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,r=t.width,s=e%rs,i=(e-s)/rs,o=s===0?i:i+1,a=n.createImageData(r,rs);let l=0;const c=t.data,u=a.data;for(let d=0;d<o;d++){const h=d<i?rs:s;({srcPos:l}=M9({src:c,srcPos:l,dest:u,width:r,height:h,nonBlackColor:0})),n.putImageData(a,0,d*rs)}}function Uf(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of e)n[r]!==void 0&&(t[r]=n[r]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function n0(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Er){const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}}function n2(n,t){if(t)return!0;const e=Mt.singularValueDecompose2dScale(n);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*nc.PDF_TO_CSS_UNITS);return e[0]<=r&&e[1]<=r}const D9=["butt","round","square"],N9=["miter","round","bevel"],_9={},r2={};var Ni,iA,oA,aA;const Fk=class Fk{constructor(t,e,r,s,i,{optionalContentConfig:o,markedContentStack:a=null},l,c){M(this,Ni);this.ctx=t,this.current=new ZM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=r,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new I9(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:r=!1,background:s=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=a,r){const l=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...tn(this.compositeCtx))}this.ctx.save(),n0(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=tn(this.ctx)}executeOperatorList(t,e,r,s){const i=t.argsArray,o=t.fnArray;let a=e||0;const l=i.length;if(l===a)return a;const c=l-a>JM&&typeof r=="function",u=c?Date.now()+P9:0;let d=0;const h=this.commonObjs,p=this.objs;let g;for(;;){if(s!==void 0&&a===s.nextBreakPoint)return s.breakIt(a,r),a;if(g=o[a],g!==ui.dependency)this[g].apply(this,i[a]);else for(const m of i[a]){const b=m.startsWith("g_")?h:p;if(!b.has(m))return b.get(m,r),a}if(a++,a===l)return a;if(c&&++d>JM){if(Date.now()>u)return r(),a;d=0}}}endDrawing(){P(this,Ni,iA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),P(this,Ni,oA).call(this)}_scaleImage(t,e){const r=t.width??t.displayWidth,s=t.height??t.displayHeight;let i=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),a=r,l=s,c="prescale1",u,d;for(;i>2&&a>1||o>2&&l>1;){let h=a,p=l;i>2&&a>1&&(h=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),i/=a/h),o>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/p),u=this.cachedCanvases.getCanvas(c,h,p),d=u.context,d.clearRect(0,0,h,p),d.drawImage(t,0,0,a,l,0,0,h,p),t=u.canvas,a=h,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:a,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:r,height:s}=t,i=this.current.fillColor,o=this.current.patternFill,a=tn(e);let l,c,u,d;if((t.bitmap||t.data)&&t.count>1){const I=t.bitmap||t.data.buffer;c=JSON.stringify(o?a:[a.slice(0,4),i]),l=this._cachedBitmapsMap.get(I),l||(l=new Map,this._cachedBitmapsMap.set(I,l));const C=l.get(c);if(C&&!o){const R=Math.round(Math.min(a[0],a[2])+a[4]),N=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:C,offsetX:R,offsetY:N}}u=C}u||(d=this.cachedCanvases.getCanvas("maskCanvas",r,s),e2(d.context,t));let h=Mt.transform(a,[1/r,0,0,-1/s,0,0]);h=Mt.transform(h,[1,0,0,1,0,-s]);const[p,g,m,b]=Mt.getAxialAlignedBoundingBox([0,0,r,s],h),y=Math.round(m-p)||1,v=Math.round(b-g)||1,x=this.cachedCanvases.getCanvas("fillCanvas",y,v),S=x.context,w=p,E=g;S.translate(-w,-E),S.transform(...h),u||(u=this._scaleImage(d.canvas,Li(S)),u=u.img,l&&o&&l.set(c,u)),S.imageSmoothingEnabled=n2(tn(S),t.interpolate),e0(S,u,0,0,u.width,u.height,0,0,r,s),S.globalCompositeOperation="source-in";const T=Mt.transform(Li(S),[1,0,0,1,-w,-E]);return S.fillStyle=o?i.getPattern(e,this,T,wr.FILL):i,S.fillRect(0,0,r,s),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,x.canvas)),{canvas:x.canvas,offsetX:Math.round(w),offsetY:Math.round(E)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=D9[t]}setLineJoin(t){this.ctx.lineJoin=N9[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,r]of t)switch(e){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(r,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const i=this.ctx;i.setTransform(...tn(this.suspendedCtx)),Uf(this.suspendedCtx,i),O9(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Uf(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,r,s){const i=s[0],o=s[1],a=s[2]-i,l=s[3]-o;a===0||l===0||(this.genericComposeSMask(e.context,r,a,l,e.subtype,e.backdrop,e.transferMap,i,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(r.canvas,0,0),t.restore())}genericComposeSMask(t,e,r,s,i,o,a,l,c,u,d){let h=t.canvas,p=l-u,g=c-d;if(o){const b=Mt.makeHexColor(...o);if(p<0||g<0||p+r>h.width||g+s>h.height){const y=this.cachedCanvases.getCanvas("maskExtension",r,s),v=y.context;v.drawImage(h,-p,-g),v.globalCompositeOperation="destination-atop",v.fillStyle=b,v.fillRect(0,0,r,s),v.globalCompositeOperation="source-over",h=y.canvas,p=g=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(p,g,r,s),t.clip(y),t.globalCompositeOperation="destination-atop",t.fillStyle=b,t.fillRect(p,g,r,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),i==="Alpha"&&a?e.filter=this.filterFactory.addAlphaFilter(a):i==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(a));const m=new Path2D;m.rect(l,c,r,s),e.clip(m),e.globalCompositeOperation="destination-in",e.drawImage(h,p,g,r,s,l,c,r,s),e.restore()}save(){this.inSMaskMode?(Uf(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Uf(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,r,s,i,o){this.ctx.transform(t,e,r,s,i,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,r){const s=this.ctx,i=this.current;let o=i.x,a=i.y,l,c;const u=tn(s),d=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,h=d?r.slice(0):null;for(let p=0,g=0,m=t.length;p<m;p++)switch(t[p]|0){case ui.rectangle:o=e[g++],a=e[g++];const b=e[g++],y=e[g++],v=o+b,x=a+y;s.moveTo(o,a),b===0||y===0?s.lineTo(v,x):(s.lineTo(v,a),s.lineTo(v,x),s.lineTo(o,x)),d||i.updateRectMinMax(u,[o,a,v,x]),s.closePath();break;case ui.moveTo:o=e[g++],a=e[g++],s.moveTo(o,a),d||i.updatePathMinMax(u,o,a);break;case ui.lineTo:o=e[g++],a=e[g++],s.lineTo(o,a),d||i.updatePathMinMax(u,o,a);break;case ui.curveTo:l=o,c=a,o=e[g+4],a=e[g+5],s.bezierCurveTo(e[g],e[g+1],e[g+2],e[g+3],o,a),i.updateCurvePathMinMax(u,l,c,e[g],e[g+1],e[g+2],e[g+3],o,a,h),g+=6;break;case ui.curveTo2:l=o,c=a,s.bezierCurveTo(o,a,e[g],e[g+1],e[g+2],e[g+3]),i.updateCurvePathMinMax(u,l,c,o,a,e[g],e[g+1],e[g+2],e[g+3],h),o=e[g+2],a=e[g+3],g+=4;break;case ui.curveTo3:l=o,c=a,o=e[g+2],a=e[g+3],s.bezierCurveTo(e[g],e[g+1],o,a,o,a),i.updateCurvePathMinMax(u,l,c,e[g],e[g+1],o,a,o,a,h),g+=4;break;case ui.closePath:s.closePath();break}d&&i.updateScalingPathMinMax(u,h),i.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,r=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&(r!=null&&r.getPattern)?(e.save(),e.strokeStyle=r.getPattern(e,this,Li(e),wr.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,r=this.current.fillColor,s=this.current.patternFill;let i=!1;s&&(e.save(),e.fillStyle=r.getPattern(e,this,Li(e),wr.FILL),i=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),i&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=_9}eoClip(){this.pendingClip=r2}beginText(){this.current.textMatrix=wD,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const r=new Path2D,s=e.getTransform().invertSelf();for(const{transform:i,x:o,y:a,fontSize:l,path:c}of t)r.addPath(c,new DOMMatrix(i).preMultiplySelf(s).translate(o,a).scale(l,-l));e.clip(r),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var u;const r=this.commonObjs.get(t),s=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=r.fontMatrix||RS,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=r,this.current.fontSize=e,r.isType3Font)return;const i=r.loadedName||"sans-serif",o=((u=r.systemFontInfo)==null?void 0:u.css)||`"${i}", ${r.fallbackName}`;let a="normal";r.black?a="900":r.bold&&(a="bold");const l=r.italic?"italic":"normal";let c=e;e<XM?c=XM:e>qM&&(c=qM),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${a} ${c}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,r,s,i,o){this.current.textMatrix=[t,e,r,s,i,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,r,s,i){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,d=c&dr.FILL_STROKE_MASK,h=!!(c&dr.ADD_TO_PATH_FLAG),p=a.patternFill&&!l.missingFile,g=a.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||h||p||g)&&(m=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||p||g){if(o.save(),o.translate(e,r),o.scale(u,-u),d===dr.FILL||d===dr.FILL_STROKE)if(s){const b=o.getTransform();o.setTransform(...s),o.fill(P(this,Ni,aA).call(this,m,b,s))}else o.fill(m);if(d===dr.STROKE||d===dr.FILL_STROKE)if(i){const b=o.getTransform();o.setTransform(...i),o.stroke(P(this,Ni,aA).call(this,m,b,i))}else o.lineWidth/=u,o.stroke(m);o.restore()}else(d===dr.FILL||d===dr.FILL_STROKE)&&o.fillText(t,e,r),(d===dr.STROKE||d===dr.FILL_STROKE)&&o.strokeText(t,e,r);h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:tn(o),x:e,y:r,fontSize:u,path:m})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let r=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){r=!0;break}return he(this,"isFontSubpixelAAEnabled",r)}showText(t){const e=this.current,r=e.font;if(r.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const i=this.ctx,o=e.fontSizeScale,a=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,u=e.textHScale*c,d=t.length,h=r.vertical,p=h?1:-1,g=r.defaultVMetrics,m=s*e.fontMatrix[0],b=e.textRenderingMode===dr.FILL&&!r.disableFontFace&&!e.patternFill;i.save(),i.transform(...e.textMatrix),i.translate(e.x,e.y+e.textRise),c>0?i.scale(u,-1):i.scale(u,1);let y,v;if(e.patternFill){i.save();const T=e.fillColor.getPattern(i,this,Li(i),wr.FILL);y=tn(i),i.restore(),i.fillStyle=T}if(e.patternStroke){i.save();const T=e.strokeColor.getPattern(i,this,Li(i),wr.STROKE);v=tn(i),i.restore(),i.strokeStyle=T}let x=e.lineWidth;const S=e.textMatrixScale;if(S===0||x===0){const T=e.textRenderingMode&dr.FILL_STROKE_MASK;(T===dr.STROKE||T===dr.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=S;if(o!==1&&(i.scale(o,o),x/=o),i.lineWidth=x,r.isInvalidPDFjsFont){const T=[];let I=0;for(const C of t)T.push(C.unicode),I+=C.width;i.fillText(T.join(""),0,0),e.x+=I*m*u,i.restore(),this.compose();return}let w=0,E;for(E=0;E<d;++E){const T=t[E];if(typeof T=="number"){w+=p*T*s/1e3;continue}let I=!1;const C=(T.isSpace?l:0)+a,R=T.fontChar,N=T.accent;let B,$,L=T.width;if(h){const _=T.vmetric||g,j=-(T.vmetric?_[1]:L*.5)*m,X=_[2]*m;L=_?-_[0]:L,B=j/o,$=(w+X)/o}else B=w/o,$=0;if(r.remeasure&&L>0){const _=i.measureText(R).width*1e3/s*o;if(L<_&&this.isFontSubpixelAAEnabled){const j=L/_;I=!0,i.save(),i.scale(j,1),B/=j}else L!==_&&(B+=(L-_)/2e3*s/o)}if(this.contentVisible&&(T.isInFont||r.missingFile)){if(b&&!N)i.fillText(R,B,$);else if(this.paintChar(R,B,$,y,v),N){const _=B+s*N.offset.x/o,j=$-s*N.offset.y/o;this.paintChar(N.fontChar,_,j,y,v)}}const F=h?L*m-C*c:L*m+C*c;w+=F,I&&i.restore()}h?e.y-=w:e.x+=w*u,i.restore(),this.compose()}showType3Text(t){const e=this.ctx,r=this.current,s=r.font,i=r.fontSize,o=r.fontDirection,a=s.vertical?1:-1,l=r.charSpacing,c=r.wordSpacing,u=r.textHScale*o,d=r.fontMatrix||RS,h=t.length,p=r.textRenderingMode===dr.INVISIBLE;let g,m,b,y;if(!(p||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...r.textMatrix),e.translate(r.x,r.y),e.scale(u,o),g=0;g<h;++g){if(m=t[g],typeof m=="number"){y=a*m*i/1e3,this.ctx.translate(y,0),r.x+=y*u;continue}const v=(m.isSpace?c:0)+l,x=s.charProcOperatorList[m.operatorListId];if(!x){ne(`Type3 character "${m.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=m,this.save(),e.scale(i,i),e.transform(...d),this.executeOperatorList(x),this.restore()),b=Mt.applyTransform([m.width,0],d)[0]*i+v,e.translate(b,0),r.x+=b*u}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,r,s,i,o){this.ctx.rect(r,s,i-r,o-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const r=t[1],s=this.baseTransform||tn(this.ctx),i={createCanvasGraphics:o=>new Fk(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new sA(t,r,this.ctx,i,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,r){this.ctx.strokeStyle=this.current.strokeColor=Mt.makeHexColor(t,e,r),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,r){this.ctx.fillStyle=this.current.fillColor=Mt.makeHexColor(t,e,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=T9(this.getObject(t)),this.cachedPatterns.set(t,r)),e&&(r.matrix=e),r}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const r=this._getPattern(t);e.fillStyle=r.getPattern(e,this,Li(e),wr.SHADING);const s=Li(e);if(s){const{width:i,height:o}=e.canvas,[a,l,c,u]=Mt.getAxialAlignedBoundingBox([0,0,i,o],s);this.ctx.fillRect(a,l,c-a,u-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ve("Should not call beginInlineImage")}beginImageData(){Ve("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=tn(this.ctx),e)){const r=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],r,s),this.current.updateRectMinMax(tn(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Fw("TODO: Support non-isolated groups."),t.knockout&&ne("Knockout groups not supported.");const r=tn(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=Mt.getAxialAlignedBoundingBox(t.bbox,tn(e));const i=[0,0,e.canvas.width,e.canvas.height];s=Mt.intersect(s,i)||[0,0,0,0];const o=Math.floor(s[0]),a=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-o,1),c=Math.max(Math.ceil(s[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(u,l,c),h=d.context;h.translate(-o,-a),h.transform(...r),t.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:o,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,a),e.save()),Uf(e,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=tn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const i=Mt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(t,e,r,s,i){if(P(this,Ni,iA).call(this),n0(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],a=e[3]-e[1];if(i&&this.annotationCanvasMap){r=r.slice(),r[4]-=e[0],r[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=a;const[l,c]=Mt.singularValueDecompose2dScale(tn(this.ctx)),{viewportScale:u}=this,d=Math.ceil(o*this.outputScaleX*u),h=Math.ceil(a*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),n0(this.ctx)}else n0(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new ZM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),P(this,Ni,oA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const r=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=R9(t)),s.compiled)){s.compiled(r);return}const i=this._createMaskCanvas(t),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,r=0,s=0,i,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const l=tn(a);a.transform(e,r,s,i,0,0);const c=this._createMaskCanvas(t);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,d=o.length;u<d;u+=2){const h=Mt.transform(l,[e,r,s,i,o[u],o[u+1]]),[p,g]=Mt.applyTransform([0,0],h);a.drawImage(c.canvas,p,g)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,r=this.current.fillColor,s=this.current.patternFill;for(const i of t){const{data:o,width:a,height:l,transform:c}=i,u=this.cachedCanvases.getCanvas("maskCanvas",a,l),d=u.context;d.save();const h=this.getObject(o,i);e2(d,h),d.globalCompositeOperation="source-in",d.fillStyle=s?r.getPattern(d,this,Li(e),wr.FILL):r,d.fillRect(0,0,a,l),d.restore(),e.save(),e.transform(...c),e.scale(1,-1),e0(e,u.canvas,0,0,a,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,r,s){if(!this.contentVisible)return;const i=this.getObject(t);if(!i){ne("Dependent image isn't ready yet");return}const o=i.width,a=i.height,l=[];for(let c=0,u=s.length;c<u;c+=2)l.push({transform:[e,0,0,r,s[c],s[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:r,height:s}=t,i=this.cachedCanvases.getCanvas("inlineImage",r,s),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",i.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,r=t.height,s=this.ctx;if(this.save(),!Er){const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none")}s.scale(1/e,-1/r);let i;if(t.bitmap)i=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)i=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,r).context;t2(l,t),i=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(i,Li(s));s.imageSmoothingEnabled=n2(tn(s),t.interpolate),e0(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-r,e,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const r=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const i=t.width,o=t.height,l=this.cachedCanvases.getCanvas("inlineImage",i,o).context;t2(l,t),s=this.applyTransferMapsToCanvas(l)}for(const i of e)r.save(),r.transform(...i.transform),r.scale(1,-1),e0(r,s,i.x,i.y,i.w,i.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const r=this.ctx;this.pendingClip&&(e||(this.pendingClip===r2?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=tn(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),r=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(r,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:r,c:s,d:i}=this.ctx.getTransform();let o,a;if(r===0&&s===0){const l=Math.abs(e),c=Math.abs(i);if(l===c)if(t===0)o=a=1/l;else{const u=l*t;o=a=u<1?1/u:1}else if(t===0)o=1/l,a=1/c;else{const u=l*t,d=c*t;o=u<1?1/u:1,a=d<1?1/d:1}}else{const l=Math.abs(e*i-r*s),c=Math.hypot(e,r),u=Math.hypot(s,i);if(t===0)o=u/l,a=c/l;else{const d=t*l;o=u>d?u/d:1,a=c>d?c/d:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:r}=this.current,[s,i]=this.getScaleForStroking();if(e.lineWidth=r||1,s===1&&i===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(s,i),o.length>0){const a=Math.max(s,i);e.setLineDash(o.map(l=>l/a)),e.lineDashOffset/=a}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ni=new WeakSet,iA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},oA=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},aA=function(t,e,r){const s=new Path2D;return s.addPath(t,new DOMMatrix(r).invertSelf().multiplySelf(e)),s};let nh=Fk;for(const n in ui)nh.prototype[n]!==void 0&&(nh.prototype[ui[n]]=nh.prototype[n]);var im,om;class ha{static get workerPort(){return f(this,im)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");k(this,im,t)}static get workerSrc(){return f(this,om)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");k(this,om,t)}}im=new WeakMap,om=new WeakMap,M(ha,im,null),M(ha,om,"");var Jc,am;class L9{constructor({parsedData:t,rawData:e}){M(this,Jc);M(this,am);k(this,Jc,t),k(this,am,e)}getRaw(){return f(this,am)}get(t){return f(this,Jc).get(t)??null}getAll(){return Ak(f(this,Jc))}has(t){return f(this,Jc).has(t)}}Jc=new WeakMap,am=new WeakMap;const Nd=Symbol("INTERNAL");var lm,cm,um,xh;class F9{constructor(t,{name:e,intent:r,usage:s,rbGroups:i}){M(this,lm,!1);M(this,cm,!1);M(this,um,!1);M(this,xh,!0);k(this,lm,!!(t&Cs.DISPLAY)),k(this,cm,!!(t&Cs.PRINT)),this.name=e,this.intent=r,this.usage=s,this.rbGroups=i}get visible(){if(f(this,um))return f(this,xh);if(!f(this,xh))return!1;const{print:t,view:e}=this.usage;return f(this,lm)?(e==null?void 0:e.viewState)!=="OFF":f(this,cm)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,r=!1){t!==Nd&&Ve("Internal method `_setVisible` called."),k(this,um,r),k(this,xh,e)}}lm=new WeakMap,cm=new WeakMap,um=new WeakMap,xh=new WeakMap;var ml,Ne,Sh,Ah,dm,lA;class B9{constructor(t,e=Cs.DISPLAY){M(this,dm);M(this,ml,null);M(this,Ne,new Map);M(this,Sh,null);M(this,Ah,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,k(this,Ah,t.order);for(const r of t.groups)f(this,Ne).set(r.id,new F9(e,r));if(t.baseState==="OFF")for(const r of f(this,Ne).values())r._setVisible(Nd,!1);for(const r of t.on)f(this,Ne).get(r)._setVisible(Nd,!0);for(const r of t.off)f(this,Ne).get(r)._setVisible(Nd,!1);k(this,Sh,this.getHash())}}isVisible(t){if(f(this,Ne).size===0)return!0;if(!t)return Fw("Optional content group not defined."),!0;if(t.type==="OCG")return f(this,Ne).has(t.id)?f(this,Ne).get(t.id).visible:(ne(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return P(this,dm,lA).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!f(this,Ne).has(e))return ne(`Optional content group not found: ${e}`),!0;if(f(this,Ne).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!f(this,Ne).has(e))return ne(`Optional content group not found: ${e}`),!0;if(!f(this,Ne).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!f(this,Ne).has(e))return ne(`Optional content group not found: ${e}`),!0;if(!f(this,Ne).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!f(this,Ne).has(e))return ne(`Optional content group not found: ${e}`),!0;if(f(this,Ne).get(e).visible)return!1}return!0}return ne(`Unknown optional content policy ${t.policy}.`),!0}return ne(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,r=!0){var i;const s=f(this,Ne).get(t);if(!s){ne(`Optional content group not found: ${t}`);return}if(r&&e&&s.rbGroups.length)for(const o of s.rbGroups)for(const a of o)a!==t&&((i=f(this,Ne).get(a))==null||i._setVisible(Nd,!1,!0));s._setVisible(Nd,!!e,!0),k(this,ml,null)}setOCGState({state:t,preserveRB:e}){let r;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":r=s;continue}const i=f(this,Ne).get(s);if(i)switch(r){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!i.visible,e);break}}k(this,ml,null)}get hasInitialVisibility(){return f(this,Sh)===null||this.getHash()===f(this,Sh)}getOrder(){return f(this,Ne).size?f(this,Ah)?f(this,Ah).slice():[...f(this,Ne).keys()]:null}getGroups(){return f(this,Ne).size>0?Ak(f(this,Ne)):null}getGroup(t){return f(this,Ne).get(t)||null}getHash(){if(f(this,ml)!==null)return f(this,ml);const t=new JD;for(const[e,r]of f(this,Ne))t.update(`${e}:${r.visible}`);return k(this,ml,t.hexdigest())}}ml=new WeakMap,Ne=new WeakMap,Sh=new WeakMap,Ah=new WeakMap,dm=new WeakSet,lA=function(t){const e=t.length;if(e<2)return!0;const r=t[0];for(let s=1;s<e;s++){const i=t[s];let o;if(Array.isArray(i))o=P(this,dm,lA).call(this,i);else if(f(this,Ne).has(i))o=f(this,Ne).get(i).visible;else return ne(`Optional content group not found: ${i}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"};class $9{constructor(t,{disableRange:e=!1,disableStream:r=!1}){En(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:i,progressiveDone:o,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!r,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const r=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const s=this._rangeReaders.some(function(i){return i._begin!==t?!1:(i._enqueue(r),!0)});En(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,r,s,i;t.total===void 0?(r=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||r.call(e,{loaded:t.loaded}):(i=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||i.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){En(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new j9(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new H9(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeReaders.slice(0))r.cancel(t);this._pdfDataRangeTransport.abort()}}class j9{constructor(t,e,r=!1,s=null){this._stream=t,this._done=r||!1,this._filename=Ck(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class H9{constructor(t,e,r){this._stream=t,this._begin=e,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function V9(n){let t=!0,e=r("filename\\*","i").exec(n);if(e){e=e[1];let u=a(e);return u=unescape(u),u=l(u),u=c(u),i(u)}if(e=o(n),e){const u=c(e);return i(u)}if(e=r("filename","i").exec(n),e){e=e[1];let u=a(e);return u=c(u),i(u)}function r(u,d){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function s(u,d){if(u){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const h=new TextDecoder(u,{fatal:!0}),p=Bw(d);d=h.decode(p),t=!1}catch{}}return d}function i(u){return t&&/[\x80-\xff]/.test(u)&&(u=s("utf-8",u),t&&(u=s("iso-8859-1",u))),u}function o(u){const d=[];let h;const p=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=p.exec(u))!==null;){let[,m,b,y]=h;if(m=parseInt(m,10),m in d){if(m===0)break;continue}d[m]=[b,y]}const g=[];for(let m=0;m<d.length&&m in d;++m){let[b,y]=d[m];y=a(y),b&&(y=unescape(y),m===0&&(y=l(y))),g.push(y)}return g.join("")}function a(u){if(u.startsWith('"')){const d=u.slice(1).split('\\"');for(let h=0;h<d.length;++h){const p=d[h].indexOf('"');p!==-1&&(d[h]=d[h].slice(0,p),d.length=h+1),d[h]=d[h].replaceAll(/\\(.)/g,"$1")}u=d.join('"')}return u}function l(u){const d=u.indexOf("'");if(d===-1)return u;const h=u.slice(0,d),g=u.slice(d+1).replace(/^[^']*'/,"");return s(h,g)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,h,p,g){if(p==="q"||p==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,b){return String.fromCharCode(parseInt(b,16))}),s(h,g);try{g=atob(g)}catch{}return s(h,g)})}return""}function dN(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const r in t){const s=t[r];s!==void 0&&e.append(r,s)}return e}function Hw(n){try{return new URL(n).origin}catch{}return null}function hN({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:r}){const s={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(s.suggestedLength=i,i<=2*e)||r||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function fN(n){const t=n.get("Content-Disposition");if(t){let e=V9(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Ck(e))return e}return null}function Vw(n,t){return n===404||n===0&&t.startsWith("file:")?new Mg('Missing PDF "'+t+'".'):new vv(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n)}function pN(n){return n===200||n===206}function gN(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function mN(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class s2{constructor(t){_t(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=dN(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return En(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new z9(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new U9(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class z9{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const r=new Headers(t.headers),s=e.url;fetch(s,gN(r,this._withCredentials,this._abortController)).then(i=>{if(t._responseOrigin=Hw(i.url),!pN(i.status))throw Vw(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:a,suggestedLength:l}=hN({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=fN(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ec("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:mN(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class U9{constructor(t,e,r){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(t.headers);i.append("Range",`bytes=${e}-${r-1}`);const o=s.url;fetch(o,gN(i,this._withCredentials,this._abortController)).then(a=>{const l=Hw(a.url);if(l!==t._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${t._responseOrigin}".`);if(!pN(a.status))throw Vw(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:mN(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const e1=200,n1=206;function W9(n){const t=n.response;return typeof t!="string"?t:Bw(t).buffer}class K9{constructor({url:t,httpHeaders:e,withCredentials:r}){_t(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=dN(this.isHttp,e),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,r=this.currXhrId++,s=this.pendingRequests[r]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[i,o]of this.headers)e.setRequestHeader(i,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=n1):s.expectedStatus=e1,e.responseType="arraybuffer",En(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,r),e.onprogress=this.onProgress.bind(this,r),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),r}onProgress(t,e){var s;const r=this.pendingRequests[t];r&&((s=r.onProgress)==null||s.call(r,e))}onStateChange(t,e){const r=this.pendingRequests[t];if(!r)return;const s=r.xhr;if(s.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){r.onError(s.status);return}const i=s.status||e1;if(!(i===e1&&r.expectedStatus===n1)&&i!==r.expectedStatus){r.onError(s.status);return}const a=W9(s);if(i===n1){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?r.onDone({begin:parseInt(c[1],10),chunk:a}):(ne('Missing or invalid "Content-Range" header.'),r.onError(0))}else a?r.onDone({begin:0,chunk:a}):r.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class G9{constructor(t){this._source=t,this._manager=new K9(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return En(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Y9(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const r=new X9(this._manager,t,e);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class Y9{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Hw(e.responseURL);const r=e.getAllResponseHeaders(),s=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...c]=a.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=hN({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=fN(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Vw(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class X9{constructor(t,e,r){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Hw((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Vw(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const q9=/^[a-z][a-z0-9\-+.]+:/i;function J9(n){if(q9.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class Q9{constructor(t){this.source=t,this.url=J9(t.url),En(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return En(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Z9(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new tY(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class Z9{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Mg(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ec("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class tY{constructor(t,e,r){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const eY=1e5,qr=30,nY=.8;var l2,yl,ts,hm,fm,Qc,Ko,pm,gm,Zc,Eh,kh,bl,Ch,mm,Th,tu,ym,bm,eu,nu,vm,vl,Mh,Pa,yN,bN,cA,Ds,F0,uA,vN,wN;const Pn=class Pn{constructor({textContentSource:t,container:e,viewport:r}){M(this,Pa);M(this,yl,Promise.withResolvers());M(this,ts,null);M(this,hm,!1);M(this,fm,!!((l2=globalThis.FontInspector)!=null&&l2.enabled));M(this,Qc,null);M(this,Ko,null);M(this,pm,0);M(this,gm,0);M(this,Zc,null);M(this,Eh,null);M(this,kh,0);M(this,bl,0);M(this,Ch,Object.create(null));M(this,mm,[]);M(this,Th,null);M(this,tu,[]);M(this,ym,new WeakMap);M(this,bm,null);var l;if(t instanceof ReadableStream)k(this,Th,t);else if(typeof t=="object")k(this,Th,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');k(this,ts,k(this,Eh,e)),k(this,bl,r.scale*(globalThis.devicePixelRatio||1)),k(this,kh,r.rotation),k(this,Ko,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:i,pageX:o,pageY:a}=r.rawDims;k(this,bm,[1,0,0,-1,-o,a+i]),k(this,gm,s),k(this,pm,i),P(l=Pn,Ds,vN).call(l),td(e,r),f(this,yl).promise.finally(()=>{f(Pn,Mh).delete(this),k(this,Ko,null),k(this,Ch,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=jr.platform;return he(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{f(this,Zc).read().then(({value:e,done:r})=>{if(r){f(this,yl).resolve();return}f(this,Qc)??k(this,Qc,e.lang),Object.assign(f(this,Ch),e.styles),P(this,Pa,yN).call(this,e.items),t()},f(this,yl).reject)};return k(this,Zc,f(this,Th).getReader()),f(Pn,Mh).add(this),t(),f(this,yl).promise}update({viewport:t,onBefore:e=null}){var i;const r=t.scale*(globalThis.devicePixelRatio||1),s=t.rotation;if(s!==f(this,kh)&&(e==null||e(),k(this,kh,s),td(f(this,Eh),{rotation:s})),r!==f(this,bl)){e==null||e(),k(this,bl,r);const o={div:null,properties:null,ctx:P(i=Pn,Ds,F0).call(i,f(this,Qc))};for(const a of f(this,tu))o.properties=f(this,ym).get(a),o.div=a,P(this,Pa,cA).call(this,o)}}cancel(){var e;const t=new ec("TextLayer task cancelled.");(e=f(this,Zc))==null||e.cancel(t).catch(()=>{}),k(this,Zc,null),f(this,yl).reject(t)}get textDivs(){return f(this,tu)}get textContentItemsStr(){return f(this,mm)}static cleanup(){if(!(f(this,Mh).size>0)){f(this,eu).clear();for(const{canvas:t}of f(this,nu).values())t.remove();f(this,nu).clear()}}};yl=new WeakMap,ts=new WeakMap,hm=new WeakMap,fm=new WeakMap,Qc=new WeakMap,Ko=new WeakMap,pm=new WeakMap,gm=new WeakMap,Zc=new WeakMap,Eh=new WeakMap,kh=new WeakMap,bl=new WeakMap,Ch=new WeakMap,mm=new WeakMap,Th=new WeakMap,tu=new WeakMap,ym=new WeakMap,bm=new WeakMap,eu=new WeakMap,nu=new WeakMap,vm=new WeakMap,vl=new WeakMap,Mh=new WeakMap,Pa=new WeakSet,yN=function(t){var s,i;if(f(this,hm))return;(i=f(this,Ko)).ctx??(i.ctx=P(s=Pn,Ds,F0).call(s,f(this,Qc)));const e=f(this,tu),r=f(this,mm);for(const o of t){if(e.length>eY){ne("Ignoring additional textDivs for performance reasons."),k(this,hm,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=f(this,ts);k(this,ts,document.createElement("span")),f(this,ts).classList.add("markedContent"),o.id!==null&&f(this,ts).setAttribute("id",`${o.id}`),a.append(f(this,ts))}else o.type==="endMarkedContent"&&k(this,ts,f(this,ts).parentNode);continue}r.push(o.str),P(this,Pa,bN).call(this,o)}},bN=function(t){var m;const e=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};f(this,tu).push(e);const s=Mt.transform(f(this,bm),t.transform);let i=Math.atan2(s[1],s[0]);const o=f(this,Ch)[t.fontName];o.vertical&&(i+=Math.PI/2);let a=f(this,fm)&&o.fontSubstitution||o.fontFamily;a=Pn.fontFamilyMap.get(a)||a;const l=Math.hypot(s[2],s[3]),c=l*P(m=Pn,Ds,wN).call(m,a,f(this,Qc));let u,d;i===0?(u=s[4],d=s[5]-c):(u=s[4]+c*Math.sin(i),d=s[5]-c*Math.cos(i));const h="calc(var(--scale-factor)*",p=e.style;f(this,ts)===f(this,Eh)?(p.left=`${(100*u/f(this,gm)).toFixed(2)}%`,p.top=`${(100*d/f(this,pm)).toFixed(2)}%`):(p.left=`${h}${u.toFixed(2)}px)`,p.top=`${h}${d.toFixed(2)}px)`),p.fontSize=`${h}${(f(Pn,vl)*l).toFixed(2)}px)`,p.fontFamily=a,r.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,f(this,fm)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),i!==0&&(r.angle=i*(180/Math.PI));let g=!1;if(t.str.length>1)g=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const b=Math.abs(t.transform[0]),y=Math.abs(t.transform[3]);b!==y&&Math.max(b,y)/Math.min(b,y)>1.5&&(g=!0)}if(g&&(r.canvasWidth=o.vertical?t.height:t.width),f(this,ym).set(e,r),f(this,Ko).div=e,f(this,Ko).properties=r,P(this,Pa,cA).call(this,f(this,Ko)),r.hasText&&f(this,ts).append(e),r.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),f(this,ts).append(b)}},cA=function(t){var a;const{div:e,properties:r,ctx:s}=t,{style:i}=e;let o="";if(f(Pn,vl)>1&&(o=`scale(${1/f(Pn,vl)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:u}=r;P(a=Pn,Ds,uA).call(a,s,u*f(this,bl),l);const{width:d}=s.measureText(e.textContent);d>0&&(o=`scaleX(${c*f(this,bl)/d}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(i.transform=o)},Ds=new WeakSet,F0=function(t=null){let e=f(this,nu).get(t||(t=""));if(!e){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=t,document.body.append(r),e=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),f(this,nu).set(t,e),f(this,vm).set(e,{size:0,family:""})}return e},uA=function(t,e,r){const s=f(this,vm).get(t);e===s.size&&r===s.family||(t.font=`${e}px ${r}`,s.size=e,s.family=r)},vN=function(){if(f(this,vl)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),k(this,vl,t.getBoundingClientRect().height),t.remove()},wN=function(t,e){const r=f(this,eu).get(t);if(r)return r;const s=P(this,Ds,F0).call(this,e);s.canvas.width=s.canvas.height=qr,P(this,Ds,uA).call(this,s,qr,t);const i=s.measureText("");let o=i.fontBoundingBoxAscent,a=Math.abs(i.fontBoundingBoxDescent);if(o){const u=o/(o+a);return f(this,eu).set(t,u),s.canvas.width=s.canvas.height=0,u}s.strokeStyle="red",s.clearRect(0,0,qr,qr),s.strokeText("g",0,0);let l=s.getImageData(0,0,qr,qr).data;a=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){a=Math.ceil(u/4/qr);break}s.clearRect(0,0,qr,qr),s.strokeText("A",0,qr),l=s.getImageData(0,0,qr,qr).data,o=0;for(let u=0,d=l.length;u<d;u+=4)if(l[u]>0){o=qr-Math.floor(u/4/qr);break}s.canvas.width=s.canvas.height=0;const c=o?o/(o+a):nY;return f(this,eu).set(t,c),c},M(Pn,Ds),M(Pn,eu,new Map),M(Pn,nu,new Map),M(Pn,vm,new WeakMap),M(Pn,vl,null),M(Pn,Mh,new Set);let Pg=Pn;class Og{static textContent(t){const e=[],r={items:e,styles:Object.create(null)};function s(i){var l;if(!i)return;let o=null;const a=i.name;if(a==="#text")o=i.value;else if(Og.shouldBuildText(a))(l=i==null?void 0:i.attributes)!=null&&l.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&e.push({str:o}),!!i.children)for(const c of i.children)s(c)}return s(t),r}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const rY=65536,sY=100,iY=5e3,oY=Er?w9:y9,aY=Er?x9:iN,lY=Er?v9:b9,cY=Er?S9:cN;function uY(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new dA,{docId:e}=t,r=n.url?dY(n.url):null,s=n.data?hY(n.data):null,i=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof xN?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:rY;let u=n.worker instanceof rh?n.worker:null;const d=n.verbosity,h=typeof n.docBaseUrl=="string"&&!jw(n.docBaseUrl)?n.docBaseUrl:null,p=typeof n.cMapUrl=="string"?n.cMapUrl:null,g=n.cMapPacked!==!1,m=n.CMapReaderFactory||aY,b=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,y=n.StandardFontDataFactory||cY,v=n.stopAtErrors!==!0,x=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,S=n.isEvalSupported!==!1,w=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Er,E=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Er&&(jr.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,I=typeof n.disableFontFace=="boolean"?n.disableFontFace:Er,C=n.fontExtraProperties===!0,R=n.enableXfa===!0,N=n.ownerDocument||globalThis.document,B=n.disableRange===!0,$=n.disableStream===!0,L=n.disableAutoFetch===!0,F=n.pdfBug===!0,_=n.CanvasFactory||oY,j=n.FilterFactory||lY,X=n.enableHWA===!0,wt=l?l.length:n.length??NaN,qt=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Er&&!I,$t=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:m===iN&&y===cN&&p&&b&&ip(p,document.baseURI)&&ip(b,document.baseURI),Pt=null;XG(d);const jt={canvasFactory:new _({ownerDocument:N,enableHWA:X}),filterFactory:new j({docId:e,ownerDocument:N}),cMapReaderFactory:$t?null:new m({baseUrl:p,isCompressed:g}),standardFontDataFactory:$t?null:new y({baseUrl:b})};if(!u){const Ot={verbosity:d,port:ha.workerPort};u=Ot.port?rh.fromPort(Ot):new rh(Ot),t._worker=u}const me={docId:e,apiVersion:"4.10.38",data:s,password:a,disableAutoFetch:L,rangeChunkSize:c,length:wt,docBaseUrl:h,enableXfa:R,evaluatorOptions:{maxImageSize:x,disableFontFace:I,ignoreErrors:v,isEvalSupported:S,isOffscreenCanvasSupported:w,isImageDecoderSupported:E,canvasMaxAreaInBytes:T,fontExtraProperties:C,useSystemFonts:qt,cMapUrl:$t?p:null,standardFontDataUrl:$t?b:null}},xe={disableFontFace:I,fontExtraProperties:C,ownerDocument:N,pdfBug:F,styleElement:Pt,loadingParams:{disableAutoFetch:L,enableXfa:R}};return u.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ot=u.messageHandler.sendWithPromise("GetDocRequest",me,s?[s.buffer]:null);let z;if(l)z=new $9(l,{disableRange:B,disableStream:$});else if(!s){if(!r)throw new Error("getDocument - no `url` parameter provided.");let rt;if(Er)if(ip(r)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");rt=s2}else rt=Q9;else rt=ip(r)?s2:G9;z=new rt({url:r,length:wt,httpHeaders:i,withCredentials:o,rangeChunkSize:c,disableRange:B,disableStream:$})}return Ot.then(rt=>{if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const et=new cp(e,rt,u.port),ht=new mY(et,t,z,xe,jt);t._transport=ht,et.send("Ready",null)})}).catch(t._capability.reject),t}function dY(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Er&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function hY(n){if(Er&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Bw(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function i2(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var _v;const Lv=class Lv{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Pr(Lv,_v)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,r,s;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(i){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,i}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};_v=new WeakMap,M(Lv,_v,0);let dA=Lv;class xN{constructor(t,e,r=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=r,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const r of this._rangeListeners)r(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Ve("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class fY{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return he(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var wl,Go,Js,_d,B0;class pY{constructor(t,e,r,s=!1){M(this,Js);M(this,wl,null);M(this,Go,!1);this._pageIndex=t,this._pageInfo=e,this._transport=r,this._stats=s?new WM:null,this._pdfBug=s,this.commonObjs=r.commonObjs,this.objs=new SN,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:r=0,offsetY:s=0,dontFlip:i=!1}={}){return new yy({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:s,dontFlip:i})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return he(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:r="display",annotationMode:s=rl.ENABLE,transform:i=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:d=!1}){var S,w;(S=this._stats)==null||S.time("Overall");const h=this._transport.getRenderingIntent(r,s,u,d),{renderingIntent:p,cacheKey:g}=h;k(this,Go,!1),P(this,Js,B0).call(this),a||(a=this._transport.getOptionalContentConfig(p));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const b=!!(p&Cs.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(w=this._stats)==null||w.time("Page Request"),this._pumpOperatorList(h));const y=E=>{var T;m.renderTasks.delete(v),(this._maybeCleanupAfterRender||b)&&k(this,Go,!0),P(this,Js,_d).call(this,!b),E?(v.capability.reject(E),this._abortOperatorList({intentState:m,reason:E instanceof Error?E:new Error(E)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(T=globalThis.Stats)!=null&&T.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new fA({callback:y,params:{canvasContext:t,viewport:e,transform:i,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(v);const x=v.task;return Promise.all([m.displayReadyCapability.promise,a]).then(([E,T])=>{var I;if(this.destroyed){y();return}if((I=this._stats)==null||I.time("Rendering"),!(T.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:E,optionalContentConfig:T}),v.operatorListChanged()}).catch(y),x}getOperatorList({intent:t="display",annotationMode:e=rl.ENABLE,printAnnotationStorage:r=null,isEditing:s=!1}={}){var c;function i(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(t,e,r,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Og.textContent(r));const e=this.streamTextContent(t);return new Promise(function(r,s){function i(){o.read().then(function({value:l,done:c}){if(c){r(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),i()},s)}const o=e.getReader(),a={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const r of e.renderTasks)t.push(r.completed),r.cancel();return this.objs.clear(),k(this,Go,!1),P(this,Js,B0).call(this),Promise.all(t)}cleanup(t=!1){k(this,Go,!0);const e=P(this,Js,_d).call(this,!1);return t&&e&&this._stats&&(this._stats=new WM),e}_startRenderPage(t,e){var s,i;const r=this._intentStates.get(e);r&&((s=this._stats)==null||s.timeEnd("Page Request"),(i=r.displayReadyCapability)==null||i.resolve(t))}_renderPageChunk(t,e){for(let r=0,s=t.length;r<s;r++)e.operatorList.fnArray.push(t.fnArray[r]),e.operatorList.argsArray.push(t.argsArray[r]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const r of e.renderTasks)r.operatorListChanged();t.lastChunk&&P(this,Js,_d).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:r,modifiedIds:s}){const{map:i,transfer:o}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:i,modifiedIds:s},o).getReader(),c=this._intentStates.get(e);c.streamReader=l;const u=()=>{l.read().then(({value:d,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),u())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const h of c.renderTasks)h.operatorListChanged();P(this,Js,_d).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};u()}_abortOperatorList({intentState:t,reason:e,force:r=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!r){if(t.renderTasks.size>0)return;if(e instanceof kk){let s=sY;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new ec(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,i]of this._intentStates)if(i===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}wl=new WeakMap,Go=new WeakMap,Js=new WeakSet,_d=function(t=!1){if(P(this,Js,B0).call(this),!f(this,Go)||this.destroyed)return!1;if(t)return k(this,wl,setTimeout(()=>{k(this,wl,null),P(this,Js,_d).call(this,!1)},iY)),!1;for(const{renderTasks:e,operatorList:r}of this._intentStates.values())if(e.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),k(this,Go,!1),!0},B0=function(){f(this,wl)&&(clearTimeout(f(this,wl)),k(this,wl,null))};var Yo,Fv;class gY{constructor(){M(this,Yo,new Map);M(this,Fv,Promise.resolve())}postMessage(t,e){const r={data:structuredClone(t,e?{transfer:e}:null)};f(this,Fv).then(()=>{for(const[s]of f(this,Yo))s.call(this,r)})}addEventListener(t,e,r=null){let s=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:i}=r;if(i.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);s=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}f(this,Yo).set(e,s)}removeEventListener(t,e){const r=f(this,Yo).get(e);r==null||r(),f(this,Yo).delete(e)}terminate(){for(const[,t]of f(this,Yo))t==null||t();f(this,Yo).clear()}}Yo=new WeakMap,Fv=new WeakMap;var Bv,ru,su,Ph,$0,Oh,j0;const Ze=class Ze{constructor({name:t=null,port:e=null,verbosity:r=qG()}={}){M(this,Ph);var s;if(this.name=t,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=f(Ze,su))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(f(Ze,su)||k(Ze,su,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new cp("main","worker",t),this._messageHandler.on("ready",function(){}),P(this,Ph,$0).call(this)}_initialize(){if(f(Ze,ru)||f(Ze,Oh,j0)){this._setupFakeWorker();return}let{workerSrc:t}=Ze;try{Ze._isSameOrigin(window.location.href,t)||(t=Ze._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),r=new cp("main","worker",e),s=()=>{i.abort(),r.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:i.signal}),r.on("test",a=>{if(i.abort(),this.destroyed||!a){s();return}this._messageHandler=r,this._port=e,this._webWorker=e,P(this,Ph,$0).call(this)}),r.on("ready",a=>{if(i.abort(),this.destroyed){s();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;r.send("test",a,[a.buffer])};o();return}catch{Fw("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){f(Ze,ru)||(ne("Setting up fake worker."),k(Ze,ru,!0)),Ze._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new gY;this._port=e;const r=`fake${Pr(Ze,Bv)._++}`,s=new cp(r+"_worker",r,e);t.setup(s,e),this._messageHandler=new cp(r,r+"_worker",e),P(this,Ph,$0).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,r;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=f(Ze,su))==null||e.delete(this._port),this._port=null,(r=this._messageHandler)==null||r.destroy(),this._messageHandler=null}static fromPort(t){var r;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(r=f(this,su))==null?void 0:r.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ze(t)}static get workerSrc(){if(ha.workerSrc)return ha.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return he(this,"_setupFakeWorkerGlobal",(async()=>f(this,Oh,j0)?f(this,Oh,j0):(await import(this.workerSrc)).WorkerMessageHandler)())}};Bv=new WeakMap,ru=new WeakMap,su=new WeakMap,Ph=new WeakSet,$0=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Oh=new WeakSet,j0=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},M(Ze,Oh),M(Ze,Bv,0),M(Ze,ru,!1),M(Ze,su),Er&&(k(Ze,ru,!0),ha.workerSrc||(ha.workerSrc="./pdf.worker.mjs")),Ze._isSameOrigin=(t,e)=>{let r;try{if(r=new URL(t),!r.origin||r.origin==="null")return!1}catch{return!1}const s=new URL(e,r);return r.origin===s.origin},Ze._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let rh=Ze;var Xo,eo,Ih,Rh,qo,iu,pp;class mY{constructor(t,e,r,s,i){M(this,iu);M(this,Xo,new Map);M(this,eo,new Map);M(this,Ih,new Map);M(this,Rh,new Map);M(this,qo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new SN,this.fontLoader=new g9({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return he(this,"annotationStorage",new Pk)}getRenderingIntent(t,e=rl.ENABLE,r=null,s=!1,i=!1){let o=Cs.DISPLAY,a=tA;switch(t){case"any":o=Cs.ANY;break;case"display":break;case"print":o=Cs.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${t}`)}const l=o&Cs.PRINT&&r instanceof ZD?r:this.annotationStorage;switch(e){case rl.DISABLE:o+=Cs.ANNOTATIONS_DISABLE;break;case rl.ENABLE:break;case rl.ENABLE_FORMS:o+=Cs.ANNOTATIONS_FORMS;break;case rl.ENABLE_STORAGE:o+=Cs.ANNOTATIONS_STORAGE,a=l.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(o+=Cs.IS_EDITING),i&&(o+=Cs.OPLIST);const{ids:c,hash:u}=l.modifiedIds,d=[o,a.hash,u];return{renderingIntent:o,cacheKey:d.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=f(this,qo))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of f(this,eo).values())t.push(s._destroy());f(this,eo).clear(),f(this,Ih).clear(),f(this,Rh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var s,i;this.commonObjs.clear(),this.fontLoader.clear(),f(this,Xo).clear(),this.filterFactory.destroy(),Pg.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new ec("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(r,s)=>{En(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},s.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){s.close();return}En(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{s.error(i)})},s.onCancel=i=>{this._fullReader.cancel(i),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async r=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:o}=this._fullReader;return(!s||!i)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=e.onProgress)==null||c.call(e,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:o}}),t.on("GetRangeReader",(r,s)=>{En(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(r.begin,r.end);if(!i){s.close();return}s.onPull=()=>{i.read().then(function({value:o,done:a}){if(a){s.close();return}En(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{i.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,e._capability.resolve(new fY(r,this))}),t.on("DocException",r=>{e._capability.reject(Jr(r))}),t.on("PasswordRequest",r=>{k(this,qo,Promise.withResolvers());try{if(!e.onPassword)throw Jr(r);const s=i=>{i instanceof Error?f(this,qo).reject(i):f(this,qo).resolve({password:i})};e.onPassword(s,r.code)}catch(s){f(this,qo).reject(s)}return f(this,qo).promise}),t.on("DataLoaded",r=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;f(this,eo).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,s,i])=>{var o;if(this.destroyed||this.commonObjs.has(r))return null;switch(s){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in i){const p=i.error;ne(`Error during font loading: ${p}`),this.commonObjs.resolve(r,p);break}const u=c&&((o=globalThis.FontInspector)!=null&&o.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,d=new m9(i,{disableFontFace:a,fontExtraProperties:l,inspectFont:u});this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!l&&d.data&&(d.data=null),this.commonObjs.resolve(r,d)});break;case"CopyLocalImage":const{imageRef:h}=i;En(h,"The imageRef must be defined.");for(const p of f(this,eo).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===h)return g.dataLen?(this.commonObjs.resolve(r,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,i);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([r,s,i,o])=>{var l;if(this.destroyed)return;const a=f(this,eo).get(s);if(!a.objs.has(r)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(i){case"Image":a.objs.resolve(r,o),(o==null?void 0:o.dataLen)>WG&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),t.on("DocProgress",r=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:r.loaded,total:r.total})}),t.on("FetchBuiltInCMap",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)}),t.on("FetchStandardFontData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((r=this._fullReader)==null?void 0:r.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,r=f(this,Ih).get(e);if(r)return r;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&f(this,Rh).set(i.refStr,t);const o=new pY(e,i,this,this._params.pdfBug);return f(this,eo).set(e,o),o});return f(this,Ih).set(e,s),s}getPageIndex(t){return i2(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return P(this,iu,pp).call(this,"GetFieldObjects")}hasJSActions(){return P(this,iu,pp).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return P(this,iu,pp).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return P(this,iu,pp).call(this,"GetOptionalContentConfig").then(e=>new B9(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=f(this,Xo).get(t);if(e)return e;const r=this.messageHandler.sendWithPromise(t,null).then(s=>{var i,o;return{info:s[0],metadata:s[1]?new L9(s[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return f(this,Xo).set(t,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of f(this,eo).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),f(this,Xo).clear(),this.filterFactory.destroy(!0),Pg.cleanup()}}cachedPageNumber(t){if(!i2(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return f(this,Rh).get(e)??null}}Xo=new WeakMap,eo=new WeakMap,Ih=new WeakMap,Rh=new WeakMap,qo=new WeakMap,iu=new WeakSet,pp=function(t,e=null){const r=f(this,Xo).get(t);if(r)return r;const s=this.messageHandler.sendWithPromise(t,e);return f(this,Xo).set(t,s),s};const Wf=Symbol("INITIAL_DATA");var ys,wm,hA;class SN{constructor(){M(this,wm);M(this,ys,Object.create(null))}get(t,e=null){if(e){const s=P(this,wm,hA).call(this,t);return s.promise.then(()=>e(s.data)),null}const r=f(this,ys)[t];if(!r||r.data===Wf)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const e=f(this,ys)[t];return!!e&&e.data!==Wf}delete(t){const e=f(this,ys)[t];return!e||e.data===Wf?!1:(delete f(this,ys)[t],!0)}resolve(t,e=null){const r=P(this,wm,hA).call(this,t);r.data=e,r.resolve()}clear(){var t;for(const e in f(this,ys)){const{data:r}=f(this,ys)[e];(t=r==null?void 0:r.bitmap)==null||t.close()}k(this,ys,Object.create(null))}*[Symbol.iterator](){for(const t in f(this,ys)){const{data:e}=f(this,ys)[t];e!==Wf&&(yield[t,e])}}}ys=new WeakMap,wm=new WeakSet,hA=function(t){var e;return(e=f(this,ys))[t]||(e[t]={...Promise.withResolvers(),data:Wf})};var xl;class yY{constructor(t){M(this,xl,null);k(this,xl,t),this.onContinue=null}get promise(){return f(this,xl).capability.promise}cancel(t=0){f(this,xl).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=f(this,xl).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=f(this,xl);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}xl=new WeakMap;var Sl,ou;const Sc=class Sc{constructor({callback:t,params:e,objs:r,commonObjs:s,annotationCanvasMap:i,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:d=!1,pageColors:h=null}){M(this,Sl,null);this.callback=t,this.params=e,this.objs=r,this.commonObjs=s,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new yY(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var a,l;if(this.cancelled)return;if(this._canvas){if(f(Sc,ou).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");f(Sc,ou).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:s,transform:i,background:o}=this.params;this.gfx=new nh(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,e=0){var r;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),f(this,Sl)&&(window.cancelAnimationFrame(f(this,Sl)),k(this,Sl,null)),f(Sc,ou).delete(this._canvas),this.callback(t||new kk(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?k(this,Sl,window.requestAnimationFrame(()=>{k(this,Sl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),f(Sc,ou).delete(this._canvas),this.callback())))}};Sl=new WeakMap,ou=new WeakMap,M(Sc,ou,new WeakSet);let fA=Sc;const bY="4.10.38",vY="f9bea397f";function o2(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Kf(n){return Math.max(0,Math.min(255,255*n))}class a2{static CMYK_G([t,e,r,s]){return["G",1-Math.min(1,.3*t+.59*r+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Kf(t),[t,t,t]}static G_HTML([t]){const e=o2(t);return`#${e}${e}${e}`}static RGB_G([t,e,r]){return["G",.3*t+.59*e+.11*r]}static RGB_rgb(t){return t.map(Kf)}static RGB_HTML(t){return`#${t.map(o2).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,r,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,r+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,r,s]){return[Kf(1-Math.min(1,t+s)),Kf(1-Math.min(1,r+s)),Kf(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,r]){const s=1-t,i=1-e,o=1-r,a=Math.min(s,i,o);return["CMYK",s,i,o,a]}}class wY{create(t,e,r=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),r||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ve("Abstract method `_createSVG` called.")}}class Ik extends wY{_createSVG(t){return document.createElementNS(Po,t)}}class AN{static setupStorage(t,e,r,s,i){const o=s.getValue(e,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),i==="print")break;t.addEventListener("input",a=>{s.setValue(e,{value:a.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?t.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&t.removeAttribute("checked"),i==="print")break;t.addEventListener("change",a=>{s.setValue(e,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),i==="print")break;t.addEventListener("input",a=>{s.setValue(e,{value:a.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const a of r.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}t.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:r=null,intent:s,linkService:i}){const{attributes:o}=e,a=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}a&&i.addLinkAttributes(t,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(t,o.dataId,e,r)}static render(t){var d,h;const e=t.annotationStorage,r=t.linkService,s=t.xfaHtml,i=t.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:i,linkService:r});const a=i!=="richText",l=t.div;if(l.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=p}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);o.append(p),a&&Og.shouldBuildText(s.name)&&c.push(p)}return{textDivs:c}}const u=[[s,-1,o]];for(;u.length>0;){const[p,g,m]=u.at(-1);if(g+1===p.children.length){u.pop();continue}const b=p.children[++u.at(-1)[1]];if(b===null)continue;const{name:y}=b;if(y==="#text"){const x=document.createTextNode(b.value);c.push(x),m.append(x);continue}const v=(d=b==null?void 0:b.attributes)!=null&&d.xmlns?document.createElementNS(b.attributes.xmlns,y):document.createElement(y);if(m.append(v),b.attributes&&this.setAttributes({html:v,element:b,storage:e,intent:i,linkService:r}),((h=b.children)==null?void 0:h.length)>0)u.push([b,-1,v]);else if(b.value){const x=document.createTextNode(b.value);a&&Og.shouldBuildText(y)&&c.push(x),v.append(x)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const vy=1e3,xY=9,nd=new WeakSet;function Kl(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class SY{static create(t){switch(t.data.annotationType){case Mn.LINK:return new EN(t);case Mn.TEXT:return new AY(t);case Mn.WIDGET:switch(t.data.fieldType){case"Tx":return new EY(t);case"Btn":return t.data.radioButton?new TN(t):t.data.checkBox?new CY(t):new TY(t);case"Ch":return new MY(t);case"Sig":return new kY(t)}return new dd(t);case Mn.POPUP:return new gA(t);case Mn.FREETEXT:return new RN(t);case Mn.LINE:return new OY(t);case Mn.SQUARE:return new IY(t);case Mn.CIRCLE:return new RY(t);case Mn.POLYLINE:return new DN(t);case Mn.CARET:return new NY(t);case Mn.INK:return new Rk(t);case Mn.POLYGON:return new DY(t);case Mn.HIGHLIGHT:return new NN(t);case Mn.UNDERLINE:return new _Y(t);case Mn.SQUIGGLY:return new LY(t);case Mn.STRIKEOUT:return new FY(t);case Mn.STAMP:return new _N(t);case Mn.FILEATTACHMENT:return new BY(t);default:return new xn(t)}}}var au,Dh,Nh,xm,pA;const Bk=class Bk{constructor(t,{isRenderable:e=!1,ignoreBorder:r=!1,createQuadrilaterals:s=!1}={}){M(this,xm);M(this,au,null);M(this,Dh,!1);M(this,Nh,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(r)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:r}){return!!(t!=null&&t.str||e!=null&&e.str||r!=null&&r.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Bk._hasPopupData(this.data)}updateEdited(t){var r;if(!this.container)return;f(this,au)||k(this,au,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&P(this,xm,pA).call(this,e),(r=f(this,Nh))==null||r.popup.updateEdited(t)}resetEdited(){var t;f(this,au)&&(P(this,xm,pA).call(this,f(this,au).rect),(t=f(this,Nh))==null||t.popup.resetEdited(),k(this,au,null))}_createContainer(t){const{data:e,parent:{page:r,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",e.id),this instanceof dd||(i.tabIndex=vy);const{style:o}=i;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(i.title=e.alternativeText),e.noRotate&&i.classList.add("norotate"),!e.rect||this instanceof gA){const{rotation:m}=e;return!e.hasOwnCanvas&&m!==0&&this.setRotation(m,i),i}const{width:a,height:l}=Kl(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const m=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(m>0||b>0){const v=`calc(${m}px * var(--scale-factor)) / calc(${b}px * var(--scale-factor))`;o.borderRadius=v}else if(this instanceof TN){const v=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=v}switch(e.borderStyle.style){case zf.SOLID:o.borderStyle="solid";break;case zf.DASHED:o.borderStyle="dashed";break;case zf.BEVELED:ne("Unimplemented border style: beveled");break;case zf.INSET:ne("Unimplemented border style: inset");break;case zf.UNDERLINE:o.borderBottomStyle="solid";break}const y=e.borderColor||null;y?(k(this,Dh,!0),o.borderColor=Mt.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):o.borderWidth=0}const c=Mt.normalizeRect([e.rect[0],r.view[3]-e.rect[1]+r.view[1],e.rect[2],r.view[3]-e.rect[3]+r.view[1]]),{pageWidth:u,pageHeight:d,pageX:h,pageY:p}=s.rawDims;o.left=`${100*(c[0]-h)/u}%`,o.top=`${100*(c[1]-p)/d}%`;const{rotation:g}=e;return e.hasOwnCanvas||g===0?(o.width=`${100*a/u}%`,o.height=`${100*l/d}%`):this.setRotation(g,i),i}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:s}=this.parent.viewport.rawDims,{width:i,height:o}=Kl(this.data.rect);let a,l;t%180===0?(a=100*i/r,l=100*o/s):(a=100*o/r,l=100*i/s),e.style.width=`${a}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,r,s)=>{const i=s.detail[e],o=i[0],a=i.slice(1);s.target.style[r]=a2[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[r]:a2[`${o}_rgb`](a)})};return he(this,"_commonActions",{display:e=>{const{display:r}=e.detail,s=r%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:r===1||r===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:r}=e.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const r=e.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(t,e){const r=this._commonActions;for(const s of Object.keys(e.detail)){const i=t[s]||r[s];i==null||i(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const r=this._commonActions;for(const[s,i]of Object.entries(e)){const o=r[s];if(o){const a={detail:{[s]:i},target:t};o(a),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,r,s,i]=this.data.rect.map(m=>Math.fround(m));if(t.length===8){const[m,b,y,v]=t.subarray(2,6);if(s===m&&i===b&&e===y&&r===v)return}const{style:o}=this.container;let a;if(f(this,Dh)){const{borderColor:m,borderWidth:b}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const l=s-e,c=i-r,{svgFactory:u}=this,d=u.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=u.createElement("defs");d.append(h);const p=u.createElement("clipPath"),g=`clippath_${this.data.id}`;p.setAttribute("id",g),p.setAttribute("clipPathUnits","objectBoundingBox"),h.append(p);for(let m=2,b=t.length;m<b;m+=8){const y=t[m],v=t[m+1],x=t[m+2],S=t[m+3],w=u.createElement("rect"),E=(x-e)/l,T=(i-v)/c,I=(y-x)/l,C=(v-S)/c;w.setAttribute("x",E),w.setAttribute("y",T),w.setAttribute("width",I),w.setAttribute("height",C),p.append(w),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${E}" y="${T}" width="${I}" height="${C}"/>`)}f(this,Dh)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:t}=this,e=k(this,Nh,new gA({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Ve("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const r=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:i,id:o,exportValues:a}of s){if(i===-1||o===e)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!nd.has(c)){ne(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:l,domElement:c})}return r}for(const s of document.getElementsByName(t)){const{exportValue:i}=s,o=s.getAttribute("data-element-id");o!==e&&nd.has(s)&&r.push({id:o,exportValue:i,domElement:s})}return r}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};au=new WeakMap,Dh=new WeakMap,Nh=new WeakMap,xm=new WeakSet,pA=function(t){const{container:{style:e},data:{rect:r,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:l}}}}=this;r==null||r.splice(0,4,...t);const{width:c,height:u}=Kl(t);e.left=`${100*(t[0]-a)/i}%`,e.top=`${100*(o-t[3]+l)/o}%`,s===0?(e.width=`${100*c/i}%`,e.height=`${100*u/o}%`):this.setRotation(s)};let xn=Bk;var Ts,mc,kN,CN;class EN extends xn{constructor(e,r=null){super(e,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});M(this,Ts);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:r}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let i=!1;return e.url?(r.addLinkAttributes(s,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(s,e.action),i=!0):e.attachment?(P(this,Ts,kN).call(this,s,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(P(this,Ts,CN).call(this,s,e.setOCGState),i=!0):e.dest?(this._bindLink(s,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),i=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}_bindLink(e,r){e.href=this.linkService.getDestinationHash(r),e.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&P(this,Ts,mc).call(this)}_bindNamedAction(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(r),!1),P(this,Ts,mc).call(this)}_bindJSAction(e,r){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(r.actions)){const o=s.get(i);o&&(e[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:i}}),!1})}e.onclick||(e.onclick=()=>!1),P(this,Ts,mc).call(this)}_bindResetFormAction(e,r){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),P(this,Ts,mc).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var d;s==null||s();const{fields:i,refs:o,include:a}=r,l=[];if(i.length!==0||o.length!==0){const h=new Set(o);for(const p of i){const g=this._fieldObjects[p]||[];for(const{id:m}of g)h.add(m)}for(const p of Object.values(this._fieldObjects))for(const g of p)h.has(g.id)===a&&l.push(g)}else for(const h of Object.values(this._fieldObjects))l.push(...h);const c=this.annotationStorage,u=[];for(const h of l){const{id:p}=h;switch(u.push(p),h.type){case"text":{const m=h.defaultValue||"";c.setValue(p,{value:m});break}case"checkbox":case"radiobutton":{const m=h.defaultValue===h.exportValues;c.setValue(p,{value:m});break}case"combobox":case"listbox":{const m=h.defaultValue||"";c.setValue(p,{value:m});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!nd.has(g)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}Ts=new WeakSet,mc=function(){this.container.setAttribute("data-internal-link","")},kN=function(e,r,s=null){e.href=this.linkService.getAnchorUrl(""),r.description&&(e.title=r.description),e.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(r.content,r.filename,s),!1},P(this,Ts,mc).call(this)},CN=function(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(r),!1),P(this,Ts,mc).call(this)};class AY extends xn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class dd extends xn{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return jr.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,r,s,i){r.includes("mouse")?t.addEventListener(r,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(r,o=>{var a;if(r==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(r==="focus"){if(e.focused)return;e.focused=!0}i&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o)}}))})}_setEventListeners(t,e,r,s){var i,o,a;for(const[l,c]of r)(c==="Action"||(i=this.data.actions)!=null&&i[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,c,s),c==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Mt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||xY,i=t.style;let o;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),u=Math.round(c/(qx*s))||1,d=c/u;o=Math.min(s,l(d/qx))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,l(c/qx))}i.fontSize=`calc(${o}px * var(--scale-factor))`,i.color=Mt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(i.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class EY extends dd{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,r,s){const i=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=r),i.setValue(o.id,{[s]:r})}render(){var s,i;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let a=o.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=o.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??a,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",c??a),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),nd.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=vy,this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",h=>{t.setValue(e,{value:h.target.value}),this.setPropertyOnSiblings(r,"value",h.target.value,"value"),u.formattedValue=null}),r.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue??"";r.value=u.userValue=p,u.formattedValue=null});let d=h=>{const{formattedValue:p}=u;p!=null&&(h.target.value=p),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",p=>{var m;if(u.focused)return;const{target:g}=p;u.userValue&&(g.value=u.userValue),u.lastCommittedValue=g.value,u.commitKey=1,(m=this.data.actions)!=null&&m.Focus||(u.focused=!0)}),r.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const g={value(m){u.userValue=m.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),m.target.value=u.userValue},formattedValue(m){const{formattedValue:b}=m.detail;u.formattedValue=b,b!=null&&m.target!==document.activeElement&&(m.target.value=b),t.setValue(e,{formattedValue:b})},selRange(m){m.target.setSelectionRange(...m.detail.selRange)},charLimit:m=>{var x;const{charLimit:b}=m.detail,{target:y}=m;if(b===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",b);let v=u.userValue;!v||v.length<=b||(v=v.slice(0,b),y.value=u.userValue=v,t.setValue(e,{value:v}),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(g,p)}),r.addEventListener("keydown",p=>{var b;u.commitKey=1;let g=-1;if(p.key==="Escape"?g=0:p.key==="Enter"&&!this.data.multiLine?g=2:p.key==="Tab"&&(u.commitKey=3),g===-1)return;const{value:m}=p.target;u.lastCommittedValue!==m&&(u.lastCommittedValue=m,u.userValue=m,(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:g,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const h=d;d=null,r.addEventListener("blur",p=>{var m,b;if(!u.focused||!p.relatedTarget)return;(m=this.data.actions)!=null&&m.Blur||(u.focused=!1);const{value:g}=p.target;u.userValue=g,u.lastCommittedValue!==g&&((b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),h(p)}),(i=this.data.actions)!=null&&i.Keystroke&&r.addEventListener("beforeinput",p=>{var w;u.lastCommittedValue=null;const{data:g,target:m}=p,{value:b,selectionStart:y,selectionEnd:v}=m;let x=y,S=v;switch(p.inputType){case"deleteWordBackward":{const E=b.substring(0,y).match(/\w*[^\w]*$/);E&&(x-=E[0].length);break}case"deleteWordForward":{const E=b.substring(y).match(/^[^\w]*\w*/);E&&(S+=E[0].length);break}case"deleteContentBackward":y===v&&(x-=1);break;case"deleteContentForward":y===v&&(S+=1);break}p.preventDefault(),(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,change:g||"",willCommit:!1,selStart:x,selEnd:S}})}),this._setEventListeners(r,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&r.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class kY extends dd{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class CY extends dd{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,r=e.id;let s=t.getValue(r,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(r,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return nd.add(i),i.setAttribute("data-element-id",r),i.disabled=e.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=e.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",e.exportValue),i.tabIndex=vy,i.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,r)){const u=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=u),t.setValue(c.id,{value:u})}t.setValue(r,{value:l})}),i.addEventListener("resetform",o=>{const a=e.defaultFieldValue||"Off";o.target.checked=a===e.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class TN extends dd{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,r=e.id;let s=t.getValue(r,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(r,{value:s})),s)for(const o of this._getElementsByName(e.fieldName,r))t.setValue(o.id,{value:!1});const i=document.createElement("input");if(nd.add(i),i.setAttribute("data-element-id",r),i.disabled=e.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=e.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=vy,i.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,r))t.setValue(c.id,{value:!1});t.setValue(r,{value:l})}),i.addEventListener("resetform",o=>{const a=e.defaultFieldValue;o.target.checked=a!=null&&a===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;i.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const u=o===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const h=u&&d.id===r;d.domElement&&(d.domElement.checked=h),t.setValue(d.id,{value:h})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class TY extends EN{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),t}}class MY extends dd{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,r=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");nd.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=vy;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",u=>{const d=this.data.defaultFieldValue;for(const h of s.options)h.selected=h.value===d});for(const u of this.data.options){const d=document.createElement("option");d.textContent=u.displayValue,d.value=u.exportValue,r.value.includes(u.exportValue)&&(d.setAttribute("selected",!0),i=!1),s.append(d)}let o=null;if(i){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),s.prepend(u),o=()=>{u.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=u=>{const d=u?"value":"textContent",{options:h,multiple:p}=s;return p?Array.prototype.filter.call(h,g=>g.selected).map(g=>g[d]):h.selectedIndex===-1?null:h[h.selectedIndex][d]};let l=a(!1);const c=u=>{const d=u.target.options;return Array.prototype.map.call(d,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",u=>{const d={value(h){o==null||o();const p=h.detail.value,g=new Set(Array.isArray(p)?p:[p]);for(const m of s.options)m.selected=g.has(m.value);t.setValue(e,{value:a(!0)}),l=a(!1)},multipleSelection(h){s.multiple=!0},remove(h){const p=s.options,g=h.detail.remove;p[g].selected=!1,s.remove(g),p.length>0&&Array.prototype.findIndex.call(p,b=>b.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:a(!0),items:c(h)}),l=a(!1)},clear(h){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=a(!1)},insert(h){const{index:p,displayValue:g,exportValue:m}=h.detail.insert,b=s.children[p],y=document.createElement("option");y.textContent=g,y.value=m,b?b.before(y):s.append(y),t.setValue(e,{value:a(!0),items:c(h)}),l=a(!1)},items(h){const{items:p}=h.detail;for(;s.length!==0;)s.remove(0);for(const g of p){const{displayValue:m,exportValue:b}=g,y=document.createElement("option");y.textContent=m,y.value=b,s.append(y)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:a(!0),items:c(h)}),l=a(!1)},indices(h){const p=new Set(h.detail.indices);for(const g of h.target.options)g.selected=p.has(g.index);t.setValue(e,{value:a(!0)}),l=a(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(d,u)}),s.addEventListener("input",u=>{var p;const d=a(!0),h=a(!1);t.setValue(e,{value:d}),u.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:h,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):s.addEventListener("input",function(u){t.setValue(e,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class gA extends xn{constructor(t){const{data:e,elements:r}=t;super(t,{isRenderable:xn._hasPopupData(e)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new PY({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",e.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(r=>`${Ek}${r}`).join(",")),this.container}}var _h,$v,jv,Lh,lu,gn,Jo,Fh,Sm,Am,Bh,Qo,gi,Zo,Em,ta,km,cu,uu,Be,H0,mA,MN,PN,ON,IN,V0,z0,yA;class PY{constructor({container:t,color:e,elements:r,titleObj:s,modificationDate:i,contentsObj:o,richText:a,parent:l,rect:c,parentRect:u,open:d}){M(this,Be);M(this,_h,P(this,Be,ON).bind(this));M(this,$v,P(this,Be,yA).bind(this));M(this,jv,P(this,Be,z0).bind(this));M(this,Lh,P(this,Be,V0).bind(this));M(this,lu,null);M(this,gn,null);M(this,Jo,null);M(this,Fh,null);M(this,Sm,null);M(this,Am,null);M(this,Bh,null);M(this,Qo,!1);M(this,gi,null);M(this,Zo,null);M(this,Em,null);M(this,ta,null);M(this,km,null);M(this,cu,null);M(this,uu,!1);var h;k(this,gn,t),k(this,km,s),k(this,Jo,o),k(this,ta,a),k(this,Am,l),k(this,lu,e),k(this,Em,c),k(this,Bh,u),k(this,Sm,r),k(this,Fh,Tk.toDateObject(i)),this.trigger=r.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",f(this,Lh)),p.addEventListener("mouseenter",f(this,jv)),p.addEventListener("mouseleave",f(this,$v)),p.classList.add("popupTriggerArea");for(const p of r)(h=p.container)==null||h.addEventListener("keydown",f(this,_h));f(this,gn).hidden=!0,d&&P(this,Be,V0).call(this)}render(){if(f(this,gi))return;const t=k(this,gi,document.createElement("div"));if(t.className="popup",f(this,lu)){const i=t.style.outlineColor=Mt.makeHexColor(...f(this,lu));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:t.style.backgroundColor=Mt.makeHexColor(...f(this,lu).map(a=>Math.floor(.7*(255-a)+a)))}const e=document.createElement("span");e.className="header";const r=document.createElement("h1");if(e.append(r),{dir:r.dir,str:r.textContent}=f(this,km),t.append(e),f(this,Fh)){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:f(this,Fh).valueOf()})),e.append(i)}const s=f(this,Be,H0);if(s)AN.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(f(this,Jo));t.append(i)}f(this,gn).append(t)}_formatContents({str:t,dir:e}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let i=0,o=s.length;i<o;++i){const a=s[i];r.append(document.createTextNode(a)),i<o-1&&r.append(document.createElement("br"))}return r}updateEdited({rect:t,popupContent:e}){var r;f(this,cu)||k(this,cu,{contentsObj:f(this,Jo),richText:f(this,ta)}),t&&k(this,Zo,null),e&&(k(this,ta,P(this,Be,PN).call(this,e)),k(this,Jo,null)),(r=f(this,gi))==null||r.remove(),k(this,gi,null)}resetEdited(){var t;f(this,cu)&&({contentsObj:Pr(this,Jo)._,richText:Pr(this,ta)._}=f(this,cu),k(this,cu,null),(t=f(this,gi))==null||t.remove(),k(this,gi,null),k(this,Zo,null))}forceHide(){k(this,uu,this.isVisible),f(this,uu)&&(f(this,gn).hidden=!0)}maybeShow(){f(this,uu)&&(f(this,gi)||P(this,Be,z0).call(this),k(this,uu,!1),f(this,gn).hidden=!1)}get isVisible(){return f(this,gn).hidden===!1}}_h=new WeakMap,$v=new WeakMap,jv=new WeakMap,Lh=new WeakMap,lu=new WeakMap,gn=new WeakMap,Jo=new WeakMap,Fh=new WeakMap,Sm=new WeakMap,Am=new WeakMap,Bh=new WeakMap,Qo=new WeakMap,gi=new WeakMap,Zo=new WeakMap,Em=new WeakMap,ta=new WeakMap,km=new WeakMap,cu=new WeakMap,uu=new WeakMap,Be=new WeakSet,H0=function(){const t=f(this,ta),e=f(this,Jo);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&f(this,ta).html||null},mA=function(){var t,e,r;return((r=(e=(t=f(this,Be,H0))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:r.fontSize)||0},MN=function(){var t,e,r;return((r=(e=(t=f(this,Be,H0))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:r.color)||null},PN=function(t){const e=[],r={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:f(this,Be,MN),fontSize:f(this,Be,mA)?`calc(${f(this,Be,mA)}px * var(--scale-factor))`:""}};for(const i of t.split(`
`))e.push({name:"span",value:i,attributes:s});return r},ON=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&f(this,Qo))&&P(this,Be,V0).call(this)},IN=function(){if(f(this,Zo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:r,pageX:s,pageY:i}}}=f(this,Am);let o=!!f(this,Bh),a=o?f(this,Bh):f(this,Em);for(const g of f(this,Sm))if(!a||Mt.intersect(g.data.rect,a)!==null){a=g.data.rect,o=!0;break}const l=Mt.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),u=o?a[2]-a[0]+5:0,d=l[0]+u,h=l[1];k(this,Zo,[100*(d-s)/e,100*(h-i)/r]);const{style:p}=f(this,gn);p.left=`${f(this,Zo)[0]}%`,p.top=`${f(this,Zo)[1]}%`},V0=function(){k(this,Qo,!f(this,Qo)),f(this,Qo)?(P(this,Be,z0).call(this),f(this,gn).addEventListener("click",f(this,Lh)),f(this,gn).addEventListener("keydown",f(this,_h))):(P(this,Be,yA).call(this),f(this,gn).removeEventListener("click",f(this,Lh)),f(this,gn).removeEventListener("keydown",f(this,_h)))},z0=function(){f(this,gi)||this.render(),this.isVisible?f(this,Qo)&&f(this,gn).classList.add("focused"):(P(this,Be,IN).call(this),f(this,gn).hidden=!1,f(this,gn).style.zIndex=parseInt(f(this,gn).style.zIndex)+1e3)},yA=function(){f(this,gn).classList.remove("focused"),!(f(this,Qo)||!this.isVisible)&&(f(this,gn).hidden=!0,f(this,gn).style.zIndex=parseInt(f(this,gn).style.zIndex)-1e3)};class RN extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=te.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const r=document.createElement("span");r.textContent=e,t.append(r)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Cm;class OY extends xn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});M(this,Cm,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:r,height:s}=Kl(e.rect),i=this.svgFactory.create(r,s,!0),o=k(this,Cm,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Cm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cm=new WeakMap;var Tm;class IY extends xn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});M(this,Tm,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:r,height:s}=Kl(e.rect),i=this.svgFactory.create(r,s,!0),o=e.borderStyle.width,a=k(this,Tm,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",r-o),a.setAttribute("height",s-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Tm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tm=new WeakMap;var Mm;class RY extends xn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});M(this,Mm,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:r,height:s}=Kl(e.rect),i=this.svgFactory.create(r,s,!0),o=e.borderStyle.width,a=k(this,Mm,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",r/2),a.setAttribute("cy",s/2),a.setAttribute("rx",r/2-o/2),a.setAttribute("ry",s/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Mm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mm=new WeakMap;var Pm;class DN extends xn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});M(this,Pm,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:r,borderStyle:s,popupRef:i}}=this;if(!r)return this.container;const{width:o,height:a}=Kl(e),l=this.svgFactory.create(o,a,!0);let c=[];for(let d=0,h=r.length;d<h;d+=2){const p=r[d]-e[0],g=e[3]-r[d+1];c.push(`${p},${g}`)}c=c.join(" ");const u=k(this,Pm,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",s.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Pm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pm=new WeakMap;class DY extends DN{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class NY extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Om,du,Im,bA;class Rk extends xn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});M(this,Im);M(this,Om,null);M(this,du,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?te.HIGHLIGHT:te.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:r,inkLists:s,borderStyle:i,popupRef:o}}=this,{transform:a,width:l,height:c}=P(this,Im,bA).call(this,r,e),u=this.svgFactory.create(l,c,!0),d=k(this,Om,this.svgFactory.createElement("svg:g"));u.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let h=0,p=s.length;h<p;h++){const g=this.svgFactory.createElement(this.svgElementName);f(this,du).push(g),g.setAttribute("points",s[h].join(",")),d.append(g)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:r,points:s,rect:i}=e,o=f(this,Om);if(r>=0&&o.setAttribute("stroke-width",r||1),s)for(let a=0,l=f(this,du).length;a<l;a++)f(this,du)[a].setAttribute("points",s[a].join(","));if(i){const{transform:a,width:l,height:c}=P(this,Im,bA).call(this,this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return f(this,du)}addHighlightArea(){this.container.classList.add("highlightArea")}}Om=new WeakMap,du=new WeakMap,Im=new WeakSet,bA=function(e,r){switch(e){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class NN extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=te.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class _Y extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class LY extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class FY extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class _N extends xn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=te.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Rm,Dm,vA;class BY extends xn{constructor(e){var s;super(e,{isRenderable:!0});M(this,Dm);M(this,Rm,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:r}=this;let s;r.hasAppearance||r.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),s.addEventListener("dblclick",P(this,Dm,vA).bind(this)),k(this,Rm,s);const{isMac:i}=jr.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&P(this,Dm,vA).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return f(this,Rm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rm=new WeakMap,Dm=new WeakSet,vA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Nm,hu,fu,_m,rd,LN,wA;class $Y{constructor({div:t,accessibilityManager:e,annotationCanvasMap:r,annotationEditorUIManager:s,page:i,viewport:o,structTreeLayer:a}){M(this,rd);M(this,Nm,null);M(this,hu,null);M(this,fu,new Map);M(this,_m,null);this.div=t,k(this,Nm,e),k(this,hu,r),k(this,_m,a||null),this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return f(this,fu).size>0}async render(t){var o;const{annotations:e}=t,r=this.div;td(r,this.viewport);const s=new Map,i={data:null,layer:r,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Ik,annotationStorage:t.annotationStorage||new Pk,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===Mn.POPUP;if(l){const d=s.get(a.id);if(!d)continue;i.elements=d}else{const{width:d,height:h}=Kl(a.rect);if(d<=0||h<=0)continue}i.data=a;const c=SY.create(i);if(!c.isRenderable)continue;if(!l&&a.popupRef){const d=s.get(a.popupRef);d?d.push(c):s.set(a.popupRef,[c])}const u=c.render();a.hidden&&(u.style.visibility="hidden"),await P(this,rd,LN).call(this,u,a.id),c._isEditable&&(f(this,fu).set(c.data.id,c),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(c))}P(this,rd,wA).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,td(e,{rotation:t.rotation}),P(this,rd,wA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(f(this,fu).values())}getEditableAnnotation(t){return f(this,fu).get(t)}}Nm=new WeakMap,hu=new WeakMap,fu=new WeakMap,_m=new WeakMap,rd=new WeakSet,LN=async function(t,e){var o,a;const r=t.firstChild||t,s=r.id=`${Ek}${e}`,i=await((o=f(this,_m))==null?void 0:o.getAriaAttributes(s));if(i)for(const[l,c]of i)r.setAttribute(l,c);this.div.append(t),(a=f(this,Nm))==null||a.moveElementInDOM(this.div,t,r,!1)},wA=function(){if(!f(this,hu))return;const t=this.div;for(const[e,r]of f(this,hu)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;r.className="annotationContent";const{firstChild:i}=s;i?i.nodeName==="CANVAS"?i.replaceWith(r):i.classList.contains("annotationContent")?i.after(r):i.before(r):s.append(r)}f(this,hu).clear()};const r0=/\r\n?|\n/g;var mi,bs,Lm,pu,vs,Tn,FN,BN,$N,U0,xa,W0,K0,jN,SA,HN;const We=class We extends un{constructor(e){super({...e,name:"freeTextEditor"});M(this,Tn);M(this,mi);M(this,bs,"");M(this,Lm,`${this.id}-editor`);M(this,pu,null);M(this,vs);k(this,mi,e.color||We._defaultColor||un._defaultLineColor),k(this,vs,e.fontSize||We._defaultFontSize)}static get _keyboardManager(){const e=We.prototype,r=o=>o.isEmpty(),s=ed.TRANSLATE_SMALL,i=ed.TRANSLATE_BIG;return he(this,"_keyboardManager",new by([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:r}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:r}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:r}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:r}]]))}static initialize(e,r){un.initialize(e,r);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,r){switch(e){case ve.FREETEXT_SIZE:We._defaultFontSize=r;break;case ve.FREETEXT_COLOR:We._defaultColor=r;break}}updateParams(e,r){switch(e){case ve.FREETEXT_SIZE:P(this,Tn,FN).call(this,r);break;case ve.FREETEXT_COLOR:P(this,Tn,BN).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ve.FREETEXT_SIZE,We._defaultFontSize],[ve.FREETEXT_COLOR,We._defaultColor||un._defaultLineColor]]}get propertiesToUpdate(){return[[ve.FREETEXT_SIZE,f(this,vs)],[ve.FREETEXT_COLOR,f(this,mi)]]}_translateEmpty(e,r){this._uiManager.translateSelectedEditors(e,r,!0)}getInitialTranslation(){const e=this.parentScale;return[-We._internalPadding*e,-(We._internalPadding+f(this,vs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(te.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),k(this,pu,new AbortController);const e=this._uiManager.combinedSignal(f(this,pu));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",f(this,Lm)),this._isDraggable=!0,(e=f(this,pu))==null||e.abort(),k(this,pu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var r;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=f(this,bs),r=k(this,bs,P(this,Tn,$N).call(this).trimEnd());if(e===r)return;const s=i=>{if(k(this,bs,i),!i){this.remove();return}P(this,Tn,K0).call(this),this._uiManager.rebuild(this),P(this,Tn,U0).call(this)};this.addCommands({cmd:()=>{s(r)},undo:()=>{s(e)},mustExec:!1}),P(this,Tn,U0).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){We._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,r;this.width&&(e=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",f(this,Lm)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${f(this,vs)}px * var(--scale-factor))`,s.color=f(this,mi),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),wv(this,this.div,["dblclick","keydown"]),this.width){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,d]=this.pageDimensions,[h,p]=this.pageTranslation;let g,m;switch(this.rotation){case 0:g=e+(a[0]-h)/u,m=r+this.height-(a[1]-p)/d;break;case 90:g=e+(a[0]-h)/u,m=r-(a[1]-p)/d,[l,c]=[c,-l];break;case 180:g=e-this.width+(a[0]-h)/u,m=r-(a[1]-p)/d,[l,c]=[-l,-c];break;case 270:g=e+(a[0]-h-this.height*d)/u,m=r+(a[1]-p-this.width*u)/d,[l,c]=[-c,l];break}this.setAt(g*i,m*o,l,c)}else this.setAt(e*i,r*o,this.width*i,this.height*o);P(this,Tn,K0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var g,m,b;const r=e.clipboardData||window.clipboardData,{types:s}=r;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const i=P(g=We,xa,SA).call(g,r.getData("text")||"").replaceAll(r0,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!i.includes(`
`)){a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:c}=a,u=[],d=[];if(l.nodeType===Node.TEXT_NODE){const y=l.parentElement;if(d.push(l.nodeValue.slice(c).replaceAll(r0,"")),y!==this.editorDiv){let v=u;for(const x of this.editorDiv.childNodes){if(x===y){v=d;continue}v.push(P(m=We,xa,W0).call(m,x))}}u.push(l.nodeValue.slice(0,c).replaceAll(r0,""))}else if(l===this.editorDiv){let y=u,v=0;for(const x of this.editorDiv.childNodes)v++===c&&(y=d),y.push(P(b=We,xa,W0).call(b,x))}k(this,bs,`${u.join(`
`)}${i}${d.join(`
`)}`),P(this,Tn,K0).call(this);const h=new Range;let p=u.reduce((y,v)=>y+v.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const v=y.nodeValue.length;if(p<=v){h.setStart(y,p),h.setEnd(y,p);break}p-=v}o.removeAllRanges(),o.addRange(h)}get contentDiv(){return this.editorDiv}static async deserialize(e,r,s){var a;let i=null;if(e instanceof RN){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:d,id:h,popupRef:p},textContent:g,textPosition:m,parent:{page:{pageNumber:b}}}=e;if(!g||g.length===0)return null;i=e={annotationType:te.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:m,pageIndex:b-1,rect:u.slice(0),rotation:d,id:h,deleted:!1,popupRef:p}}const o=await super.deserialize(e,r,s);return k(o,vs,e.fontSize),k(o,mi,Mt.makeHexColor(...e.color)),k(o,bs,P(a=We,xa,SA).call(a,e.value)),o.annotationElementId=e.id||null,o._initialData=i,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=We._internalPadding*this.parentScale,s=this.getRect(r,r),i=un._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:f(this,mi)),o={annotationType:te.FREETEXT,color:i,fontSize:f(this,vs),value:P(this,Tn,jN).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!P(this,Tn,HN).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const r=super.renderAnnotationElement(e);if(this.deleted)return r;const{style:s}=r;s.fontSize=`calc(${f(this,vs)}px * var(--scale-factor))`,s.color=f(this,mi),r.replaceChildren();for(const o of f(this,bs).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),r.append(a)}const i=We._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:f(this,bs)}),r}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};mi=new WeakMap,bs=new WeakMap,Lm=new WeakMap,pu=new WeakMap,vs=new WeakMap,Tn=new WeakSet,FN=function(e){const r=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-f(this,vs))*this.parentScale),k(this,vs,i),P(this,Tn,U0).call(this)},s=f(this,vs);this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},BN=function(e){const r=i=>{k(this,mi,this.editorDiv.style.color=i)},s=f(this,mi);this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},$N=function(){var s;const e=[];this.editorDiv.normalize();let r=null;for(const i of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(P(s=We,xa,W0).call(s,i)),r=i);return e.join(`
`)},U0=function(){const[e,r]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/r):(this.width=s.height/e,this.height=s.width/r),this.fixAndSetPosition()},xa=new WeakSet,W0=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(r0,"")},K0=function(){if(this.editorDiv.replaceChildren(),!!f(this,bs))for(const e of f(this,bs).split(`
`)){const r=document.createElement("div");r.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(r)}},jN=function(){return f(this,bs).replaceAll(" "," ")},SA=function(e){return e.replaceAll(" "," ")},HN=function(e){const{value:r,fontSize:s,color:i,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==r||e.fontSize!==s||e.color.some((a,l)=>a!==i[l])||e.pageIndex!==o},M(We,xa),_t(We,"_freeTextDefaultContent",""),_t(We,"_internalPadding",0),_t(We,"_defaultColor",null),_t(We,"_defaultFontSize",10),_t(We,"_type","freetext"),_t(We,"_editorType",te.FREETEXT);let xA=We;class yt{toSVGPath(){Ve("Abstract method `toSVGPath` must be implemented.")}get box(){Ve("Abstract getter `box` must be implemented.")}serialize(t,e){Ve("Abstract method `serialize` must be implemented.")}static _rescale(t,e,r,s,i,o){o||(o=new Float32Array(t.length));for(let a=0,l=t.length;a<l;a+=2)o[a]=e+t[a]*s,o[a+1]=r+t[a+1]*i;return o}static _rescaleAndSwap(t,e,r,s,i,o){o||(o=new Float32Array(t.length));for(let a=0,l=t.length;a<l;a+=2)o[a]=e+t[a+1]*s,o[a+1]=r+t[a]*i;return o}static _translate(t,e,r,s){s||(s=new Float32Array(t.length));for(let i=0,o=t.length;i<o;i+=2)s[i]=e+t[i],s[i+1]=r+t[i+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,r,s,i){switch(i){case 90:return[1-e/r,t/s];case 180:return[1-t/r,1-e/s];case 270:return[e/r,1-t/s];default:return[t/r,e/s]}}static _normalizePagePoint(t,e,r){switch(r){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,r,s,i,o){return[(t+5*r)/6,(e+5*s)/6,(5*r+i)/6,(5*s+o)/6,(r+i)/2,(s+o)/2]}}_t(yt,"PRECISION",1e-4);var ws,yi,$h,jh,no,ue,gu,mu,Fm,Bm,Hh,Vh,Al,$m,Hv,Vv,Ln,gp,VN,zN,UN,WN,KN,GN;const _o=class _o{constructor({x:t,y:e},r,s,i,o,a=0){M(this,Ln);M(this,ws);M(this,yi,[]);M(this,$h);M(this,jh);M(this,no,[]);M(this,ue,new Float32Array(18));M(this,gu);M(this,mu);M(this,Fm);M(this,Bm);M(this,Hh);M(this,Vh);M(this,Al,[]);k(this,ws,r),k(this,Vh,i*s),k(this,jh,o),f(this,ue).set([NaN,NaN,NaN,NaN,t,e],6),k(this,$h,a),k(this,Bm,f(_o,$m)*s),k(this,Fm,f(_o,Vv)*s),k(this,Hh,s),f(this,Al).push(t,e)}isEmpty(){return isNaN(f(this,ue)[8])}add({x:t,y:e}){var C;k(this,gu,t),k(this,mu,e);const[r,s,i,o]=f(this,ws);let[a,l,c,u]=f(this,ue).subarray(8,12);const d=t-c,h=e-u,p=Math.hypot(d,h);if(p<f(this,Fm))return!1;const g=p-f(this,Bm),m=g/p,b=m*d,y=m*h;let v=a,x=l;a=c,l=u,c+=b,u+=y,(C=f(this,Al))==null||C.push(t,e);const S=-y/g,w=b/g,E=S*f(this,Vh),T=w*f(this,Vh);return f(this,ue).set(f(this,ue).subarray(2,8),0),f(this,ue).set([c+E,u+T],4),f(this,ue).set(f(this,ue).subarray(14,18),12),f(this,ue).set([c-E,u-T],16),isNaN(f(this,ue)[6])?(f(this,no).length===0&&(f(this,ue).set([a+E,l+T],2),f(this,no).push(NaN,NaN,NaN,NaN,(a+E-r)/i,(l+T-s)/o),f(this,ue).set([a-E,l-T],14),f(this,yi).push(NaN,NaN,NaN,NaN,(a-E-r)/i,(l-T-s)/o)),f(this,ue).set([v,x,a,l,c,u],6),!this.isEmpty()):(f(this,ue).set([v,x,a,l,c,u],6),Math.abs(Math.atan2(x-l,v-a)-Math.atan2(y,b))<Math.PI/2?([a,l,c,u]=f(this,ue).subarray(2,6),f(this,no).push(NaN,NaN,NaN,NaN,((a+c)/2-r)/i,((l+u)/2-s)/o),[a,l,v,x]=f(this,ue).subarray(14,18),f(this,yi).push(NaN,NaN,NaN,NaN,((v+a)/2-r)/i,((x+l)/2-s)/o),!0):([v,x,a,l,c,u]=f(this,ue).subarray(0,6),f(this,no).push(((v+5*a)/6-r)/i,((x+5*l)/6-s)/o,((5*a+c)/6-r)/i,((5*l+u)/6-s)/o,((a+c)/2-r)/i,((l+u)/2-s)/o),[c,u,a,l,v,x]=f(this,ue).subarray(12,18),f(this,yi).push(((v+5*a)/6-r)/i,((x+5*l)/6-s)/o,((5*a+c)/6-r)/i,((5*l+u)/6-s)/o,((a+c)/2-r)/i,((l+u)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=f(this,no),e=f(this,yi);if(isNaN(f(this,ue)[6])&&!this.isEmpty())return P(this,Ln,VN).call(this);const r=[];r.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?r.push(`L${t[s+4]} ${t[s+5]}`):r.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);P(this,Ln,UN).call(this,r);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?r.push(`L${e[s+4]} ${e[s+5]}`):r.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return P(this,Ln,zN).call(this,r),r.join(" ")}newFreeDrawOutline(t,e,r,s,i,o){return new YN(t,e,r,s,i,o)}getOutlines(){var d;const t=f(this,no),e=f(this,yi),r=f(this,ue),[s,i,o,a]=f(this,ws),l=new Float32Array((((d=f(this,Al))==null?void 0:d.length)??0)+2);for(let h=0,p=l.length-2;h<p;h+=2)l[h]=(f(this,Al)[h]-s)/o,l[h+1]=(f(this,Al)[h+1]-i)/a;if(l[l.length-2]=(f(this,gu)-s)/o,l[l.length-1]=(f(this,mu)-i)/a,isNaN(r[6])&&!this.isEmpty())return P(this,Ln,WN).call(this,l);const c=new Float32Array(f(this,no).length+24+f(this,yi).length);let u=t.length;for(let h=0;h<u;h+=2){if(isNaN(t[h])){c[h]=c[h+1]=NaN;continue}c[h]=t[h],c[h+1]=t[h+1]}u=P(this,Ln,GN).call(this,c,u);for(let h=e.length-6;h>=6;h-=6)for(let p=0;p<6;p+=2){if(isNaN(e[h+p])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=e[h+p],c[u+1]=e[h+p+1],u+=2}return P(this,Ln,KN).call(this,c,u),this.newFreeDrawOutline(c,l,f(this,ws),f(this,Hh),f(this,$h),f(this,jh))}};ws=new WeakMap,yi=new WeakMap,$h=new WeakMap,jh=new WeakMap,no=new WeakMap,ue=new WeakMap,gu=new WeakMap,mu=new WeakMap,Fm=new WeakMap,Bm=new WeakMap,Hh=new WeakMap,Vh=new WeakMap,Al=new WeakMap,$m=new WeakMap,Hv=new WeakMap,Vv=new WeakMap,Ln=new WeakSet,gp=function(){const t=f(this,ue).subarray(4,6),e=f(this,ue).subarray(16,18),[r,s,i,o]=f(this,ws);return[(f(this,gu)+(t[0]-e[0])/2-r)/i,(f(this,mu)+(t[1]-e[1])/2-s)/o,(f(this,gu)+(e[0]-t[0])/2-r)/i,(f(this,mu)+(e[1]-t[1])/2-s)/o]},VN=function(){const[t,e,r,s]=f(this,ws),[i,o,a,l]=P(this,Ln,gp).call(this);return`M${(f(this,ue)[2]-t)/r} ${(f(this,ue)[3]-e)/s} L${(f(this,ue)[4]-t)/r} ${(f(this,ue)[5]-e)/s} L${i} ${o} L${a} ${l} L${(f(this,ue)[16]-t)/r} ${(f(this,ue)[17]-e)/s} L${(f(this,ue)[14]-t)/r} ${(f(this,ue)[15]-e)/s} Z`},zN=function(t){const e=f(this,yi);t.push(`L${e[4]} ${e[5]} Z`)},UN=function(t){const[e,r,s,i]=f(this,ws),o=f(this,ue).subarray(4,6),a=f(this,ue).subarray(16,18),[l,c,u,d]=P(this,Ln,gp).call(this);t.push(`L${(o[0]-e)/s} ${(o[1]-r)/i} L${l} ${c} L${u} ${d} L${(a[0]-e)/s} ${(a[1]-r)/i}`)},WN=function(t){const e=f(this,ue),[r,s,i,o]=f(this,ws),[a,l,c,u]=P(this,Ln,gp).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-r)/i,(e[3]-s)/o,NaN,NaN,NaN,NaN,(e[4]-r)/i,(e[5]-s)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(e[16]-r)/i,(e[17]-s)/o,NaN,NaN,NaN,NaN,(e[14]-r)/i,(e[15]-s)/o],0),this.newFreeDrawOutline(d,t,f(this,ws),f(this,Hh),f(this,$h),f(this,jh))},KN=function(t,e){const r=f(this,yi);return t.set([NaN,NaN,NaN,NaN,r[4],r[5]],e),e+=6},GN=function(t,e){const r=f(this,ue).subarray(4,6),s=f(this,ue).subarray(16,18),[i,o,a,l]=f(this,ws),[c,u,d,h]=P(this,Ln,gp).call(this);return t.set([NaN,NaN,NaN,NaN,(r[0]-i)/a,(r[1]-o)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(s[0]-i)/a,(s[1]-o)/l],e),e+=24},M(_o,$m,8),M(_o,Hv,2),M(_o,Vv,f(_o,$m)+f(_o,Hv));let Av=_o;var zh,yu,ea,jm,xs,Hm,vn,zv,XN;class YN extends yt{constructor(e,r,s,i,o,a){super();M(this,zv);M(this,zh);M(this,yu,new Float32Array(4));M(this,ea);M(this,jm);M(this,xs);M(this,Hm);M(this,vn);k(this,vn,e),k(this,xs,r),k(this,zh,s),k(this,Hm,i),k(this,ea,o),k(this,jm,a),this.lastPoint=[NaN,NaN],P(this,zv,XN).call(this,a);const[l,c,u,d]=f(this,yu);for(let h=0,p=e.length;h<p;h+=2)e[h]=(e[h]-l)/u,e[h+1]=(e[h+1]-c)/d;for(let h=0,p=r.length;h<p;h+=2)r[h]=(r[h]-l)/u,r[h+1]=(r[h+1]-c)/d}toSVGPath(){const e=[`M${f(this,vn)[4]} ${f(this,vn)[5]}`];for(let r=6,s=f(this,vn).length;r<s;r+=6){if(isNaN(f(this,vn)[r])){e.push(`L${f(this,vn)[r+4]} ${f(this,vn)[r+5]}`);continue}e.push(`C${f(this,vn)[r]} ${f(this,vn)[r+1]} ${f(this,vn)[r+2]} ${f(this,vn)[r+3]} ${f(this,vn)[r+4]} ${f(this,vn)[r+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,r,s,i],o){const a=s-e,l=i-r;let c,u;switch(o){case 0:c=yt._rescale(f(this,vn),e,i,a,-l),u=yt._rescale(f(this,xs),e,i,a,-l);break;case 90:c=yt._rescaleAndSwap(f(this,vn),e,r,a,l),u=yt._rescaleAndSwap(f(this,xs),e,r,a,l);break;case 180:c=yt._rescale(f(this,vn),s,r,-a,l),u=yt._rescale(f(this,xs),s,r,-a,l);break;case 270:c=yt._rescaleAndSwap(f(this,vn),s,i,-a,-l),u=yt._rescaleAndSwap(f(this,xs),s,i,-a,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return f(this,yu)}newOutliner(e,r,s,i,o,a=0){return new Av(e,r,s,i,o,a)}getNewOutline(e,r){const[s,i,o,a]=f(this,yu),[l,c,u,d]=f(this,zh),h=o*u,p=a*d,g=s*u+l,m=i*d+c,b=this.newOutliner({x:f(this,xs)[0]*h+g,y:f(this,xs)[1]*p+m},f(this,zh),f(this,Hm),e,f(this,jm),r??f(this,ea));for(let y=2;y<f(this,xs).length;y+=2)b.add({x:f(this,xs)[y]*h+g,y:f(this,xs)[y+1]*p+m});return b.getOutlines()}}zh=new WeakMap,yu=new WeakMap,ea=new WeakMap,jm=new WeakMap,xs=new WeakMap,Hm=new WeakMap,vn=new WeakMap,zv=new WeakSet,XN=function(e){const r=f(this,vn);let s=r[4],i=r[5],o=s,a=i,l=s,c=i,u=s,d=i;const h=e?Math.max:Math.min;for(let g=6,m=r.length;g<m;g+=6){if(isNaN(r[g]))o=Math.min(o,r[g+4]),a=Math.min(a,r[g+5]),l=Math.max(l,r[g+4]),c=Math.max(c,r[g+5]),d<r[g+5]?(u=r[g+4],d=r[g+5]):d===r[g+5]&&(u=h(u,r[g+4]));else{const b=Mt.bezierBoundingBox(s,i,...r.slice(g,g+6));o=Math.min(o,b[0]),a=Math.min(a,b[1]),l=Math.max(l,b[2]),c=Math.max(c,b[3]),d<b[3]?(u=b[2],d=b[3]):d===b[3]&&(u=h(u,b[2]))}s=r[g+4],i=r[g+5]}const p=f(this,yu);p[0]=o-f(this,ea),p[1]=a-f(this,ea),p[2]=l-o+2*f(this,ea),p[3]=c-a+2*f(this,ea),this.lastPoint=[u,d]};var Vm,zm,El,bi,Vr,qN,G0,JN,QN,EA;class AA{constructor(t,e=0,r=0,s=!0){M(this,Vr);M(this,Vm);M(this,zm);M(this,El,[]);M(this,bi,[]);let i=1/0,o=-1/0,a=1/0,l=-1/0;const c=10**-4;for(const{x:b,y,width:v,height:x}of t){const S=Math.floor((b-e)/c)*c,w=Math.ceil((b+v+e)/c)*c,E=Math.floor((y-e)/c)*c,T=Math.ceil((y+x+e)/c)*c,I=[S,E,T,!0],C=[w,E,T,!1];f(this,El).push(I,C),i=Math.min(i,S),o=Math.max(o,w),a=Math.min(a,E),l=Math.max(l,T)}const u=o-i+2*r,d=l-a+2*r,h=i-r,p=a-r,g=f(this,El).at(s?-1:-2),m=[g[0],g[2]];for(const b of f(this,El)){const[y,v,x]=b;b[0]=(y-h)/u,b[1]=(v-p)/d,b[2]=(x-p)/d}k(this,Vm,new Float32Array([h,p,u,d])),k(this,zm,m)}getOutlines(){f(this,El).sort((e,r)=>e[0]-r[0]||e[1]-r[1]||e[2]-r[2]);const t=[];for(const e of f(this,El))e[3]?(t.push(...P(this,Vr,EA).call(this,e)),P(this,Vr,JN).call(this,e)):(P(this,Vr,QN).call(this,e),t.push(...P(this,Vr,EA).call(this,e)));return P(this,Vr,qN).call(this,t)}}Vm=new WeakMap,zm=new WeakMap,El=new WeakMap,bi=new WeakMap,Vr=new WeakSet,qN=function(t){const e=[],r=new Set;for(const o of t){const[a,l,c]=o;e.push([a,l,o],[a,c,o])}e.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=e.length;o<a;o+=2){const l=e[o][2],c=e[o+1][2];l.push(c),c.push(l),r.add(l),r.add(c)}const s=[];let i;for(;r.size>0;){const o=r.values().next().value;let[a,l,c,u,d]=o;r.delete(o);let h=a,p=l;for(i=[a,c],s.push(i);;){let g;if(r.has(u))g=u;else if(r.has(d))g=d;else break;r.delete(g),[a,l,c,u,d]=g,h!==a&&(i.push(h,p,a,p===l?l:c),h=a),p=p===l?c:l}i.push(h,p)}return new jY(s,f(this,Vm),f(this,zm))},G0=function(t){const e=f(this,bi);let r=0,s=e.length-1;for(;r<=s;){const i=r+s>>1,o=e[i][0];if(o===t)return i;o<t?r=i+1:s=i-1}return s+1},JN=function([,t,e]){const r=P(this,Vr,G0).call(this,t);f(this,bi).splice(r,0,[t,e])},QN=function([,t,e]){const r=P(this,Vr,G0).call(this,t);for(let s=r;s<f(this,bi).length;s++){const[i,o]=f(this,bi)[s];if(i!==t)break;if(i===t&&o===e){f(this,bi).splice(s,1);return}}for(let s=r-1;s>=0;s--){const[i,o]=f(this,bi)[s];if(i!==t)break;if(i===t&&o===e){f(this,bi).splice(s,1);return}}},EA=function(t){const[e,r,s]=t,i=[[e,r,s]],o=P(this,Vr,G0).call(this,s);for(let a=0;a<o;a++){const[l,c]=f(this,bi)[a];for(let u=0,d=i.length;u<d;u++){const[,h,p]=i[u];if(!(c<=h||p<=l)){if(h>=l){if(p>c)i[u][1]=c;else{if(d===1)return[];i.splice(u,1),u--,d--}continue}i[u][2]=l,p>c&&i.push([e,c,p])}}}return i};var Um,Uh;class jY extends yt{constructor(e,r,s){super();M(this,Um);M(this,Uh);k(this,Uh,e),k(this,Um,r),this.lastPoint=s}toSVGPath(){const e=[];for(const r of f(this,Uh)){let[s,i]=r;e.push(`M${s} ${i}`);for(let o=2;o<r.length;o+=2){const a=r[o],l=r[o+1];a===s?(e.push(`V${l}`),i=l):l===i&&(e.push(`H${a}`),s=a)}e.push("Z")}return e.join(" ")}serialize([e,r,s,i],o){const a=[],l=s-e,c=i-r;for(const u of f(this,Uh)){const d=new Array(u.length);for(let h=0;h<u.length;h+=2)d[h]=e+u[h]*l,d[h+1]=i-u[h+1]*c;a.push(d)}return a}get box(){return f(this,Um)}get classNamesForOutlining(){return["highlightOutline"]}}Um=new WeakMap,Uh=new WeakMap;class kA extends Av{newFreeDrawOutline(t,e,r,s,i,o){return new HY(t,e,r,s,i,o)}}class HY extends YN{newOutliner(t,e,r,s,i,o=0){return new kA(t,e,r,s,i,o)}}var vi,bu,Wh,In,Wm,Kh,Km,Gm,kl,wi,Gh,Ym,Fe,CA,TA,MA,yc,ZN,Va;const Qr=class Qr{constructor({editor:t=null,uiManager:e=null}){M(this,Fe);M(this,vi,null);M(this,bu,null);M(this,Wh);M(this,In,null);M(this,Wm,!1);M(this,Kh,!1);M(this,Km,null);M(this,Gm);M(this,kl,null);M(this,wi,null);M(this,Gh);var r;t?(k(this,Kh,!1),k(this,Gh,ve.HIGHLIGHT_COLOR),k(this,Km,t)):(k(this,Kh,!0),k(this,Gh,ve.HIGHLIGHT_DEFAULT_COLOR)),k(this,wi,(t==null?void 0:t._uiManager)||e),k(this,Gm,f(this,wi)._eventBus),k(this,Wh,(t==null?void 0:t.color)||((r=f(this,wi))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),f(Qr,Ym)||k(Qr,Ym,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return he(this,"_keyboardManager",new by([[["Escape","mac+Escape"],Qr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Qr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Qr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Qr.prototype._moveToPrevious],[["Home","mac+Home"],Qr.prototype._moveToBeginning],[["End","mac+End"],Qr.prototype._moveToEnd]]))}renderButton(){const t=k(this,vi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=f(this,wi)._signal;t.addEventListener("click",P(this,Fe,yc).bind(this),{signal:e}),t.addEventListener("keydown",P(this,Fe,MA).bind(this),{signal:e});const r=k(this,bu,document.createElement("span"));return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=f(this,Wh),t.append(r),t}renderMainDropdown(){const t=k(this,In,P(this,Fe,CA).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===f(this,vi)){P(this,Fe,yc).call(this,t);return}const e=t.target.getAttribute("data-color");e&&P(this,Fe,TA).call(this,e,t)}_moveToNext(t){var e,r;if(!f(this,Fe,Va)){P(this,Fe,yc).call(this,t);return}if(t.target===f(this,vi)){(e=f(this,In).firstChild)==null||e.focus();return}(r=t.target.nextSibling)==null||r.focus()}_moveToPrevious(t){var e,r;if(t.target===((e=f(this,In))==null?void 0:e.firstChild)||t.target===f(this,vi)){f(this,Fe,Va)&&this._hideDropdownFromKeyboard();return}f(this,Fe,Va)||P(this,Fe,yc).call(this,t),(r=t.target.previousSibling)==null||r.focus()}_moveToBeginning(t){var e;if(!f(this,Fe,Va)){P(this,Fe,yc).call(this,t);return}(e=f(this,In).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!f(this,Fe,Va)){P(this,Fe,yc).call(this,t);return}(e=f(this,In).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=f(this,In))==null||t.classList.add("hidden"),(e=f(this,kl))==null||e.abort(),k(this,kl,null)}_hideDropdownFromKeyboard(){var t;if(!f(this,Kh)){if(!f(this,Fe,Va)){(t=f(this,Km))==null||t.unselect();return}this.hideDropdown(),f(this,vi).focus({preventScroll:!0,focusVisible:f(this,Wm)})}}updateColor(t){if(f(this,bu)&&(f(this,bu).style.backgroundColor=t),!f(this,In))return;const e=f(this,wi).highlightColors.values();for(const r of f(this,In).children)r.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=f(this,vi))==null||t.remove(),k(this,vi,null),k(this,bu,null),(e=f(this,In))==null||e.remove(),k(this,In,null)}};vi=new WeakMap,bu=new WeakMap,Wh=new WeakMap,In=new WeakMap,Wm=new WeakMap,Kh=new WeakMap,Km=new WeakMap,Gm=new WeakMap,kl=new WeakMap,wi=new WeakMap,Gh=new WeakMap,Ym=new WeakMap,Fe=new WeakSet,CA=function(){const t=document.createElement("div"),e=f(this,wi)._signal;t.addEventListener("contextmenu",Di,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,s]of f(this,wi).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=r,i.setAttribute("data-l10n-id",f(Qr,Ym)[r]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=s,i.setAttribute("aria-selected",s===f(this,Wh)),i.addEventListener("click",P(this,Fe,TA).bind(this,s),{signal:e}),t.append(i)}return t.addEventListener("keydown",P(this,Fe,MA).bind(this),{signal:e}),t},TA=function(t,e){e.stopPropagation(),f(this,Gm).dispatch("switchannotationeditorparams",{source:this,type:f(this,Gh),value:t})},MA=function(t){Qr._keyboardManager.exec(this,t)},yc=function(t){if(f(this,Fe,Va)){this.hideDropdown();return}if(k(this,Wm,t.detail===0),f(this,kl)||(k(this,kl,new AbortController),window.addEventListener("pointerdown",P(this,Fe,ZN).bind(this),{signal:f(this,wi).combinedSignal(f(this,kl))})),f(this,In)){f(this,In).classList.remove("hidden");return}const e=k(this,In,P(this,Fe,CA).call(this));f(this,vi).append(e)},ZN=function(t){var e;(e=f(this,In))!=null&&e.contains(t.target)||this.hideDropdown()},Va=function(){return f(this,In)&&!f(this,In).classList.contains("hidden")},M(Qr,Ym,null);let Ev=Qr;var Yh,Xm,na,vu,Xh,es,qm,Jm,wu,Ws,Ss,tr,qh,ra,mr,Jh,Ks,Qm,Qt,PA,Y0,t_,e_,n_,OA,bc,Qs,Ld,r_,X0,mp,s_,i_,o_,a_,l_;const Pe=class Pe extends un{constructor(e){super({...e,name:"highlightEditor"});M(this,Qt);M(this,Yh,null);M(this,Xm,0);M(this,na);M(this,vu,null);M(this,Xh,null);M(this,es,null);M(this,qm,null);M(this,Jm,0);M(this,wu,null);M(this,Ws,null);M(this,Ss,null);M(this,tr,!1);M(this,qh,null);M(this,ra);M(this,mr,null);M(this,Jh,"");M(this,Ks);M(this,Qm,"");this.color=e.color||Pe._defaultColor,k(this,Ks,e.thickness||Pe._defaultThickness),k(this,ra,e.opacity||Pe._defaultOpacity),k(this,na,e.boxes||null),k(this,Qm,e.methodOfCreation||""),k(this,Jh,e.text||""),this._isDraggable=!1,e.highlightId>-1?(k(this,tr,!0),P(this,Qt,Y0).call(this,e),P(this,Qt,bc).call(this)):f(this,na)&&(k(this,Yh,e.anchorNode),k(this,Xm,e.anchorOffset),k(this,qm,e.focusNode),k(this,Jm,e.focusOffset),P(this,Qt,PA).call(this),P(this,Qt,bc).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=Pe.prototype;return he(this,"_keyboardManager",new by([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:f(this,tr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:f(this,Ks),methodOfCreation:f(this,Qm)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,r){var s;un.initialize(e,r),Pe._defaultColor||(Pe._defaultColor=((s=r.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,r){switch(e){case ve.HIGHLIGHT_DEFAULT_COLOR:Pe._defaultColor=r;break;case ve.HIGHLIGHT_THICKNESS:Pe._defaultThickness=r;break}}translateInPage(e,r){}get toolbarPosition(){return f(this,qh)}updateParams(e,r){switch(e){case ve.HIGHLIGHT_COLOR:P(this,Qt,t_).call(this,r);break;case ve.HIGHLIGHT_THICKNESS:P(this,Qt,e_).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ve.HIGHLIGHT_DEFAULT_COLOR,Pe._defaultColor],[ve.HIGHLIGHT_THICKNESS,Pe._defaultThickness]]}get propertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,this.color||Pe._defaultColor],[ve.HIGHLIGHT_THICKNESS,f(this,Ks)||Pe._defaultThickness],[ve.HIGHLIGHT_FREE,f(this,tr)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(k(this,Xh,new Ev({editor:this})),e.addColorPicker(f(this,Xh))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(P(this,Qt,mp).call(this))}getBaseTranslation(){return[0,0]}getRect(e,r){return super.getRect(e,r,P(this,Qt,mp).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){P(this,Qt,OA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(P(this,Qt,bc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let r=!1;this.parent&&!e?P(this,Qt,OA).call(this):e&&(P(this,Qt,bc).call(this,e),r=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),r&&this.select()}rotate(e){var i,o,a;const{drawLayer:r}=this.parent;let s;f(this,tr)?(e=(e-this.rotation+360)%360,s=P(i=Pe,Qs,Ld).call(i,f(this,Ws).box,e)):s=P(o=Pe,Qs,Ld).call(o,[this.x,this.y,this.width,this.height],e),r.updateProperties(f(this,Ss),{bbox:s,root:{"data-main-rotation":e}}),r.updateProperties(f(this,mr),{bbox:P(a=Pe,Qs,Ld).call(a,f(this,es).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();f(this,Jh)&&(e.setAttribute("aria-label",f(this,Jh)),e.setAttribute("role","mark")),f(this,tr)?e.classList.add("free"):this.div.addEventListener("keydown",P(this,Qt,r_).bind(this),{signal:this._uiManager._signal});const r=k(this,wu,document.createElement("div"));e.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=f(this,vu);const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),wv(this,f(this,wu),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(f(this,mr),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(f(this,mr),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:P(this,Qt,X0).call(this,!0);break;case 1:case 3:P(this,Qt,X0).call(this,!1);break}}select(){var e;super.select(),f(this,mr)&&((e=this.parent)==null||e.drawLayer.updateProperties(f(this,mr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),f(this,mr)&&((e=this.parent)==null||e.drawLayer.updateProperties(f(this,mr),{rootClass:{selected:!1}}),f(this,tr)||P(this,Qt,X0).call(this,!1))}get _mustFixPosition(){return!f(this,tr)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(f(this,Ss),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(f(this,mr),{rootClass:{hidden:!e}}))}static startHighlighting(e,r,{target:s,x:i,y:o}){const{x:a,y:l,width:c,height:u}=s.getBoundingClientRect(),d=new AbortController,h=e.combinedSignal(d),p=g=>{d.abort(),P(this,Qs,a_).call(this,e,g)};window.addEventListener("blur",p,{signal:h}),window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("pointerdown",Ps,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Di,{signal:h}),s.addEventListener("pointermove",P(this,Qs,o_).bind(this,e),{signal:h}),this._freeHighlight=new kA({x:i,y:o},[a,l,c,u],e.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,r,s){var m,b,y,v;let i=null;if(e instanceof NN){const{data:{quadPoints:x,rect:S,rotation:w,id:E,color:T,opacity:I,popupRef:C},parent:{page:{pageNumber:R}}}=e;i=e={annotationType:te.HIGHLIGHT,color:Array.from(T),opacity:I,quadPoints:x,boxes:null,pageIndex:R-1,rect:S.slice(0),rotation:w,id:E,deleted:!1,popupRef:C}}else if(e instanceof Rk){const{data:{inkLists:x,rect:S,rotation:w,id:E,color:T,borderStyle:{rawWidth:I},popupRef:C},parent:{page:{pageNumber:R}}}=e;i=e={annotationType:te.HIGHLIGHT,color:Array.from(T),thickness:I,inkLists:x,boxes:null,pageIndex:R-1,rect:S.slice(0),rotation:w,id:E,deleted:!1,popupRef:C}}const{color:o,quadPoints:a,inkLists:l,opacity:c}=e,u=await super.deserialize(e,r,s);u.color=Mt.makeHexColor(...o),k(u,ra,c||1),l&&k(u,Ks,e.thickness),u.annotationElementId=e.id||null,u._initialData=i;const[d,h]=u.pageDimensions,[p,g]=u.pageTranslation;if(a){const x=k(u,na,[]);for(let S=0;S<a.length;S+=8)x.push({x:(a[S]-p)/d,y:1-(a[S+1]-g)/h,width:(a[S+2]-a[S])/d,height:(a[S+1]-a[S+5])/h});P(m=u,Qt,PA).call(m),P(b=u,Qt,bc).call(b),u.rotate(u.rotation)}else if(l){k(u,tr,!0);const x=l[0],S={x:x[0]-p,y:h-(x[1]-g)},w=new kA(S,[0,0,d,h],1,f(u,Ks)/2,!0,.001);for(let I=0,C=x.length;I<C;I+=2)S.x=x[I]-p,S.y=h-(x[I+1]-g),w.add(S);const{id:E,clipPathId:T}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);P(y=u,Qt,Y0).call(y,{highlightOutlines:w.getOutlines(),highlightId:E,clipPathId:T}),P(v=u,Qt,bc).call(v)}return u}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const r=this.getRect(0,0),s=un._colorManager.convert(this.color),i={annotationType:te.HIGHLIGHT,color:s,opacity:f(this,ra),thickness:f(this,Ks),quadPoints:P(this,Qt,s_).call(this),outlines:P(this,Qt,i_).call(this,r),pageIndex:this.pageIndex,rect:r,rotation:P(this,Qt,mp).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!P(this,Qt,l_).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Yh=new WeakMap,Xm=new WeakMap,na=new WeakMap,vu=new WeakMap,Xh=new WeakMap,es=new WeakMap,qm=new WeakMap,Jm=new WeakMap,wu=new WeakMap,Ws=new WeakMap,Ss=new WeakMap,tr=new WeakMap,qh=new WeakMap,ra=new WeakMap,mr=new WeakMap,Jh=new WeakMap,Ks=new WeakMap,Qm=new WeakMap,Qt=new WeakSet,PA=function(){const e=new AA(f(this,na),.001);k(this,Ws,e.getOutlines()),[this.x,this.y,this.width,this.height]=f(this,Ws).box;const r=new AA(f(this,na),.0025,.001,this._uiManager.direction==="ltr");k(this,es,r.getOutlines());const{lastPoint:s}=f(this,es);k(this,qh,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},Y0=function({highlightOutlines:e,highlightId:r,clipPathId:s}){var d,h;if(k(this,Ws,e),k(this,es,e.getNewOutline(f(this,Ks)/2+1.5,.0025)),r>=0)k(this,Ss,r),k(this,vu,s),this.parent.drawLayer.finalizeDraw(r,{bbox:e.box,path:{d:e.toSVGPath()}}),k(this,mr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:f(this,es).box,path:{d:f(this,es).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(f(this,Ss),{bbox:P(d=Pe,Qs,Ld).call(d,f(this,Ws).box,(p-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(f(this,mr),{bbox:P(h=Pe,Qs,Ld).call(h,f(this,es).box,p),path:{d:f(this,es).toSVGPath()}})}const[o,a,l,c]=e.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=c;break;case 90:{const[p,g]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*g/p,this.height=c*p/g;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[p,g]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*g/p,this.height=c*p/g;break}}const{lastPoint:u}=f(this,es);k(this,qh,[(u[0]-o)/l,(u[1]-a)/c])},t_=function(e){const r=(o,a)=>{var l,c;this.color=o,k(this,ra,a),(l=this.parent)==null||l.drawLayer.updateProperties(f(this,Ss),{root:{fill:o,"fill-opacity":a}}),(c=f(this,Xh))==null||c.updateColor(o)},s=this.color,i=f(this,ra);this.addCommands({cmd:r.bind(this,e,Pe._defaultOpacity),undo:r.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},e_=function(e){const r=f(this,Ks),s=i=>{k(this,Ks,i),P(this,Qt,n_).call(this,i)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},n_=function(e){if(!f(this,tr))return;P(this,Qt,Y0).call(this,{highlightOutlines:f(this,Ws).getNewOutline(e/2)}),this.fixAndSetPosition();const[r,s]=this.parentDimensions;this.setDims(this.width*r,this.height*s)},OA=function(){f(this,Ss)===null||!this.parent||(this.parent.drawLayer.remove(f(this,Ss)),k(this,Ss,null),this.parent.drawLayer.remove(f(this,mr)),k(this,mr,null))},bc=function(e=this.parent){f(this,Ss)===null&&({id:Pr(this,Ss)._,clipPathId:Pr(this,vu)._}=e.drawLayer.draw({bbox:f(this,Ws).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":f(this,ra)},rootClass:{highlight:!0,free:f(this,tr)},path:{d:f(this,Ws).toSVGPath()}},!1,!0),k(this,mr,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:f(this,tr)},bbox:f(this,es).box,path:{d:f(this,es).toSVGPath()}},f(this,tr))),f(this,wu)&&(f(this,wu).style.clipPath=f(this,vu)))},Qs=new WeakSet,Ld=function([e,r,s,i],o){switch(o){case 90:return[1-r-i,e,i,s];case 180:return[1-e-s,1-r-i,s,i];case 270:return[r,1-e-s,i,s]}return[e,r,s,i]},r_=function(e){Pe._keyboardManager.exec(this,e)},X0=function(e){if(!f(this,Yh))return;const r=window.getSelection();e?r.setPosition(f(this,Yh),f(this,Xm)):r.setPosition(f(this,qm),f(this,Jm))},mp=function(){return f(this,tr)?this.rotation:0},s_=function(){if(f(this,tr))return null;const[e,r]=this.pageDimensions,[s,i]=this.pageTranslation,o=f(this,na),a=new Float32Array(o.length*8);let l=0;for(const{x:c,y:u,width:d,height:h}of o){const p=c*e+s,g=(1-u)*r+i;a[l]=a[l+4]=p,a[l+1]=a[l+3]=g,a[l+2]=a[l+6]=p+d*e,a[l+5]=a[l+7]=g-h*r,l+=8}return a},i_=function(e){return f(this,Ws).serialize(e,P(this,Qt,mp).call(this))},o_=function(e,r){this._freeHighlight.add(r)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},a_=function(e,r){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l_=function(e){const{color:r}=this._initialData;return e.color.some((s,i)=>s!==r[i])},M(Pe,Qs),_t(Pe,"_defaultColor",null),_t(Pe,"_defaultOpacity",1),_t(Pe,"_defaultThickness",12),_t(Pe,"_type","highlight"),_t(Pe,"_editorType",te.HIGHLIGHT),_t(Pe,"_freeHighlightId",-1),_t(Pe,"_freeHighlight",null),_t(Pe,"_freeHighlightClipId","");let kv=Pe;var xu;class VY{constructor(){M(this,xu,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,r]of Object.entries(t))this.updateProperty(e,r)}updateSVGProperty(t,e){f(this,xu)[t]=e}toSVGProperties(){const t=f(this,xu);return k(this,xu,Object.create(null)),{root:t}}reset(){k(this,xu,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Ve("Not implemented")}}xu=new WeakMap;var As,Qh,Hn,Su,Au,Cl,Tl,Ml,Eu,ke,RA,DA,NA,yp,c_,q0,bp,Fd;const vt=class vt extends un{constructor(e){super(e);M(this,ke);M(this,As,null);M(this,Qh);_t(this,"_drawId",null);k(this,Qh,e.mustBeCommitted||!1),e.drawOutlines&&(P(this,ke,RA).call(this,e),P(this,ke,yp).call(this))}static _mergeSVGProperties(e,r){const s=new Set(Object.keys(e));for(const[i,o]of Object.entries(r))s.has(i)?Object.assign(e[i],o):e[i]=o;return e}static getDefaultDrawingOptions(e){Ve("Not implemented")}static get typesMap(){Ve("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,r){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,r),this._currentParent&&(f(vt,Hn).updateProperty(s,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,r){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,r)}static get defaultPropertiesToUpdate(){const e=[],r=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)e.push([s,r[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:r}=this;for(const[s,i]of this.constructor.typesMap)e.push([s,r[i]]);return e}_updateProperty(e,r,s){const i=this._drawingOptions,o=i[r],a=l=>{var u;i.updateProperty(r,l);const c=f(this,As).updateProperty(r,l);c&&P(this,ke,bp).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,vt._mergeSVGProperties(f(this,As).getPathResizingSVGProperties(P(this,ke,q0).call(this)),{bbox:P(this,ke,Fd).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,vt._mergeSVGProperties(f(this,As).getPathResizedSVGProperties(P(this,ke,q0).call(this)),{bbox:P(this,ke,Fd).call(this)}))}_onTranslating(e,r){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:P(this,ke,Fd).call(this,e,r)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,vt._mergeSVGProperties(f(this,As).getPathTranslatedSVGProperties(P(this,ke,q0).call(this),this.parentDimensions),{bbox:P(this,ke,Fd).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,f(this,Qh)&&(k(this,Qh,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){P(this,ke,NA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(P(this,ke,yp).call(this),P(this,ke,bp).call(this,f(this,As).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let r=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),P(this,ke,NA).call(this)):e&&(this._uiManager.addShouldRescale(this),P(this,ke,yp).call(this,e),r=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,vt._mergeSVGProperties({bbox:P(this,ke,Fd).call(this)},f(this,As).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&P(this,ke,bp).call(this,f(this,As).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const r=document.createElement("div");e.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,r,s,i,o){Ve("Not implemented")}static startDrawing(e,r,s,i){var b;const{target:o,offsetX:a,offsetY:l,pointerId:c,pointerType:u}=i;if(f(vt,Tl)&&f(vt,Tl)!==u)return;const{viewport:{rotation:d}}=e,{width:h,height:p}=o.getBoundingClientRect(),g=k(vt,Su,new AbortController),m=e.combinedSignal(g);if(f(vt,Cl)||k(vt,Cl,c),f(vt,Tl)??k(vt,Tl,u),window.addEventListener("pointerup",y=>{var v;f(vt,Cl)===y.pointerId?this._endDraw(y):(v=f(vt,Ml))==null||v.delete(y.pointerId)},{signal:m}),window.addEventListener("pointercancel",y=>{var v;f(vt,Cl)===y.pointerId?this._currentParent.endDrawingSession():(v=f(vt,Ml))==null||v.delete(y.pointerId)},{signal:m}),window.addEventListener("pointerdown",y=>{f(vt,Tl)===y.pointerType&&((f(vt,Ml)||k(vt,Ml,new Set)).add(y.pointerId),f(vt,Hn).isCancellable()&&(f(vt,Hn).removeLastElement(),f(vt,Hn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Di,{signal:m}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),o.addEventListener("touchmove",y=>{y.timeStamp===f(vt,Eu)&&Ps(y)},{signal:m}),e.toggleDrawing(),(b=r._editorUndoBar)==null||b.hide(),f(vt,Hn)){e.drawLayer.updateProperties(this._currentDrawId,f(vt,Hn).startNew(a,l,h,p,d));return}r.updateUIForDefaultProperties(this),k(vt,Hn,this.createDrawerInstance(a,l,h,p,d)),k(vt,Au,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(f(vt,Au).toSVGProperties(),f(vt,Hn).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(k(vt,Eu,-1),!f(vt,Hn))return;const{offsetX:r,offsetY:s,pointerId:i}=e;if(f(vt,Cl)===i){if(((o=f(vt,Ml))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,f(vt,Hn).add(r,s)),k(vt,Eu,e.timeStamp),Ps(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,k(vt,Hn,null),k(vt,Au,null),k(vt,Tl,null),k(vt,Eu,NaN)),f(vt,Su)&&(f(vt,Su).abort(),k(vt,Su,null),k(vt,Cl,NaN),k(vt,Ml,null))}static _endDraw(e){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),e&&r.drawLayer.updateProperties(this._currentDrawId,f(vt,Hn).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=f(vt,Hn),i=this._currentDrawId,o=s.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(i,s.setLastElement(o))},undo:()=>{r.drawLayer.updateProperties(i,s.removeLastElement())},mustExec:!1,type:ve.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(ve.DRAW_STEP),!f(vt,Hn).isEmpty()){const{pageDimensions:[s,i],scale:o}=r,a=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:f(vt,Hn).getOutlines(s*o,i*o,o,this._INNER_MARGIN),drawingOptions:f(vt,Au),mustBeCommitted:!e});return this._cleanup(!0),a}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,r,s,i,o,a){Ve("Not implemented")}static async deserialize(e,r,s){var d,h;const{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:l}}=r.viewport,c=this.deserializeDraw(a,l,i,o,this._INNER_MARGIN,e),u=await super.deserialize(e,r,s);return u.createDrawingOptions(e),P(d=u,ke,RA).call(d,{drawOutlines:c}),P(h=u,ke,yp).call(h),u.onScaleChanging(),u.rotate(),u}serializeDraw(e){const[r,s]=this.pageTranslation,[i,o]=this.pageDimensions;return f(this,As).serialize([r,s,i,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};As=new WeakMap,Qh=new WeakMap,Hn=new WeakMap,Su=new WeakMap,Au=new WeakMap,Cl=new WeakMap,Tl=new WeakMap,Ml=new WeakMap,Eu=new WeakMap,ke=new WeakSet,RA=function({drawOutlines:e,drawId:r,drawingOptions:s}){k(this,As,e),this._drawingOptions||(this._drawingOptions=s),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,e.defaultProperties)):this._drawId=P(this,ke,DA).call(this,e,this.parent),P(this,ke,bp).call(this,e.box)},DA=function(e,r){const{id:s}=r.drawLayer.draw(vt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s},NA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},yp=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=P(this,ke,DA).call(this,f(this,As),e)}},c_=function([e,r,s,i]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[r,1-e,s*(a/o),i*(o/a)];case 180:return[1-e,1-r,s,i];case 270:return[1-r,e,s*(a/o),i*(o/a)];default:return[e,r,s,i]}},q0=function(){const{x:e,y:r,width:s,height:i,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-r,e,s*(o/a),i*(a/o)];case 180:return[1-e,1-r,s,i];case 270:return[r,1-e,s*(o/a),i*(a/o)];default:return[e,r,s,i]}},bp=function(e){if([this.x,this.y,this.width,this.height]=P(this,ke,c_).call(this,e),this.div){this.fixAndSetPosition();const[r,s]=this.parentDimensions;this.setDims(this.width*r,this.height*s)}this._onResized()},Fd=function(){const{x:e,y:r,width:s,height:i,rotation:o,parentRotation:a,parentDimensions:[l,c]}=this;switch((o*4+a)/90){case 1:return[1-r-i,e,i,s];case 2:return[1-e-s,1-r-i,s,i];case 3:return[r,1-e-s,i,s];case 4:return[e,r-s*(l/c),i*(c/l),s*(l/c)];case 5:return[1-r,e,s*(l/c),i*(c/l)];case 6:return[1-e-i*(c/l),1-r,i*(c/l),s*(l/c)];case 7:return[r-s*(l/c),1-e-i*(c/l),s*(l/c),i*(c/l)];case 8:return[e-s,r-i,s,i];case 9:return[1-r,e-s,i,s];case 10:return[1-e,1-r,s,i];case 11:return[r-i,1-e,i,s];case 12:return[e-i*(c/l),r,i*(c/l),s*(l/c)];case 13:return[1-r-s*(l/c),e-i*(c/l),s*(l/c),i*(c/l)];case 14:return[1-e,1-r-s*(l/c),i*(c/l),s*(l/c)];case 15:return[r,1-e,s*(l/c),i*(c/l)];default:return[e,r,s,i]}},_t(vt,"_currentDrawId",-1),_t(vt,"_currentParent",null),M(vt,Hn,null),M(vt,Su,null),M(vt,Au,null),M(vt,Cl,NaN),M(vt,Tl,null),M(vt,Ml,null),M(vt,Eu,NaN),_t(vt,"_INNER_MARGIN",3);let IA=vt;var ro,Vn,zn,ku,Zh,Nr,er,Gs,Cu,Tu,Mu,tf,J0;class zY{constructor(t,e,r,s,i,o){M(this,tf);M(this,ro,new Float64Array(6));M(this,Vn);M(this,zn);M(this,ku);M(this,Zh);M(this,Nr);M(this,er,"");M(this,Gs,0);M(this,Cu,new Cv);M(this,Tu);M(this,Mu);k(this,Tu,r),k(this,Mu,s),k(this,ku,i),k(this,Zh,o),[t,e]=P(this,tf,J0).call(this,t,e);const a=k(this,Vn,[NaN,NaN,NaN,NaN,t,e]);k(this,Nr,[t,e]),k(this,zn,[{line:a,points:f(this,Nr)}]),f(this,ro).set(a,0)}updateProperty(t,e){t==="stroke-width"&&k(this,Zh,e)}isEmpty(){return!f(this,zn)||f(this,zn).length===0}isCancellable(){return f(this,Nr).length<=10}add(t,e){[t,e]=P(this,tf,J0).call(this,t,e);const[r,s,i,o]=f(this,ro).subarray(2,6),a=t-i,l=e-o;return Math.hypot(f(this,Tu)*a,f(this,Mu)*l)<=2?null:(f(this,Nr).push(t,e),isNaN(r)?(f(this,ro).set([i,o,t,e],2),f(this,Vn).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(f(this,ro)[0])&&f(this,Vn).splice(6,6),f(this,ro).set([r,s,i,o,t,e],0),f(this,Vn).push(...yt.createBezierPoints(r,s,i,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const r=this.add(t,e);return r||(f(this,Nr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,r,s,i){k(this,Tu,r),k(this,Mu,s),k(this,ku,i),[t,e]=P(this,tf,J0).call(this,t,e);const o=k(this,Vn,[NaN,NaN,NaN,NaN,t,e]);k(this,Nr,[t,e]);const a=f(this,zn).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),f(this,zn).push({line:o,points:f(this,Nr)}),f(this,ro).set(o,0),k(this,Gs,0),this.toSVGPath(),null}getLastElement(){return f(this,zn).at(-1)}setLastElement(t){return f(this,zn)?(f(this,zn).push(t),k(this,Vn,t.line),k(this,Nr,t.points),k(this,Gs,0),{path:{d:this.toSVGPath()}}):f(this,Cu).setLastElement(t)}removeLastElement(){if(!f(this,zn))return f(this,Cu).removeLastElement();f(this,zn).pop(),k(this,er,"");for(let t=0,e=f(this,zn).length;t<e;t++){const{line:r,points:s}=f(this,zn)[t];k(this,Vn,r),k(this,Nr,s),k(this,Gs,0),this.toSVGPath()}return{path:{d:f(this,er)}}}toSVGPath(){const t=yt.svgRound(f(this,Vn)[4]),e=yt.svgRound(f(this,Vn)[5]);if(f(this,Nr).length===2)return k(this,er,`${f(this,er)} M ${t} ${e} Z`),f(this,er);if(f(this,Nr).length<=6){const s=f(this,er).lastIndexOf("M");k(this,er,`${f(this,er).slice(0,s)} M ${t} ${e}`),k(this,Gs,6)}if(f(this,Nr).length===4){const s=yt.svgRound(f(this,Vn)[10]),i=yt.svgRound(f(this,Vn)[11]);return k(this,er,`${f(this,er)} L ${s} ${i}`),k(this,Gs,12),f(this,er)}const r=[];f(this,Gs)===0&&(r.push(`M ${t} ${e}`),k(this,Gs,6));for(let s=f(this,Gs),i=f(this,Vn).length;s<i;s+=6){const[o,a,l,c,u,d]=f(this,Vn).slice(s,s+6).map(yt.svgRound);r.push(`C${o} ${a} ${l} ${c} ${u} ${d}`)}return k(this,er,f(this,er)+r.join(" ")),k(this,Gs,f(this,Vn).length),f(this,er)}getOutlines(t,e,r,s){const i=f(this,zn).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),f(this,Cu).build(f(this,zn),t,e,r,f(this,ku),f(this,Zh),s),k(this,ro,null),k(this,Vn,null),k(this,zn,null),k(this,er,null),f(this,Cu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ro=new WeakMap,Vn=new WeakMap,zn=new WeakMap,ku=new WeakMap,Zh=new WeakMap,Nr=new WeakMap,er=new WeakMap,Gs=new WeakMap,Cu=new WeakMap,Tu=new WeakMap,Mu=new WeakMap,tf=new WeakSet,J0=function(t,e){return yt._normalizePoint(t,e,f(this,Tu),f(this,Mu),f(this,ku))};var _r,Zm,ty,Es,so,io,ef,nf,rf,sr,Io,u_,d_,h_;const $k=class $k extends yt{constructor(){super(...arguments);M(this,sr);M(this,_r);M(this,Zm,0);M(this,ty);M(this,Es);M(this,so);M(this,io);M(this,ef);M(this,nf);M(this,rf)}build(e,r,s,i,o,a,l){k(this,so,r),k(this,io,s),k(this,ef,i),k(this,nf,o),k(this,rf,a),k(this,ty,l??0),k(this,Es,e),P(this,sr,d_).call(this)}setLastElement(e){return f(this,Es).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return f(this,Es).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:r}of f(this,Es)){if(e.push(`M${yt.svgRound(r[4])} ${yt.svgRound(r[5])}`),r.length===6){e.push("Z");continue}if(r.length===12){e.push(`L${yt.svgRound(r[10])} ${yt.svgRound(r[11])}`);continue}for(let s=6,i=r.length;s<i;s+=6){const[o,a,l,c,u,d]=r.subarray(s,s+6).map(yt.svgRound);e.push(`C${o} ${a} ${l} ${c} ${u} ${d}`)}}return e.join("")}serialize([e,r,s,i],o){const a=[],l=[],[c,u,d,h]=P(this,sr,u_).call(this);let p,g,m,b,y,v,x,S,w;switch(f(this,nf)){case 0:w=yt._rescale,p=e,g=r+i,m=s,b=-i,y=e+c*s,v=r+(1-u-h)*i,x=e+(c+d)*s,S=r+(1-u)*i;break;case 90:w=yt._rescaleAndSwap,p=e,g=r,m=s,b=i,y=e+u*s,v=r+c*i,x=e+(u+h)*s,S=r+(c+d)*i;break;case 180:w=yt._rescale,p=e+s,g=r,m=-s,b=i,y=e+(1-c-d)*s,v=r+u*i,x=e+(1-c)*s,S=r+(u+h)*i;break;case 270:w=yt._rescaleAndSwap,p=e+s,g=r+i,m=-s,b=-i,y=e+(1-u-h)*s,v=r+(1-c-d)*i,x=e+(1-u)*s,S=r+(1-c)*i;break}for(const{line:E,points:T}of f(this,Es))a.push(w(E,p,g,m,b,o?new Array(E.length):null)),l.push(w(T,p,g,m,b,o?new Array(T.length):null));return{lines:a,points:l,rect:[y,v,x,S]}}static deserialize(e,r,s,i,o,{paths:{lines:a,points:l},rotation:c,thickness:u}){const d=[];let h,p,g,m,b;switch(c){case 0:b=yt._rescale,h=-e/s,p=r/i+1,g=1/s,m=-1/i;break;case 90:b=yt._rescaleAndSwap,h=-r/i,p=-e/s,g=1/i,m=1/s;break;case 180:b=yt._rescale,h=e/s+1,p=-r/i,g=-1/s,m=1/i;break;case 270:b=yt._rescaleAndSwap,h=r/i+1,p=e/s+1,g=-1/i,m=-1/s;break}if(!a){a=[];for(const v of l){const x=v.length;if(x===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(x===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const S=new Float32Array(3*(x-2));a.push(S);let[w,E,T,I]=v.subarray(0,4);S.set([NaN,NaN,NaN,NaN,w,E],0);for(let C=4;C<x;C+=2){const R=v[C],N=v[C+1];S.set(yt.createBezierPoints(w,E,T,I,R,N),(C-2)*3),[w,E,T,I]=[T,I,R,N]}}}for(let v=0,x=a.length;v<x;v++)d.push({line:b(a[v].map(S=>S??NaN),h,p,g,m),points:b(l[v].map(S=>S??NaN),h,p,g,m)});const y=new $k;return y.build(d,s,i,1,c,u,o),y}get box(){return f(this,_r)}updateProperty(e,r){return e==="stroke-width"?P(this,sr,h_).call(this,r):null}updateParentDimensions([e,r],s){const[i,o]=P(this,sr,Io).call(this);k(this,so,e),k(this,io,r),k(this,ef,s);const[a,l]=P(this,sr,Io).call(this),c=a-i,u=l-o,d=f(this,_r);return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateRotation(e){return k(this,Zm,e),{path:{transform:this.rotationTransform}}}get viewBox(){return f(this,_r).map(yt.svgRound).join(" ")}get defaultProperties(){const[e,r]=f(this,_r);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(e)} ${yt.svgRound(r)}`}}}get rotationTransform(){const[,,e,r]=f(this,_r);let s=0,i=0,o=0,a=0,l=0,c=0;switch(f(this,Zm)){case 90:i=r/e,o=-e/r,l=e;break;case 180:s=-1,a=-1,l=e,c=r;break;case 270:i=-r/e,o=e/r,c=r;break;default:return""}return`matrix(${s} ${i} ${o} ${a} ${yt.svgRound(l)} ${yt.svgRound(c)})`}getPathResizingSVGProperties([e,r,s,i]){const[o,a]=P(this,sr,Io).call(this),[l,c,u,d]=f(this,_r);if(Math.abs(u-o)<=yt.PRECISION||Math.abs(d-a)<=yt.PRECISION){const b=e+s/2-(l+u/2),y=r+i/2-(c+d/2);return{path:{"transform-origin":`${yt.svgRound(e)} ${yt.svgRound(r)}`,transform:`${this.rotationTransform} translate(${b} ${y})`}}}const h=(s-2*o)/(u-2*o),p=(i-2*a)/(d-2*a),g=u/s,m=d/i;return{path:{"transform-origin":`${yt.svgRound(l)} ${yt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${m}) translate(${yt.svgRound(o)} ${yt.svgRound(a)}) scale(${h} ${p}) translate(${yt.svgRound(-o)} ${yt.svgRound(-a)})`}}}getPathResizedSVGProperties([e,r,s,i]){const[o,a]=P(this,sr,Io).call(this),l=f(this,_r),[c,u,d,h]=l;if(l[0]=e,l[1]=r,l[2]=s,l[3]=i,Math.abs(d-o)<=yt.PRECISION||Math.abs(h-a)<=yt.PRECISION){const y=e+s/2-(c+d/2),v=r+i/2-(u+h/2);for(const{line:x,points:S}of f(this,Es))yt._translate(x,y,v,x),yt._translate(S,y,v,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(e)} ${yt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(s-2*o)/(d-2*o),g=(i-2*a)/(h-2*a),m=-p*(c+o)+e+o,b=-g*(u+a)+r+a;if(p!==1||g!==1||m!==0||b!==0)for(const{line:y,points:v}of f(this,Es))yt._rescale(y,m,b,p,g,y),yt._rescale(v,m,b,p,g,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(e)} ${yt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,r],s){const[i,o]=s,a=f(this,_r),l=e-a[0],c=r-a[1];if(f(this,so)===i&&f(this,io)===o)for(const{line:u,points:d}of f(this,Es))yt._translate(u,l,c,u),yt._translate(d,l,c,d);else{const u=f(this,so)/i,d=f(this,io)/o;k(this,so,i),k(this,io,o);for(const{line:h,points:p}of f(this,Es))yt._rescale(h,l,c,u,d,h),yt._rescale(p,l,c,u,d,p);a[2]*=u,a[3]*=d}return a[0]=e,a[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${yt.svgRound(e)} ${yt.svgRound(r)}`}}}get defaultSVGProperties(){const e=f(this,_r);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${yt.svgRound(e[0])} ${yt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};_r=new WeakMap,Zm=new WeakMap,ty=new WeakMap,Es=new WeakMap,so=new WeakMap,io=new WeakMap,ef=new WeakMap,nf=new WeakMap,rf=new WeakMap,sr=new WeakSet,Io=function(e=f(this,rf)){const r=f(this,ty)+e/2*f(this,ef);return f(this,nf)%180===0?[r/f(this,so),r/f(this,io)]:[r/f(this,io),r/f(this,so)]},u_=function(){const[e,r,s,i]=f(this,_r),[o,a]=P(this,sr,Io).call(this,0);return[e+o,r+a,s-2*o,i-2*a]},d_=function(){const e=k(this,_r,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of f(this,Es)){if(i.length<=12){for(let l=4,c=i.length;l<c;l+=6){const[u,d]=i.subarray(l,l+2);e[0]=Math.min(e[0],u),e[1]=Math.min(e[1],d),e[2]=Math.max(e[2],u),e[3]=Math.max(e[3],d)}continue}let o=i[4],a=i[5];for(let l=6,c=i.length;l<c;l+=6){const[u,d,h,p,g,m]=i.subarray(l,l+6);Mt.bezierBoundingBox(o,a,u,d,h,p,g,m,e),o=g,a=m}}const[r,s]=P(this,sr,Io).call(this);e[0]=Math.min(1,Math.max(0,e[0]-r)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+r)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]},h_=function(e){const[r,s]=P(this,sr,Io).call(this);k(this,rf,e);const[i,o]=P(this,sr,Io).call(this),[a,l]=[i-r,o-s],c=f(this,_r);return c[0]-=a,c[1]-=l,c[2]+=2*a,c[3]+=2*l,c};let Cv=$k;var sf;const jk=class jk extends VY{constructor(e){super();M(this,sf);k(this,sf,e),super.updateProperties({fill:"none",stroke:un._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,r){e==="stroke-width"&&(r??(r=this["stroke-width"]),r*=f(this,sf).realScale),super.updateSVGProperty(e,r)}clone(){const e=new jk(f(this,sf));return e.updateAll(this),e}};sf=new WeakMap;let _A=jk;var Uv,f_;const zd=class zd extends IA{constructor(e){super({...e,name:"inkEditor"});M(this,Uv);this._willKeepAspectRatio=!0}static initialize(e,r){un.initialize(e,r),this._defaultDrawingOptions=new _A(r.viewParameters)}static getDefaultDrawingOptions(e){const r=this._defaultDrawingOptions.clone();return r.updateProperties(e),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return he(this,"typesMap",new Map([[ve.INK_THICKNESS,"stroke-width"],[ve.INK_COLOR,"stroke"],[ve.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,r,s,i,o){return new zY(e,r,s,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,r,s,i,o,a){return Cv.deserialize(e,r,s,i,o,a)}static async deserialize(e,r,s){let i=null;if(e instanceof Rk){const{data:{inkLists:a,rect:l,rotation:c,id:u,color:d,opacity:h,borderStyle:{rawWidth:p},popupRef:g},parent:{page:{pageNumber:m}}}=e;i=e={annotationType:te.INK,color:Array.from(d),thickness:p,opacity:h,paths:{points:a},boxes:null,pageIndex:m-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:g}}const o=await super.deserialize(e,r,s);return o.annotationElementId=e.id||null,o._initialData=i,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:r,parent:s}=this;r.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:r,opacity:s}){this._drawingOptions=zd.getDefaultDrawingOptions({stroke:Mt.makeHexColor(...e),"stroke-width":r,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":l}}=this,c={annotationType:te.INK,color:un._colorManager.convert(o),opacity:a,thickness:l,paths:{lines:r,points:s},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?c:this.annotationElementId&&!P(this,Uv,f_).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(e){const{points:r,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:r}),null}};Uv=new WeakSet,f_=function(e){const{color:r,thickness:s,opacity:i,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,l)=>a!==r[l])||e.thickness!==s||e.opacity!==i||e.pageIndex!==o},_t(zd,"_type","ink"),_t(zd,"_editorType",te.INK),_t(zd,"_defaultDrawingOptions",null);let LA=zd;var on,nr,Pl,sa,Ol,of,oo,ao,ks,af,Me,vp,wp,Q0,BA,Z0,$A,tb,p_;const Qp=class Qp extends un{constructor(e){super({...e,name:"stampEditor"});M(this,Me);M(this,on,null);M(this,nr,null);M(this,Pl,null);M(this,sa,null);M(this,Ol,null);M(this,of,"");M(this,oo,null);M(this,ao,null);M(this,ks,!1);M(this,af,!1);k(this,sa,e.bitmapUrl),k(this,Ol,e.bitmapFile)}static initialize(e,r){un.initialize(e,r)}static get supportedTypes(){return he(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(r=>`image/${r}`))}static get supportedTypesStr(){return he(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,r){r.pasteEditor(te.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const r=e.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(e=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:a}=e||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:i,width:o,height:a,channels:i.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),r&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var e;f(this,nr)&&(k(this,on,null),this._uiManager.imageManager.deleteId(f(this,nr)),(e=f(this,oo))==null||e.remove(),k(this,oo,null),f(this,ao)&&(clearTimeout(f(this,ao)),k(this,ao,null))),super.remove()}rebuild(){if(!this.parent){f(this,nr)&&P(this,Me,Q0).call(this);return}super.rebuild(),this.div!==null&&(f(this,nr)&&f(this,oo)===null&&P(this,Me,Q0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(f(this,Pl)||f(this,on)||f(this,sa)||f(this,Ol)||f(this,nr))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,r;if(this.width&&(e=this.x,r=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),f(this,on)?P(this,Me,BA).call(this):P(this,Me,Q0).call(this),this.width&&!this.annotationElementId){const[s,i]=this.parentDimensions;this.setAt(e*s,r*i,this.width*s,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;f(this,ao)!==null&&clearTimeout(f(this,ao)),k(this,ao,setTimeout(()=>{k(this,ao,null),P(this,Me,$A).call(this)},200))}copyCanvas(e,r,s=!1){var p;e||(e=224);const{width:i,height:o}=f(this,on),a=new _S;let l=f(this,on),c=i,u=o,d=null;if(r){if(i>r||o>r){const I=Math.min(r/i,r/o);c=Math.floor(i*I),u=Math.floor(o*I)}d=document.createElement("canvas");const g=d.width=Math.ceil(c*a.sx),m=d.height=Math.ceil(u*a.sy);f(this,ks)||(l=P(this,Me,Z0).call(this,g,m));const b=d.getContext("2d");b.filter=this._uiManager.hcmFilter;let y="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",v="#42414d");const x=15,S=x*a.sx,w=x*a.sy,E=new OffscreenCanvas(S*2,w*2),T=E.getContext("2d");T.fillStyle=y,T.fillRect(0,0,S*2,w*2),T.fillStyle=v,T.fillRect(0,0,S,w),T.fillRect(S,w,S,w),b.fillStyle=b.createPattern(E,"repeat"),b.fillRect(0,0,g,m),b.drawImage(l,0,0,l.width,l.height,0,0,g,m)}let h=null;if(s){let g,m;if(a.symmetric&&l.width<e&&l.height<e)g=l.width,m=l.height;else if(l=f(this,on),i>e||o>e){const v=Math.min(e/i,e/o);g=Math.floor(i*v),m=Math.floor(o*v),f(this,ks)||(l=P(this,Me,Z0).call(this,g,m))}const y=new OffscreenCanvas(g,m).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,g,m),h={width:g,height:m,data:y.getImageData(0,0,g,m).data}}return{canvas:d,width:c,height:u,imageData:h}}getImageForAltText(){return f(this,oo)}static async deserialize(e,r,s){var m;let i=null;if(e instanceof _N){const{data:{rect:b,rotation:y,id:v,structParent:x,popupRef:S},container:w,parent:{page:{pageNumber:E}}}=e,T=w.querySelector("canvas"),I=s.imageManager.getFromCanvas(w.id,T);T.remove();const C=((m=await r._structTree.getAriaAttributes(`${Ek}${v}`))==null?void 0:m.get("aria-label"))||"";i=e={annotationType:te.STAMP,bitmapId:I.id,bitmap:I.bitmap,pageIndex:E-1,rect:b.slice(0),rotation:y,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:C},isSvg:!1,structParent:x,popupRef:S}}const o=await super.deserialize(e,r,s),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:d,accessibilityData:h}=e;u&&s.imageManager.isValidId(u)?(k(o,nr,u),l&&k(o,on,l)):k(o,sa,c),k(o,ks,d);const[p,g]=o.pageDimensions;return o.width=(a[2]-a[0])/p,o.height=(a[3]-a[1])/g,o.annotationElementId=e.id||null,h&&(o.altTextData=h),o._initialData=i,k(o,af,!!i),o}serialize(e=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:te.STAMP,bitmapId:f(this,nr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:f(this,ks),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=P(this,Me,tb).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=P(this,Me,p_).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,r===null)return s;r.stamps||(r.stamps=new Map);const a=f(this,ks)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!r.stamps.has(f(this,nr)))r.stamps.set(f(this,nr),{area:a,serialized:s}),s.bitmap=P(this,Me,tb).call(this,!1);else if(f(this,ks)){const l=r.stamps.get(f(this,nr));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=P(this,Me,tb).call(this,!1))}return s}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};on=new WeakMap,nr=new WeakMap,Pl=new WeakMap,sa=new WeakMap,Ol=new WeakMap,of=new WeakMap,oo=new WeakMap,ao=new WeakMap,ks=new WeakMap,af=new WeakMap,Me=new WeakSet,vp=function(e,r=!1){if(!e){this.remove();return}k(this,on,e.bitmap),r||(k(this,nr,e.id),k(this,ks,e.isSvg)),e.file&&k(this,of,e.file.name),P(this,Me,BA).call(this)},wp=function(){if(k(this,Pl,null),this._uiManager.enableWaiting(!1),!!f(this,oo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,on)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,on)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Q0=function(){if(f(this,nr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(f(this,nr)).then(s=>P(this,Me,vp).call(this,s,!0)).finally(()=>P(this,Me,wp).call(this));return}if(f(this,sa)){const s=f(this,sa);k(this,sa,null),this._uiManager.enableWaiting(!0),k(this,Pl,this._uiManager.imageManager.getFromUrl(s).then(i=>P(this,Me,vp).call(this,i)).finally(()=>P(this,Me,wp).call(this)));return}if(f(this,Ol)){const s=f(this,Ol);k(this,Ol,null),this._uiManager.enableWaiting(!0),k(this,Pl,this._uiManager.imageManager.getFromFile(s).then(i=>P(this,Me,vp).call(this,i)).finally(()=>P(this,Me,wp).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Qp.supportedTypesStr;const r=this._uiManager._signal;k(this,Pl,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),P(this,Me,vp).call(this,i)}s()},{signal:r}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:r})}).finally(()=>P(this,Me,wp).call(this))),e.click()},BA=function(){var d;const{div:e}=this;let{width:r,height:s}=f(this,on);const[i,o]=this.pageDimensions,a=.75;if(this.width)r=this.width*i,s=this.height*o;else if(r>a*i||s>a*o){const h=Math.min(a*i/r,a*o/s);r*=h,s*=h}const[l,c]=this.parentDimensions;this.setDims(r*l/i,s*c/o),this._uiManager.enableWaiting(!1);const u=k(this,oo,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=r/i,this.height=s/o,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),P(this,Me,$A).call(this),f(this,af)||(this.parent.addUndoableEditor(this),k(this,af,!0)),this._reportTelemetry({action:"inserted_image"}),f(this,of)&&u.setAttribute("aria-label",f(this,of))},Z0=function(e,r){const{width:s,height:i}=f(this,on);let o=s,a=i,l=f(this,on);for(;o>2*e||a>2*r;){const c=o,u=a;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*r&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(o,a);d.getContext("2d").drawImage(l,0,0,c,u,0,0,o,a),l=d.transferToImageBitmap()}return l},$A=function(){const[e,r]=this.parentDimensions,{width:s,height:i}=this,o=new _S,a=Math.ceil(s*e*o.sx),l=Math.ceil(i*r*o.sy),c=f(this,oo);if(!c||c.width===a&&c.height===l)return;c.width=a,c.height=l;const u=f(this,ks)?f(this,on):P(this,Me,Z0).call(this,a,l),d=c.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(u,0,0,u.width,u.height,0,0,a,l)},tb=function(e){if(e){if(f(this,ks)){const i=this._uiManager.imageManager.getSvgUrl(f(this,nr));if(i)return i}const r=document.createElement("canvas");return{width:r.width,height:r.height}=f(this,on),r.getContext("2d").drawImage(f(this,on),0,0),r.toDataURL()}if(f(this,ks)){const[r,s]=this.pageDimensions,i=Math.round(this.width*r*nc.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*nc.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,o);return a.getContext("2d").drawImage(f(this,on),0,0,f(this,on).width,f(this,on).height,0,0,i,o),a.transferToImageBitmap()}return structuredClone(f(this,on))},p_=function(e){var a;const{pageIndex:r,accessibilityData:{altText:s}}=this._initialData,i=e.pageIndex===r,o=(((a=e.accessibilityData)==null?void 0:a.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}},_t(Qp,"_type","stamp"),_t(Qp,"_editorType",te.STAMP);let FA=Qp;var Pu,lf,lo,Il,ia,Ys,Rl,cf,Ou,xi,oa,yr,aa,Ct,Dl,nn,g_,$i,HA,VA,eb;const ci=class ci{constructor({uiManager:t,pageIndex:e,div:r,structTreeLayer:s,accessibilityManager:i,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:u}){M(this,nn);M(this,Pu);M(this,lf,!1);M(this,lo,null);M(this,Il,null);M(this,ia,null);M(this,Ys,new Map);M(this,Rl,!1);M(this,cf,!1);M(this,Ou,!1);M(this,xi,null);M(this,oa,null);M(this,yr,null);M(this,aa,null);M(this,Ct);const d=[...f(ci,Dl).values()];if(!ci._initialized){ci._initialized=!0;for(const h of d)h.initialize(u,t)}t.registerEditorTypes(d),k(this,Ct,t),this.pageIndex=e,this.div=r,k(this,Pu,i),k(this,lo,o),this.viewport=c,k(this,yr,l),this.drawLayer=a,this._structTree=s,f(this,Ct).addLayer(this)}get isEmpty(){return f(this,Ys).size===0}get isInvisible(){return this.isEmpty&&f(this,Ct).getMode()===te.NONE}updateToolbar(t){f(this,Ct).updateToolbar(t)}updateMode(t=f(this,Ct).getMode()){switch(P(this,nn,eb).call(this),t){case te.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case te.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case te.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const r of f(ci,Dl).values())e.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=f(this,yr))==null?void 0:e.div)}setEditingState(t){f(this,Ct).setEditingState(t)}addCommands(t){f(this,Ct).addCommands(t)}cleanUndoStack(t){f(this,Ct).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=f(this,lo))==null||e.div.classList.toggle("disabled",!t)}async enable(){k(this,Ou,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const r of f(this,Ys).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(f(this,Ct).removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!f(this,lo)){k(this,Ou,!1);return}const e=f(this,lo).getEditableAnnotations();for(const r of e){if(r.hide(),f(this,Ct).isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;const s=await this.deserialize(r);s&&(this.addOrRebuild(s),s.enableEditing())}k(this,Ou,!1)}disable(){var s;k(this,cf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const i of f(this,Ys).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);(s=this.getEditableAnnotation(i.annotationElementId))==null||s.show(),i.remove()}if(f(this,lo)){const i=f(this,lo).getEditableAnnotations();for(const o of i){const{id:a}=o.data;if(f(this,Ct).isDeletedAnnotationElement(a))continue;let l=e.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=t.get(a),l&&(f(this,Ct).addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}P(this,nn,eb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of f(ci,Dl).values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),k(this,cf,!1)}getEditableAnnotation(t){var e;return((e=f(this,lo))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){f(this,Ct).getActive()!==t&&f(this,Ct).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=f(this,yr))!=null&&t.div&&!f(this,aa)){k(this,aa,new AbortController);const e=f(this,Ct).combinedSignal(f(this,aa));f(this,yr).div.addEventListener("pointerdown",P(this,nn,g_).bind(this),{signal:e}),f(this,yr).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=f(this,yr))!=null&&t.div&&f(this,aa)&&(f(this,aa).abort(),k(this,aa,null),f(this,yr).div.classList.remove("highlighting"))}enableClick(){if(f(this,Il))return;k(this,Il,new AbortController);const t=f(this,Ct).combinedSignal(f(this,Il));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=f(this,Il))==null||t.abort(),k(this,Il,null)}attach(t){f(this,Ys).set(t.id,t);const{annotationElementId:e}=t;e&&f(this,Ct).isDeletedAnnotationElement(e)&&f(this,Ct).removeDeletedAnnotationElement(t)}detach(t){var e;f(this,Ys).delete(t.id),(e=f(this,Pu))==null||e.removePointerInTextLayer(t.contentDiv),!f(this,cf)&&t.annotationElementId&&f(this,Ct).addDeletedAnnotationElement(t)}remove(t){this.detach(t),f(this,Ct).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(f(this,Ct).addDeletedAnnotationElement(t.annotationElementId),un.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),f(this,Ct).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!f(this,Ou)),f(this,Ct).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var r;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!f(this,ia)&&(t._focusEventsAllowed=!1,k(this,ia,setTimeout(()=>{k(this,ia,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:f(this,Ct)._signal}),e.focus())},0))),t._structTreeParentId=(r=f(this,Pu))==null?void 0:r.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:e,undo:r,mustExec:!1})}getNextId(){return f(this,Ct).getId()}combinedSignal(t){return f(this,Ct).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=f(this,nn,$i))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){f(this,Ct).updateToolbar(t),f(this,Ct).updateMode(t);const{offsetX:r,offsetY:s}=P(this,nn,VA).call(this),i=this.getNextId(),o=P(this,nn,HA).call(this,{parent:this,id:i,x:r,y:s,uiManager:f(this,Ct),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=f(ci,Dl).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,f(this,Ct)))||null}createAndAddNewEditor(t,e,r={}){const s=this.getNextId(),i=P(this,nn,HA).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:f(this,Ct),isCentered:e,...r});return i&&this.add(i),i}addNewEditor(){this.createAndAddNewEditor(P(this,nn,VA).call(this),!0)}setSelected(t){f(this,Ct).setSelected(t)}toggleSelected(t){f(this,Ct).toggleSelected(t)}unselect(t){f(this,Ct).unselect(t)}pointerup(t){var r;const{isMac:e}=jr.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&f(this,Rl)&&(k(this,Rl,!1),!((r=f(this,nn,$i))!=null&&r.isDrawer&&f(this,nn,$i).supportMultipleDrawings))){if(!f(this,lf)){k(this,lf,!0);return}if(f(this,Ct).getMode()===te.STAMP){f(this,Ct).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var s;if(f(this,Ct).getMode()===te.HIGHLIGHT&&this.enableTextSelection(),f(this,Rl)){k(this,Rl,!1);return}const{isMac:e}=jr.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(k(this,Rl,!0),(s=f(this,nn,$i))!=null&&s.isDrawer){this.startDrawingSession(t);return}const r=f(this,Ct).getActive();k(this,lf,!r||r.isEmpty())}startDrawingSession(t){if(this.div.focus(),f(this,xi)){f(this,nn,$i).startDrawing(this,f(this,Ct),!1,t);return}f(this,Ct).setCurrentDrawingSession(this),k(this,xi,new AbortController);const e=f(this,Ct).combinedSignal(f(this,xi));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(k(this,oa,null),this.commitOrRemove())},{signal:e}),f(this,nn,$i).startDrawing(this,f(this,Ct),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&k(this,oa,e);return}f(this,oa)&&setTimeout(()=>{var e;(e=f(this,oa))==null||e.focus(),k(this,oa,null)},0)}endDrawingSession(t=!1){return f(this,xi)?(f(this,Ct).setCurrentDrawingSession(null),f(this,xi).abort(),k(this,xi,null),k(this,oa,null),f(this,nn,$i).endDrawing(t)):null}findNewParent(t,e,r){const s=f(this,Ct).findParent(e,r);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return f(this,xi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){f(this,xi)&&f(this,nn,$i).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=f(this,Ct).getActive())==null?void 0:t.parent)===this&&(f(this,Ct).commitOrRemove(),f(this,Ct).setActiveEditor(null)),f(this,ia)&&(clearTimeout(f(this,ia)),k(this,ia,null));for(const r of f(this,Ys).values())(e=f(this,Pu))==null||e.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,f(this,Ys).clear(),f(this,Ct).removeLayer(this)}render({viewport:t}){this.viewport=t,td(this.div,t);for(const e of f(this,Ct).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){f(this,Ct).commitOrRemove(),P(this,nn,eb).call(this);const e=this.viewport.rotation,r=t.rotation;if(this.viewport=t,td(this.div,{rotation:r}),e!==r)for(const s of f(this,Ys).values())s.rotate(r)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return f(this,Ct).viewParameters.realScale}};Pu=new WeakMap,lf=new WeakMap,lo=new WeakMap,Il=new WeakMap,ia=new WeakMap,Ys=new WeakMap,Rl=new WeakMap,cf=new WeakMap,Ou=new WeakMap,xi=new WeakMap,oa=new WeakMap,yr=new WeakMap,aa=new WeakMap,Ct=new WeakMap,Dl=new WeakMap,nn=new WeakSet,g_=function(t){f(this,Ct).unselectAll();const{target:e}=t;if(e===f(this,yr).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&f(this,yr).div.contains(e)){const{isMac:r}=jr.platform;if(t.button!==0||t.ctrlKey&&r)return;f(this,Ct).showAllEditors("highlight",!0,!0),f(this,yr).div.classList.add("free"),this.toggleDrawing(),kv.startHighlighting(this,f(this,Ct).direction==="ltr",{target:f(this,yr).div,x:t.x,y:t.y}),f(this,yr).div.addEventListener("pointerup",()=>{f(this,yr).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:f(this,Ct)._signal}),t.preventDefault()}},$i=function(){return f(ci,Dl).get(f(this,Ct).getMode())},HA=function(t){const e=f(this,nn,$i);return e?new e.prototype.constructor(t):null},VA=function(){const{x:t,y:e,width:r,height:s}=this.div.getBoundingClientRect(),i=Math.max(0,t),o=Math.max(0,e),a=Math.min(window.innerWidth,t+r),l=Math.min(window.innerHeight,e+s),c=(i+a)/2-t,u=(o+l)/2-e,[d,h]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:d,offsetY:h}},eb=function(){for(const t of f(this,Ys).values())t.isEmpty()&&t.remove()},_t(ci,"_initialized",!1),M(ci,Dl,new Map([xA,LA,FA,kv].map(t=>[t._editorType,t])));let jA=ci;var Si,ey,Lr,Iu,Wv,m_,wo,UA,y_,WA;const fr=class fr{constructor({pageIndex:t}){M(this,wo);M(this,Si,null);M(this,ey,0);M(this,Lr,new Map);M(this,Iu,new Map);this.pageIndex=t}setParent(t){if(!f(this,Si)){k(this,Si,t);return}if(f(this,Si)!==t){if(f(this,Lr).size>0)for(const e of f(this,Lr).values())e.remove(),t.append(e);k(this,Si,t)}}static get _svgFactory(){return he(this,"_svgFactory",new Ik)}draw(t,e=!1,r=!1){const s=Pr(this,ey)._++,i=P(this,wo,UA).call(this),o=fr._svgFactory.createElement("defs");i.append(o);const a=fr._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),e&&f(this,Iu).set(s,a);const c=r?P(this,wo,y_).call(this,o,l):null,u=fr._svgFactory.createElement("use");return i.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(i,t),f(this,Lr).set(s,i),{id:s,clipPathId:`url(#${c})`}}drawOutline(t,e){const r=Pr(this,ey)._++,s=P(this,wo,UA).call(this),i=fr._svgFactory.createElement("defs");s.append(i);const o=fr._svgFactory.createElement("path");i.append(o);const a=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(e){const d=fr._svgFactory.createElement("mask");i.append(d),l=`mask_p${this.pageIndex}_${r}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const h=fr._svgFactory.createElement("rect");d.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const p=fr._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const c=fr._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return s.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(s,t),f(this,Lr).set(r,s),r}finalizeDraw(t,e){f(this,Iu).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var l;if(!e)return;const{root:r,bbox:s,rootClass:i,path:o}=e,a=typeof t=="number"?f(this,Lr).get(t):t;if(a){if(r&&P(this,wo,WA).call(this,a,r),s&&P(l=fr,Wv,m_).call(l,a,s),i){const{classList:c}=a;for(const[u,d]of Object.entries(i))c.toggle(u,d)}if(o){const u=a.firstChild.firstChild;P(this,wo,WA).call(this,u,o)}}}updateParent(t,e){if(e===this)return;const r=f(this,Lr).get(t);r&&(f(e,Si).append(r),f(this,Lr).delete(t),f(e,Lr).set(t,r))}remove(t){f(this,Iu).delete(t),f(this,Si)!==null&&(f(this,Lr).get(t).remove(),f(this,Lr).delete(t))}destroy(){k(this,Si,null);for(const t of f(this,Lr).values())t.remove();f(this,Lr).clear(),f(this,Iu).clear()}};Si=new WeakMap,ey=new WeakMap,Lr=new WeakMap,Iu=new WeakMap,Wv=new WeakSet,m_=function(t,[e,r,s,i]){const{style:o}=t;o.top=`${100*r}%`,o.left=`${100*e}%`,o.width=`${100*s}%`,o.height=`${100*i}%`},wo=new WeakSet,UA=function(){const t=fr._svgFactory.create(1,1,!0);return f(this,Si).append(t),t.setAttribute("aria-hidden",!0),t},y_=function(t,e){const r=fr._svgFactory.createElement("clipPath");t.append(r);const s=`clip_${e}`;r.setAttribute("id",s),r.setAttribute("clipPathUnits","objectBoundingBox");const i=fr._svgFactory.createElement("use");return r.append(i),i.setAttribute("href",`#${e}`),i.classList.add("clip"),s},WA=function(t,e){for(const[r,s]of Object.entries(e))s===null?t.removeAttribute(r):t.setAttribute(r,s)},M(fr,Wv);let zA=fr;globalThis.pdfjsTestingUtils={HighlightOutliner:AA};Ut.AbortException;Ut.AnnotationEditorLayer;Ut.AnnotationEditorParamsType;Ut.AnnotationEditorType;Ut.AnnotationEditorUIManager;Ut.AnnotationLayer;Ut.AnnotationMode;Ut.ColorPicker;Ut.DOMSVGFactory;Ut.DrawLayer;Ut.FeatureTest;var UY=Ut.GlobalWorkerOptions;Ut.ImageKind;Ut.InvalidPDFException;Ut.MissingPDFException;Ut.OPS;Ut.OutputScale;Ut.PDFDataRangeTransport;Ut.PDFDateString;Ut.PDFWorker;Ut.PasswordResponses;Ut.PermissionFlag;Ut.PixelsPerInch;Ut.RenderingCancelledException;Ut.TextLayer;Ut.TouchManager;Ut.UnexpectedResponseException;Ut.Util;Ut.VerbosityLevel;Ut.XfaLayer;Ut.build;Ut.createValidAbsoluteUrl;Ut.fetchData;var WY=Ut.getDocument;Ut.getFilenameFromUrl;Ut.getPdfFilenameFromUrl;Ut.getXfaPageViewport;Ut.isDataScheme;Ut.isPdfFile;Ut.noContextMenu;Ut.normalizeUnicode;Ut.setLayerDimensions;Ut.shadow;Ut.stopEvent;var KY=Ut.version;const GY={class:"flex items-center justify-between mb-6"},YY={class:"flex items-center"},XY={key:0,class:"text-2xl font-bold text-gray-900 dark:text-white"},qY={key:0,class:"text-center py-8"},JY={key:1,class:"card"},QY={key:0,class:"mb-3 flex items-center"},ZY={class:"text-sm text-gray-600 dark:text-gray-300"},tX={class:"flex items-center justify-between mb-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg"},eX={class:"flex items-center space-x-2"},nX=["disabled"],rX={class:"text-sm text-gray-700 dark:text-gray-300"},sX=["disabled"],iX={class:"flex items-center space-x-2"},oX={class:"text-sm text-gray-700 dark:text-gray-300"},aX={class:"overflow-auto bg-gray-200 dark:bg-gray-900 rounded-lg p-4 flex justify-center"},lX={__name:"PdfViewer",setup(n){UY.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${KY}/pdf.worker.min.js`;const t=Pf(),e=pw(),r=Sk(),s=Ra(),i=ot(Number(t.params.id)),o=ot(null),a=ot(null),l=ot(1),c=ot(0),u=ot(!0),d=ot(null),h=ot(1);qn(async()=>{await s.fetchSubjects(),await p()}),ad(()=>{o.value&&o.value.destroy()});const p=async()=>{u.value=!0;try{if(a.value=await r.getPdfById(i.value),!a.value){e.push("/pdfs");return}const w=a.value.file,E=new Uint8Array(w),T=WY({data:E});o.value=await T.promise,c.value=o.value.numPages,await g(l.value)}catch(w){console.error("Error loading PDF:",w),alert("Error al cargar el PDF")}finally{u.value=!1}},g=async w=>{try{const E=await o.value.getPage(w),T=E.getViewport({scale:h.value}),I=d.value,C=I.getContext("2d");I.height=T.height,I.width=T.width;const R={canvasContext:C,viewport:T};await E.render(R).promise}catch(E){console.error("Error rendering PDF page:",E)}},m=async()=>{l.value>1&&(l.value--,await g(l.value))},b=async()=>{l.value<c.value&&(l.value++,await g(l.value))},y=async()=>{h.value+=.2,await g(l.value)},v=async()=>{h.value>.5&&(h.value-=.2,await g(l.value))},x=()=>{if(!a.value)return;const w=new Blob([a.value.file],{type:"application/pdf"}),E=document.createElement("a");E.href=URL.createObjectURL(w),E.download=`${a.value.title}.pdf`,E.click(),URL.revokeObjectURL(E.href)},S=w=>s.subjects.find(E=>E.id===w)||{name:"Sin materia",color:"#94a3b8"};return(w,E)=>{const T=Ia("router-link");return K(),Y("div",null,[A("div",GY,[A("div",YY,[bt(T,{to:"/pdfs",class:"mr-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"},{default:Se(()=>E[0]||(E[0]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),_:1,__:[0]}),a.value?(K(),Y("h1",XY,pt(a.value.title),1)):Re("",!0)]),a.value?(K(),Y("button",{key:0,onClick:x,class:"btn btn-primary flex items-center"},E[1]||(E[1]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),ge(" Descargar ")]))):Re("",!0)]),u.value?(K(),Y("div",qY,E[2]||(E[2]=[A("p",{class:"text-gray-500 dark:text-gray-400"},"Cargando documento...",-1)]))):a.value?(K(),Y("div",JY,[a.value.subjectId?(K(),Y("div",QY,[A("span",{class:"inline-block w-3 h-3 rounded-full mr-2",style:Wn({backgroundColor:S(a.value.subjectId).color})},null,4),A("span",ZY,pt(S(a.value.subjectId).name),1)])):Re("",!0),A("div",tX,[A("div",eX,[A("button",{onClick:m,class:"p-2 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600 disabled:opacity-50",disabled:l.value===1},E[3]||(E[3]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,nX),A("span",rX," Página "+pt(l.value)+" de "+pt(c.value),1),A("button",{onClick:b,class:"p-2 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600 disabled:opacity-50",disabled:l.value===c.value},E[4]||(E[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,sX)]),A("div",iX,[A("button",{onClick:v,class:"p-2 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"},E[5]||(E[5]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})],-1)])),A("span",oX,pt(Math.round(h.value*100))+"% ",1),A("button",{onClick:y,class:"p-2 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"},E[6]||(E[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})],-1)]))])]),A("div",aX,[A("canvas",{ref_key:"canvasRef",ref:d},null,512)])])):Re("",!0)])}}},Dk=ld("theme",()=>{const n=ot(localStorage.getItem("theme")==="dark");function t(r){n.value=r,localStorage.setItem("theme",r?"dark":"light")}function e(){t(!n.value)}return{isDark:n,setDarkMode:t,toggleDarkMode:e}}),cX={class:"space-y-6"},uX={class:"card"},dX={class:"flex items-center justify-between"},hX={class:"card"},fX={key:0,class:"text-gray-500 dark:text-gray-400"},pX={key:1,class:"space-y-4"},gX={class:"flex items-center justify-between"},mX=["disabled"],yX={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},bX={class:"card"},vX={class:"space-y-2"},wX={class:"flex items-center"},xX={class:"text-gray-900 dark:text-white"},SX={class:"card"},AX={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},EX=["disabled"],kX=["disabled"],CX={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},TX={__name:"SettingsPage",setup(n){const t=Dk(),e=Ra(),r=bw(),s=yw(),i=LE(),o=vD(),a=Sk(),l=ot(!1),c=ot(!1),u=ot(!1),d=ot(null);qn(async()=>{await e.fetchSubjects()});const h=async()=>{l.value=!0;try{await r.fetchNotes(),await s.fetchTasks(),await i.fetchEvents(),await o.fetchGrades(),await a.fetchPdfs();const S={subjects:e.subjects,notes:r.notes,tasks:s.tasks,planner:i.events,grades:o.grades,pdfs:a.pdfs.map(C=>({id:C.id,title:C.title,subjectId:C.subjectId,size:C.size,createdAt:C.createdAt,updatedAt:C.updatedAt}))},w=JSON.stringify(S,null,2),E=new Blob([w],{type:"application/json"}),T=URL.createObjectURL(E),I=document.createElement("a");I.href=T,I.download=`estudiaplan_backup_${new Date().toISOString().split("T")[0]}.json`,I.click(),URL.revokeObjectURL(T)}catch(S){console.error("Error exporting data:",S),alert("Error al exportar los datos")}finally{l.value=!1}},p=()=>{d.value&&d.value.click()},g=async S=>{const w=S.target.files[0];if(w){c.value=!0;try{const E=new FileReader;E.onload=async T=>{try{const I=JSON.parse(T.target.result);if(!I.subjects||!Array.isArray(I.subjects))throw new Error("Invalid data format");if(!confirm("¿Estás seguro de que deseas importar estos datos? Los datos existentes serán reemplazados.")){c.value=!1;return}for(const C of I.subjects)await e.addSubject({name:C.name,color:C.color});if(I.notes&&Array.isArray(I.notes))for(const C of I.notes)await r.addNote({title:C.title,content:C.content,subjectId:C.subjectId,tags:C.tags||[]});if(I.tasks&&Array.isArray(I.tasks))for(const C of I.tasks)await s.addTask({title:C.title,description:C.description||"",dueDate:C.dueDate,subjectId:C.subjectId,priority:C.priority||"medium",status:C.status||"pending"});if(I.planner&&Array.isArray(I.planner))for(const C of I.planner)await i.addEvent({title:C.title,description:C.description||"",startTime:C.startTime,endTime:C.endTime,day:C.day,subjectId:C.subjectId});if(I.grades&&Array.isArray(I.grades))for(const C of I.grades)await o.addGrade({title:C.title,score:C.score,maxScore:C.maxScore,weight:C.weight,date:C.date,subjectId:C.subjectId});alert("Datos importados correctamente"),location.reload()}catch(I){console.error("Error parsing import file:",I),alert("Error al importar los datos: formato de archivo inválido")}finally{c.value=!1}},E.readAsText(w)}catch(E){console.error("Error importing data:",E),alert("Error al importar los datos"),c.value=!1}}},m=()=>{u.value=!0},b=()=>{u.value=!1},y=async()=>{try{if(!confirm("¿Estás ABSOLUTAMENTE seguro? Esta acción eliminará TODOS tus datos y no puede deshacerse.")){b();return}const S=await window.indexedDB.open("EstudiaPlan");S.onupgradeneeded=()=>{const w=S.result.objectStoreNames;for(let E=0;E<w.length;E++)S.result.deleteObjectStore(w[E])},location.reload()}catch(S){console.error("Error deleting data:",S),alert("Error al eliminar los datos")}},v=async()=>{await s.requestNotificationPermission()},x=()=>"Notification"in window?Notification.permission:"not-supported";return(S,w)=>(K(),Y("div",null,[w[13]||(w[13]=A("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-6"},"Configuración",-1)),A("div",cX,[A("div",uX,[w[2]||(w[2]=A("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Apariencia",-1)),A("div",dX,[w[1]||(w[1]=A("span",{class:"text-gray-700 dark:text-gray-300"},"Tema Oscuro",-1)),A("button",{onClick:w[0]||(w[0]=E=>ee(t).toggleDarkMode()),class:Kt(["relative inline-flex items-center h-6 rounded-full w-11 transition-colors",ee(t).isDark?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"])},[A("span",{class:Kt(["inline-block w-4 h-4 transform rounded-full bg-white transition-transform",ee(t).isDark?"translate-x-6":"translate-x-1"])},null,2)],2)])]),A("div",hX,[w[4]||(w[4]=A("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Notificaciones",-1)),x()==="not-supported"?(K(),Y("div",fX," Las notificaciones no están soportadas en este navegador. ")):(K(),Y("div",pX,[A("div",gX,[w[3]||(w[3]=A("span",{class:"text-gray-700 dark:text-gray-300"},"Estado",-1)),A("span",{class:Kt(["px-2 py-1 text-xs rounded-full",{"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":x()==="granted","bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":x()==="default","bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":x()==="denied"}])},pt(x()==="granted"?"Habilitadas":x()==="denied"?"Bloqueadas":"No configuradas"),3)]),x()!=="granted"?(K(),Y("button",{key:0,onClick:v,class:"btn btn-primary w-full",disabled:x()==="denied"},pt(x()==="denied"?"Notificaciones bloqueadas en el navegador":"Habilitar Notificaciones"),9,mX)):Re("",!0),x()==="denied"?(K(),Y("p",yX," Para habilitar las notificaciones, debes cambiar la configuración en tu navegador. ")):Re("",!0)]))]),A("div",bX,[w[5]||(w[5]=A("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Materias",-1)),A("div",vX,[(K(!0),Y(ae,null,ln(ee(e).subjects,E=>(K(),Y("div",{key:E.id,class:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 border border-gray-200 dark:border-gray-700 rounded-lg"},[A("div",wX,[A("span",{class:"inline-block w-4 h-4 rounded-full mr-3",style:Wn({backgroundColor:E.color})},null,4),A("span",xX,pt(E.name),1)])]))),128))])]),A("div",SX,[w[8]||(w[8]=A("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Gestión de Datos",-1)),A("div",AX,[A("button",{onClick:h,class:"btn bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 flex items-center justify-center",disabled:l.value},[w[6]||(w[6]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),ge(" "+pt(l.value?"Exportando...":"Exportar Datos"),1)],8,EX),A("button",{onClick:p,class:"btn bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 flex items-center justify-center",disabled:c.value},[w[7]||(w[7]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),ge(" "+pt(c.value?"Importando...":"Importar Datos"),1)],8,kX),A("input",{type:"file",ref_key:"fileInputRef",ref:d,onChange:g,accept:"application/json",class:"hidden"},null,544)]),A("div",{class:"mt-6"},[A("button",{onClick:m,class:"btn bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 w-full"}," Eliminar Todos los Datos ")])]),w[9]||(w[9]=A("div",{class:"card"},[A("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Acerca de"),A("div",{class:"text-gray-700 dark:text-gray-300 space-y-2"},[A("p",null,"EstudiaPlan v1.0.0"),A("p",null,"Una aplicación para ayudar a los estudiantes a organizar su vida académica."),A("p",null,"© 2025 EstudiaPlan. Todos los derechos reservados.")])],-1))]),u.value?(K(),Y("div",CX,[A("div",{class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6"},[w[10]||(w[10]=A("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},"Confirmar Eliminación",-1)),w[11]||(w[11]=A("p",{class:"text-gray-600 dark:text-gray-300 mb-2"}," ¿Estás seguro de que deseas eliminar TODOS tus datos? ",-1)),w[12]||(w[12]=A("p",{class:"text-red-600 dark:text-red-400 font-medium mb-6"}," Esta acción no se puede deshacer y perderás toda tu información. ",-1)),A("div",{class:"flex justify-end space-x-3"},[A("button",{onClick:b,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Cancelar "),A("button",{onClick:y,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Eliminar Todo ")])])])):Re("",!0)]))}},MX={class:"flex flex-col items-center justify-center py-12"},PX={__name:"NotFoundPage",setup(n){const t=pw(),e=()=>{t.go(-1)},r=()=>{t.push("/")};return(s,i)=>(K(),Y("div",MX,[i[0]||(i[0]=A("h1",{class:"text-6xl font-bold text-primary-600 dark:text-primary-400 mb-4"},"404",-1)),i[1]||(i[1]=A("p",{class:"text-xl text-gray-700 dark:text-gray-300 mb-8"},"Página no encontrada",-1)),A("div",{class:"flex space-x-4"},[A("button",{onClick:e,class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"}," Volver "),A("button",{onClick:r,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"}," Ir al Inicio ")])]))}},OX=[{path:"/",name:"home",component:pH},{path:"/notes",name:"notes",component:jH},{path:"/notes/:id",name:"note-editor",component:JW,props:!0},{path:"/tasks",name:"tasks",component:p7},{path:"/tasks/:id",name:"task-editor",component:P7,props:!0},{path:"/planner",name:"planner",component:$K},{path:"/grades",name:"grades",component:vG},{path:"/pdfs",name:"pdfs",component:UG},{path:"/pdfs/:id",name:"pdf-viewer",component:lX,props:!0},{path:"/settings",name:"settings",component:TX},{path:"/:pathMatch(.*)*",name:"not-found",component:PX}],IX=iB({history:N4("/Focus-App/"),routes:OX}),RX={class:"bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-gray-700 py-2 w-full"},DX={class:"max-w-lg mx-auto px-4"},NX={class:"flex justify-around items-center"},_X={__name:"TheNavigation",setup(n){const t=Pf();Dk();const e=Ee(()=>t.name);return(r,s)=>{const i=Ia("router-link");return K(),Y("nav",RX,[A("div",DX,[A("div",NX,[bt(i,{to:"/",class:Kt(["flex flex-col items-center py-1 px-3 text-sm rounded-lg transition-colors",e.value==="home"?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"])},{default:Se(()=>s[0]||(s[0]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),A("span",null,"Inicio",-1)])),_:1,__:[0]},8,["class"]),bt(i,{to:"/notes",class:Kt(["flex flex-col items-center py-1 px-3 text-sm rounded-lg transition-colors",e.value==="notes"?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"])},{default:Se(()=>s[1]||(s[1]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),A("span",null,"Apuntes",-1)])),_:1,__:[1]},8,["class"]),bt(i,{to:"/tasks",class:Kt(["flex flex-col items-center py-1 px-3 text-sm rounded-lg transition-colors",e.value==="tasks"?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"])},{default:Se(()=>s[2]||(s[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),A("span",null,"Tareas",-1)])),_:1,__:[2]},8,["class"]),bt(i,{to:"/planner",class:Kt(["flex flex-col items-center py-1 px-3 text-sm rounded-lg transition-colors",e.value==="planner"?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"])},{default:Se(()=>s[3]||(s[3]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),A("span",null,"Planner",-1)])),_:1,__:[3]},8,["class"]),bt(i,{to:"/settings",class:Kt(["flex flex-col items-center py-1 px-3 text-sm rounded-lg transition-colors md:hidden",e.value==="settings"?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"])},{default:Se(()=>s[4]||(s[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),A("span",null,"Ajustes",-1)])),_:1,__:[4]},8,["class"])])])])}}},LX={class:"w-64 flex-shrink-0 h-screen bg-white dark:bg-slate-800 border-r border-gray-200 dark:border-gray-700"},FX={class:"flex flex-col h-full"},BX={class:"flex-1 px-4 py-6 space-y-2 overflow-y-auto"},$X={class:"p-4 border-t border-gray-200 dark:border-gray-700"},jX={__name:"TheSidebar",setup(n){const t=Pf(),e=Ee(()=>t.name);return(r,s)=>{const i=Ia("router-link");return K(),Y("aside",LX,[A("div",FX,[s[7]||(s[7]=A("div",{class:"flex items-center justify-center h-16 border-b border-gray-200 dark:border-gray-700"},[A("h1",{class:"text-xl font-bold text-primary-600 dark:text-primary-400"},"EstudiaPlan")],-1)),A("nav",BX,[bt(i,{to:"/",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="home"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[0]||(s[0]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),A("span",null,"Dashboard",-1)])),_:1,__:[0]},8,["class"]),bt(i,{to:"/notes",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="notes"||e.value==="note-editor"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[1]||(s[1]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),A("span",null,"Apuntes",-1)])),_:1,__:[1]},8,["class"]),bt(i,{to:"/tasks",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="tasks"||e.value==="task-editor"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[2]||(s[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),A("span",null,"Tareas",-1)])),_:1,__:[2]},8,["class"]),bt(i,{to:"/planner",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="planner"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[3]||(s[3]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),A("span",null,"Planificador",-1)])),_:1,__:[3]},8,["class"]),bt(i,{to:"/grades",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="grades"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[4]||(s[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),A("span",null,"Calificaciones",-1)])),_:1,__:[4]},8,["class"]),bt(i,{to:"/pdfs",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="pdfs"||e.value==="pdf-viewer"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[5]||(s[5]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),A("span",null,"Documentos",-1)])),_:1,__:[5]},8,["class"])]),A("div",$X,[bt(i,{to:"/settings",class:Kt(["flex items-center px-4 py-3 rounded-lg transition-colors",e.value==="settings"?"bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 font-medium":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"])},{default:Se(()=>s[6]||(s[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),A("span",null,"Configuración",-1)])),_:1,__:[6]},8,["class"])])])])}}},HX={key:0,class:"fixed bottom-20 md:bottom-4 right-4 z-50"},VX={__name:"InstallPrompt",setup(n){const t=ot(null),e=ot(!1),r=o=>{o.preventDefault(),t.value=o,e.value=!0},s=async()=>{t.value&&(t.value.prompt(),await t.value.userChoice,t.value=null,e.value=!1)},i=()=>{window.matchMedia("(display-mode: standalone)").matches&&(e.value=!1)};return qn(()=>{window.addEventListener("beforeinstallprompt",r),i()}),ad(()=>{window.removeEventListener("beforeinstallprompt",r)}),(o,a)=>e.value?(K(),Y("div",HX,[A("button",{onClick:s,class:"bg-accent-500 hover:bg-accent-600 text-white font-semibold rounded-lg shadow-lg px-4 py-3 flex items-center transition-colors duration-200"},a[0]||(a[0]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),ge(" Descargar App ")]))])):Re("",!0)}},zX={class:"min-h-screen flex flex-col md:flex-row transition-colors duration-300"},UX={class:"flex-1 flex flex-col"},WX={class:"bg-white dark:bg-slate-800 shadow-sm border-b border-gray-200 dark:border-gray-700"},KX={class:"px-4 py-3 flex items-center justify-between"},GX={class:"text-xl font-bold text-gray-900 dark:text-white"},YX={class:"flex items-center space-x-2"},XX={key:0,class:"i-heroicons-sun-20-solid text-white w-5 h-5"},qX={key:1,class:"i-heroicons-moon-20-solid text-gray-700 w-5 h-5"},JX={class:"flex-1 overflow-auto p-4"},QX={__name:"App",setup(n){const t=Pf(),e=Dk(),r=Ee(()=>({home:"Dashboard",notes:"Apuntes",tasks:"Tareas",planner:"Planificador",grades:"Calificaciones",pdfs:"Documentos",settings:"Configuración"})[t.name]||"EstudiaPlan");return Mi(()=>e.isDark,s=>{s?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},{immediate:!0}),qn(()=>{window.matchMedia("(prefers-color-scheme: dark)").matches&&e.setDarkMode(!0)}),(s,i)=>{const o=Ia("router-view");return K(),Y("div",zX,[bt(jX,{class:"hidden md:flex"}),A("div",UX,[A("header",WX,[A("div",KX,[A("h1",GX,pt(r.value),1),A("div",YX,[A("button",{class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-700",onClick:i[0]||(i[0]=a=>ee(e).toggleDarkMode())},[ee(e).isDark?(K(),Y("span",XX)):(K(),Y("span",qX))])])])]),A("main",JX,[bt(o,null,{default:Se(({Component:a})=>[bt(UP,{name:"fade",mode:"out-in"},{default:Se(()=>[(K(),Yl(nP(a)))]),_:2},1024)]),_:1})]),bt(_X,{class:"md:hidden"})]),bt(VX)])}}};"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/estudiaplan/sw.js").then(n=>{console.log("SW registered: ",n)}).catch(n=>{console.log("SW registration failed: ",n)})});const ZX=Q3(),Nk=yb(QX);Nk.use(ZX);Nk.use(IX);Nk.mount("#app");
